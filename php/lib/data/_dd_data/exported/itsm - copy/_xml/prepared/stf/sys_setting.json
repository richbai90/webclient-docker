{"espForm":{"configuration":{"settings":{"name":"sys_setting","title":"System Settings","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":[{"name":"sw_adm_settings","type":"Related Table","mainDetailsColumn":"setting_name","flags":"6"},{"name":"sw_sbs_settings","type":"Main Details Table","mainDetailsColumn":"setting_name","flags":"4"}]},"javascript":{"methods":{"method":{"name":"(Globals)","code":"function setup_form(strValue)\n{\n\tvar oRec = app.g.get_record(\"sw_adm_settings\", strValue);\n\tif(oRec)\n\t{\n\t\tvar oEle = null;\n\t\tif(oRec.flg_type==0)\n\t\t{\n\t\t\toEle = mainform.fld_numeric;\n\t\t\t_evi(mainform.fld_picklist,false);\n\t\t\t_evi(mainform.fld_string,false);\n\t\t\t_evi(mainform.fld_xmlpicklist,false);\n\t\t\t_evi(mainform.fld_numpicklist,false);\n\t\t\t_evi(mainform.fld_mailbox_picklist,false);\n\t\t\t_evi(mainform.fld_kbcatalog_picklist, false);\n\t\t}\n\t\telse if(oRec.flg_type==1)\n\t\t{\n\t\t\t_evi(mainform.fld_numeric,false);\n\t\t\t_evi(mainform.fld_picklist,false);\n\t\t\t_evi(mainform.fld_xmlpicklist,false);\n\t\t\t_evi(mainform.fld_numpicklist,false);\n\t\t\t_evi(mainform.fld_mailbox_picklist,false);\n\t\t\t_evi(mainform.fld_kbcatalog_picklist, false);\n\t\t\toEle =mainform.fld_string;\n\t\t}\n\t\telse if(oRec.flg_type==2)\n\t\t{\n\t\t\toEle = mainform.fld_picklist;\n\t\t\t_evi(mainform.fld_numeric,false);\n\t\t\t_evi(mainform.fld_string,false);\n\t\t\t_evi(mainform.fld_xmlpicklist,false);\n\t\t\t_evi(mainform.fld_numpicklist,false);\n\t\t\t_evi(mainform.fld_mailbox_picklist,false);\n\t\t\t_evi(mainform.fld_kbcatalog_picklist, false);\n\t\t\t_slf(oEle , \"setting=\"+strValue);\n\t\t}\n\t\telse if(oRec.flg_type==3)\n\t\t{\n\t\t\toEle = mainform.fld_xmlpicklist;\n\t\t\t_evi(mainform.fld_numeric,false);\n\t\t\t_evi(mainform.fld_string,false);\n\t\t\t_evi(mainform.fld_picklist,false);\n\t\t\t_evi(mainform.fld_numpicklist,false);\n\t\t\t_evi(mainform.fld_mailbox_picklist,false);\n\t\t\t_evi(mainform.fld_kbcatalog_picklist, false);\n\t\t\t\/\/-- call php to get list\n\t\t\tvar strURL = \"php\/itsm\/get_setting_options.php?option=\"+sw_adm_settings.source_file; \n\t\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\t\tmainform.fld_xmlpicklist.pickList = strResult;\n\t\t}\n\t\telse if(oRec.flg_type==4)\n\t\t{\n\t\t\toEle = mainform.fld_numpicklist;\n\t\t\t_evi(mainform.fld_xmlpicklist,false);\n\t\t\t_evi(mainform.fld_numeric,false);\n\t\t\t_evi(mainform.fld_string,false);\n\t\t\t_evi(mainform.fld_picklist,false);\n\t\t\t_evi(mainform.fld_mailbox_picklist,false);\n\t\t\t_evi(mainform.fld_kbcatalog_picklist, false);\n\t\t\t\/\/-- call php to get list\n\t\t\tvar strURL = \"php\/itsm\/get_setting_options.php?option=\"+sw_adm_settings.source_file; \n\t\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\t\tmainform.fld_numpicklist.pickList = strResult;\n\t\t}\n\t\telse if(oRec.flg_type==5) \/\/ Pick list of available Shared Mailboxes\n\t\t{\n\t\t\toEle = mainform.fld_mailbox_picklist;\n\t\t\t_evi(mainform.fld_numeric,false);\n\t\t\t_evi(mainform.fld_string,false);\n\t\t\t_evi(mainform.fld_numpicklist,false);\n\t\t\t_evi(mainform.fld_kbcatalog_picklist, false);\n\t\t\t\n\t\t\t\/\/-- call php to get mailbox list\n\t\t\tvar strURL = \"php\/itsm\/get_mailboxlist.php?sessid=\" + app.session.sessionId; \n\t\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\t\tmainform.fld_mailbox_picklist.pickList = strResult;\n\t\t}\n\t\telse if(oRec.flg_type==6) \/\/ Pick list of available email templates\n\t\t{\n\t\t\tvar boolLoad = true;\n\t\t\toEle = mainform.fld_mailbox_picklist;\n\t\t\t_evi(mainform.fld_numeric,false);\n\t\t\t_evi(mainform.fld_string,false);\n\t\t\t_evi(mainform.fld_numpicklist,false);\n\t\t\t_evi(mainform.fld_kbcatalog_picklist, false);\n\t\t\t\n\t\t\t\/\/-- can work out name of mailbox setting (setting name)\n\t\t\tvar strMailboxSetting = strValue.replace('.EMAILTEMPLATE', '.MAILBOX');\n\t\t\t\/\/-- get mailbox name (setting value)\n\t\t\tvar strMailboxName = \"\";\n\t\t\tvar oParams = {};\n\t\t\toParams.mailbox = strMailboxSetting;\n\t\t\toParams.dataset = _swdoc.GetArg(\"dataset\");\n\t\t\tvar oMailbox = app.g.get_sqrecordset(\"form\/sys_settings\/get_mailbox_value.select\",oParams);\n\t\t\tif(oMailbox.Fetch())\n\t\t\t{\n\t\t\t\tstrMailboxName = app.g.get_field(oMailbox,\"setting_value\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tMessageBox('The setting value of '+\tstrMailboxSetting +' could not be loaded.');\n\t\t\t\tboolLoad = false;\n\t\t\t}\n\t\t\tif(strMailboxName==\"\")\n\t\t\t{\n\t\t\t\tMessageBox('The setting value of '+\tstrMailboxSetting +' is not set.');\t\t\t\n\t\t\t\tboolLoad = false;\n\t\t\t}\n\t\t\t\n\t\t\tif(boolLoad)\n\t\t\t{\n\t\t\t\t\/\/-- call php to get mailbox list\n\t\t\t\tvar strURL = \"php\/itsm\/get_templatelist.php?mailboxname=\" + strMailboxName; \n\t\t\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\t\t\tmainform.fld_mailbox_picklist.pickList = strResult;\n\t\t\t}\n\t\t}\n\t\telse if(oRec.flg_type==7) \/\/ Pick list of available knowledgebase catalogs\n\t\t{\n\t\t\toEle = mainform.fld_kbcatalog_picklist;\n\t\t\t_evi(mainform.fld_numeric,false);\n\t\t\t_evi(mainform.fld_string,false);\n\t\t\t_evi(mainform.fld_numpicklist,false);\n\t\t\t\n\t\t\t\/\/-- call php to get mailbox list\n\t\t\tvar strURL = \"php\/itsm\/get_kbcataloglist.php?sessid=\" + app.session.sessionId; \n\t\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\t\tmainform.fld_kbcatalog_picklist.pickList = strResult;\n\t\t}\n\t\t\n\t\t_evi(oEle,true);\n\t\tif(oRec.flg_mandatory)\n\t\t{\n\t\t\t_ema(oEle,true);\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_ema(oEle,false);\n\t\t}\n\n\t}\n\telse\n\t{\n\t\tMessageBox('Failed to load settings value');\n\t}\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"387","height":"131","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Setting Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"14","left":"39","right":"120","bottom":"32"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_name"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_pk_setting","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"14","left":"130","right":"380","bottom":"32"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","listItems":"WSSM.MAX_LOGIN_ATTEMPTS|WSSM.LOCKOUT_LENGTH_MINS|","sqlSource":"swdata","distinctTable":"sw_adm_settings","distinctColumn":"pk_settings"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"Setting Value","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"36","left":"38","right":"120","bottom":"54"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_numeric","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"130","right":"380","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","inputMask":"###","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_picklist","type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"130","right":"380","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","storedQuery":"setting.load_value","listFilter":"setting="}}},{"general":{"name":"fld_xmlpicklist","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"130","right":"380","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","url":"&[app.webroot]\/clisupp\/php\/itsm\/get_setting_options.php?option=&[sw_adm_settings.source_file]"}}},{"general":{"name":"fld_numpicklist","type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"130","right":"380","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","url":"&[app.webroot]\/clisupp\/php\/itsm\/get_setting_options.php?option=remotetools"}}},{"general":{"name":"fld_string","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"130","right":"380","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"58","left":"58","right":"120","bottom":"74"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sw_sbs_settings.description"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field1","type":"Field"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"58","left":"130","right":"380","bottom":"124"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.description"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"fld_mailbox_picklist","type":"Field"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"130","right":"380","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata"}}},{"general":{"name":"fld_kbcatalog_picklist","type":"Field"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"130","right":"380","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sw_sbs_settings.setting_value"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata"}}}]},"javascript":{"methods":{"method":[{"name":"fld_pk_setting_OnValueChanged","code":"fld_pk_setting_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.setup_form(strValue);\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(sw_sbs_settings.setting_name!=\"\")\n\t\t_swdoc.setup_form(sw_sbs_settings.setting_name);\n\n}"},{"name":"fld_xmlpicklist_OnLeftClick","code":"fld_xmlpicklist_OnLeftClick()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\t\/\/-- call php to get mailbox list\n\t\tvar strURL = \"php\/itsm\/get_setting_options.php?option=\"+sw_adm_settings.source_file; \n\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\tfld_xmlpicklist.pickList = strResult;\n\n\treturn true;\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}