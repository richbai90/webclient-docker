{"espForm":{"configuration":{"settings":{"name":"_sys_calendar_appointment","title":"Appointment","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strClass)\n{\n\t\/\/-- get data\n\tvar intCalID = _swdoc.GetArg('calid');\n\tvar intAppID = _swdoc.GetArg('appid');\n\t\n\tif(intCalID!=\"\")\n\t{\n\t\t\/\/-- get calendar name\n\t\tvar rs = new SqlQuery();\n\t\trs.Query(\"select name from calendars where id =\" + intCalID,\"sw_calendar\");\n\t\tif(rs.Fetch())\n\t\t{\n\t\t\t\/\/-- get appointment record\n\t\t\tvar strName = rs.GetValueAsString(\"name\");\n\t\t\tvar strAppTable = \"appointments_\" + strName;\n\t\t\t_swdoc._overide_master_save_table = strAppTable; \/\/-- will use this when saving data\n\t\t\tMessageBox(_swdoc._overide_master_save_table)\n\t\t\tif(intAppID!=\"\")\n\t\t\t{\n\t\t\t\trs = new SqlQuery();\n\t\t\t\trs.Query(\"select * from \"+strAppTable+\" where id = \" + intAppID,\"sw_calendar\");\n\t\t\t\tif(rs.Fetch())\n\t\t\t\t{\n\t\t\t\t\t\/\/-- load record info form \n\t\t\t\t\treturn _swdoc._load_bespoke_record(rs,\"appointments\"); \/\/-- webclient specific\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"424","height":"387","backgroundColor":"#dddddd","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Appointment","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Tab1","backgroundColor":"#ccccff","foregroundColor":"#8aa8e4","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"32","left":"6","right":"418","bottom":"383"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":{"name":"Details","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}}},"selectedTextFont":{"@size":"8","#text":"Trebuchet MS"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"subject","type":"Field","group":"Appointment:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"61","left":"80","right":"409","bottom":"79"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"appointments.subject"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"tabBackMode":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_date","type":"Field","group":"Appointment:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"83","left":"80","right":"241","bottom":"101"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"appointments.start_time"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"tabBackMode":"#eeeeee","dateFormatMode":"0","disabledBackgroundColor":"#eeeeee","hintText":"yyyy-MM-dd"}}},{"general":{"name":"tb_start_time","type":"Field","group":"Appointment:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"105","left":"80","right":"129","bottom":"123"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"tabBackMode":"#eeeeee","listItems":"00:00|00:30|01:00|01:30|02:00|02:30|03:00|03:30|04:00|04:30|05:00|05:30|06:00|06:30|07:00|07:30|08:00|08:30|09:00|09:30|10:00|10:30|11:00|11:30|12:00|12:30|13:00|13:30|14:00|14:30|15:00|15:30|16:00|16:30|17:00|17:30|18:00|18:30|19:00|19:30|20:00|20:30|21:00|21:30|22:00|22:30|23:00|23:30","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_end_time","type":"Field","group":"Appointment:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"105","left":"192","right":"241","bottom":"123"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"tabBackMode":"#eeeeee","listItems":"00:00|00:30|01:00|01:30|02:00|02:30|03:00|03:30|04:00|04:30|05:00|05:30|06:00|06:30|07:00|07:30|08:00|08:30|09:00|09:30|10:00|10:30|11:00|11:30|12:00|12:30|13:00|13:30|14:00|14:30|15:00|15:30|16:00|16:30|17:00|17:30|18:00|18:30|19:00|19:30|20:00|20:30|21:00|21:30|22:00|22:30|23:00|23:30","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"description","type":"Field","group":"Appointment:0"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"149","left":"15","right":"409","bottom":"374"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"appointments.description"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"tabBackMode":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Appointment1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Appointment:0"},"appearance":{"index":"6","caption":"Date","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"83","left":"16","right":"76","bottom":"101"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Appointment2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Appointment:0"},"appearance":{"index":"7","caption":"Subject","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"61","left":"16","right":"76","bottom":"79"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Appointment3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Appointment:0"},"appearance":{"index":"8","caption":"Show Time As","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"86","left":"280","right":"362","bottom":"104"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Appointment4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Appointment:0"},"appearance":{"index":"9","caption":"Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"130","left":"12","right":"83","bottom":"145"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"show_time_as","type":"Field","group":"Appointment:0"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"105","left":"280","right":"409","bottom":"123"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"appointments.show_time_as"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"tabBackMode":"#eeeeee","listItems":"Free^1|Busy^2|Tentative^3|Out of Office^4|","disabledBackgroundColor":"#eeeeee","defaultValue":"1"}}},{"general":{"name":"Appointment5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Appointment:0"},"appearance":{"index":"11","caption":"Start Time","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"105","left":"16","right":"76","bottom":"123"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Appointment6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Appointment:0"},"appearance":{"index":"12","caption":"End Time","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"106","left":"134","right":"188","bottom":"124"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Rect1","type":"Rectange"},"appearance":{"index":"13","backgroundColor":"#eaeaea","foregroundColor":"#b2b2b2","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"2","left":"7","right":"417","bottom":"29"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_save","type":"EventButton","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"14","caption":"Save","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"3","left":"13","right":"77","bottom":"27"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","eventButtonIcon":"ImageList=Appointment;IconIndex=0"}}},{"general":{"name":"btn_cancel","type":"EventButton","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"15","caption":"Delete","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"3","left":"82","right":"146","bottom":"27"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","eventButtonIcon":"ImageList=Appointment;IconIndex=1"}}}]},"javascript":{"methods":{"method":[{"name":"btn_save_OnPressed","code":"btn_save_OnPressed()\n{\n\t\/\/-- nwj - set start time and end time\n\tvar strYYYYMMDD = tb_date.display.substring(0,10); \/\/-- should return formatted control display\n\tvar strStartTime = strYYYYMMDD + \" \" + tb_start_time.value + \":00\";\n\tvar strEndTime = strYYYYMMDD + \" \" + tb_end_time.value + \":00\";\n\t\n\t_swdoc.appointments.start_time = strStartTime;\n\t_swdoc.appointments.end_time = strEndTime;\n\t\n\t_swdoc.Save();\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t\/\/-- delete appointment\n\tif(confirm(\"Are you sure you want to delete this appointment?\"))\n\t{\n\t\t_swdoc._delete_master_record(); \/\/-- webclient function\n\t}\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tif(app.bWebClient==false)return;\n\t\t\n\t\/\/-- get start time and end\n\tif(_swdoc.appointments.start_time==\"\")\n\t{\n\t\t\/\/-- from params\n\t\t_swdoc.appointments.start_time = _swdoc.GetArg(\"startdate\");\n\t\t_swdoc.appointments.end_time = _swdoc.GetArg(\"enddate\"); \n\t\t_swdoc.UpdateFormFromData();\n\t}\n\t\n\n\tvar strStartTime = _swdoc.appointments.start_time.substring(11,16);\n\tvar strEndTime = _swdoc.appointments.end_time.substring(11,16);\n\t\t\n\t_eva(tb_start_time,strStartTime);\n\t_eva(tb_end_time,strEndTime);\t\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}