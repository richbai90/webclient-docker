{"espForm":{"configuration":{"settings":{"name":"EfImpactAssessmentEntry","title":"Assessment","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var appcode = \"\";\nvar usage_area = \"\";\nvar strSelectedKeys = \"\";\nvar intWeighting = 0;\nvar strImpactLevel = \"\";\nvar intLeadTime = 0;\nvar boolApplied = false; \/\/ set to true if the Apply button is used to indicate that the new settings should be applied\nvar changeRisk = false;\n\nvar boolEnforceEachCriterion = false;\nvar boolCDFAllowAlteration = false; \/\/ based on the System Setting to allow alteration of ILA from Change Details Form\n\nvar arrCriteriaDetails = new Array();\n\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction updateWeighting()\n{\n\t\/\/ Update the current Overall Weighting\n\t_swdoc.intWeighting = 0;\n\tfor (var x=0;x<_swdoc.MF().sl_ila_options.rowCount();x++)\n\t{\n\t\tif (_swdoc.MF().sl_ila_options.IsRowChecked(x))\n\t\t{\n\t\t\t_swdoc.intWeighting = Number(_swdoc.intWeighting) + Number(app.g.sl_getrawcolvalue(_swdoc.MF().sl_ila_options, x, \"weighting_value\"));\n\t\t}\n\t}\n\t_swdoc.intWeighting = _swdoc.intWeighting;\n\tapp._eva(_swdoc.MF().lb_weighting, _swdoc.intWeighting);\n\tapp._ete(_swdoc.MF().lb_weighting, _swdoc.intWeighting);\n\n}\n\nfunction updateImpactLevel()\n{\n\tvar xmlmc = new XmlMethodCall;\n\t\n\t\/\/ Set up our input parameters\n\txmlmc.SetValue(\"appcode\", _swdoc.appcode);\n\txmlmc.SetValue(\"usage_area\", _swdoc.usage_area);\n\txmlmc.SetValue(\"weighting\", _swdoc.intWeighting);\n\t\n\t\/\/ Invoke the method\n\tif(xmlmc.Invoke(\"VPME\", \"getILAImpactLevel\"))\n\t{\n\t\tstrImpactLvl = xmlmc.GetReturnValue(\"res1\");\n\t\t_swdoc.strImpactLevel = strImpactLvl;\n\t\tapp._eva(_swdoc.MF().eb_impact_level, strImpactLvl);\n\t\tapp._ete(_swdoc.MF().eb_impact_level, strImpactLvl);\n\t\t\n\t\t\/\/ Display the Lead Time based on the Impact\n\t\t_swdoc.intLeadTime = xmlmc.GetReturnValue(\"res2\");\n\t\t_swdoc.intLeadTime = _swdoc.intLeadTime;\n\t\tapp._eva(_swdoc.MF().eb_lead_time, _swdoc.intLeadTime);\n\t\tapp._ete(_swdoc.MF().eb_lead_time, _swdoc.intLeadTime);\n\t}\n\telse\n\t{\n\t\tMessageBox(xmlmc.GetLastError());\n\t}\n\t\n\tif (strImpactLvl == \"\")\n\t{\n\t\tapp._eva(_swdoc.MF().eb_impact_level, \"N\/A\");\n\t\tapp._ete(_swdoc.MF().eb_impact_level, \"N\/A\");\n\t\tapp._eva(_swdoc.MF().eb_lead_time, \"0\");\n\t\tapp._ete(_swdoc.MF().eb_lead_time, \"0\");\n\t}\n\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"809","height":"541","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"sl_ila_options","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"true","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"}},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"163","left":"9","right":"805","bottom":"441"},"scaling":{"top":"0","left":"0","right":"100","bottom":"50"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"criterion"},"name":"Criterion","width":"174","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"23","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"weighting_value","imageHAlign":"0"},"name":"Weighting","width":"69","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"option_text"},"name":"Option","width":"506","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"120","image":"-1","dataColumn":"4"}]},"sortColumn":"1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"sqlSource":"swdata","table":"ila_option","listFilter":"_ac=1&_swc_usage_area=Release Risk","newRecordForm":"Form.EfImpactAssessment","editRecordForm":"Form.EfImpactAssessment","borderColor":"#d3c9b6","storedQuery":"common.load_by_colvalues"}}},{"general":{"name":"btnApply","type":"EventButton"},"appearance":{"index":"1","caption":"OK","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"517","left":"633","right":"713","bottom":"537"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"Overall Weighting:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"517","left":"9","right":"100","bottom":"537"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Overall Assessment:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"517","left":"202","right":"311","bottom":"537"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_weighting","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"517","left":"102","right":"169","bottom":"537"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_clear_selected","type":"EventButton"},"appearance":{"index":"5","caption":"Clear All","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"139","left":"725","right":"805","bottom":"159"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"lb_selected_list1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","caption":"Selecting a second Option for a Criterion will clear the first selection.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"141","left":"9","right":"584","bottom":"156"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"eb_criterion_desc","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"465","left":"9","right":"389","bottom":"510"},"scaling":{"top":"50","left":"0","right":"50","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Criterion Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"444","left":"9","right":"142","bottom":"462"},"scaling":{"top":"50","left":"0","right":"0","bottom":"50"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"eb_option_desc","type":"Field"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"465","left":"425","right":"805","bottom":"510"},"scaling":{"top":"50","left":"50","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"10","caption":"Option Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"444","left":"425","right":"558","bottom":"462"},"scaling":{"top":"50","left":"50","right":"50","bottom":"50"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"eb_impact_level","type":"Field"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"517","left":"312","right":"379","bottom":"537"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lbl_lead_time","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"12","caption":"Impact Lead Time:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"517","left":"422","right":"531","bottom":"537"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"eb_lead_time","type":"Field"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"517","left":"542","right":"609","bottom":"537"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"sl_current_ila_options","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"false","horizontalGridLines":"false","autoLoad":"false","allowMultiSelect":"false"}},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"9","right":"805","bottom":"129"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"criterion"},"name":"Criterion","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"weighting_value"},"name":"Weighting","width":"84","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"option_text"},"name":"Option","width":"438","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"ID","width":"120","image":"-1","dataColumn":"3"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#cae1ee","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"1","borderColor":"#d3c9b6","sqlSource":"swdata","table":"ila_option","listFilter":"pids=-1","storedQuery":"common.load_by_pkautoid"}}},{"general":{"name":"lb_selected_list2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"15","caption":"The current selected values","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"14","left":"10","right":"168","bottom":"29"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"btn_history","type":"EventButton"},"appearance":{"index":"16","caption":"History","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"12","left":"725","right":"805","bottom":"32"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"17","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"517","left":"720","right":"800","bottom":"537"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.strSelectedKeys = _swdoc.GetArg(\"ila_options\");\n\t_swdoc.appcode = _swdoc.GetArg(\"appcode\");\n\t_swdoc.usage_area = _swdoc.GetArg(\"usage_area\");\n\t_swdoc.changeRisk = _swdoc.GetArg(\"changeRisk\");\n\t\n\tapp._evi(_swdoc.MF().btn_history, !(_swdoc.GetArg(\"mode\") == \"log form\"))\n\n\tif (_swdoc.strSelectedKeys != \"\")\n\t{\n\t\tapp._slf(_swdoc.MF().sl_current_ila_options, \"pids=\" + _swdoc.strSelectedKeys);\n\t}\n\t\n\t\/\/ F0111914 Need to cater for different Usage options\n\tswitch (_swdoc.usage_area)\n\t{\n\t\tcase \"Change Log Call Form\":\n\t\t\t_swdoc.boolEnforceEachCriterion = app.g.ila_changelogcall_enforce_each_criterion();\n\t\t\t\/\/ Check if the ILA can be altered when this form is launched from the Change Details Form. This is based on Application Right\n\t\t\tvar boolAlterILA = app.itsm.can_alter_ila();\n\t\tbreak;\n\t\t\n\t\tcase \"Release Risk\":\n\t\t\t_swdoc.boolEnforceEachCriterion = true;\n\t\t\tvar boolAlterILA = app.itsm.release_can_alter_ila();\n\t\t\tapp._evi(_swdoc.MF().lbl_lead_time, false);\n\t\t\tapp._evi(_swdoc.MF().eb_lead_time, false);\n\t\tbreak;\n\t}\n\t\/\/ F0111914 EOF\n\t\n\t\/\/ If Risk Assessment is selected, then check for canalterrights against Change Management\n\tif (_swdoc.changeRisk)\n\t{\n\t\tvar boolAlterILA = app.itsm.can_alter_ila();\n\t}\n\t\n\t\/\/--F0101061\n\tif(!_swdoc.boolEnforceEachCriterion)\n\t\tapp._ete(_swdoc.MF().lb_selected_list1 , \"Selecting a second Option for a Criterion will clear the first selection.\");\n\t\t\n\tif ((_swdoc.GetArg(\"mode\") == \"details form\") && (!boolAlterILA))\n\t{\n\t\tapp._een(_swdoc.MF().btnApply, false);\n\t\tapp._een(_swdoc.MF().sl_ila_options, false);\n\t\tapp._een(_swdoc.MF().btn_clear_selected, false);\n\t}\n\t\n\t\/\/ Set the filter of the list based on the contents of the selected keys\n\tvar strFilter = \"_ac=1&_swc_usage_area=\"+_swdoc.usage_area;\n\tapp._slf(_swdoc.MF().sl_ila_options , strFilter);\t\n\t\n\t_swdoc.MF().SetTimer(101, 200);\n\t_swdoc.MF().sl_ila_options.Refresh();\n\t_swdoc.MF().sl_current_ila_options.Refresh();\n\t\n\t\/\/Check the Options which have already been selected\n\tvar arrSelectedKeys = _swdoc.strSelectedKeys.split(\",\");\n\tfor (x in arrSelectedKeys)\n\t{\n\t\tapp.g.sqllist_checkrow_byvalue(_swdoc.MF().sl_ila_options, arrSelectedKeys[x], 1);\n\t}\n\t\n\t\/\/ Update the Weighting\n\t_swdoc.updateWeighting();\n\t\n\t\/\/ Update Level Impact\n\t_swdoc.updateImpactLevel();\n\n\t_swdoc.arrCriteriaDetails = app.g.get_ILA_criteria_desc(_swdoc.appcode, _swdoc.usage_area);\n\t\n\n}"},{"name":"sl_ila_options_OnItemDoubleClicked","code":"sl_ila_options_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\treturn false; \/\/ no requirement to enable viewing of the selected entry\n\n}"},{"name":"btnApply_OnPressed","code":"btnApply_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strTempSelectedKeys = app.g.sl_getchecked_valuesdel(_swdoc.MF().sl_ila_options, \"pk_auto_id\", \",\", \"\", false);\n\t\/\/ DTH: Check if we need to enforce the selection of one option for each and every Criteria\n\tif (_swdoc.boolEnforceEachCriterion)\n\t{\n\t\tvar arrTempSelectedKeys = strTempSelectedKeys.split(\",\");\n\t\tif (arrTempSelectedKeys.length < _swdoc.arrCriteriaDetails.length)\n\t\t{\n\t\t\tMessageBox(\"One Option must be selected for each available Criterion\");\n\t\t\treturn;\n\t\t}\n\t}\n\t_swdoc.strSelectedKeys = strTempSelectedKeys;\n\t_swdoc.boolApplied = true;\n    _swdoc.CloseForm();\n}"},{"name":"sl_ila_options_OnItemChecked","code":"sl_ila_options_OnItemChecked(nRow, bChecked)\n{\n\t\/\/ TODO: Add your event handler code here\n\t\/\/ DTH: If an Option has bee checked, we need to clear any other checked options for the same Criterion\n\tif (bChecked)\n\t{\n\t\t\/\/ get the Criterion for the current row\n\t\tvar strCriterion = app.g.sl_getrawcolvalue(_swdoc.MF().sl_ila_options, nRow, \"criterion\");\n\t\t\n\t\t\/\/ loop through the list. if the Criterion matches the newly checked row and the row is different, then the check should be cleared\n\t\tfor (var x=0;x<_swdoc.MF().sl_ila_options.rowCount();x++)\n\t\t{\n\t\t\tif (x == nRow)\n\t\t\t\tcontinue; \/\/ leave the recently checked option\n\t\t\tif (app.g.sl_getrawcolvalue(_swdoc.MF().sl_ila_options, x, \"criterion\") == strCriterion)\n\t\t\t\t_swdoc.MF().sl_ila_options.SetRowChecked(x, false);\n\t\t}\n\t}\n\t\n\t_swdoc.updateWeighting(); \/\/ Update the Weighting\n\t\n\t_swdoc.updateImpactLevel(); \/\/ Update the Impact Level\n\n}"},{"name":"btn_clear_selected_OnPressed","code":"btn_clear_selected_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\n\tfor (var x=0;x<_swdoc.MF().sl_ila_options.rowCount();x++)\n\t{\n\t\t_swdoc.MF().sl_ila_options.SetRowChecked(x, false);\n\t}\n\t\t\n\t\/\/ Update the Weighting\n\t_swdoc.updateWeighting();\n\t\n\t\/\/ Update Level Impact\n\t_swdoc.updateImpactLevel(); \n\t\n}"},{"name":"sl_ila_options_OnItemSelected","code":"sl_ila_options_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp._eva(_swdoc.MF().eb_option_desc, app.g.sl_getrawcolvalue(_swdoc.MF().sl_ila_options, nRow, \"description\"));\n\t\n\tvar strCriterion = app.g.sl_getrawcolvalue(_swdoc.MF().sl_ila_options, nRow, \"criterion\");\n\tapp._eva(_swdoc.MF().eb_criterion_desc, _swdoc.arrCriteriaDetails[strCriterion]);\n}"},{"name":"OnTimer","code":"OnTimer(nTimer)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif (nTimer == 101)  \n\t{\n\t\t_swdoc.MF().KillTimer(101);\n\t\t_swdoc.MF().sl_ila_options.SetRowSelected(0);\n\t}\n\n}"},{"name":"eb_impact_level_OnLeftClick","code":"eb_impact_level_OnLeftClick()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\n\treturn false; \/\/ effectively makes this a read only field and it still displays with normal black text\n}"},{"name":"eb_lead_time_OnLeftClick","code":"eb_lead_time_OnLeftClick()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\n\treturn false; \/\/ effectively makes this a read only field and it still displays with normal black text\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\n    _swdoc.CloseForm();\n}"},{"name":"sl_current_ila_options_OnItemDoubleClicked","code":"sl_current_ila_options_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\/\/ No edit form\nreturn false;\n}"},{"name":"btn_history_OnPressed","code":"btn_history_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strURL = \"callref=\"+_swdoc.GetArg(\"callref\")+\"&usage_area=\" + _swdoc.usage_area;\n\tapp.OpenForm(\"EfILACallHistory\", strURL, false, function(oRes)\n\t{\n\t\n\t});\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}