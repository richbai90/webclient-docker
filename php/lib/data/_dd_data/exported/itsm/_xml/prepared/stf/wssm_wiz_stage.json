{"espForm":{"configuration":{"settings":{"name":"wssm_wiz_stage","title":"Wizard Step","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"wssm_wiz_stage","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\n\nfunction oStage()\n{\n\treturn wssm_wiz_stage;\n}\n"}}}},"layouts":{"layout":[{"appearance":{"width":"478","height":"219","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"type":"Field","group":"Tab1:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"39","left":"100","right":"461","bottom":"57"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"wssm_wiz_stage.title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"Field","group":"Tab1:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"61","left":"100","right":"461","bottom":"183"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"wssm_wiz_stage.description"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"btn_add_step","type":"EventButton","group":"Tab1:1"},"appearance":{"index":"2","caption":"Add","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"40","left":"411","right":"463","bottom":"62"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"3","caption":"Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"61","left":"20","right":"96","bottom":"77"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"wssm_wiz_stage.description"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"4","caption":"Title","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"39","left":"20","right":"96","bottom":"55"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"wssm_wiz_stage.title"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_remove_q","type":"EventButton","group":"Tab1:1"},"appearance":{"index":"5","caption":"Remove","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"40","left":"352","right":"404","bottom":"62"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_ups","type":"EventButton","group":"Tab1:1"},"appearance":{"index":"6","caption":"Up","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"40","left":"18","right":"70","bottom":"62"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_downs","type":"EventButton","group":"Tab1:1"},"appearance":{"index":"7","caption":"Down","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"40","left":"76","right":"128","bottom":"62"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"sl_qs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"Tab1:1"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"67","left":"19","right":"463","bottom":"206"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"qindex"},"name":"Pos.","width":"38","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"question"},"name":"Question","width":"242","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"type"},"name":"Type","width":"122","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_qid"},"name":"id","width":"26","image":"-1","dataColumn":"3"}]},"sortColumn":"0","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#000099","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#d3c9b6","newRecordForm":"Form.wssm_wiz_q","editRecordForm":"Form.wssm_wiz_q","sqlSource":"swdata","table":"wssm_wiz_q","listFilter":"swc=fk_wiz_stage&kvs=&[wssm_wiz_stage.pk_auto_id]","storedQuery":"common.load_by_colname"}}},{"general":{"name":"Tab1","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"9","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"9","left":"9","right":"472","bottom":"212"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Step","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Questions","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"flg_end","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"188","left":"94","right":"346","bottom":"204"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"data":{"binding":"wssm_wiz_stage.flg_endofwiz"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"0","image":"#eeeeee","flagItems":"This is a wizard completed step.^1|","disabledBackgroundColor":"#eeeeee"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n    \n    Tab1.ShowTabItem(1,(_swdoc.oStage().pk_auto_id>0));\n    app._etab(Tab1,0);\n    \n\tapp.g.popuplate_form_fromargs(\"wssm_wiz_stage\", _swdoc, true, true);\n  \n\t\t\n}"},{"name":"btn_ups_OnPressed","code":"btn_ups_OnPressed()\n{\n\t\n\n\tvar currRow = sl_qs.curSel;\n\tvar intDownID = sl_qs.GetItemTextRaw(sl_qs.curSel-1, 'pk_qid');\n\t\n\t\/\/-- get id to up\n\tvar intUpID = sl_qs.GetItemTextRaw(sl_qs.curSel, 'pk_qid');\n\t\n\t\/\/-- update seq id for both \n\tvar strParams = \"qid=\"+app.pfu(intUpID);\n\tif(app.g.submitsqs(\"form\/wiz_stage\/dec_question_seq\", strParams))\n\t{\n\t\tvar strParams = \"qid=\"+app.pfu(intDownID);\n\t\tif(app.g.submitsqs(\"form\/wiz_stage\/inc_question_seq\", strParams))\n\t\t{\n\t\t\t\/\/-- refresh list\n\t\t\tsl_qs.Refresh();\n\t\t\tsl_qs.SetRowSelected(currRow-1, true, false);\n\t\t}\n\t}\n\t\n\n}"},{"name":"btn_downs_OnPressed","code":"btn_downs_OnPressed()\n{\n\n\tvar currRow = sl_qs.curSel;\n\tvar intDownID = sl_qs.GetItemTextRaw(sl_qs.curSel, 'pk_qid');\n\t\n\t\/\/-- get id to up\n\tvar intUpID = sl_qs.GetItemTextRaw(sl_qs.curSel+1, 'pk_qid');\n\n\t\/\/-- update seq id for both \n\tvar strParams = \"qid=\"+app.pfu(intUpID);\n\tif(app.g.submitsqs(\"form\/wiz_stage\/dec_question_seq\", strParams))\n\t{\n\t\tvar strParams = \"qid=\"+app.pfu(intDownID);\n\t\tif(app.g.submitsqs(\"form\/wiz_stage\/inc_question_seq\", strParams))\n\t\t{\n\t\t\t\/\/-- refresh list\n\t\t\tsl_qs.Refresh();\n\t\t\tsl_qs.SetRowSelected(currRow+1, true, false);\n\t\t}\n\t}\n\n}"},{"name":"btn_add_step_OnPressed","code":"btn_add_step_OnPressed()\n{\n\n\tvar intIndex = app.g.sl_getmaxvalue(sl_qs,'qindex');\n\tvar strURL = \"fk_wiz_stage=\" + _swdoc.oStage().pk_auto_id + \"&qindex=\" + ++intIndex;\n\tapp.OpenFormForAdd(\"wssm_wiz_q\", \"\", strURL, true, function(){\n\t\tsl_qs.Refresh();\n\t\tsl_qs.SetRowSelected(0);\n\t});\n}"},{"name":"sl_qs_OnItemSelected","code":"sl_qs_OnItemSelected(nRow)\n{\n\t\n\tapp._een(btn_remove_q, (sl_qs.rowCount()>0));\n\tapp._een(btn_downs,((nRow+1) < sl_qs.rowCount()));\n\tapp._een(btn_ups, (nRow > 0));\n\n\n\n\n}"},{"name":"btn_remove_q_OnPressed","code":"btn_remove_q_OnPressed()\n{\n\tvar strConfirm = \"Are you sure you want to delete the selected question?\";\n\tvar intQpos = parseInt(sl_qs.GetItemTextRaw(sl_qs.curSel, \"qindex\"));\n\t\n\tif(app.g.sl_deldbrow(sl_qs,sl_qs.curSel,0,null,strConfirm))\n\t{\n\t\t\/\/-- loop through list and set seq for each to #\n\t\tvar intQid = 0;\n\t\tfor(var x=0; x < sl_qs.rowCount();x++)\n\t\t{\n\t\t\tvar intThisQpos = parseInt(sl_qs.GetItemTextRaw(x, \"qindex\"));\n\t\t\tif(intThisQpos > intQpos)\n\t\t\t{\n\t\t\t\tintQid = sl_qs.GetItemTextRaw(x, \"pk_qid\");\n\t\t\t\tvar strParams = \"qid=\"+app.pfu(intQid);\n\t\t\t\tapp.g.submitsqs(\"form\/wiz_stage\/dec_question_seq\", strParams);\n\t\t\t}\n\t\t}\n\t\tsl_qs.Refresh();\n\t\tsl_qs.SetRowSelected(0, true, false);\n\t}\n}"},{"name":"Tab1_OnTabSelected","code":"Tab1_OnTabSelected(nTab)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(nTab==1)\n\t{\n\t\t_swdoc.MF().sl_qs.Refresh();\n\t}\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}