{"espForm":{"configuration":{"settings":{"name":"Service Request","title":"Log New Service Request","callClass":"Service Request","profileFilter":"code_status not like 'deactivate%'","options":{"showExtendedDetails":"true","showWorkflow":"false","showFileAttachments":"true","showAffectedCustomers":"false","showAffectedContacts":"true","showCustomHtmlTab":"false","showPartsUsedTab":"false","allowLog":"true","allowLogAssign":"true","allowLogAccept":"true","allowLogClose":"true","allowLogAcceptTake":"true","showMassageBar":"false","showCloseDetails":"false","useEmailDateToLogCall":"false","hideToolbar":"false","hideMenubar":"false","hideFromMenu":"false","extendedDetailsTable":{"title":"Associated Information"}}},"tables":{"table":[{"name":"opencall","type":"Main Details Table","recordPicklist":"Company","addRecordForm":"Form.TfCompany","editRecordForm":"Form.TfCompany","flags":"0"},{"name":"updatedb","type":"Diary Updates Table","flags":"0"},{"name":"itsm_opencall_rfc","type":"Extended Details Table","description":"Associated Information","mainDetailsColumn":"callref","recordPicklist":"Customer","addRecordForm":"Form.tfCustomer","editRecordForm":"Form.tfCustomer","flags":"0"},{"name":"userdb","type":"Related Table","description":"Customer Details","mainDetailsColumn":"cust_id","recordPicklist":"Customer","addRecordForm":"Form.tfCustomer","editRecordForm":"Form.tfCustomer","flags":"0","assignments":{"assignment":[{"expression":"keysearch","masterRecordColumn":"opencall.cust_id"},{"expression":"firstname + \" \" + surname","masterRecordColumn":"opencall.cust_name"},{"expression":"postcode","masterRecordColumn":"opencall.postcode"},{"expression":"fk_manager","masterRecordColumn":"opencall.bpm_managerid"}]}},{"name":"bpm_workflow","type":"Related Table","mainDetailsColumn":"bpm_workflow_id","recordPicklist":"Business Process","flags":"0","assignments":{"assignment":{"expression":"pk_workflow_id","masterRecordColumn":"opencall.bpm_workflow_id"}}},{"name":"company","type":"Related Table","mainDetailsColumn":"fk_company_id","recordPicklist":"Company","addRecordForm":"Form.TfCompany","editRecordForm":"Form.TfCompany","flags":"0","assignments":{"assignment":[{"expression":"companyname","masterRecordColumn":"opencall.companyname"},{"expression":"pk_company_id","masterRecordColumn":"opencall.fk_company_id"}]}}]},"showMeItems":{"action":[{"name":"Change Customer","id":"9","attrib1":"Customer","displayName":"Change Customer"},{"name":"Customer Properties","id":"2","attrib1":"Form.TfCustomer","attrib2":"&[userdb.keysearch]","displayName":"Customer Properties"},{"name":"Organisation Properties","id":"2","attrib1":"Form.TfCompany","attrib2":"&[company.pk_company_id]","displayName":"Organisation Properties"},{"name":"Selfservice Wizard Input","id":"3","attrib1":"if(_swdoc.OC().logcall_source=='SELFSERVICE')\r\n{\r\n    var strParams = 'in_callref='+_swdoc.OC().callref;\r\n    var intCount = app.g.get_sqrecordset(\"call\/common\/count_wiz_qs\",strParams);\r\n    if(intCount>0)\r\n    {\r\n \t\tvar strServer = '&[app.webroot]';\r\n\t\tvar strCurrentdd = '&[app.currentdd]';\r\n\r\n\t\tapp.global.OpenHtmlWindow(\"wssm_wiz_input\", \"frame\", strServer + \"\/clisupp\/details\/\"+ strCurrentdd +\"\/wssm_wiz_input.php?sessionid=\"+app.session.sessionId+\"&fk_callref=\"+_swdoc.OC().callref, \"Selfservice Wizard Input\", true, 950, 700);\r\n    }\r\n    else\r\n    {\r\n        \/\/MessageBox(\"resolved call count = \" + intCount);\r\n    }\r\n}\r\nelse\r\n{\r\n\tMessageBox('Call was not logged via selfservice.')\r\n}","displayName":"Selfservice Wizard Input"},{"name":"Store Resolution Details","id":"3","attrib1":"strURL= \"company_code=\"+_swdoc.oCompany().pk_company_id;\r\n        \r\nif (_swdoc.OC().custom_i3){\r\n        app.OpenFormForEdit(\"itsmEfQLogResCloseData\", _swdoc.OC().custom_i3,strURL,true, function(aForm){});\r\n}       \r\nelse\r\n{\r\n\tapp.OpenFormForAdd(\"itsmEfQLogResCloseData\", \"\", strURL, true, function(aForm){\r\n\t\tif (aForm)\r\n\t\t{\r\n\t\t\tvar newRecId = aForm.document.record_id;\r\n\t\t\tif (newRecId != \"\"){\r\n\t\t\t\t_swdoc.OC().custom_i3 = newRecId;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tMessageBox(\"No Resolution \/ Closure details were created. If this form is saved as a Quick Log Call, there will be no Resolution \/ Closure details.\");\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}","displayName":"Store Resolution Details"}]},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\n\nvar boolFormLoaded = false;\nvar boolRFCTitleSetManually = false;\nvar boolResolvingCust = false;\nvar strSearchFor = \"\";\n\n\/\/###\nvar strPreSelectedCompany = \"\";\n\/\/ store CI IDs for each company\nvar multi_companyCIIDS = new Array();\n\n\nvar companyCIIDS = \"\";\nvar strSelectedService = \"\";\nvar strCurrentPrice = \"\";\nvar arrSLACost = new Array();\nvar arrSLAPrice = new Array();\n\nvar boolChangeProfile = false;\nvar boolServiceSLASetManually = false;\n\n\/\/-- F0105032\nvar oOpencall = null;\nvar oExtended = null;\n\/\/-- EOF F0105032\n\n\nvar strSLACallClass = \"Service Request\";\n\n\nvar boolCustid_fromCall = false;\nvar boolCustSearchOpen = false;\n\nvar arrOrigSettings = new Array();\n\/\/-- NWJ\n\/\/-- record pointers\nfunction OC()\n{\n\treturn _swdoc.opencall;\n}\n\nfunction RFC_EXT()\n{\n\treturn _swdoc.itsm_opencall_rfc;\n}\n\n\/\/-- form pointers\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction EF()\n{\n\treturn extform;\n}\n\nfunction oCust()\n{\n\treturn _swdoc.userdb;\n}\n\nfunction oCompany()\n{\n\treturn _swdoc.company;\n}\n\n\n\/\/###20120716\nfunction multi_c_set_company(companyId){\n\t\/\/MessageBox(companyId);\n\tvar c = app.g.get_record(\"company\", companyId);\n\t_swdoc.OC().fk_company_id = c.pk_company_id;\t\n\t_swdoc.OC().companyname = c.companyname;\n\t\n\tapp._eva(_swdoc.MF().pl_oc_org , c.pk_company_id);\n\tapp._ete(_swdoc.MF().pl_oc_org , c.pk_company_id);\n\t_swdoc.MF().pl_oc_org.display = c.companyname;\n\t\n\tvar boolCompanySet = (\"\" !== _swdoc.OC().fk_company_id);\n\tapp._ema(_swdoc.MF().x_fld_org, !boolCompanySet);\n\tapp._evi(_swdoc.MF().x_fld_org, !boolCompanySet);\n\tapp._een(_swdoc.MF().x_fld_org, false);\n\t\n\tapp._ema(_swdoc.MF().pl_oc_org, boolCompanySet);\n\tapp._evi(_swdoc.MF().pl_oc_org, boolCompanySet && _swdoc.MF().lb_company.visible);\n\tapp._een(_swdoc.MF().pl_oc_org, boolCompanySet && (1 == dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")) );\n\n    _swdoc.set_org_filter();\n}\n\nfunction set_org_filter(){\n\n \tif (\"\"!=_swdoc.OC().cust_id){\n\t\tvar strKeyValues = \"pk_company_id=\"+app.pfu(_swdoc.OC().fk_company_id) + \"&fk_user_id=\"+app.pfu(_swdoc.OC().cust_id);\n\t\tapp._slf(_swdoc.MF().pl_oc_org , strKeyValues);\n\t} else {\n\t\tapp._slf(_swdoc.MF().pl_oc_org , \"pk_company_id=\");\n\t}\n\tvar strCompFilter = \"_swc_fk_company_id=\" + _swdoc.MF().pl_oc_org.value;\n\tapp._slf(_swdoc.MF().lb_oc_dept , strCompFilter);\n\tapp._slf(_swdoc.MF().lb_oc_site1 , strCompFilter);\n\tapp._slf(_swdoc.MF().lb_oc_cc1 , strCompFilter);\n\n\t_swdoc.OC().site = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().site;\n\t_swdoc.OC().fk_dept_code = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().department;\n\t_swdoc.OC().costcenter = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().costcenter;\n\t_swdoc.OC().fk_contract_id = \"\";\n\t_swdoc.handle_set_contract(\"\");\t\n\t_swdoc.UpdateFormFromData();\n}\n\n\n\/\/-- given an analyst object (from app.global.js) load values for either monitored \/ raised by analyst\n\/\/-- for the rfc\nfunction set_rfc_analyst(oAnalyst,boolMonitoredBy)\n{\n\tif(!oAnalyst) \n\t{\n\t\t\/\/-- invalid so clear fields\n\t\toAnalyst = app.g.get_blank_analyst();\n\t}\n\t\n\tif(boolMonitoredBy)\n\t{\n\t\t_swdoc.RFC_EXT().monitored_by_analystid = oAnalyst.id;\n\t\t_swdoc.RFC_EXT().monitored_by_name = oAnalyst.name;\n\t\t_swdoc.RFC_EXT().monitored_by_group = oAnalyst.supportgroup;\n\t\t_swdoc.RFC_EXT().monitored_by_telephone =  oAnalyst.telephone;\n\t\t_swdoc.RFC_EXT().monitored_by_email = oAnalyst.email;\t\n\t}\n\telse\n\t{\n\t\t_swdoc.RFC_EXT().raised_by_analystid = oAnalyst.id;\n\t\t_swdoc.RFC_EXT().raised_by_name = oAnalyst.name;\n\t\t_swdoc.RFC_EXT().raised_by_group = oAnalyst.supportgroup;\n\t\t_swdoc.RFC_EXT().raised_by_telephone =  oAnalyst.telephone;\n\t\t_swdoc.RFC_EXT().raised_by_email = oAnalyst.email;\n\t}\n\t_swdoc.UpdateFormFromData();\t\n}\n\nfunction setup_customer_details()\n{   \n\t\/\/-- get managers name\n\t\/\/_ete(_swdoc.MF().lbl_manager1, \": \" + app.g.get_managername(_swdoc.oCust().fk_manager));\n\t\n\tvar oUserdbRating = app.g.get_record(\"userdb_rating\",_swdoc.oCust().keysearch,'fk_keysearch');\n\tif(oUserdbRating!=null)\n\t{\n\t\tapp._ete(_swdoc.MF().lbl_open_request,\": \"+oUserdbRating.active_count);\n\t\tapp._ete(_swdoc.MF().lbl_closed_request,\": \"+oUserdbRating.inactive_count);\n\t}\n\t\n\t\/\/-- show overall rating\n\tvar webroot = \"&[app.webroot]\/\";\n\tswitch(_swdoc.oCust().flg_ocrating)\n\t{\n\t\tcase 1:\n\t\t\tapp._eim(_swdoc.MF().img_orating1,webroot + \"clisupp\/formimages\/itsm\/cr_neg16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating1,\": Overall satisfaction negative\");\n\t\t\tbreak;\t\t\t\n\t\tcase 2:\n\t\t\tapp._eim(_swdoc.MF().img_orating1, webroot + \"clisupp\/formimages\/itsm\/cr_neu16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating1,\": Overall satisfaction neutral\");\n\t\t\tbreak;\t\t\t\t\t\t\n\t\tcase 3:\n\t\t\n\t\t\tapp._eim(_swdoc.MF().img_orating1, webroot + \"clisupp\/formimages\/itsm\/cr_pos16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating1, \": Overall satisfaction positive\");\n\t\t\tbreak;\t\t\t\t\t\t\n\t\tdefault:\n\t\t\tapp._eim(_swdoc.MF().img_orating1, webroot + \"clisupp\/formimages\/itsm\/cr_neu16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating1,\": Overall satisfaction undetermined\");\n\t\t\tbreak;\n\t}\n\t\n\t\/\/-- log from email fix\n\t\n\tif(app.LC(_swdoc.oCust().fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\t\n\t{\n\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", _swdoc.oCust().fk_company_id);\n\t}\n\t\n}\n\n\/\/-- given a ci or list of cis link it to problem cause list\nfunction link_cause_cis_to_change(strLinkCIs)\n{\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_configitems1, strLinkCIs,0);\n\n\t\/\/-- if only 1 CI use it default profile unless blank\n\tif(_swdoc.EF().sl_configitems1.rowCount()==1)\n\t{\n\t\tvar strCode = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems1,0,\"fk_profilecode\");\n\t\tif(strCode!=\"\")\n\t\t{\n\t\t\t_swdoc.OC().probcode = strCode;\n\t\t\t_swdoc.UpdateFormFromData();\t\t\n\t\t}\n\t}\n\n\t\/\/ -- SG, 03\/07\/2012, F0103324\n\t\/\/ Build array of CI's that have the Bespoke Terms field populated\n\tapp.bespokeTermsProcessing(strLinkCIs);\n\t_swdoc.EF().sl_configitems1.Refresh();\t\n}\n\n\/\/-- given a ci or list of cis link it to problem affect list\nfunction link_affect_cis_to_change(strLinkCIs)\n{\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_configitems1, strLinkCIs,\"pk_auto_id\");\n\t_swdoc.EF().sl_configitems1.Refresh();\t\n}\n\n\/\/-- for removed incidents prompt user to remove attached CIs linked to those incidents\nfunction remove_selected_incident_cis(strSelectedIncs)\n{\n\tvar array_RemoveImpactCIS = new Array();\n\t\n\tif(_swdoc.EF().sl_configitems1.rowCount()<1) return;\n\t\n\t\/\/--\n\t\/\/-- get linked inc cis and see if they are linked to problem\n\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\tif(strLinkedCIs==\"0\")return;\n\n\tvar arrayCIS = strLinkedCIs.split(\",\");\n\tfor(var z=0;z<arrayCIS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems1,arrayCIS[z],\"pk_auto_id\")>-1)\t\n\t\t{\n\t\t\tarray_RemoveImpactCIS[array_RemoveImpactCIS.length++] = arrayCIS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveImpactCIS.length>0)\n\t{\n\t\tif(confirm(\"There are associated impact configuration items, that are linked to the incidents you are removing. Do you want to remove these items as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveImpactCIS.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_configitems1,array_RemoveImpactCIS[y],\"pk_auto_id\", null,0);\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().sl_configitems1.Refresh();\n}\n\nfunction remove_selected_ke_incs(strSelectedKes)\n{\n\tvar array_RemoveKEincs = new Array();\n\t\n\tif(_swdoc.EF().sl_incs1.rowCount()<1) return;\n\t\n\t\/\/--\n\t\/\/-- get linked inc cis and see if they are linked to problem\n\tvar strLinkedINCs = app.g.get_slave_calls(strSelectedKes , \"PROBLEM-INCIDENT\", \"\");\n\tif(strLinkedINCs==\"0\")return;\n\n\tvar arrayINCS = strLinkedINCs.split(\",\");\n\tfor(var z=0;z<arrayINCS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_incs1,arrayINCS[z],\"callref\")!=-1)\t\n\t\t{\n\t\t\tarray_RemoveKEincs[array_RemoveKEincs.length++] = arrayINCS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveKEincs.length>0)\n\t{\n\t\tif(confirm(\"There are associated incident records, that are linked to the known error you are removing. Do you want to remove these records as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveKEincs.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_incs1,array_RemoveKEincs[y],\"callref\", null,0);\n\t\t\t}\n\t\t\t\/\/--\n\t\t\t\/\/-- remove linked incident CIs\n\t\t\t_swdoc.remove_selected_incident_cis(strLinkedINCs);\n\t\t}\n\t}\n\t_swdoc.EF().sl_incs1.Refresh();\n}\n\n\/\/-- for removed incidents prompt user to remove attached CIs linked to those incidents\nfunction remove_selected_ke_cis(strSelectedKes)\n{\n\tif((_swdoc.EF().sl_configitems1.rowCount()<1)) return;\n\n\t_swdoc.remove_selected_ke_causeci(strSelectedKes);\n\t_swdoc.remove_selected_ke_impactci(strSelectedKes);\t\n}\n\nfunction remove_selected_ke_causeci(strSelectedKes)\n{\t\/\/--\n\t\/\/-- get linked ke cis and see if they are linked to problem\n\tvar array_RemoveCIS = new Array();\n\tvar strLinkedCauseCIs = app.cmdb.get_call_cis(strSelectedKes , \"PROBLEM-CAUSE\", \"\");\n\tif(strLinkedCauseCIs==\"0\")return;\n\n\t\n\tvar arrayCIS = strLinkedCauseCIs.split(\",\");\n\tfor(var z=0;z<arrayCIS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems1,arrayCIS[z],\"pk_auto_id\")>-1)\n\t\t{\n\t\t\tarray_RemoveCIS[array_RemoveCIS.length++] = arrayCIS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveCIS.length>0)\n\t{\n\t\tif(confirm(\"There are associated change configuration items, that are linked to the known errors you are removing. Do you want to remove these items as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveCIS.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_configitems1,array_RemoveCIS[y],\"pk_auto_id\", null,0);\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().sl_configitems1.Refresh();\n}\n\nfunction remove_selected_ke_impactci(strSelectedKes)\n{\t\/\/--\n\t\/\/-- get linked ke cis and see if they are linked to problem\n\tvar array_RemoveCIS = new Array();\n\tvar strLinkedImpactCIs = app.cmdb.get_call_cis(strSelectedKes , \"PROBLEM-AFFECT\", \"\");\n\tif(strLinkedImpactCIs==\"0\")return;\n\n\tvar arrayCIS = strLinkedImpactCIs.split(\",\");\n\tfor(var z=0;z<arrayCIS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems1,arrayCIS[z],\"pk_auto_id\")!=-1)\t\n\t\t{\n\t\t\tarray_RemoveCIS[array_RemoveCIS.length++] = arrayCIS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveCIS.length>0)\n\t{\n\t\tif(confirm(\"There are associated impact configuration items, that are linked to the known errors you are removing. Do you want to remove these items as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveCIS.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_configitems1,array_RemoveCIS[y],\"pk_auto_id\", null,0);\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().sl_configitems1.Refresh();\n}\n\nfunction filter_ke_impact(strKErefs)\n{\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_kes1, strKErefs,0);\n\t_swdoc.EF().sl_kes1.Refresh();\n\t\/\/-- check if we should add ke incidents\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyErrorIncidents\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar strLinkIncidents = app.g.get_slave_calls(strKErefs,\"PROBLEM-INCIDENT\");\n\t\tif(strLinkIncidents!=\"0\")\n\t\t{\n \t\t\t_swdoc.filter_inc_impact(strLinkIncidents);\n\t\t}\n\t}\n\n\t\/\/-- Now check if we should link new ke ci items as being affect or cause (or both)\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyErrorCauseCIs\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strKErefs , \"PROBLEM-CAUSE\", \"\");\n\t\t_swdoc.link_cause_cis_to_change(strLinkedCIs);\n\t}\n\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyErrorImpactCIs\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strKErefs , \"PROBLEM-AFFECT\", \"\");\n\t\t_swdoc.link_affect_cis_to_change(strLinkedCIs);\n\t}\n}\n\n\/\/-- link incidents\nfunction filter_inc_impact(strIncidentRefs)\n{\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_incs1,strIncidentRefs ,0);\n\t_swdoc.EF().sl_incs1.Refresh();\t\n\n\t\/\/-- Now check if we should link new ci items as being affect\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyIncidentCIs\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strIncidentRefs , \"INCIDENT\", \"\");\n\t\t_swdoc.link_affect_cis_to_change(strLinkedCIs);\n\t}\n\n}\n\nfunction filter_impact_customers(oForm)\n{\n\t\/\/-- get list of customers impacted by these incidents and refresh cust impact list\n\tvar strCustFilter = app.g.sl_get_valuesdel(oForm.sl_incs1,'cust_id',\",\",\"'\",true);\n\t\n\tvar strCustIdsFromRFCs = app.g.sl_get_valuesdel(oForm.sl_rfcs,'cust_id',\",\",\"'\",true);\n\tif(strCustIdsFromRFCs!=\"\")\n\t{\t\n\t\tif(strCustFilter!=\"\")strCustFilter+=\",\";\n\t\tstrCustFilter+=strCustIdsFromRFCs;\n\t}\n\n\t\/\/-- get customers that use affected cis\n\tvar strImpactedCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems1,'pk_auto_id',\",\");\t\n\tvar strCustIidsFromImpactCIs = app.cmdb.get_ci_customer_ids(strImpactedCIs,true);\n\tif(strCustIidsFromImpactCIs!=\"\")\n\t{\t\n\t\tif(strCustFilter!=\"\")strCustFilter+=\",\";\n\t\tstrCustFilter+=strCustIidsFromImpactCIs;\t\n\t}\n\n\tif(_swdoc.oCust().keysearch!=\"\")\n\t{\t\n\t\tif(strCustFilter!=\"\")strCustFilter+=\",\";\n\t\tstrCustFilter+=_swdoc.oCust().keysearch;\t\n\t}\n\n\tapp._slf(oForm.sl_customerimpact, \"_kv=\" + strCustFilter);\n\toForm.sl_customerimpact.Refresh();\t\t\t\n}\n\nfunction filter_impact_orgs(oForm)\n{\n\t\/\/-- get list of orgs impacted by impacted customer\n\tvar strOrgFilter = app.g.sl_get_valuesdel(oForm.sl_incs1,'fk_company_id',\",\",\"'\",true);\n\n\tvar strOrgIdsFromRFCs = app.g.sl_get_valuesdel(oForm.sl_rfcs,'fk_company_id',\",\",\"'\",true);\n\tif(strOrgIdsFromRFCs!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")strOrgFilter+=\",\";\n\t\tstrOrgFilter+=strOrgIdsFromRFCs;\n\t}\n\t\n\t\/\/-- get orgs that use affected cis\n\tvar strImpactedCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems1,'pk_auto_id',\",\");\t\n\tvar strOrgIDSFromCIs = app.cmdb.get_ci_company_ids(strImpactedCIs,true);\n\tif(strOrgIDSFromCIs!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")strOrgFilter+=\",\";\n\t\tstrOrgFilter+=strOrgIDSFromCIs;\n\t}\n\n\n\t\/\/-- 2.4 include orgs that use change ci\n\t\/\/-- get orgs that use change cis\n\tvar strChangeCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems1,'pk_auto_id',\",\");\t\n\tvar strOrgIDSFromCIs = app.cmdb.get_ci_company_ids(strChangeCIs,true);\n\tif(strOrgIDSFromCIs!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")strOrgFilter+=\",\";\n\t\tstrOrgFilter+=strOrgIDSFromCIs;\n\t}\n\n\tif(_swdoc.OC().fk_company_id!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")strOrgFilter+=\",\";\n\t\tstrOrgFilter+=_swdoc.OC().fk_company_id;\n\t}\n\t\n\t\/\/### change to call Org\n\tapp._slf(oForm.sl_orgimpact, \"_kv=\" + strOrgFilter);\n\toForm.sl_orgimpact.Refresh();\t\n}\n\n\nfunction get_company_cis(strCompanyID)\n{\n\t\/\/###20120801 - rewrite to accommodate multiple organisations\n\tvar strKeyValues = app.cfg.get_company_cikeys(strCompanyID,true,true);\t\n\n\tvar strParams = \"fk_company_id=\"+app.pfu(strCompanyID);\n    var oRS = app.g.get_sqrecordset(\"general\/get_company_sites\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tif(strKeyValues!=\"\")strKeyValues+=\",\";\t\n\t\tvar strSiteName = app.g.get_field(oRS,\"site_name\");\n\t\tstrKeyValues+= app.cmdb.get_site_cis(strSiteName);\n\t}\t\n\t\n\tif(strKeyValues==\"\")\n\t\tstrKeyValues = \"-1\";\n\t_swdoc.multi_companyCIIDS[strCompanyID] = strKeyValues;\n\n}\n\n\n\/\/ remove any currently selected CI's that are not related to the currently selected organisation\nfunction check_cis()\n{\n\tvar oList =_swdoc.EF().sl_configitems1;\n\tif(oList.rowCount() ==\"\")\n\t\treturn;\n\tvar boolCIRemoved = false;\n\t\/\/###20120801\n\tvar strCompanyID = _swdoc.OC().fk_company_id;\n\tif(typeof _swdoc.multi_companyCIIDS[strCompanyID] === \"undefined\")\n\t\t_swdoc.get_company_cis(strCompanyID);\n\t\t\n\tvar arrCIS = _swdoc.multi_companyCIIDS[strCompanyID].split(\",\");\n\tfor (var x=oList.rowCount();x > -1;x--)\n\t{\n\t\tvar strValue = oList.GetItemText(x,0);\n\t\tif(strValue !=\"\"){\n\t\t\tif(app.in_array(arrCIS,strValue))\n\t\t\t{\n\t\t\t\toList.SetRowSelected(x,false,true);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\toList.SetRowSelected(x,true,true);\n\t\t\t\tboolCIRemoved = true;\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().sl_configitems1.Refresh();\n\t_swdoc.EF().mbtn_cci_actions1_OnMenuItem('test',1);\n\tif(boolCIRemoved)\n\t\tMessageBox(\"CIs were removed from this call, as they were not associated with the currently selected Organisation\");\n}\n\n\/\/ load the app.service information on selection\n\/\/ checks that the app.service exists, and then loads preset informations for the app.service\nfunction load_service_details(pkey)\n{\n\t_swdoc.OC().request_qty = 1;\n\toRec = app.g.get_record(\"sc_folio\", pkey);\n\tif(!oRec)\n\t{\n\t\t_swdoc.reset_service(oRec);\n\t\treturn;\n\t}\n\n\tif(_swdoc.MF().fld_service_subscribe.value == 0)\n\t{\n\t\t_swdoc.load_on_request(oRec);\n\t}else\n\t{\n\t\t_swdoc.load_on_subscription(oRec);\n\t}\n\t_swdoc.UpdateFormFromData();\n\treturn true;\n}\n\n\/\/ reload the services availaable, taking in whether we are looking for requests or available services to subscribe to\nfunction reload_services(boolSubscribed)\n{\n\n\tvar strFilter = \"\";\n\t\/\/###20120607\n\tvar CIIDS = \"\";\n\tif(boolSubscribed)\n\t{\n\t\tCIIDS = app.service.get_customer_services(_swdoc.oCust().keysearch, true, false, \"SR\");\n\t}\n\telse\n\t{\n\t\tCIIDS = app.service.get_customer_view_services(_swdoc.oCust().keysearch, true, false, \"SR\");\n\t}\n\n\tstrFilter = \"pk_auto_id=\"+CIIDS;\n\tif(boolSubscribed)\n\t\tstrFilter += \"&bls=1\";\n\telse\n\t\tstrFilter += \"&bls=0\";\n\n\tapp._slf(_swdoc.MF().fld_fk_service, strFilter);\n\t_swdoc.load_service_details(\"-1\");\n}\n\n\/\/ deselect the current app.service - when change of customer \/ organisation \/ app.service\nfunction reset_service()\n{\n\t_swdoc.OC().itsm_fk_service = 0;\n\tapp._slf(_swdoc.MF().sl_component1, \"fks=-1\");\n\tapp._slf(_swdoc.MF().sl_optional_component1, \"fks=-1\");\n\t_swdoc.MF().sl_component1.Refresh();\n\t_swdoc.MF().sl_optional_component1.Refresh();\n\t_swdoc.arrSLACost = \"\";\n\t_swdoc.arrSLAPrice = \"\";\n\t_swdoc.OC().request_qty = 1;\n\tapp._een(_swdoc.MF().fld_req_qty,false);\n\tapp._een(_swdoc.MF().lbl_req_qty,false);\n\t_swdoc.UpdateFormFromData();\n}\n\n\/\/ load any on request values defined in the app.service\nfunction load_on_request(oRec)\n{\n\tif(oRec.fk_cmdb_id!=undefined)\n\t\topencall.itsm_fk_service = oRec.fk_cmdb_id;\n\telse\n\t\treturn false;\n\n\tif(oRec.fk_df_onreq>0)\n\t{\n\t\t_swdoc.load_dataform(oRec.fk_df_onreq);\t\n\t}\n\n\t_swdoc.get_service_slas(oRec.fk_cmdb_id,\"SUBSCRIPTION\",oRec.fk_default_sla);\n\tapp._slf(_swdoc.MF().sl_component1, \"fks=\"+oRec.fk_cmdb_id+\"&bls=0\");\n\tapp._slf(_swdoc.MF().sl_optional_component1, \"fks=\"+oRec.fk_cmdb_id+\"&bls=0\");\n\t_swdoc.MF().sl_component1.Refresh();\n\t_swdoc.MF().sl_optional_component1.Refresh();\n\t_swdoc.handle_set_contract(oRec.fk_default_sla);\n}\n\n\n\n\/\/ load any on subscription values defined in the app.service\nfunction load_on_subscription(oRec)\n{\n\tif(oRec.fk_cmdb_id!=undefined)\n\t\topencall.itsm_fk_service = oRec.fk_cmdb_id;\n\telse\n\t\treturn false;\n\t\t\n\tif(oRec.fk_df_onsub>0)\n\t{\n\t\t_swdoc.load_dataform(oRec.fk_df_onsub);\t\n\t}\n\n\t_swdoc.get_service_slas(oRec.fk_cmdb_id,\"VIEW\",oRec.fk_default_sla);\n\tapp._slf(_swdoc.MF().sl_component1, \"fks=\"+_swdoc.OC().itsm_fk_service+\"&bls=1\");\n\tapp._slf(_swdoc.MF().sl_optional_component1, \"fks=\"+_swdoc.OC().itsm_fk_service+\"&bls=1\");\n\t_swdoc.MF().sl_component1.Refresh();\n\t_swdoc.MF().sl_optional_component1.Refresh();\n\t_swdoc.handle_set_contract(oRec.fk_default_sla);\n}\n\n\/\/ given a app.service id, and whether a subscription or request, find the current customers available slas return an array\n\/\/ item 0 - string of delimited sla keys, item 1 - default sla key\nfunction get_service_slas(serviceID,strRelType,strServiceDefaultSLA)\n{\n\tvar strSLA = \"\";\n\tvar strDefaultSLA = \"\";\n\n\tvar strSLACost = new Array();\n\tvar strSLAPrice = new Array();\n\n\tvar strSubscriptionID = app.service.get_customer_subscription(_swdoc.oCust().keysearch,serviceID,strRelType);\n\n\tvar strParams = \"fks=\"+strSubscriptionID;\n\tvar oRS = app.g.get_sqrecordset(\"call\/service\/subscription_sla_prices\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tvar strSLAField = app.g.get_field(oRS,\"fk_sla\");\n\t\tvar strCost = app.g.get_field(oRS,\"cost\");\n\t\tvar strPrice = app.g.get_field(oRS,\"price\");\n\n\t\tstrSLACost[strSLAField] = strCost;\n\t\tstrSLAPrice[strSLAField] = strPrice;\n\t\t\n\t\tif(strSLA!=\"\")strSLA+=\",\";\t\n\t\tstrSLA+= strSLAField;\n\t}\n\tif(strSLA==\"\")\n\t{\n\t\tvar strParams = \"fks=\"+serviceID;\n\t\tvar oRS = app.g.get_sqrecordset(\"call\/service\/service_sla_prices\",strParams);\n\t\twhile(oRS.Fetch())\n\t\t{\n\t\t\tvar strSLAField = app.g.get_field(oRS,\"fk_sla\");\n\t\t\tvar strCost = app.g.get_field(oRS,\"cost\");\n\t\t\tvar strPrice = app.g.get_field(oRS,\"price\");\n\t\n\t\t\tstrSLACost[strSLAField] = strCost;\n\t\t\tstrSLAPrice[strSLAField] = strPrice;\n\t\t\t\n\t\t\tif(strSLA!=\"\")strSLA+=\",\";\t\n\t\t\tstrSLA+= strSLAField;\n\t\t}\n\t\t\/\/-- 29.03.2010 - remove as causes sql error where old data has links to string sla name\n\t\tstrDefaultSLA = strServiceDefaultSLA;\n\t}if(strSLA==\"\")\n\t\tstrSLA=\"-1\";\n\tvar strDefaultPriority = \"\";\n\n\t\/\/ get default sla and price for subscription\n\tvar strParams = \"fks=\"+strSubscriptionID;\n\tvar oRS = app.g.get_sqrecordset(\"call\/service\/subscription_prices\",strParams);\n\tif(oRS.Fetch())\n\t{\n\t\tif(strDefaultSLA==\"\")\n\t\t\tstrDefaultSLA = app.g.get_field(oRS,\"fk_default_sla\");\n\t\tif(strRelType=='SUBSCRIPTION')\n\t\t\t_swdoc.strCurrentPrice = app.g.get_field(oRS,\"request_price\");\n\t\telse\n\t\t\t_swdoc.strCurrentPrice = app.g.get_field(oRS,\"subscription_price\");\n\t\tif(_swdoc.strCurrentPrice==\"\")\n\t\t\t_swdoc.strCurrentPrice = 0;\n\t\tstrDefaultPriority = app.g.get_field(oRS,\"fk_priority\");\n\t}\n\t\n\t_swdoc.arrSLACost = strSLACost;\n\t_swdoc.arrSLAPrice = strSLAPrice;\n\n\tif(strDefaultSLA!=\"\") \n\t{\n\t\t\/\/F0101290\n\t\tvar oSLARec = app.g.get_record(\"itsmsp_slad\", strDefaultSLA);\n\t\tif(oSLARec)\n\t\t{\n\t\t\t_swdoc.OC().itsm_sladef = strDefaultSLA;\n\t\t\t_swdoc.OC().itsm_slaname = oSLARec.slad_id;\n\t\t\t_swdoc.handle_set_sladef(_swdoc.OC().itsm_slaname);\n\t\t\tif(strDefaultPriority!=\"\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = strDefaultPriority;\n\t\t\t}\n\t\t}\n\t}\n\n\tapp._slf(_swdoc.MF().lb_oc_slad, \"kvs=\"+strSLA);\n}\n\nfunction load_dataform(dfKey)\n{\n\toDf = app.g.get_record(\"sc_dataform\", dfKey);\n\tif(oDf.suppgroup!=\"\")\n\t\topencall.suppgroup = oDf.suppgroup;\n\tif(oDf.owner!=\"\")\n\t\topencall.owner = oDf.owner;\n\tif(oDf.bpm_wf_id!=\"\")\n\t{\n\t\tbpm_workflow.pk_workflow_id = oDf.bpm_wf_id;\n\t\t_swdoc.ResolveRecord(\"bpm_workflow\",\"pk_workflow_id\",oDf.bpm_wf_id);\n\t}\n\tif(oDf.probcode!=\"\")\n\t\topencall.probcode = oDf.probcode;\n\tif(oDf.prob_text!=\"\")\n\t{\n\t\tif(updatedb.updatetxt==\"\")\n\t\t\tupdatedb.updatetxt += oDf.prob_text;\n\t\telse\n\t\t{\n\t\t\tvar x = confirm('Would you like to append the default text to the description?');\n\t\t\tif(x)\n\t\t\t\tupdatedb.updatetxt += \"\\n\\n\"+oDf.prob_text;\n\t\t}\n\t}\n\n}\n\nfunction service_select(strValue)\n{\n\t_swdoc.load_service_details(strValue);\n\tapp._een(_swdoc.MF().mbtn_service_views, true);\n\tif(_swdoc.MF().fld_service_subscribe.value==\"1\")\n\t{\n\t\t_swdoc.OC().itsm_catreq_type = 'SUBSCRIPTION';\n\t}\n\telse\n\t{\n\t\t_swdoc.OC().itsm_catreq_type = 'REQUEST';\n\t}\n\tapp._een(_swdoc.MF().fld_req_qty,true);\n\tapp._een(_swdoc.MF().lbl_req_qty, true);\n\n}\n\n\/\/-- load sld info and settings\nfunction handle_set_sladef(strNewSLD, boolValidate)\n{\n\tif(boolValidate==undefined)\n\t\tboolValidate==false;\n\tvar strDisplaySLD = strNewSLD;\n\n\t\/\/-- get actual SLD ID if getting from related record\n\tswitch(strNewSLD)\n\t{\n\t\tcase \"[Use Configuration SLA]\":\n\t\t\tbreak;\n\t\tcase \"[Use Customer SLA]\":\n\t\t\tif(_swdoc.oCust().keysearch==\"\")\n\t\t\t{\n\t\t\t\tapp._eva(_swdoc.MF().lb_oc_slad1, \"\");\n\t\t\t\tapp._eva(_swdoc.MF().lb_oc_slad1, strNewSLD);\n\t\t\t\topencall.itsm_slaname = strNewSLD;\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t_swdoc.OC().priority = \"[Use Customer Priority]\"\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No customer selected, cannot resolve customer SLA. Please select a valid SLA.\",16);\n\t\t\t\telse\n\t\t\t\t\tMessageBox(\"No customer selected.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(_swdoc.oCust().sld==\"\")\n\t\t\t{\n\t\t\t\tapp._eva(_swdoc.MF().lb_oc_slad1, strNewSLD);\n\t\t\t\topencall.itsm_slaname = strNewSLD;\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t_swdoc.OC().priority = \"[Use Customer Priority]\"\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No Default SLA is associated to this Customer. Please select a valid SLA.\",16);\n\t\t\t\telse\n\t\t\t\t\tMessageBox(\"Customer does not have a default SLA.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.oCust().sld);\n\t\t\tif(oRecSLD)\n\t\t\t{\n\t\t\t\tstrNewSLD = oRecSLD.slad_id;\n\t\t\t\t_swdoc.OC().itsm_slaname = strNewSLD;\n\t\t\t}\n\t\t\tbreak;\t\t\n\t}\n\n  \tvar oRecSLD = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strNewSLD);\n\tif(oRecSLD.Fetch())\n\t{\t\n\t\t\/\/-- load cost center option\n\t\tvar strNewCC = app.g.get_field(oRecSLD, \"chargeto_cc\");\n\t\tswitch(strNewCC)\n\t\t{\n\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\tbreak;\n\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\tbreak;\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/-- eof cc option\n\t\t\t\n\t\t\/\/-- set oc values\n\t\tif(strNewCC!=\"\") _swdoc.OC().costcenter = strNewCC;\n\t\tif (_swdoc.boolServiceSLASetManually)\n\t\t{\n\t\t\t_swdoc.OC().priority = app.g.get_field(oRecSLD, \"fk_ssla\");\n\t\t}\t\t\n\t\t_swdoc.OC().itsm_sladef = \tapp.g.get_field(oRecSLD, \"pk_slad_id\");\n\t\t_swdoc.OC().itsm_slaname = app.g.get_field(oRecSLD, \"slad_id\");\n\t\t_swdoc.handle_set_priority(_swdoc.OC().priority);\n\t\t\n\t\t\/\/-- check if customer dept has nay alternative settings\n\t\t_swdoc.check_customer_department_slad(strNewSLD,_swdoc.oCust().department);\n\t\t\n\t\tapp._een(_swdoc.MF().lbl_oc_priority, true);\n\t\tapp._een(_swdoc.MF().lb_oc_sla, true);\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\telse\n\t{\n\t\tMessageBox(\"Failed to retrieve service level definition record for '\" + strDisplaySLD + \"'. Please contact your Supportworks Administrator\");\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n\n\/\/-- check if there is alternative slad settings based on the customers department\nfunction check_customer_department_slad(strSLADID, strDepartment)\n{\n \tif(strDepartment==\"\")\n\t\treturn;\n\tvar strParams = \"fk_slad_id=\" +app.pfu(strSLADID)+ \"&fk_dept=\" +app.pfu(strDepartment);\n \tvar oRecSLD = app.g.get_sqrecordset(\"call\/incident\/get_dept_sla\",strParams);\n\tif(oRecSLD.Fetch())\n\t{\n\t\t\/\/-- load cost center option\n\t\tvar strNewCC = app.g.get_field(oRecSLD,\"chargeto_cc\");\n\t\tswitch(strNewCC)\n\t\t{\n\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\tbreak;\n\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\tbreak;\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/-- eof cc option\n\t\t\t\n\t\t\/\/-- set oc values\n\t\tif(strNewCC!=\"\") _swdoc.OC().costcenter = strNewCC;\n\t\t_swdoc.OC().priority = app.g.get_field(oRecSLD,\"fk_sla\");\n\t}\n}\n\n\nfunction handle_set_priority(strValue)\n{\n\tif(strValue==\"[Use SLA Default Priority]\")\n\t{\n\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.OC().itsm_sladef);\n\t\tif(oRecSLD)\n\t\t{\t\n\t\t\t_swdoc.OC().priority = oRecSLD.fk_ssla;\n\t\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Customer Priority]\")\n\t{\n\t\tif(_swdoc.oCust().priority==\"[Use SLA Default Priority]\")\n\t\t\t_swdoc.handle_set_priority(\"[Use SLA Default Priority]\");\n\t\telse\n\t\t{\n\t\t\t_swdoc.OC().priority = _swdoc.oCust().priority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\n\telse if(strValue==\"[Use Profile Priority]\")\n\t{\n\t\tif(_swdoc.OC().probcode!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.sla);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The Profile SLA is not the same as the currently selected SLA. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority=\"[Use Profile Priority]\";\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No profile has been set for this request. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Charge Centre Priority]\")\n\t{\n\t\tif(_swdoc.OC().costcenter!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.priority);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t\t{\n\t\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"The cost center SLA is not the same as the currently selected SLA. The cost center priority cannot be used.\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t{\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No cost center has been set for this request. The cost center priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\t\n\telse\n\t{\n\t\t_swdoc.OC().priority = strValue;\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t_swdoc.UpdateFormFromData();\n\t\treturn false;\n\t}\n}\n\nfunction handle_set_contract(strNewSLD)\n{\n\tvar strDefaultContract = app.g.filter_company_contracts(_swdoc.OC().fk_company_id, _swdoc.MF().lb_contract, strNewSLD);\n\t\/\/###20120730 addition of typeof and else\n\tif((typeof strDefaultContract !== \"undefined\") && strDefaultContract!=\"\")\n\t{\n\t\t_swdoc.OC().fk_contract_id = strDefaultContract;\n\t\tapp.g.strLogAndResolveContract = strDefaultContract;\n\t} else {\n\t\t_swdoc.OC().fk_contract_id = \"\";\n\t\tapp._eva(_swdoc.MF().lb_contract , \"\");\n\t\tapp._ete(_swdoc.MF().lb_contract , \"\");\n\t}\n\t_swdoc.UpdateFormFromData();\n\t\t\n}\n\/\/--Generic Function to Remove Calls\nfunction remove_service_relatedcalls(strRemoveCallrefs, sl_removefrom)\n{\n\tvar arrRemoveRefs = strRemoveCallrefs.split(\",\");\n\tfor(var y=0;y<arrRemoveRefs.length;y++)\n\t{\n\t\tapp.g.sl_delrow_byvalue(sl_removefrom,arrRemoveRefs[y],\"callref\", null,0);\t\n\t\tsl_removefrom.SetRowSelected(0,true,false);\n\t\tsl_removefrom.Refresh();\n\t}\n}\n\nfunction set_preferred_assignment(boolFromLogAndResolve)\n{\n    \/\/-- 10.06.2004\n    \/\/-- NWJ\n    \/\/-- if just logging a call if we have \n    \/\/-- a support group assign to them\n    if (_swdoc.OC().itsm_prefered_suppgroup != \"\")\n    {\n    \t\/\/-- see if we have a matching analyst (if not try the suppo groups)   \t\n    \tvar anAnalyst = app.g.get_analyst_detail(_swdoc.OC().itsm_prefered_suppgroup);\n    \tif(anAnalyst)\n    \t{\n\t        _swdoc.OC().suppgroup = anAnalyst.supportgroup;\n    \t    _swdoc.OC().owner = anAnalyst.id;\n    \t}\n    \telse\n    \t{\n    \t\t\/\/-- analyst not found so check if we are assigning to a group\n\t\t\tvar aGroup = app.g.get_group_detail(_swdoc.OC().itsm_prefered_suppgroup);    \t\n\t\t\tif (aGroup)\n\t\t\t{\n\t        \t_swdoc.OC().suppgroup = _swdoc.OC().itsm_prefered_suppgroup;\n    \t    }\n\t\t}\n\t\t\n        if ((!boolFromLogAndResolve)&&(_swdoc.OC().owner != \"\"))\n        {\n            \/\/-- set call to unaccepted\n            \/\/-- when assigned to an analyst\n            _swdoc.OC().status = 3;\n        }\n    }\n}\n\nfunction determine_prefered_support(strKeyValue)\n{\t\t\n\n\tvar boolSetByCI=false;    \n\tvar strSupportG = \"\";\n\tvar oCiRec = app.g.get_sqrecordset(\"cmdb\/common\/select.config_item\", \"cid=\"+strKeyValue);\n\twhile(oCiRec.Fetch())\n\t{\n\t\tstrSupportA = app.g.get_field(oCiRec,\"ci_support_analyst\");\n\t\tstrSupportG = app.g.get_field(oCiRec,\"ci_support_group\");\n\t}\n\tif(strSupportA!=\"\")\n\t{\t\t\t\n\t\t\/\/-- have an analyst\n\t\tvar anAnalyst = app.g.get_analyst_detail(strSupportA);\t\t\n\t\tif(anAnalyst)\t\t\t\t\t\t\t\n\t\t{\n\t\t\t_swdoc.OC().itsm_prefered_suppgroup = strSupportA;\n\t\t\t_swdoc.OC().itsm_prefered_text = anAnalyst.name;\n\t\t\tboolSetByCI=true;\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t}\n\t}\n\telse if(strSupportG != \"\")\n\t{\n\t\t\/\/-- have a supp group\n\t\tvar aGroup = app.g.get_group_detail(strSupportG);    \t\n\t\tif(aGroup)\n\t\t{\n\t\t\t_swdoc.OC().itsm_prefered_suppgroup = strSupportG;\n\t\t\t_swdoc.OC().itsm_prefered_text = aGroup.name;\n\t\t\tboolSetByCI=true;\t\t\t\t\t\t\n\t\t}\n\t}\n\telse\n\t{\n\t\t\/\/-- there is no prefer so reset\n\t\t\/\/-- 29.04.2008 - out of 2.2.0 testing\n\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t_swdoc.OC().itsm_prefered_text = \"\";\t\n\t\t\n\t}\n\n    _swdoc.UpdateFormFromData();\n}"},{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strCallclass)\n{\n\t\/\/-- can they raise a record of this class\n\n\tif(app.itsm.can_create(strCallclass,true)==false) return false;\n\n\n\treturn true;\n}"},{"name":"OnRecordValueChanged","code":"OnRecordValueChanged(strTable, strColumn, strValue, strOldValue)\n{\n\t\/\/-- NWJ - check to see if user has changed the itsm_opencall_rfc table field\n\t\/\/-- to search for raised by and monitored by analyst - so it works like resolving a customer.\n\n\tif(strTable==\"itsm_opencall_rfc\")\n\t{\n\t\tvar oAnalyst = false;\n\t\tif((strColumn.indexOf(\"raised_\") == 0)||(strColumn.indexOf(\"monitored_\") == 0))\n\t\t{\n\t\t\t\/\/-- get db col name based on passed in col name\n\t\t\tvar strDBCol=\"\";\n\t\t\t\/\/MessageBox(strColumn.split(\"_\")[2])\n\t\t\tswitch(strColumn.split(\"_\")[2])\n\t\t\t{\n\t\t\t\tcase \"analystid\":\n\t\t\t\t\tstrDBCol=\"analystid\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"name\":\n\t\t\t\t\tstrDBCol=\"name\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"group\":\t\t\t\t\t\n\t\t\t\t\tstrDBCol=\"supportgroup\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"telephone\":\n\t\t\t\t\tstrDBCol=\"contactb\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"email\":\n\t\t\t\t\tstrDBCol=\"contacte\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tMessageBox(\"The extended rfc column (\" + strColumn + \") cannot be matched to swanalysts. please contact your Supportworks Administrator.\");\n\t\t\t\t\t_swdoc.set_rfc_analyst(false,true);\n\t\t\t\t\treturn;\n\t\t\t\t\tbreak;\t\t\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tif(strColumn.indexOf(\"raised_\") == 0)\n\t\t{\n\t\t\t\/\/-- auto search raised by\n\t\t\tapp.g.resolve_analyst(strDBCol,strValue,function(oAnalyst)\n\t\t\t{\n\t\t\t\tif(oAnalyst) _swdoc.set_rfc_analyst(oAnalyst,false);\n\t\t\t});\n\t\t}\n\t\telse if (strColumn.indexOf(\"monitored_\") == 0)\n\t\t{\n\t\t\t\/\/-- auto search monitored by\n\t\t\tapp.g.resolve_analyst(strDBCol,strValue,function(oAnalyst)\n\t\t\t{\n\t\t\t\tif(oAnalyst) _swdoc.set_rfc_analyst(oAnalyst,true);\n\t\t\t});\t\t\t\n\t\t}\n\t}\n\telse if(strColumn==\"probcode\" && strTable == \"opencall\")\n    {\n\t\t_swdoc.boolChangeProfile = true;\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n  \t\tmainform.SetTimer(4, 100);\n\t}\n\telse if(strColumn==\"priority\" && strTable == \"opencall\")\n    {\n     \tif(_swdoc.boolChangeProfile)\n        {\n\t \t\t_swdoc.OC().priority =strOldValue;\n\t \t\t_swdoc.UpdateFormFromData();\n\t   \t\tMessageBox(\"SLAs and Priorities are dependant on Service, so cannot be set from the request profile.\");\n\t   \t}\n    }\n    else if( (strColumn==\"itsm_impact_level\")||(strColumn==\"itsm_urgency_level\") )\n    {\n    \tif(_swdoc.OC().itsm_sladef!=\"\")\n    \t{\n    \t\t\/\/-- if use incident assessment over ci\n    \t\t\/\/if(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/UseCIAssessmentLevels\")!=1)\n    \t\t\/\/{\n    \t\t\tvar strPriority = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level);\n    \t\t\tif(strPriority!=\"\")\n   \t\t\t\t\t_swdoc.handle_set_priority(strPriority);\n    \t\t\t_swdoc.UpdateFormFromData();\n    \t\t\/\/}\n    \t}\n    }\n    else if (strColumn==\"fk_company_id\"||strColumn==\"site\"||strColumn==\"fk_dept_code\"||strColumn==\"costcenter\"||strColumn==\"pk_workflow_id\")\n\t{\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n}"},{"name":"OnCallLoggedOK","code":"OnCallLoggedOK(nCallRef, dateRespondBy, dateFixBy, strCustName, strSla)\n{\n\t\/\/-- NWJ - 12-02.2007 - after logging problem link its CIs and Incidents\n    \/\/-- nwj \n    \/\/-- 15.03.2004\n    var intCallRef = app.g.callref_unpad(nCallRef);\n\n\t\/\/-- affected CIs\n    var olist = _swdoc.MF().sl_component1;\n    var boolComponents = false;\n\tvar strCauseDiaryText = \"\\nThe following Service Option's will be included in Request.\\n\";    \n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolComponents = true;\n        var pk_ci_id = olist.GetItemTextRaw(x,4);\n        var intQty = olist.GetItemTextRaw(x,7);\n        var ci_item_key = app.g.sl_getcolvalue(olist, x, 'service_id');\/\/olist.GetItemTextRaw(x,1);\n\n        var gl_code = app.g.sl_getcolvalue(olist, x, 'gl_code');\/\/olist.GetItemTextRaw(x,1);\n\n        var type = olist.GetItemTextRaw(x,2);\n        var description = app.g.sl_getcolvalue(olist, x, 'description');\/\/olist.GetItemTextRaw(x,3);\n\n\t\tintQty = intQty * _swdoc.OC().request_qty;\n\t\t\n\t\tvar price = app.g.sl_getcolvalue(olist, x, 'price');\n\t\tif(isNaN(price))price=0;\n\t\tvar price = price*_swdoc.OC().request_qty;\n\t\tvar price = app.format_float_to_decimal_str(price);\n\n\t\tvar cost = app.g.sl_getcolvalue(olist, x, 'total_unit_cost');\n\t\tif(isNaN(cost))cost=0;\n\t\tvar cost = cost*_swdoc.OC().request_qty;\n\t\tvar cost = app.format_float_to_decimal_str(cost);\n\n\t\tvar oInsertTmp = new app.oSqlInsert('request_comp');\n\t\toInsertTmp.setfield('fk_callref',intCallRef);\n\t\toInsertTmp.setfield('fk_comp_id',pk_ci_id);\n\t\toInsertTmp.setfield('name',ci_item_key);\n\t\toInsertTmp.setfield('type',type);\n\t\toInsertTmp.setfield('description',description);\n\t\toInsertTmp.setfield('qty',intQty);\n\t\toInsertTmp.setfield('comp_price',price);\n\t\toInsertTmp.setfield('comp_cost',cost);\n\t\toInsertTmp.setfield('gl_code',gl_code);\n\t\toInsertTmp.execute();\n\t\t\/\/-- Relate the CI to the call\n\t\t\/\/if (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'REQUEST-COMPONENT'))\n\t\t\/\/{\n\t\tstrCauseDiaryText    += \"Service Name (\" + description + \"). \\n\"\n\t\t\/\/}\n    }    \n    var olist = _swdoc.MF().sl_optional_component1;\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n\t\tif(olist.IsRowChecked(x))\n\t\t{\n    \t\tboolComponents = true;\n        \tvar pk_ci_id = app.g.sl_getcolvalue(olist, x, 'fk_key');\/\/olist.GetItemTextRaw(x,1);\n        \tvar intQty = olist.GetItemTextRaw(x,6);\n        \tvar ci_item_key = app.g.sl_getcolvalue(olist, x, 'service_id');\/\/olist.GetItemTextRaw(x,1);\n\t\n        \tvar gl_code = app.g.sl_getcolvalue(olist, x, 'gl_code');\/\/olist.GetItemTextRaw(x,1);\n\n\t      \tvar type = olist.GetItemTextRaw(x,2);\n        \tvar description = app.g.sl_getcolvalue(olist, x, 'description');\/\/olist.GetItemTextRaw(x,3);\n\t\n\t\t\tintQty = intQty * _swdoc.OC().request_qty;\n\t\t\t\n\t\t\tvar price = app.g.sl_getcolvalue(olist, x, 'price');\n\t\t\tif(isNaN(price))price=0;\n\t\t\tvar price = price*_swdoc.OC().request_qty;\n\t\t\tvar price = app.format_float_to_decimal_str(price);\n\t\n\t\t\tvar cost = app.g.sl_getcolvalue(olist, x, 'total_unit_cost');\n\t\t\tif(isNaN(cost))cost=0;\n\t\t\tvar cost = cost*_swdoc.OC().request_qty;\n\t\t\tvar cost = app.format_float_to_decimal_str(cost);\n\t\n\t\t\tvar oInsertTmp = new app.oSqlInsert('request_comp');\n\t\t\toInsertTmp.setfield('fk_callref',intCallRef);\n\t\t\toInsertTmp.setfield('fk_comp_id',pk_ci_id);\n\t\t\toInsertTmp.setfield('name',ci_item_key);\n\t\t\toInsertTmp.setfield('type',type);\n\t\t\toInsertTmp.setfield('description',description);\n\t\t\toInsertTmp.setfield('qty',intQty);\n\t\t\toInsertTmp.setfield('comp_price',price);\n\t\t\toInsertTmp.setfield('comp_cost',cost);\n\t\t\toInsertTmp.setfield('gl_code',gl_code);\n\t\t\toInsertTmp.execute();\n\t\t\t\/\/-- Relate the CI to the call\n\t\t\t\/\/if (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'REQUEST-COMPONENT'))\n\t\t\t\/\/{\n\t\t\tstrCauseDiaryText    += \"Service Name (\" + description + \"). \\n\"\n\t\t\t\/\/}\t\n\t\t}\n    }    \n    \/\/-- if we have Components to add add it\n    if (boolComponents)\n    {\n\t\tvar strActionSource = \"Service Request Management\";\n\t\tvar strCode\t\t\t= \"Linking Component Items\";\n\t\tapp.g.new_dairyevent(intCallRef,strCauseDiaryText,strActionSource,strCode);    \n    }\n\n\n    \/\/-- loop through causing CI and assign them to this call\n\tvar strDiaryText = \"The following Configuration Items are to be associated.\\n\";\n\tvar boolCIs = false;\n    var olist = _swdoc.EF().sl_configitems1;\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolCIs =true;\n        var pk_ci_id = olist.GetItemTextRaw(x,0);\n        var ci_item_key = olist.GetItemTextRaw(x,1);\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'REQUEST'))\n\t\t{\n\t\t\tstrDiaryText    += \"Configuration Item (\" + ci_item_key + \"). \\n\";\n\t\t}\n    }\n\n  \n    \/\/-- if we have CI to add add it\n    if (boolCIs)\n    {\n\t\tvar strActionSource = \"Service Request Management\";\n\t\tvar strCode\t\t\t= \"Linking Configuration Items\";\n\t\tstrDiaryText += strCauseDiaryText;\n\t\tapp.g.new_dairyevent(intCallRef,strDiaryText,strActionSource,strCode);\n\t\t\/\/ -- If we have a CI,  check whether the first Stage requires Authorisations for CI Owner\n\t\tvar xmlmc = new XmlMethodCall();\n\t\txmlmc.SetParam(\"in_callref\", intCallRef);\n\t\tif(!xmlmc.Invoke(\"VPME\", \"checkStageAuthSR\"))\n\t\t{\n\t\t\tMessageBox(xmlmc.GetLastError());\n\t\t}\n\t\t\n\t}\n\t\n    \/\/-- insert a relationship between app.service request and incs\n    var strIncidents = app.g.sl_get_valuesdel(_swdoc.EF().sl_incs1,0,\",\");\n    if (strIncidents !=\"\")\n    {\n \t\tvar strActionSource = \"Service Request Management\";\n\t   \tvar strText = \"This service request has been associated with the following Incidents\\n\\n\";\n    \tvar arrIncidents = strIncidents.split(\",\");\n    \tfor(var x=0; x < arrIncidents.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(intCallRef,arrIncidents[x],'REQUEST-INCIDENT'))\n\t\t\t{\n\t\t\t\tstrText += \"Incident (\" + app.g.pad_callref(arrIncidents[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrIncText = \"The service request (\" + nCallRef + \") has been associated to this Incident\";\n\t\t\t\tapp.g.new_diaryevent(arrIncidents[x],strIncText,strActionSource,\"Service Request Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,strActionSource,\"Incident Association\");\n    }\n   \n   \/\/-- insert a relationship between app.service request and incs\n    var strChanges = app.g.sl_get_valuesdel(_swdoc.EF().sl_rfcs,0,\",\");\n    if (strChanges !=\"\")\n    {\n \t\tvar strActionSource = \"Service Request Management\";\n\t   \tvar strText = \"This service request has been associated with the following Change Request\\n\\n\";\n    \tvar arrChanges = strChanges.split(\",\");\n    \tfor(var x=0; x < arrChanges.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrChanges[x],intCallRef,'REQUEST-CHANGE'))\n\t\t\t{\n\t\t\t\tstrText += \"Change (\" + app.g.pad_callref(arrChanges[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrIncText = \"The service request (\" + nCallRef + \") has been associated to this Change\";\n\t\t\t\tapp.g.new_diaryevent(arrChanges[x],strIncText,strActionSource,\"Service Request Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,strActionSource,\"Change Association\");\n    }\n   \n\n\n   \/\/-- insert a relationship between rfc and problem \/ ke\n    var strProblems = app.g.sl_get_valuesdel(_swdoc.EF().sl_srs,0,\",\");\n    if (strProblems !=\"\")\n    {\n    \tvar strText = \"This service request has been associated with the following Service Requests\\n\\n\";\n  \t\tvar strActionSource = \"Service Request Management\";\n\t   \tvar arrProblems = strProblems.split(\",\");\n    \tfor(var x=0; x < arrProblems.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(intCallRef,arrProblems[x],'REQUEST-REQUEST'))\n\t\t\t{\n\t\t\t\tapp.g.relate_calls(arrProblems[x],intCallRef,'REQUEST-REQUEST');\n\t\t\t\tstrText += \"Service Request (\" + app.g.pad_callref(arrProblems[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrPrbText = \"The service request (\" + nCallRef + \") has been associated to this service request.\";\n\t\t\t\tapp.g.new_diaryevent(arrProblems[x],strPrbText,strActionSource,\"Service Request Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,strActionSource,\"Service Request Association\");\n    }\n\n   \/\/-- insert a relationship between rfc and rels\n    var strReleases = app.g.sl_get_valuesdel(_swdoc.EF().sl_rels1,0,\",\");\n    if (strReleases !=\"\")\n    {\n    \tvar strText = \"This service request has been associated with the following Releases\\n\\n\";\n  \t\tvar strActionSource = \"Service Request Management\";\n\t   \tvar arrReleases = strReleases.split(\",\");\n    \tfor(var x=0; x < arrReleases.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrReleases[x],intCallRef,'RELEASE-REQUEST'))\n\t\t\t{\n\t\t\t\tstrText += \"Release (\" + app.g.pad_callref(arrReleases[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrRelText = \"The service request (\" + nCallRef + \") has been associated to this release.\";\n\t\t\t\tapp.g.new_diaryevent(arrReleases[x],strRelText,strActionSource,\"Service Request Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,strActionSource,\"Release Association\");\n    }\n    \n\t\/\/-- F0105032 - audit trail if incoming call\t\n\tif(_swdoc._form.PreloadType==2)\n\t{\n\t\tif(_swdoc.OC().bpm_workflow_id!=\"\")\n\t\t{\n\t\t\tvar intEpochTime = app.global.GetCurrentEpocTime();\n\t\t\tvar oAnalyst = app.g.get_sys_record(\"swanalysts\",app.session.analystId);\n\t\t\tvar oGroup = app.g.get_sys_record(\"swgroups\",app.session.groupId);\n\t\t\tvar strParams = \"fk_workflow_id=\"+app.pfu(_swdoc.OC().bpm_workflow_id);\n   \t\t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_audit_fields\",strParams);\n\t\t\twhile(oRS.Fetch())\n\t\t\t{\n\t\t\t\tvar strBinding = app.g.get_field(oRS,\"fieldname\");\n\t\t\t\tarrBinding = strBinding.split(\".\");\n\t\t\t\tvar strTable = arrBinding[0];\n\t\t\t\tvar strColName = arrBinding[1];\n\t\t\t\t\n\t\t\t\tvar oldValue = \"\";\n\t\t\t\tif(strTable==\"opencall\")\n\t\t\t\t\tvar oldValue = _swdoc.oOpencall[strColName];\n\t\t\t\telse\n\t\t\t\t\tvar oldValue = _swdoc.oExtended[strColName];\n\t\t\t\t\n\t\t\t\tvar newValue = _swdoc[strTable][strColName];\n\t\t\t\tif(app.g.dd_isnumeric(strTable, strColName))\n\t\t\t\t{\n\t\t\t\t\tif(newValue<0)\n\t\t\t\t\t\tnewValue = app.g.fix_epoch(newValue);\n\t\t\t\t\tif(oldValue<0)\n\t\t\t\t\t\toldValue = app.g.fix_epoch(oldValue);\n\t\t\t\t}\n\t\t\t\tif(oldValue!=newValue)\n\t\t\t\t{\n\t\t\t\t\tvar strFieldDisplay = dd.tables[app.LC(strTable)].columns[strColName].DisplayName;\n\t\t\t\t\tvar strFmtOldValue = app.g.dd_format(strTable, strColName, oldValue);\n\t\t\t\t\tvar strFmtNewValue = app.g.dd_format(strTable, strColName, newValue);\n\t\t\t\t\tvar oInsertTmp = new app.oXmlmcInsert('oc_audit');\n\t\t\t\t\toInsertTmp.setfield('fk_callref',_swdoc.OC().callref);\n\t\t\t\t\toInsertTmp.setfield('updatetimex',intEpochTime);\n\t\t\t\t\toInsertTmp.setfield('updatedby',app.session.analystId);\n\t\t\t\t\toInsertTmp.setfield('updatedbyname',oAnalyst.name);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroup',app.session.groupId);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroupname',oGroup.name);\n\t\t\t\t\toInsertTmp.setfield('databinding',strBinding);\n\t\t\t\t\toInsertTmp.setfield('bindingfield',arrBinding[1]);\n\t\t\t\t\toInsertTmp.setfield('bindingtable',arrBinding[0]);\n\t\t\t\t\toInsertTmp.setfield('fielddisplay',strFieldDisplay);\n\t\t\t\t\toInsertTmp.setfield('oldvalue',oldValue);\n\t\t\t\t\toInsertTmp.setfield('newvalue',newValue);\n\t\t\t\t\toInsertTmp.setfield('fmtoldvalue',strFmtOldValue);\n\t\t\t\t\toInsertTmp.setfield('fmtnewvalue',strFmtNewValue);\n\t\t\t\t\toInsertTmp.execute();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\/\/-- EOF F0105032 \n}"},{"name":"OnRecordResolved","code":"OnRecordResolved(strTable)\n{\n\t\/\/###20120730 fix for \"Company\")\n\tstrTable = strTable.toLowerCase();\n\t\n\t\/\/-- set sla based on worflow default\n\tif(IsObjectDefined(\"mainform\") && strTable==\"bpm_workflow\")\n\t{\n\t\t\/\/OC().priority = bpm_workflow.fk_default_sla;\n\t\tapp.g.process_bpm_form_attribute_check(_swdoc,bpm_workflow.pk_workflow_id);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\t_swdoc.UpdateFormFromData();\n\t\treturn;\n\t}\n\n    if (IsObjectDefined(\"mainform\") && strTable == \"userdb\")\n    {\n    \t\/\/_swdoc.setup_customer_details()\n    \t\/\/-- rjc - 2.4.0 - customer changed and site selected, confirm site part of new customers organisation\n\t\tif(_swdoc.OC().site!=\"[Use Customers Site]\"){\n\t\t\tvar recSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\t\tif(recSite)\n\t\t\t{\n\t\t\t\tif(app.LC(recSite.fk_company_id) != app.LC(_swdoc.oCust().fk_company_id))\n\t\t\t\t{\n\n\t\t\t\t\t_swdoc.OC().site = \"[Use Customers Site]\";\n\t\t\t\t\t\/\/##### rename of lb_oc_site to lb_oc_site1\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_site1, \"[Use Customers Site]\");\n\n\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\/\/-- check if customer is in active    \t\n    \tvar strCustStatusMsgValue = dd.GetGlobalParamAsString(\"Application Settings\/CustomerStatusMessages\/\" + _swdoc.oCust().status);\n\t\tif(strCustStatusMsgValue!=\"\")\n\t\t{\n\t\t\tMessageBox(strCustStatusMsgValue);\n\t\t}\n\t\n\t\t\n\t\t\/\/-- nwj - 2.3.2 - load company record for customer - and show company on resolve message\n\t\tif(_swdoc.oCust().fk_company_id != \"\" && app.LC(_swdoc.oCust().fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t{\n\t\t\t\/\/-- rjc - 2.4 - resolve company record if company doesnt exist\n\t\t\t_swdoc.ResolveRecord('company','pk_company_id',_swdoc.oCust().fk_company_id);\n\t\t\tif(_swdoc.oCompany())\n\t\t\t{\n\t\t\t\tif(_swdoc.oCompany().recordresolvedmsg!=\"\")MessageBox(_swdoc.oCompany().recordresolvedmsg);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- there is adata issue here as the customers organisation does not exist\n\t\t\t\tMessageBox(\"The organisation that this customer belongs to cannot be found on the system. Please contact your Supportworks administrator.\");\n\t\t\t}\n\t\t}\n\n\t\t_swdoc.setup_customer_details();\n\n\t\t_swdoc.reload_services(true);\n\n\n\t\t\/\/###20120730\n\t\t_swdoc.set_org_filter();\n\t\t\n\t\t\/\/--F0110887 Start\n\t\tvar intExpiryEpoch = app.g.fix_epoch(_swdoc.oCompany().supportexpiryx);\n\t\tapp.g.checkOrgSupport(_swdoc.oCust().fk_company_id, intExpiryEpoch, true);\n\t\t\/\/--F0110887 End\n\t\t\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\t\t\n    }    \n    if (IsObjectDefined(\"mainform\") && strTable == \"company\")\n    {\n    \n        \/\/###20120716\n    \t_swdoc.multi_c_set_company(_swdoc.oCompany().pk_company_id);\n    \n    \tapp.g.strLogAndResolveCompany = _swdoc.oCompany().pk_company_id;\n\t\tif(app.LC(_swdoc.oCust().fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t{   \n    \t\t_swdoc.ResetRecord('userdb');\n\t\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Service Request\/OnOrganisationResolveCustomer\")==1)\n\t\t\t{\n\t\t\t\t_swdoc.boolResolvingCust = true;\n\t\t\t\tmainform.SetTimer(1, 10);\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(_swdoc.oCompany().recordresolvedmsg!=\"\")MessageBox(_swdoc.oCompany().recordresolvedmsg);\n\t\t\n\t\tif(_swdoc.OC().site!=\"[Use Customers Site]\"){\n\t\t\tvar recSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\t\tif(recSite)\n\t\t\t{\n\t\t\t\tif(recSite.fk_company_id!=_swdoc.oCompany().pk_company_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().site = \"[Use Customers Site]\";\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_site1,  \"[Use Customers Site]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(_swdoc.OC().costcenter!=\"\"){\n\t\t\tvar recCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(recCC.fk_company_id!=_swdoc.oCompany().pk_company_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().costcenter = \"\";\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_cc1,  \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/-- Filter Contracts for Company\n\t\t\/\/###20120730 app.g.filter_company_contracts(_swdoc.oCompany().pk_company_id, _swdoc.MF().lb_contract);\n\t\tapp.g.filter_company_contracts(_swdoc.OC().fk_company_id, _swdoc.MF().lb_contract);\n\t\t\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\t\n  \t\t_swdoc.check_cis();\n \t\t_swdoc.UpdateFormFromData();\n\t}\n\n}"},{"name":"OnResolveRecord","code":"OnResolveRecord(strTable, strColumn, strValue)\n{\n \t\/\/-- resolving the customer record\n \tif(IsObjectDefined(\"mainform\") && strTable == 'userdb' && _swdoc.boolResolvingCust == false && strValue!=\"\")\n \t{\n \t\tif (\"companyname\" == strColumn && \"\" != strValue){\n\t\t\t_swdoc.ResolveRecord(\"company\",\"companyname\",strValue);\n \t\t\t_swdoc.strPreSelectedCompany = strValue;\n\t\t}\n\t\t\n  \t\tif(strColumn ==\"firstname!surname\")\n  \t\t{\n  \t\t\t\/\/-- if using customer name search on firstname and lastname\n  \t\t\t\/\/-- 2.4.1 bug fix 79046\n   \t\t\tarrNames = strValue.split(\" \");\n   \t\t\tif(arrNames[1]==undefined)\n   \t\t\t{\n      \t\t\tvar strParams = \"_swc_firstname=\"+arrNames[0];\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0];\n    \t\t}\n   \t\t\telse\n   \t\t\t{\n    \t\t\tvar strLastName=\"\";\n    \t\t\tfor(var y=1;y<arrNames.length;y++)\n    \t\t\t{\n     \t\t\t\tif(y>1)strLastName = strLastName+\" \";\n     \t\t\t\tstrLastName = strLastName+arrNames[y];\n    \t\t\t}\n       \t\t\tvar strParams = \"_swc_firstname=\"+arrNames[0]+\"&_swc_surname=\"+strLastName;\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n  \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0]+\"&surname=\"+strLastName;\n   \t\t\t}\n  \t\t}\n  \t\telse\n  \t\t{\n       \t\tvar strParams = \"_swc_\"+strColumn+\"=\"+strValue;\n   \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\tvar strSearch = strColumn+\"=\"+strValue;\n   \t\t}\n\t\tif(intCount!=1 && !_swdoc.boolCustid_fromCall)\n\t\t{\n\t\t\t_swdoc.strSearchFor = strSearch;\n  \t\t\tmainform.SetTimer(1, 100);\n  \t\t\t_swdoc.boolResolvingCust = true;\n  \t\t\treturn \"\";\n \t\t}\n \t}\n \t if(strTable == \"company\")\n \t{\n \t\t\/\/-- Grab Company Record\n \t\tvar oCompanyTemp = app.g.get_record(\"company\",strValue,'companyname');\n \t\t\/\/--F0110887 Start\n\t\tvar intExpiryEpoch = app.g.fix_epoch(oCompanyTemp.supportexpiryx);\n\t\tapp.g.checkOrgSupport(_swdoc.oCust().companyname, intExpiryEpoch, true);\n\t\t\/\/--F0110887 End\n \t}\n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'company' && strValue ==\"\")\n \t{\n\t\tapp.g.strLogAndResolveCompany = \"\";\n  \t\t\/\/2.4 clear down list if user is being unselected\n  \t\t_swdoc.ResetRecord('userdb');\n \t} \n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'bpm_workflow' && strValue ==\"\")\n \t{\n\t\tapp.g.reset_bpm_form_attribute_check(_swdoc);\n \t} \n \n return strValue;\n}"},{"name":"OnValidate","code":"OnValidate()\n{\n\t\/\/-- Check Service status is still \"catalog\" and available for logging\n\t\/\/-- This check is used for requests stored as quick log calls with the app.service selected\n\tif(_swdoc.OC().itsm_fk_service>0)\n\t{\n\t\tvar rec = app.g.get_record(\"config_itemi\", _swdoc.OC().itsm_fk_service);\n\t\tif(rec.status_portfolio.toLowerCase()!=\"catalog\")\n\t\t{\n\t\t\tMessageBox('This service is no longer available in the service catalog. Please select an alternative service.');\n\t\t\t_swdoc.OC().itsm_fk_service=0;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\treturn VALIDATE_FAIL;\n\t\t}\n\t}\n\t\n\tif(_swdoc.OC().request_qty<1)\n\t{\n\t\tMessageBox('You must request a quantity greater than 0');\n\t\treturn VALIDATE_FAIL;\n\t}\n\t\n\titsm_opencall_rfc.dow_note = updatedb.updatetxt;\n\tvar fltPrice = 0;\n\tvar fltCost = 0;\n\t\/\/sl_optional_component1.rowCount()\n\tfor(var x = 0; x<_swdoc.MF().sl_optional_component1.rowCount();x++)\n\t{\n\t\tif(_swdoc.MF().sl_optional_component1.IsRowChecked(x))\n\t\t{\n\t\t\tvar price = app.g.sl_getcolvalue(_swdoc.MF().sl_optional_component1, x, 'price');\n\t\t\tif(isNaN(price))price=0;\n\t\t\tprice = price*_swdoc.OC().request_qty;\n\t\t\tfltPrice = fltPrice + parseFloat(price);\n\n\t\t\tvar cost = app.g.sl_getcolvalue(_swdoc.MF().sl_optional_component1, x, 'total_unit_cost');\n\t\t\tif(isNaN(cost))cost=0;\n\t\t\tfltCost = fltCost*_swdoc.OC().request_qty;\n\t\t\tfltCost = fltCost + parseFloat(cost);\n\t\t}\n\t}\n\n\tvar strManCompCost = app.g.sqllist_gettotalvalue(_swdoc.MF().sl_component1, 'total_unit_cost');\n\tif(isNaN(strManCompCost))strManCompCost=0;\n\tfltCompCost = parseFloat(strManCompCost)+fltCost;\n\tfltCompCost = fltCompCost*_swdoc.OC().request_qty;\n\topencall.request_comp_cost = app.format_float_to_decimal_str(fltCompCost);\n\n\tvar fltSLACost = _swdoc.arrSLACost[_swdoc.OC().itsm_sladef];\n\tif(isNaN(fltSLACost))fltSLACost=0;\n\topencall.request_sla_cost = app.format_float_to_decimal_str(fltSLACost);\n\n\tvar fltCost = parseFloat(fltSLACost)+parseFloat(fltCompCost);\n\tif(isNaN(fltCost))fltCost=0;\n\topencall.request_cost = app.format_float_to_decimal_str(fltCost);\n\n\tif(isNaN(_swdoc.strCurrentPrice))_swdoc.strCurrentPrice=0;\n\tvar fltCompPrice = parseFloat(_swdoc.strCurrentPrice) + fltPrice;\n\tif(isNaN(fltCompPrice))fltCompPrice=0;\n\tfltCompPrice = fltCompPrice*_swdoc.OC().request_qty;\n\topencall.request_comp_price = app.format_float_to_decimal_str(fltCompPrice);\n\t\n\tvar fltSLAPrice = _swdoc.arrSLAPrice[_swdoc.OC().itsm_sladef];\n\tif(isNaN(fltSLAPrice))fltSLAPrice=0;\n\topencall.request_sla_price = app.format_float_to_decimal_str(fltSLAPrice);\n\t\n\tfltPrice = parseFloat(fltSLAPrice)+parseFloat(fltCompPrice);\n\tif(isNaN(fltPrice))fltPrice=0;\n\topencall.request_price = app.format_float_to_decimal_str(fltPrice);\n\n\tif(bpm_workflow.flg_requireci==1)\n\t{\n\t\tif(_swdoc.EF().sl_configitems1.rowCount() < 1)\n\t\t{\n\t\t\tMessageBox(\"Before logging this Service request you have to associate at least one configuration item or service\");\n\t\t\treturn VALIDATE_FAIL;\n\t\t}\n\t}\n\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"OnPreValidate","code":"OnPreValidate()\n{\n\t\/\/--F0110887 Start\n\tvar intExpiryEpoch = app.g.fix_epoch(_swdoc.oCompany().supportexpiryx);\n\tvar boolOrgSupported = new Boolean(app.g.checkOrgSupport(_swdoc.oCust().companyname, intExpiryEpoch, false));\n\tif (boolOrgSupported==false)\n\t{\n\t\t MessageBox(\"You cannot log a call for this customer as the '\" + _swdoc.oCust().companyname + \"' organisation is no longer supported.\");\n\t\t return VALIDATE_FAIL;\n\t}\n\t\/\/--F0110887 End\n\t\n\tif(_swdoc.OC().itsm_fk_service<1)\n\t{\n\t\tMessageBox(\"The field 'Service' is a mandatory field and must be completed\",MB_ICONSTOP);\n\t\treturn VALIDATE_FAIL;\n\t}\n\n    var boolResolve = false;\n\tif(\t_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\"||_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Workflow SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\tboolResolve = true;\n\tif(boolResolve)\n\t{\n\t\tvar boolOK = _swdoc.handle_set_sladef(_swdoc.OC().itsm_slaname,true);\n\t\tif(!boolOK)\n\t\t\treturn VALIDATE_FAIL;\n\t}\n\n\t\/\/###20120802 check cc, dept, site in org?\n\tvar iCaptureMistakes = 0;\n\tvar intMistakeCounter = 0;\n\tvar tDept; \/\/ needs to remain outside as department name is NOT the fk_dept_code but dept_name\n\tif (\"\" !== _swdoc.OC().site){\n\t\ttSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\tif (tSite.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 1;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (\"\" !== _swdoc.OC().costcenter){\n\t\tvar tCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\tif (tCC.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 2;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (\"\" !== _swdoc.OC().fk_dept_code){\n\t\ttDept = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\tif (tDept.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 4;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (iCaptureMistakes > 0){\n\t\tvar strDetectedMistakes = \"\";\n\t\tvar intDealtWithMistakes = 0;\n\t\tif ( 1 == (iCaptureMistakes % 2) ) {\n\t\t\tstrDetectedMistakes += \"site (\" + _swdoc.OC().site + \")\";\n\t\t\tintDealtWithMistakes++;\n\t\t}\n\t\tif ( 1 == (Math.floor(iCaptureMistakes \/ 2) % 2) ) {\n\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":((2==intMistakeCounter)?\" and \":\", \")) + \"charge centre (\" + _swdoc.OC().costcenter + \")\";\n\t\t\tintDealtWithMistakes++;\n\t\t}\n\t\tif ( 1 == (Math.floor(iCaptureMistakes \/ 4) % 2) ) {\n\t\t\tif(!tDept.dept_name)\n\t\t\t{\n\t\t\t\t\/\/-- F0108424\n\t\t\t\tvar oCust2 = app.g.get_record(\"userdb\", _swdoc.OC().cust_id);\n\t\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":\" and \") + \"department (\"+oCust2.department+\") does not exist and\";\n\t\t\t}else\n\t\t\t{\n\t\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":\" and \") + \"department (\" + tDept.dept_name + \")\";\n\t\t\t}\n\t\t\t\/\/-- F0108424\n\n\t\t}\n\t\tvar intResponse = MessageBox(\"The \" + strDetectedMistakes + \" \" + ((1==intMistakeCounter)?\"is\":\"are\") + \" NOT part of \" + _swdoc.OC().companyname + \".\\n\\nSelect 'OK' to proceed with the current data.\", MB_OKCANCEL | MB_ICONEXCLAMATION);\n\t\tif (2==intResponse) return VALIDATE_FAIL;\n\t}\n\n\n\n\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"OnFormClosing","code":"OnFormClosing()\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.strLogAndResolveContract = \"\";\n\tapp.g.strLogAndResolveCompany = \"\";\n\n\n\treturn true;\n}"},{"name":"OnLogCall","code":"OnLogCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.set_preferred_assignment(false);\n\t_swdoc.handle_set_priority(_swdoc.MF().lb_oc_sla.text);\n\t_swdoc.OC().custom_i3=0;\n    return true;\n}"},{"name":"OnLogAndResolveCall","code":"OnLogAndResolveCall()\n{\n\t\/\/-- nwj - hide confirmation\n\tapp.g.bDoNotShowLogCallConfirmation = true;\n\tapp.g.bPromptToOpenCallDetails = false;\n\t\n\treturn true;\n}"},{"name":"OnAcceptCall","code":"OnAcceptCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.OC().custom_i3=0;\n\n\treturn true;\n}"},{"name":"OnLogAndAssignCall","code":"OnLogAndAssignCall(strGroupID, strAnalystID)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.OC().custom_i3=0;\n\t\n\t_swdoc.OC().suppgroup = strGroupID;\n\t_swdoc.OC().owner = strAnalystID;\n\n\treturn true;\n}"},{"name":"OnTakeCall","code":"OnTakeCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.OC().custom_i3=0;\n\n\treturn true;\n}"}]}}},"layout":{"appearance":{"width":"1016","height":"553","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"lb_company","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"73","left":"95","right":"256","bottom":"91"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.companyname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_customerid1","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"95","left":"95","right":"256","bottom":"113"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"SearchField1","type":"DualSearchField"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"117","left":"95","right":"256","bottom":"135"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.firstname!surname"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"name":"fld_userdb_site","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"139","left":"95","right":"256","bottom":"157"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.site"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfSite","editRecordForm":"Form.EfSite","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_userdb_costcenter","type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"161","left":"95","right":"256","bottom":"179"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_userdb_dept","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"182","left":"95","right":"256","bottom":"200"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.department"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"department","distinctColumn":"pk_dept_code","newRecordForm":"Form.EfDepartment","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","displayColumn":"dept_name","storedQuery":"generic.select"}}},{"general":{"name":"tb_tel1","type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"203","left":"95","right":"256","bottom":"221"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_userdb_email","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"225","left":"95","right":"256","bottom":"243"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageList":"Helpdesk Icons","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_title","type":"Field"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"309","left":"95","right":"498","bottom":"327"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_update","type":"Field"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"331","left":"95","right":"498","bottom":"547"},"scaling":{"top":"0","left":"0","right":"50","bottom":"100"}},"data":{"binding":"updatedb.updatetxt"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_probcode1","type":"Field"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"287","left":"95","right":"498","bottom":"305"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.probcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Click on this field to browse for and select a category for this call","activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"pcdesc","distinctColumn":"code","displayColumn":"info"}}},{"general":{"name":"lb_oc_slad","type":"Field"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"73","left":"577","right":"738","bottom":"91"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_slaname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"itsmsp_slad","distinctColumn":"slad_id","listFilter":"kvs=-1&_swc_archive=0","extraOptions":"[Use Customer SLA]=&[userdb.sld_name]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"service.filter_itsm_sla"}}},{"general":{"name":"Field9","type":"Field"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"95","left":"577","right":"738","bottom":"113"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Critical|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_impact_lvl","distinctColumn":"pk_impact","storedQuery":"generic.select"}}},{"general":{"name":"Field11","type":"Field"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"117","left":"577","right":"738","bottom":"135"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_urgency_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Immediate|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_urgency_lvl","distinctColumn":"pk_urgency","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_sla","type":"Field"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"139","left":"577","right":"738","bottom":"157"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"itsmsp_slad_priority","distinctColumn":"fk_priority","listFilter":"_swc_flg_sla=1&_swc_fk_slad=&[opencall.itsm_sladef]","extraOptions":"[Use SLA Default Priority]=&[itsmsp_slad.pk_slad_id]^[Use Customer Priority]=&[userdb.priority]^[Use Charge Centre Priority]=&[costcent.priority]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lb_contract","type":"Field"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"161","left":"577","right":"738","bottom":"179"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"contract","distinctColumn":"pk_contract_id","displayColumn":"title","disabledBackgroundColor":"#eeeeee","listFilter":"_swc_pk_contract_id=''","storedQuery":"requests.filter_company_contracts"}}},{"general":{"name":"lb_workflows","type":"Field"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"183","left":"577","right":"738","bottom":"201"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"bpm_workflow.pk_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","sqlSource":"swdata","distinctTable":"bpm_workflow","distinctColumn":"pk_workflow_id","disabledBackgroundColor":"#eeeeee","listFilter":"_swc_callclass=Service Request&_swc_flg_active=1","borderColor":"#c0c0c0","storedQuery":"requests.filter_bpm_selection"}}},{"general":{"name":"pl_oc_org","type":"Field"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"73","left":"826","right":"1009","bottom":"91"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Organisation]=[Use Customer's Organisation]","hintText":"The organisation for this call","image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"company","distinctColumn":"pk_company_id","displayColumn":"companyname","disabledBackgroundColor":"#eeeeee","storedQuery":"requests.filter_multi_organisation"}}},{"general":{"name":"lb_oc_site1","type":"Field"},"appearance":{"index":"18","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"95","left":"827","right":"1010","bottom":"113"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.site"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Site]","hintText":"The site at which change request is being implemented","distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","extraOptions":"[Use Customer's Site]=&[userdb.site]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_cc1","type":"Field"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"117","left":"827","right":"1010","bottom":"135"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"The charge centre for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_dept","type":"Field"},"appearance":{"index":"20","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"139","left":"827","right":"1010","bottom":"157"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Department]","hintText":"The department at which change request is being implemented","distinctTable":"department","distinctColumn":"pk_dept_code","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","extraOptions":"[Use Customer's Department]=&[userdb.department]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","displayColumn":"dept_name","storedQuery":"generic.select"}}},{"general":{"name":"fld_del_date","type":"Field"},"appearance":{"index":"21","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"161","left":"827","right":"1010","bottom":"179"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.itsm_sched_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","textLineCount":"0","textInputFormat":"Uppercase","properties":{"dateFormatMode":"0","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field"},"appearance":{"index":"22","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"183","left":"827","right":"1010","bottom":"201"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.customer_ref"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field2","type":"Field"},"appearance":{"index":"23","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"206","left":"827","right":"1010","bottom":"224"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","sqlSource":"swdata","storedQuery":"common.getSwList","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ORIGIN"}}},{"general":{"name":"fld_fk_service","type":"Field"},"appearance":{"index":"24","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"287","left":"577","right":"738","bottom":"305"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_fk_service"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Service for this request","imageList":"Helpdesk Icons","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"config_itemi","distinctColumn":"pk_auto_id","displayColumn":"description","listFilter":"pk_auto_id=-1","storedQuery":"requests.filter_service_logservice"}}},{"general":{"name":"fld_req_qty","type":"Field"},"appearance":{"index":"25","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"287","left":"827","right":"1010","bottom":"305"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.request_qty"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Numeric","properties":{"defaultValue":"1","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"mb_cust_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"26","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"40","left":"443","right":"503","bottom":"62"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"commands":"Customer Search^2|Customer Properties^1|Managers Properties^3|Organisation Properties^4|Selfservice Wizard Input^5|","backgroundColor":"#ff9900"}}},{"general":{"name":"mbtn_service_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"27","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"256","left":"948","right":"1007","bottom":"278"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|","backgroundColor":"#ff9900"}}},{"general":{"name":"fld_userdb_dob","type":"FormulaField"},"appearance":{"index":"28","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"95","left":"328","right":"411","bottom":"113"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":": &[userdb.start_datex]"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_userdb_sdrating","type":"FormulaField"},"appearance":{"index":"29","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"182","left":"328","right":"498","bottom":"200"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":": &[userdb.sdrating]"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_service_subscribe","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"30","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"260","left":"623","right":"844","bottom":"276"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"0","dateFormatMode":"#eeeeee","flagItems":"View customer's unsubscribed services^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"sl_component1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"}},"appearance":{"index":"31","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"329","left":"518","right":"1002","bottom":"419"},"scaling":{"top":"0","left":"50","right":"100","bottom":"50"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Title","width":"207","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"apply_type"},"name":"Apply Type","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"flg_cancustomise"},"name":"Can Customise","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_key"},"name":"FK_key","width":"10","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"price"},"name":"Price","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"total_unit_cost"},"name":"Cost","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"units"},"name":"Units","width":"120","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"service_id"},"name":"Comp Id","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"gl_code"},"name":"GL COde","width":"120","image":"-1","dataColumn":"9"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#808080","editRecordForm":"Form.service_component_selection","listFilter":"fks=-1","table":"sc_rels","sqlSource":"swdata","storedQuery":"request.service.log.components"}}},{"general":{"name":"sl_optional_component1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"true","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"}},"appearance":{"index":"32","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"450","left":"518","right":"1002","bottom":"540"},"scaling":{"top":"50","left":"50","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Title","width":"207","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"ID","width":"102","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"apply_type"},"name":"Apply Type","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_key"},"name":"fk_key","width":"25","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"price"},"name":"Price","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"total_unit_cost"},"name":"Cost","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"units"},"name":"Units","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"service_id"},"name":"Comp ID","width":"120","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"gl_code"},"name":"GL COdee","width":"120","image":"-1","dataColumn":"8"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#808080","editRecordForm":"Form.service_component","listFilter":"fks=-1","table":"sc_rels","sqlSource":"swdata","storedQuery":"request.service.log.optional_components"}}},{"general":{"name":"lb_rfctype","type":"Field"},"appearance":{"index":"33","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"830","left":"800","right":"923","bottom":"848"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.itsm_rfc_type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","sqlSource":"swdata","distinctTable":"swlists","distinctColumn":"value","disabledBackgroundColor":"#eeeeee","listFilter":"list_id = 'RFCTYPE'","borderColor":"#c0c0c0","displayColumn":"display_name"}}},{"general":{"name":"CaptionPanel5","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"34","caption":"Customer Details","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"40","left":"3","right":"502","bottom":"251"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_contact.png"}}},{"general":{"name":"CaptionPanel2","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"35","caption":"Settings","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"40","left":"507","right":"1015","bottom":"251"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_alarm.png"}}},{"general":{"name":"t3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"36","caption":"Process","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"183","left":"518","right":"569","bottom":"201"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.bpm_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text31","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"37","caption":"Impact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"95","left":"520","right":"569","bottom":"113"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text32","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"38","caption":"Urgency","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"117","left":"520","right":"569","bottom":"135"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"CaptionPanel3","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"39","caption":"Description","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"255","left":"3","right":"502","bottom":"552"},"scaling":{"top":"0","left":"0","right":"50","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_document.png"}}},{"general":{"name":"lbl_oc_cc","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"40","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"117","left":"733","right":"822","bottom":"135"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"lbl_oc_site","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"41","caption":"Site Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"95","left":"742","right":"822","bottom":"113"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.site"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"t5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"42","caption":"Change Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"830","left":"730","right":"796","bottom":"848"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Label17","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"43","caption":"Summary","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"309","left":"2","right":"91","bottom":"327"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.itsm_title"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"img_orating1","type":"Image"},"appearance":{"index":"44","caption":"&[app.webroot]\/clisupp\/formimages\/itsm\/cr_neu16.gif","backgroundColor":"#f2eeed","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"ExactSize","borderStyle":"None"},"objectPlacement":{"position":{"top":"203","left":"310","right":"326","bottom":"221"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"imageVAlign":"1"}}},{"general":{"name":"img_customer1","type":"Image","flags":{"transparent":"false","xpStyle":"false","hasShadow":"true","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"45","caption":"&[app.webroot]\/clisupp\/documents\/userdb\/images\/&[userdb.keysearch].jpg","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"Stretch","borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"95","left":"424","right":"498","bottom":"169"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Hand","properties":{"imageHAlign":"0","imageVAlign":"0","backMode":"0","noImageImage":"&[app.webroot]\/clisupp\/documents\/userdb\/images\/noimage.gif"}}},{"general":{"name":"Label11","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"46","caption":"Assessment","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"182","left":"259","right":"324","bottom":"200"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"userdb.sdrating"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label9","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"47","caption":"Start Date","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"95","left":"274","right":"324","bottom":"113"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"userdb.dob"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_userdb_email","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"48","caption":"E-Mail","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"225","left":"6","right":"91","bottom":"243"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"lbl_userdb_tel","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"49","caption":"Tel. No.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"203","left":"6","right":"91","bottom":"221"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_userdb_cc","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"50","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"161","left":"6","right":"91","bottom":"179"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","sqlSource":"swdata"}}},{"general":{"name":"lbl_userdb_site","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"51","caption":"Main Site","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"6","right":"91","bottom":"157"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.site"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfSite","editRecordForm":"Form.EfSite","sqlSource":"swdata"}}},{"general":{"name":"lbl_user_cust_name","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"52","caption":"Customer Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"117","left":"6","right":"91","bottom":"135"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_userdb_keysearch","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"53","caption":"Customer ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"95","left":"6","right":"91","bottom":"113"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"name":"lbl_company","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"54","caption":"Main Organisation","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"73","left":"23","right":"91","bottom":"91"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.companyname"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel4","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"55","caption":"Services","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"255","left":"507","right":"1015","bottom":"552"},"scaling":{"top":"0","left":"50","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_pcadd.png"}}},{"general":{"name":"Rect2","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"56","backgroundColor":"#ffffff","foregroundColor":"#c0c0c0","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"318","left":"513","right":"1010","bottom":"425"},"scaling":{"top":"0","left":"50","right":"100","bottom":"50"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_components","type":"Text"},"appearance":{"index":"57","caption":"Components","backgroundColor":"#f2eedd","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"311","left":"529","right":"597","bottom":"326"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Rect3","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"58","backgroundColor":"#ffffff","foregroundColor":"#c0c0c0","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"438","left":"513","right":"1010","bottom":"545"},"scaling":{"top":"50","left":"50","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_components1","type":"Text"},"appearance":{"index":"59","caption":"Optional Components (tick to include)","backgroundColor":"#f2eedd","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"431","left":"533","right":"719","bottom":"446"},"scaling":{"top":"50","left":"50","right":"50","bottom":"50"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_userdb_dept","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"60","caption":"Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"182","left":"6","right":"91","bottom":"200"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.department"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_fk_dept","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"61","caption":"Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"742","right":"822","bottom":"157"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"lbl_itsm_fk_service","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"62","caption":"Service","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"287","left":"522","right":"569","bottom":"305"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_fk_service"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"lbl_orating1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"63","caption":": Overall satisfaction undetermined","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"203","left":"329","right":"532","bottom":"221"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_req_qty","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"64","caption":"Quantity","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"287","left":"774","right":"822","bottom":"303"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.request_qty"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"lbl_oc_slad","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"65","caption":"SLA","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"73","left":"523","right":"569","bottom":"91"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"name":"lbl_oc_priority","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"66","caption":"Priority","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"507","right":"569","bottom":"157"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"name":"CaptionPanel7","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"67","caption":"Log New Service Request","backgroundColor":"#add8e6","foregroundColor":"#003366","font":{"@size":"18"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"5","left":"3","right":"1015","bottom":"35"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#f1f1f1","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"30","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"name":"lb_oc_slad1","type":"Field"},"appearance":{"index":"68","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"170","left":"1040","right":"1163","bottom":"188"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"itsmsp_slad","distinctColumn":"pk_slad_id","listFilter":"pk_slad_id=-1","extraOptions":"[Use Customer SLA]=&[userdb.sld]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","displayColumn":"slad_id"}}},{"general":{"name":"lbl_contract","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"69","caption":"Contract","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"160","left":"520","right":"569","bottom":"176"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"70","caption":"Job Role","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"73","left":"261","right":"324","bottom":"91"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"userdb.jobrole"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FormulaField"},"appearance":{"index":"71","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"73","left":"328","right":"498","bottom":"91"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":": &[userdb.jobrole]"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text7","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"72","caption":"Requests","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"117","left":"261","right":"324","bottom":"137"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"73","caption":"Active","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"261","right":"324","bottom":"159"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_open_request","type":"Text"},"appearance":{"index":"74","caption":":","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"328","right":"411","bottom":"156"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"75","caption":"Closed","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"161","left":"261","right":"324","bottom":"181"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_closed_request","type":"Text"},"appearance":{"index":"76","caption":":","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"161","left":"328","right":"411","bottom":"178"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"77","caption":"Category","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"287","left":"35","right":"91","bottom":"305"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_details1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"78","caption":"Details","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"332","left":"35","right":"91","bottom":"350"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"79","caption":"Delivery Date","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"161","left":"754","right":"826","bottom":"177"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_sched_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"80","caption":"Customer Ref","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"183","left":"744","right":"822","bottom":"201"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.customer_ref"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"x_fld_org","type":"Field"},"appearance":{"index":"81","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"73","left":"826","right":"1009","bottom":"91"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#c0c0c0","image":"#eeeeee","defaultValue":"[Use Customer's Organisation]","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lbl_oc_company","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"82","caption":"Organisation","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"73","left":"742","right":"821","bottom":"91"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.companyname"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text9","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"83","caption":"There are two Organisation fields here !","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"75","left":"1025","right":"1141","bottom":"118"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"Label7","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"84","caption":"Origin","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"206","left":"786","right":"822","bottom":"222"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"btn_pick_worka_OnPressed","code":"btn_pick_worka_OnPressed()\r\n{\r\n    \/\/ TODO: Add your event code here\r\n    MessageBox(\"Open list of analysts to select from for the analyst to do work\",MB_OK);\r\n    \r\n}\r\n\r\n"},{"name":"btn_pick_raiseda_OnPressed","code":"btn_pick_raiseda_OnPressed()\r\n{\r\n    \/\/-- NWJ 17.03.2004\r\n   \/\/-- open analyst search form in select mode\r\n\r\n    \/\/ Create an instance of a PopupForm class\r\n    var form = new PopupForm();\r\n\r\n    \/\/ Open the form TbSites\r\n    if(form.Open(\"tbAnalysts\",\"\",\"\"))\r\n    {\r\n        \/\/-- Access the forms _swdoc and call the _swdoc.GetVariable() method with the name of the variable\r\n        var stranalystid = form.document.analystid;\r\n        if (stranalystid == \"\") return;\r\n\r\n        \/\/-- assign values\r\n        var oe = elements;\r\n        app._ete(oe[\"db.rfc_sb_id\"] , stranalystid);\r\n        app._ete(oe[\"db.rfc_sb_name\"] , form.document.name);\r\n        app._ete(oe[\"db.rfc_sb_sg\"] , form.document.group);\r\n        app._ete(oe[\"db.rfc_sb_tel\"] ,form.document.phone);\r\n        app._ete(oe[\"db.rfc_sb_email\"] , form.document.email);\r\n    }\r\n}\r\n\r\n"},{"name":"btn_pick_sb_OnPressed","code":"btn_pick_sb_OnPressed()\r\n{\r\n   \/\/-- NWJ 17.03.2004\r\n   \/\/-- open analyst search form in select mode\r\n\r\n    \/\/ Create an instance of a PopupForm class\r\n    var form = new PopupForm();\r\n\r\n    \/\/ Open the form TbSites\r\n    if(form.Open(\"tbAnalysts\",\"\",\"\"))\r\n    {\r\n        \/\/-- Access the forms _swdoc and call the _swdoc.GetVariable() method with the name of the variable\r\n        var stranalystid = form.document.analystid;\r\n        if (stranalystid == \"\") return;\r\n\r\n        \/\/-- assign values\r\n        var oe = elements;\r\n        app._ete(oe[\"db.rfc_sb_id\"] , stranalystid);\r\n        app._ete(oe[\"db.rfc_sb_name\"] , form.document.name);\r\n        app._ete(oe[\"db.rfc_sb_sg\"] , form.document.group);\r\n        app._ete(oe[\"db.rfc_sb_tel\"] ,form.document.phone);\r\n        app._ete(oe[\"db.rfc_sb_email\"] , form.document.email);\r\n                _swdoc.opencall.itsm_rfc_sb_id = stranalystid;\r\n                _swdoc.opencall.itsm_rfc_sb_name = form.document.name;\r\n                _swdoc.opencall.itsm_rfc_sb_group = form.document.group;\r\n                _swdoc.opencall.itsm_rfc_sb_tel = form.document.phone;\r\n                _swdoc.opencall.itsm_rfc_sb_email = form.document.email;\r\n    }\r\n    \r\n}\r\n\r\n"},{"name":"btn_pick_sb_as_rb_OnPressed","code":"btn_pick_sb_as_rb_OnPressed()\r\n{\r\n        \/\/-- NWJ - 18.03.2004\r\n        \/\/-- assign same values to sb as rb analyst\r\n        var oe = elements;\r\n        app._ete(oe[\"db.rfc_sb_id\"], oe[\"db.rfc_rb_id\"].text) \r\n        app._ete(oe[\"db.rfc_sb_name\"], oe[\"db.rfc_rb_name\"].text) \r\n        app._ete(oe[\"db.rfc_sb_sg\"],oe[\"db.rfc_rb_sg\"].text) \r\n        app._ete(oe[\"db.rfc_sb_tel\"] , oe[\"db.rfc_rb_tel\"].text) \r\n        app._ete(oe[\"db.rfc_sb_email\"] , oe[\"db.rfc_rb_email\"].text) \r\n        _swdoc.opencall.itsm_rfc_sb_id = oe[\"db.rfc_sb_id\"].text;\r\n        _swdoc.opencall.itsm_rfc_sb_name = oe[\"db.rfc_sb_name\"].text;\r\n        _swdoc.opencall.itsm_rfc_sb_group = oe[\"db.rfc_sb_sg\"].text;\r\n        _swdoc.opencall.itsm_rfc_sb_tel = oe[\"db.rfc_sb_tel\"].text\r\n        _swdoc.opencall.itsm_rfc_sb_email = oe[\"db.rfc_sb_email\"].text\r\n    \r\n}\r\n\r\n"},{"name":"btn_logrfc_OnPressed","code":"btn_logrfc_OnPressed()\r\n{\r\n    \/\/-- NWJ - 17.03.2004\r\n    \/\/-- log new rfc\r\n\r\n    MessageBox(\"RFC Logged\")\r\n\r\n    var hdcon = new HelpdeskSession;\r\n    If(hdcon.Connect())\r\n    {\r\n\r\n        if(hdcon.BeginLogCall())\r\n        {   \r\n            \/\/ We send our transaction values one by one\r\n            hdcon.SendText (\"description\", \"Attached is my win.ini\");\r\n\r\n            if(hdcon.Commit())MessageBox(\"RFC Created\");\r\n        }\r\n\r\n        \/\/ We have finished with the connection, close it.    \r\n        hdcon.Close();\r\n    } \r\n    \r\n}\r\n\r\n"},{"name":"btn_sb_analyst_OnPressed","code":"btn_sb_analyst_OnPressed()\r\n{\r\n    \/\/ TODO: Add your event code here\r\nmainform.UpdateFormFromData();\r\n    \r\n}\r\n\r\n"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\n\t\/\/-- F0105032\n\tif(_swdoc._form.PreloadType==2)\n\t{\n\t\t_swdoc.oOpencall = app.g.get_sys_record(\"opencall\", _swdoc.OC().callref);\n\t\t_swdoc.oExtended = app.g.get_record(\"itsm_opencall_rfc\", _swdoc.OC().callref);\n\t}\n\t\/\/-- EOF F0105032\n\n\t\/\/-- 12.07.2008 \n\t\/\/-- disable or hide company field if internal support only\n\t\/\/###20120730 - updated\n\tvar boolExternalCompanies =dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1;\n\tapp._een(_swdoc.MF().lb_company, boolExternalCompanies);\n\tapp._evi(_swdoc.MF().lb_contract, boolExternalCompanies);\n\tapp._evi(_swdoc.MF().lbl_contract, boolExternalCompanies);\n\tif(!_swdoc.MF().lb_company.enable)\n\t{\n\t\t\/\/-- check if we should hide\n\t\tapp._evi(_swdoc.MF().lb_company,(dd.GetGlobalParamAsString(\"Application Settings\/HideCompanyField\")!=1));\t\t\n\t\t\/\/alter filter if we do not support external\n\t\t\n\t\tapp._slf(_swdoc.MF().fld_userdb_site,\"\");\n\t\tapp._slf(_swdoc.MF().fld_userdb_costcenter,\"\");\n\t\tapp._slf(_swdoc.MF().fld_userdb_dept,\"\");\t\n\t\tapp._slf(_swdoc.MF().lb_oc_cc1,\"\");\n\t\tapp._slf(_swdoc.MF().lb_oc_site1,\"\");\n\t\tapp._slf(_swdoc.MF().lb_oc_dept,\"\");\n\t}\n\t\/\/###20120730 ensure correct field for organisation is showing - workaround because distinct picklist with Display is broken\n\tvar boolCompanyFieldVisible = (_swdoc.MF().lb_company.visible);\n\tapp._evi(_swdoc.MF().lbl_oc_company, boolCompanyFieldVisible);\n\n\tvar boolCompanySet = (\"\" !== _swdoc.OC().fk_company_id);\n\tapp._ema(_swdoc.MF().x_fld_org, !boolCompanySet);\n\tapp._evi(_swdoc.MF().x_fld_org, !boolCompanySet && boolCompanyFieldVisible);\n\tapp._een(_swdoc.MF().x_fld_org, false);\n\t\n\tapp._ema(_swdoc.MF().pl_oc_org, boolCompanySet);\n\tapp._evi(_swdoc.MF().pl_oc_org, boolCompanySet && boolCompanyFieldVisible);\n\tapp._een(_swdoc.MF().pl_oc_org, boolCompanySet && boolExternalCompanies);\n\t\n\tapp._evi(_swdoc.MF().lbl_company, boolCompanyFieldVisible);\n\t\/\/-- eof hide \/ enable\t    \n\n\t\/\/--\n\t\/\/-- if logging ofr a customer\n\tif(app.g.LOG_CALL_FOR_USER!=\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", app.g.LOG_CALL_FOR_USER);\n\t\tapp.g.LOG_CALL_FOR_USER=\"\";\n\t\t_swdoc.UpdateFormFromData();\n\t\tif(app.g.LOG_CALL_FOR_SERVICE!=\"\")\n\t\t{\n\t\t\tmainform.SetTimer(2, 500);\n\t\t}\n\t}\n\telse if(app.g.LOG_FOR_ORGID!=\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", app.g.LOG_FOR_ORGID);\t\n\t\tapp.g.LOG_FOR_ORGID=\"\";\n\t}\n\t\t\n\t\/\/-- NWJ - 28.02.2006\n\t\/\/--      get any incoming cis (logged from ss)\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems1, _swdoc.OC().callref ,\"INCOMING\",\"\");\n\n\t\/\/-- load CIs if call has been logged from another SR\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems1, _swdoc.OC().callref ,\"REQUEST\",\"\");\n\n\tvar oAnalyst = app.g.get_analyst_detail(app.session.analystId);\n\t_swdoc.set_rfc_analyst(oAnalyst,false);\t\n\t\n\t\/\/--\n\t\/\/-- check if we are raising this problem from an incident\n\tif(app.g.LOG_FROM_CALL!=null)\n\t{\t\n\t\t\/\/-- store incident record info (uses global params to determine what to store)\n\t\tif(app.g.LOG_FROM_CALL.callclass==\"Incident\")\t\t\n\t\t{\n\t\t\t_swdoc.filter_inc_impact(app.g.LOG_FROM_CALL.callref);\t\t\t\n\t\t}\n\t\t\n\t\t\/\/-- store prob\/ke record (uses global params to determine what to store)\n\t\tif(app.g.LOG_FROM_CALL.callclass==\"Known Error\")\n\t\t{\n\t\t\t_swdoc.filter_ke_impact(app.g.LOG_FROM_CALL.callref);\n\t\t}\n\t\t\n\t\t\n\t\t\/\/-- show customer impacted by the log from call\n\t\tif(app.g.LOG_FROM_CALL.cust_id!=\"\")\n\t\t{\n\t\t\t_swdoc.filter_impact_customers(_swdoc.EF());\n\t\t\t_swdoc.ResolveRecord(\"userdb\",\"keysearch\", app.g.LOG_FROM_CALL.cust_id);\n\t\t}\n\t\t\n\t\t\/\/-- copy over prob text\n\t\tupdatedb.updatetxt = app.g.CALLINFO[app.g.LOG_FROM_CALL.callref].origupdatetxt\n\t\t\t\t\n\t\t\n\t\t\/\/-- copy over prob code into recog prob code\n\t\t_swdoc.OC().probcode = app.g.LOG_FROM_CALL.probcode;\n\t\t\n\t\t\/\/-- copy of cost center\n\t\t_swdoc.OC().costcenter = app.g.LOG_FROM_CALL.costcenter;\n\t\t\n\t\t\/\/-- impact \/ urgency \/ priority level \n\t\t_swdoc.OC().itsm_impact_level \t= app.g.LOG_FROM_CALL.itsm_impact_level;\n\t\t_swdoc.OC().itsm_urgency_level\t= app.g.LOG_FROM_CALL.itsm_urgency_level;\n\t\t\/\/OC().priority\t\t\t= app.g.LOG_FROM_CALL.priority;\n\t\t\t\t\n\t\t\/\/-- update form\n\t\t_swdoc.UpdateFormFromData();\n\t\t\n\t\t\/\/-- important - null record\t\t\n\t\tapp.g.LOG_FROM_CALL=null;\n\t}\t\n\t_swdoc.OC().itsm_catreq_type = 'REQUEST';\n\t\/\/-- handle log from email\n\n\t\n\t\/\/Workaround for PM00139253\n\t\/\/if(_swdoc.oCust().keysearch!=\"\" && _swdoc.OC().itsm_fk_service<1)_swdoc.reload_services(true);\t\n\tvar tmpService = _swdoc.OC().itsm_fk_service;\n\tif(_swdoc.oCust().keysearch!=\"\")_swdoc.reload_services(true);\n\t_swdoc.OC().itsm_fk_service = tmpService;\n\t\/\/End workaround\n\t\n\t\n\tif((_swdoc.oCust().fk_company_id!=\"\")&&(_swdoc.oCust().fk_company_id!=_swdoc.oCompany().pk_company_id))_swdoc.ResolveRecord(\"company\", \"pk_company_id\", _swdoc.oCust().fk_company_id);\n\t\t\t\n\t\/\/-- RJC - F0105434\n\tapp.g.get_default_process(_swdoc,'Service Request',_swdoc.MF().t3,_swdoc.MF().lb_workflows);\n\t\/\/-- EOF - F0105434\n\t\n\t\/\/-- F0094989\n\tif(_swdoc.OC().itsm_slaname.indexOf(\"[Use \")<0 && _swdoc.OC().itsm_slaname.indexOf(\" SLA]\")<0 )\n\t{\n\t\tif(_swdoc.OC().itsm_slaname!=\"\")\n\t\t{\n\t\t\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+_swdoc.OC().itsm_slaname);\n\t\t\tif(slarec.Fetch())\n\t\t\t{\n\t\t\t\tvar intSLAId = app.g.get_field(slarec,\"slad_id\");\n\t\t\t\tif(intSLAId!=\"\") {\n\t\t\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t\t\t\t\t_swdoc.handle_set_sladef(intSLAId);\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\/\/ -- Update Main Organisation on the form if only the Organisation is set\n\tif(_swdoc.oCompany().pk_company_id && _swdoc.oCust().keysearch ==\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"userdb\", \"fk_company_id\", _swdoc.oCompany().pk_company_id);\n\t}\n\t\n\t\/\/-- F0108825 : A newly logged call should not have resolve\/close text\n\t\/\/\t         even when it has been copied from a resloved\/closed call\n\t_swdoc.OC().resolve_text=\"\";\n\t_swdoc.OC().close_text=\"\";\t\n\t\/\/\tPM00143977 : values copied from parent call\n\t_swdoc.OC().lastactdatex=\"\";\t\n\t_swdoc.OC().lastactdate=\"\";\t\n\t_swdoc.OC().lastactby=\"\";\t\n\t_swdoc.OC().assigndatx=\"\";\t\n\t_swdoc.OC().withinresp=\"\";\t\n\t_swdoc.OC().resp_time=\"\";\t\n\t_swdoc.OC().slaresp=\"\";\t\n\t_swdoc.OC().assigndate=\"\";\t\t\n\t\/\/-- TK Set Summary Based on Email Subject\n\tif((_swdoc._form['emailsubject']) && (app.oSettings.get_setting(\"boolUseSubjectasSummary\")=='True'))\n\t{\n\t\t_swdoc.OC().itsm_title = _swdoc._form['emailsubject'];\n\t\t_swdoc.boolRFCTitleSetManually = true;\n\t}\n\t\n\t_swdoc.strDefaultPriority = _swdoc.MF().lb_oc_sla.value;\n\t\n}"},{"name":"lb_workflows_OnValueChanged","code":"lb_workflows_OnValueChanged(strValue)\n{\n\t\/\/-- if title not set - set it to match workflow name\n\tif(!_swdoc.boolRFCTitleSetManually)\n\t{\n\t\t_swdoc.OC().itsm_title=strValue;\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\n}"},{"name":"tb_title_OnLeftClick","code":"tb_title_OnLeftClick()\n{\n\t_swdoc.boolRFCTitleSetManually = true;\n\treturn true;\n}"},{"name":"OnTimer","code":"OnTimer(nTimer)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(nTimer==1)\n\t{\n\t\tmainform.KillTimer(1);\n\t\t\n\t\tif(_swdoc.boolCustSearchOpen == true)return;\n        _swdoc.boolCustSearchOpen = true;        \n\t\tvar strURL = \"autorun=1&searchtype=1&canreset=1&fk_company_id=\" + _swdoc.oCompany().pk_company_id+\"&\"+_swdoc.strSearchFor;\n\t\t_swdoc.strSearchFor=\"\";\n\t\tapp.g.search_for(\"customers\",false,strURL,function(sResults)\n\t\t{\n\t\t\tif(sResults.selectedkeys==\"\") \n    \t\t{\n \t\t\t\t_swdoc.boolResolvingCust = false;\n   \t\t\t\treturn;\n    \t\t}\n    \t\tvar arrKey = sResults.selectedkeys.split(\",\");\n    \t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", arrKey[0]);\n    \t\t_swdoc.boolCustSearchOpen = false;                         \n\t\t\t_swdoc.boolResolvingCust = false; \n\t\t});\n\t}\n\t\n\telse if(nTimer==2)\n\t{\n\t\tmainform.KillTimer(2);\n\t\t_swdoc.OC().itsm_fk_service = app.g.LOG_CALL_FOR_SERVICE;\n\t\t_swdoc.service_select(app.g.LOG_CALL_FOR_SERVICE);\n\t\tapp.g.LOG_CALL_FOR_SERVICE=\"\";\n\t}\n\n\telse if(nTimer==4)\n\t{\n\t\tmainform.KillTimer(4);\n\t\t_swdoc.boolChangeProfile = false;\n\t\t\n\t}\n\n}"},{"name":"sl_cust_cis1_OnHeaderItemClicked","code":"sl_cust_cis1_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\/\/sl_cust_cis1.Refresh();\n\t_swdoc.load_cis();\n\t\/\/_swdoc.load_customer_items();\n\t\n\n\n}"},{"name":"sl_cust_cis1_OnItemSelected","code":"sl_cust_cis1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_cust_cis1.curSel > -1);\n\tapp._een(mbtn_cci_views1 , boolActive);\n\tapp._een(mbtn_cci_actions1 , boolActive);\t\n\t\n}"},{"name":"sl_cust_cis1_OnItemChecked","code":"sl_cust_cis1_OnItemChecked(nRow, bChecked)\n{\n\t\n\tvar pk_ci_id = app.g.sl_getrawcolvalue(sl_cust_cis1, nRow, \"pk_auto_id\");\t\n\t\/\/MessageBox(pk_ci_id + \" A:A \" + nRow)\n\tif(bChecked)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems, pk_ci_id, 'pk_auto_id') > -1) return;\n\t\n\t\t\/\/MessageBox(pk_ci_id)\t\n\t\tapp.g.sl_appendfilter(_swdoc.EF().sl_configitems, pk_ci_id,'pk_auto_id');\n\n\t\t\n\t\t\/\/-- NWJ - determine who the preferred support is\n \t\t_swdoc.determine_prefered_support(true)\t\n \t\t\n \t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\tapp.cfg.process_call_contract_check(pk_ci_id, true,_swdoc);\n\t}\n\telse\n\t{\n\t\t\tvar intRowPos = app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems, pk_ci_id, 'pk_auto_id');\n\t\t\tif(intRowPos>-1)\n\t\t\t{\n\t\t\t\t_swdoc.EF().sl_configitems.RemoveRow(intRowPos);\t\t\n\t\n\t\t\t\t\/\/-- 29.04.2008 - 2.2.0 if this ci that has been removed was used to set the pref supp group then change it\n\t\t\t\tif(_swdoc.intAssessmentCI == pk_ci_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\n\t\t\t\t}\n\t\t\t\n\t\t\t\t_swdoc.determine_prefered_support(true);\n\t\t\t\t\/\/_swdoc.check_ci_assessment();\n\t\t\t}\n\n\n\t}\n\n}"},{"name":"mbtn_service_views_OnMenuItem","code":"mbtn_service_views_OnMenuItem(strName, nItemID)\n{\n\tvar iProperties = 1;\n\t\n\t\/\/-- get intCI\n\tvar intService = opencall.itsm_fk_service;\n  \t\/\/var intService = app.g.sl_getrawcolvalue(sl_services,-1,\"fk_cmdb_id\");\n  \tif(intService>0)\n  \t{\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.OpenFormForEdit(\"portfolio\", intService, \"\", true, function(){\n\t\t\t\treturn;\n\t\t\t});\n\t\t\t\/\/app.cmdb.popup_configitem(intCI,true,\"\",false);\n    \t}\n\n\t}\n}"},{"name":"mb_cust_actions1_OnMenuItem","code":"mb_cust_actions1_OnMenuItem(strName, nItemID)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar iProperties = 1;\n\tvar iSearch=2;\t\n\tvar iMgr = 3;\n\t\n\tif(nItemID==iSearch)\n\t{\n\t\tvar strURL = \"canreset=1&fk_company_id=\" + _swdoc.oCompany().pk_company_id;\n\t\tapp.g.search_for(\"customers\",false,strURL,function(sResults)\n\t\t{\n\t\t\tif(sResults.selectedkeys==\"\") return;\n    \n    \t\tvar arrKey = sResults.selectedkeys.split(\",\");\n    \t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", arrKey[0]);\n\t\t});\n    }\n    else if(nItemID==iMgr)\n    {\n    \t\/\/-- popup a form \n\t\tif (_swdoc.userdb.fk_manager != \"\")\n\t\t{\n\t\t\tapp.OpenFormForEdit(\"tfCustomer\", _swdoc.userdb.fk_manager, \"\", true);\n\t\t}\n\t}\n}"},{"name":"sl_component1_OnItemSelected","code":"sl_component1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolEnable = (sl_component1.rowCount() > 0);\n\/\/\tbtn_del_component.enable = boolEnable;\n\n\n}"},{"name":"sl_optional_component1_OnItemSelected","code":"sl_optional_component1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolEnable = (sl_optional_component1.rowCount() > 0);\n\/\/\tbtn_del_component_optional.enable = boolEnable;\n\n\n}"},{"name":"sl_component1_OnHeaderItemClicked","code":"sl_component1_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\treturn false;\n}"},{"name":"sl_component1_OnItemDoubleClicked","code":"sl_component1_OnItemDoubleClicked(nRow, nCol)\n{\n\tif(nRow!=sl_component1.curSel)\n\t\treturn;\n\n\t\/\/ TODO: Add your event handler code here\n\tvar strCanCust = app.g.sl_getcolvalue(sl_component1, sl_component1.curSel, \"flg_cancustomise\");\n\tif(strCanCust==\"No\"){\n\t\tvar strKeyValue = app.g.sl_getprikeyvalue(sl_component1, nRow);\n\t\tapp.OpenFormForEdit(\"service_component\", strKeyValue, \"customise=1&selection=1\", true, function(){\n\t\t\treturn false;\n\t\t});\n\t}\n\t\n\tvar strKeyValue = app.g.sl_getprikeyvalue(sl_component1,  sl_component1.curSel);\n\tapp.OpenFormForEdit(\"service_component_selection\", strKeyValue, \"\", true, function(x){\n\t\tvar newKey = x.document.strSelected;\n\t\tvar pDiff = x.document.strPriceDiff;\n\t\tif(newKey==\"\")\n\t\t\treturn false;\n\t\t\t\n\t\tvar currKey = app.g.sqllist_keys(sl_component1, 0, true, \",\"); \n\t\tvar currentKeys = currKey.split(\",\");\n\t\tvar strFilter = \"\";\n\t\tfor(var i = 0; i< currentKeys.length ; i++)\n\t\t{\n\t\t\tif(currentKeys[i]==strKeyValue)\n\t\t\t{\n\t\t\t\tif(strFilter!=\"\")strFilter+=\",\";\n\t\t\t\tstrFilter+=newKey;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(strFilter!=\"\")strFilter+=\",\";\n\t\t\t\tstrFilter+=currentKeys[i];\n\t\t\t}\n\t\t}\n\t\t\/\/MessageBox(strFilter);\n\t\tif(strFilter==\"\")\n\t\t\tstrFilter = -1;\n\t\t\t\n\t\tvar strPrice = _swdoc.strCurrentPrice;\n\t\tstrPrice = parseFloat(strPrice)+parseFloat(pDiff);\n\t\t_swdoc.strCurrentPrice = strPrice;\n\t\t\t\n\t\tapp._slf(_swdoc.MF().sl_component1, \"rids=\"+strFilter);\n\t\t_swdoc.MF().sl_component1.Refresh();\n\t\treturn false;\n\t\t\n\t});\t\n}"},{"name":"sl_optional_component1_OnItemDoubleClicked","code":"sl_optional_component1_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strKeyValue = app.g.sl_getprikeyvalue(sl_optional_component1, nRow);\n\tapp.OpenFormForEdit(\"service_component\", strKeyValue, \"customise=1&selection=1\", true, function(){\n\t\treturn false;\n\t});\n\t\n}"},{"name":"fld_fk_service_service_subscribe_OnValueChanged","code":"fld_fk_service_service_subscribe_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(strValue==\"1\")\n\t{\n\t\t_swdoc.reload_services(false);\n\t}\n\telse\n\t{\n\t\t_swdoc.reload_services(true);\n\t}\n\n}"},{"name":"fld_service_subscribe_OnValueChanged","code":"fld_service_subscribe_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(strValue==\"1\")\n\t{\n\t\t_swdoc.reload_services(false);\n\t}\n\telse\n\t{\n\t\t_swdoc.reload_services(true);\n\t}\n\n}"},{"name":"fld_fk_service_OnValueChanged","code":"fld_fk_service_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.service_select(strValue);\n\n\t\/\/ -- SG, 03\/07\/2012, F0103324\n\t\/\/ Create new array to hold CI and Bespoke Terms info\n\tvar itemType = \"Service\";\n\tbespokeTermsArray = new Array();\n\tvar rec = app.g.get_record(\"config_itemi\", strValue);\n\tif(rec.recordresolvedmsg != '')\n\t{\n\t\tbespokeTermsArray[0] = new Array(2);\n\t\tbespokeTermsArray[0][0] = rec.ck_config_item;\n\t\tbespokeTermsArray[0][1] = rec.recordresolvedmsg;\n\t}\t\t\n\tapp.bespokeTermsOutput(bespokeTermsArray, 1, itemType);\n\t\/\/ -- END OF BESPOKE TERMS PROCESSING\n\t_swdoc.determine_prefered_support(strValue);\n\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\t\n\t\n}"},{"name":"tb_update_OnValueChanged","code":"tb_update_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\titsm_opencall_rfc.dow_note = strValue;\n\n}"},{"name":"lb_oc_slad_OnValueChanged","code":"lb_oc_slad_OnValueChanged(strValue)\n{\n\t_swdoc.boolServiceSLASetManually = true;\n\t_swdoc.handle_set_sladef(strValue);\n\t\n\t\/\/-- Filter Contracts for Company\n\tapp.g.filter_company_contracts(_swdoc.oCompany().pk_company_id, _swdoc.MF().lb_contract);\n\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strValue);\n\tif(slarec.Fetch())\n\t{\n\t\tvar intSLAId = app.g.get_field(slarec,\"pk_slad_id\");\n\t\tif(intSLAId!=\"\")\n\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t}\n\n}"},{"name":"lb_oc_sla_OnValueChanged","code":"lb_oc_sla_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.handle_set_priority(strValue);\n}"},{"name":"lb_oc_slad1_OnValueChanged","code":"lb_oc_slad1_OnValueChanged(strValue)\n{\n\t_swdoc.handle_set_sladef(strValue);\n\n\n}"},{"name":"lb_contract_OnValueChanged","code":"lb_contract_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.strLogAndResolveContract = strValue;\n\n\n}"},{"name":"img_customer1_OnLeftClick","code":"img_customer1_OnLeftClick()\n{\n\t\/\/-- Open Related Customer Form if customer is selected\n\tif(_swdoc.oCust().keysearch!=\"\")\n\t\tapp.OpenFormForEdit(\"tfCustomer\", _swdoc.oCust().keysearch, \"\", false, function(){\n\t\t\treturn true;\n\t\t});\n\n\n\treturn true;\n}"},{"name":"OnFieldValueChanged","code":"OnFieldValueChanged(strName, strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(strName == \"fld_del_date\")\n\t{\t\t\n\t\tif(_swdoc.MF().fld_del_date.value < app.global.GetCurrentEpocTime()){\n\t\t\tMessageBox(\"The Delivery Date that you have selected is in the past!\");\n\t\t}\n\t}\n\n}"},{"name":"pl_oc_org_OnValueChanged","code":"pl_oc_org_OnValueChanged(strValue)\n{\n\n\t_swdoc.multi_c_set_company(strValue);\n\n}"}]}}},"extendedLayout":{"appearance":{"width":"916","height":"201","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"TabRel","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f2eedd","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"5","left":"3","right":"911","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Configuration Items","properties":"56=#ffffff|58=#000000|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","activeTextColor":"#000000","inactiveTextColor":"#5f5f5f"}}},{"name":"Associated Incidents","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Associated Change Requests","properties":"56=#ffffff|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f"}}},{"name":"Associated Release","properties":"56=#ffffff|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f"}}},{"name":"Associated Service Requests","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"<< Impacted Customers","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"<< Impacted Organisations","properties":"56=#f7b683|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#f7b683"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"mbtn_cci_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"1","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|"}}},{"general":{"name":"mbtn_cci_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"2","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|"}}},{"general":{"name":"btn_search_cci1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"3","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_configitems1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration ID","width":"133","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"126","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"240","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pids=0&sf=","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_rels1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:3"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"_kv=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_rel_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"6","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Release Detail^1|"}}},{"general":{"name":"mbtn_rel_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"7","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Service Request^1|"}}},{"general":{"name":"btn_srch_rel1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"8","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_srs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:4"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"_kv=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_ke_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"10","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Service Request Detail^1|"}}},{"general":{"name":"mbtn_ke_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"11","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Request^1|"}}},{"general":{"name":"btn_srch_kes1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"12","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_incs1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:1"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"178","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_name"},"name":"Customer","width":"150","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_id"},"name":"Customer ID","width":"7","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_id"},"name":"Org ID","width":"6","image":"-1","dataColumn":"12"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_inc_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"14","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Incident Detail^1|Customer Detail^2|"}}},{"general":{"name":"mbtn_inc_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"15","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Service Request^1|"}}},{"general":{"name":"btn_search_inc1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"16","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_customerimpact","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabRel:5"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"33","left":"11","right":"904","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"161","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"keysearch"},"name":"Customer ID","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"firstname"},"name":"First  Name","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"surname"},"name":"Last Name","width":"191","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telext"},"name":"Telephone","width":"148","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"email"},"name":"Email","width":"268","image":"-1","dataColumn":"5"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"userdb","listFilter":"_kv=-1","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_orgimpact","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:6"},"appearance":{"index":"18","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"33","left":"11","right":"904","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_company_id"},"name":"Organisation ID","width":"133","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"193","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_industry_type"},"name":"Industry Category","width":"161","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_type"},"name":"Industry Sector","width":"174","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telephone"},"name":"Telephone","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"address_1"},"name":"Address 1","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"address_2"},"name":"Address 2","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"town"},"name":"Town","width":"120","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"county"},"name":"County","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"country"},"name":"Country","width":"120","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"postcode"},"name":"Postcode","width":"103","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"company","editRecordForm":"Form.TfCompany","newRecordForm":"Form.entCompany","sqlSource":"swdata","highlightStyle":"0","selectionMode":"1","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_rfcs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:2"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"120","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_name"},"name":"Customer","width":"120","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_id"},"name":"Cust_id","width":"120","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_id"},"name":"org id","width":"120","image":"-1","dataColumn":"12"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"_kv=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_rel_views2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"20","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Change Detail^1|"}}},{"general":{"name":"mbtn_rel_actions2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"21","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Service Request^1|"}}},{"general":{"name":"btn_srch_rel2","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"22","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}}]},"javascript":{"methods":{"method":[{"name":"mbtn_cci_views1_OnMenuItem","code":"mbtn_cci_views1_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_configitems1,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_configitems1,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_cci_actions1_OnMenuItem","code":"mbtn_cci_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"_kv=-1\";\n\t\tfor (var x=sl_configitems1.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tif (!sl_configitems1.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tvar value = sl_configitems1.GetItemTextRaw(x,\"pk_auto_id\");\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter += value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n       app._slf(sl_configitems1, strFilter);  \n       sl_configitems1.Refresh();\n       sl_configitems1.SetRowSelected(0);\n       return;\n\t}\n       \n}"},{"name":"btn_search_cci1_OnPressed","code":"btn_search_cci1_OnPressed()\n{\n\n   \tvar strURL = \"canreset=1&fk_company_id=\" + app.pfu(_swdoc.oCompany().pk_company_id);\n\tapp.cmdb.search_ci(true,strURL,function(sResults)\n\t{\t\n\t\tif (sResults.selectedkeys==\"\") return;\n   \n\t\t_swdoc.link_cause_cis_to_change(sResults.selectedkeys);\n\t\t\n\t\n \t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\tapp.cfg.process_call_contract_check(sResults.selectedkeys, true,_swdoc);\t\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t});\n\t\n\n}"},{"name":"sl_configitems1_OnHeaderItemClicked","code":"sl_configitems1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_configitems1.Refresh();\n}"},{"name":"sl_configitems1_OnItemSelected","code":"sl_configitems1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_configitems1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_configitems1);\t\n\tapp._een(mbtn_cci_views1, (selCount==1));\n\tapp._een(mbtn_cci_actions1, boolActive);\n\n}"},{"name":"sl_rels1_OnHeaderItemClicked","code":"sl_rels1_OnHeaderItemClicked(strOrder, nCol)\n{\n\n\tsl_rels1.Refresh();\n\n}"},{"name":"sl_rels1_OnItemSelected","code":"sl_rels1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_rels1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rels1);\t\n\tapp._een(mbtn_rel_views1, (selCount==1));\n\tapp._een(mbtn_rel_actions1,boolActive);\n\n\n}"},{"name":"mbtn_rel_views1_OnMenuItem","code":"mbtn_rel_views1_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\tsl_rels1.EditRecord(sl_rels1.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"mbtn_rel_actions1_OnMenuItem","code":"mbtn_rel_actions1_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tvar strSelectedKes = app.g.sl_getselected_valuesdel(sl_rels1,0,\",\",\"\");\n\t\t\t_swdoc.remove_service_relatedcalls(strSelectedKes, sl_rels1);\n\t\t\tbreak;\n\t}\n\n\n}"},{"name":"btn_srch_rel1_OnPressed","code":"btn_srch_rel1_OnPressed()\n{\n\tvar strURL = \"canreset=1\";  \n\tapp.itsm.search_calls(\"REL\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\t\tapp.g.sl_kv_appendfilter(sl_rels1, oResults.selectedkeys,0);\n\t\tsl_rels1.Refresh();\n\t});\n}"},{"name":"sl_kes1_OnHeaderItemClicked","code":"sl_kes1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_kes1.Refresh();\n\n\n}"},{"name":"sl_kes1_OnItemSelected","code":"sl_kes1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_kes1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_kes1\t);\t\n\tapp._een(mbtn_ke_views1 , (selCount==1));\n\tapp._een(mbtn_ke_actions1 , boolActive);\n\n\n}"},{"name":"mbtn_ke_views1_OnMenuItem","code":"mbtn_ke_views1_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\tsl_srs.EditRecord(sl_srs.curSel);\n\t\t\tbreak;\n\t}\t\n}"},{"name":"mbtn_ke_actions1_OnMenuItem","code":"mbtn_ke_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- get select incidents\n\t\t\tvar strSelectedKes = app.g.sl_getselected_valuesdel(sl_srs,0,\",\",\"\");\n\t\t\t_swdoc.remove_service_relatedcalls(strSelectedKes, _swdoc.EF().sl_srs);\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_srch_kes1_OnPressed","code":"btn_srch_kes1_OnPressed()\n{\n\tvar strURL = \"canreset=1\";\n\tapp.itsm.search_calls(\"SR\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\t\n\t\tapp.g.sl_kv_appendfilter(sl_srs, oResults.selectedkeys,0);\n\t\tsl_srs.Refresh();\n\t});\n}"},{"name":"sl_incs1_OnHeaderItemClicked","code":"sl_incs1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_incs1.Refresh();\n\n\n}"},{"name":"sl_incs1_OnItemSelected","code":"sl_incs1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_incs1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_incs1);\t\n\tapp._een(mbtn_inc_views1, (selCount==1));\n\tapp._een(mbtn_inc_actions1, boolActive);\n\n\n}"},{"name":"mbtn_inc_views1_OnMenuItem","code":"mbtn_inc_views1_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tvar iCust = 2\n\tif(nItemID == iDetails)\n\t{\n\t\tif(sl_incs1.curSel > -1)sl_incs1.EditRecord(sl_incs1.curSel);\n\t}\n\telse if (nItemID==iCust)\n\t{\n\t\tif(sl_incs1.curSel > -1)\n\t\t{\n\t\t\tvar strKeySearch = app.g.sl_getcolvalue(sl_incs1,-1,\"cust_id\");\n\t\t\tif(strKeySearch!=\"\")app.OpenFormForEdit(\"tfCustomer\", strKeySearch, \"\", true);\n\t\t}\n\t}\n}"},{"name":"mbtn_inc_actions1_OnMenuItem","code":"mbtn_inc_actions1_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\tvar iLinkCauseCI = 2;\n\tvar iLinkImpactCI = 3;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- get select incidents\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs1,\"callref\",\",\",\"\");\n\t\t\tapp.g.sl_clearselected(sl_incs1,null,0);\t\t\t\n\t\t\t_swdoc.remove_selected_incident_cis(strSelectedIncs);\n\t\t\tbreak;\n\t\tcase iLinkCauseCI:\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs1,\"callref\",\",\",\"\");\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\t\t\t_swdoc.link_cause_cis_to_change(strLinkedCIs);\t\t\n\t\t\tbreak;\n\t\tcase iLinkImpactCI:\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs1,\"callref\",\",\",\"\");\t\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\t\t\t_swdoc.link_affect_cis_to_change(strLinkedCIs);\t\t\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc1_OnPressed","code":"btn_search_inc1_OnPressed()\n{\n\tvar strURL = \"canreset=1\";  \n\tapp.itsm.search_calls(\"INC\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\t\n\t\t_swdoc.filter_inc_impact(oResults.selectedkeys);\n\t});\n}"},{"name":"TabRel_OnTabSelected","code":"TabRel_OnTabSelected(nTab)\n{\n\tif(nTab==5)\n\t{\n\t\t_swdoc.filter_impact_customers(_swdoc.EF()); \n\t}\n\telse if (nTab==6)\n\t{\n\t\t_swdoc.filter_impact_orgs(_swdoc.EF()); \n\t}\n\n\n}"},{"name":"sl_rels2_OnHeaderItemClicked","code":"sl_rels2_OnHeaderItemClicked(strOrder, nCol)\n{\n\n\tsl_rels2.Refresh();\n\n}"},{"name":"sl_rels2_OnItemSelected","code":"sl_rels2_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_rels2.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rels2);\t\n\tapp._een(mbtn_rel_views2 , (selCount==1));\n\tapp._een(mbtn_rel_actions2 , boolActive);\n\n\n}"},{"name":"mbtn_rel_views2_OnMenuItem","code":"mbtn_rel_views2_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\tsl_rfcs.EditRecord(sl_rfcs.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"mbtn_rel_actions2_OnMenuItem","code":"mbtn_rel_actions2_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tvar strSelectedKes = app.g.sl_getselected_valuesdel(sl_rfcs,0,\",\",\"\");\n\t\t\t_swdoc.remove_service_relatedcalls(strSelectedKes, sl_rfcs);\n\t\t\tbreak;\n\t}\n\n\n}"},{"name":"btn_srch_rel2_OnPressed","code":"btn_srch_rel2_OnPressed()\n{\n\tvar strURL = \"canreset=1\";  \n\tapp.itsm.search_calls(\"RFC\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\t\t\n\t\tapp.g.sl_kv_appendfilter(sl_rfcs, oResults.selectedkeys,0);\n\t\tsl_rfcs.Refresh();\n\t});\n}"},{"name":"sl_srs_OnItemSelected","code":"sl_srs_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_srs.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_srs);\t\n\tapp._een(mbtn_ke_views1, (selCount==1));\n\tapp._een(mbtn_ke_actions1,boolActive);\n\n\n}"},{"name":"sl_rfcs_OnItemSelected","code":"sl_rfcs_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tvar boolActive = (sl_rfcs.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rfcs);\t\n\tapp._een(mbtn_rel_views2, (selCount==1));\n\tapp._een(mbtn_rel_actions2,boolActive);\n\n\n}"}]}}}}}