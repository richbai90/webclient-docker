{"espForm":{"configuration":{"settings":{"name":"cmdb_ctrl_fields","title":"Managed Field Attribute","description":"Form used to managed a planned activity","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"ct_ctrl_fields","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"function oAtt()\n{\n\treturn _swdoc.ct_ctrl_fields;\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"430","height":"224","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Field1","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"84","right":"417","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.databinding"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field2","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"131","left":"84","right":"399","bottom":"149"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.regexcheck"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field3","type":"Field"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"153","left":"84","right":"417","bottom":"189"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.regexerrormsg"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"The format of the entered value is incorrect. Please try again.","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_testvalue","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"194","left":"84","right":"363","bottom":"212"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Data Binding","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"36","left":"14","right":"82","bottom":"54"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.databinding"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"5","caption":"Expression","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"131","left":"14","right":"82","bottom":"149"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.regexcheck"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field4","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"59","left":"78","right":"427","bottom":"77"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.flg_ctrl_flag"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","flagItems":"Form field can only be set by specialist^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field5","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"78","left":"78","right":"427","bottom":"96"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.flg_autodiary"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","flagItems":"Open the diary entry form if this field is updated^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Test Value","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"194","left":"14","right":"82","bottom":"212"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_test","type":"EventButton"},"appearance":{"index":"9","caption":"Test","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"192","left":"371","right":"416","bottom":"214"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"txt_ex","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"10","caption":"label set in form onloaded","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"420","left":"60","right":"464","bottom":"559"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"11","caption":"Error Message","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"153","left":"9","right":"82","bottom":"171"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.regexerrormsg"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_labels","type":"Field"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"14","left":"84","right":"417","bottom":"32"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Select data binding by column label","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"13","caption":"Table Column","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"14","left":"14","right":"82","bottom":"32"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Rect1","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#b2b2b2","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"123","left":"9","right":"425","bottom":"221"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text3","type":"Text"},"appearance":{"index":"15","caption":"Advanced Format Checking","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"115","left":"27","right":"168","bottom":"130"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Button1","type":"EventButton"},"appearance":{"index":"16","caption":"?","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"129","left":"398","right":"416","bottom":"150"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"Field6","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"96","left":"78","right":"427","bottom":"114"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ct_ctrl_fields.flg_silent_diary"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","flagItems":"Create an automated diary entry if this field is updated^1|","disabledBackgroundColor":"#eeeeee"}}}]},"javascript":{"methods":{"method":[{"name":"btn_test_OnPressed","code":"btn_test_OnPressed()\n{\n\t\/\/-- evaluate the test value against the regex\n\tvar testString = new String(tb_testvalue.text);\n\tvar re = new RegExp(ct_ctrl_fields.regexcheck);\n  \tif (testString.match(re)) \n  \t{\n    \tMessageBox(\"Successful match\");\n  \t}\n  \telse \n  \t{\n  \t\tif (ct_ctrl_fields.regexerrormsg!=\"\")\n  \t\t{\n  \t\t\tMessageBox(ct_ctrl_fields.regexerrormsg)\n  \t\t}\n  \t\telse\n  \t\t{\n    \t\tMessageBox(\"No match\");\n    \t}\n  \t}\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/txt_ex.text = '.at matches any three-character string ending with \"at\", including \"hat\", \"cat\", and \"bat\".\\n'\n\t\/\/txt_ex.text +='[hc]at matches \"hat\" and \"cat\".\\n'\n\t\/\/txt_ex.text +='[^b]at matches all strings matched by .at except \"bat\".\\n'\n\t\/\/txt_ex.text +='^[hc]at matches \"hat\" and \"cat\", but only at the beginning of the string or line.\\n'\n\t\/\/txt_ex.text +='[hc]at$ matches \"hat\" and \"cat\", but only at the end of the string or line.\\n'\n\t\/\/txt_ex.text +='[hc]+at matches \"hat\", \"cat\", \"hhat\", \"chat\", \"hcat\", \"ccchat\", and so on, but not \"at\".\\n';\n\t\/\/txt_ex.text +='[hc]?at matches \"hat\", \"cat\", and \"at\".\\n';\n\t\/\/txt_ex.text +='cat|dog matches \"cat\" or \"dog\".\\n';\n\n\t\n\t\/\/-- load lables listbox for config_itemi and the extended table for this ci type if it has one.\n\t\/\/-- we can then use the label listbox to select a field and then auto set the databinding.\n\tvar strLbData = app.g.dd_getcolumnlist(\"config_itemi\", true,undefined,undefined,true);\n\tvar strExtTable = _swdoc.GetArg(\"extended_table\");\n\tif(strExtTable!=\"\")\n\t{\n\t\t strLbData += \"|\" + app.g.dd_getcolumnlist(strExtTable, true, undefined,undefined,true);\n\t}\n\tlb_labels.pickList = strLbData;\n\tif(_swdoc.oAtt().fk_config_type==\"\")\n\t{\n\t\t\n\t\t_swdoc.oAtt().fk_config_type = unescape(_swdoc.GetArg(\"fk_config_type\")); \/\/F0108069\n\t\t_swdoc.oAtt().flg_sc = _swdoc.GetArg(\"flg_sc\");\n\t}\n\t\t\n\tif(_swdoc.oAtt().databinding!=\"\")\n\t{\n\t\tvar arrBindingInfo = _swdoc.oAtt().databinding.split(\".\");\n\t\tvar strCol = dd.tables[app.LC(arrBindingInfo[0])].columns[arrBindingInfo[1]].DisplayName\t\t\n\t\tapp._eva(lb_labels, strCol+\" (\"+_swdoc.oAtt().databinding+\")\");\n\t}\n\n}"},{"name":"lb_labels_OnValueChanged","code":"lb_labels_OnValueChanged(strValue)\n{\n\t\/\/-- get value - which is number.\n\t\/\/-- we can then make array of table bindings and match up\n\tif (strValue == \"\") \/\/ prevents a JS error when no option was selected from the list\n\t{\n    \tct_ctrl_fields.databinding = \"\"; \/\/ blank the contents of the form\n\t}\n\telse\n\t{\n    \tvar arrBindingInfo = strValue.split(\" (\");\n    \tvar arrBindingInfo = arrBindingInfo[1].split(\")\");\n    \tif(app.cmdb.form_field_exists(arrBindingInfo[0],ct_ctrl_fields.fk_config_type))\n    \t{\n        \tMessageBox(\"There is already a form field management record setup for \"+arrBindingInfo[0]);\n        \tct_ctrl_fields.databinding = \"\";\n        \tapp._eva(lb_labels,\"\");\n    \t}\n    \telse\n    \t{\n        \tct_ctrl_fields.databinding = arrBindingInfo[0];\n    \t}\n\t}\n\t_swdoc.UpdateFormFromData(); \n}"},{"name":"Button1_OnPressed","code":"Button1_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.OpenFormForEdit(\"regex_example\", \"\", \"\", true, function(){});\n\n}"},{"name":"Field1_OnValueChanged","code":"Field1_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tif(app.cmdb.form_field_exists(strValue,ct_ctrl_fields.fk_config_type))\n\t{\n\t\tMessageBox(\"There is already a form field management record setup for \"+strValue);\n\t\tct_ctrl_fields.databinding = \"\";\n\t}else\n\t{\n\t\tct_ctrl_fields.databinding = strValue;\n\t}\n\t_swdoc.UpdateFormFromData(); \n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}