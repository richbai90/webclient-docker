{"espForm":{"configuration":{"settings":{"name":"itsmEfQLogResCloseData","title":"Quick Log Resolution \/ Closure Details","description":"Quick Log Resolution \/ Closure Details","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"qlog_resclose_details","type":"Main Details Table","mainDetailsColumn":"udcode","flags":"0"}},"javascript":{"methods":{"method":[{"name":"OnDataSaved","code":"OnDataSaved()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\n\t_swdoc.record_id = _swdoc.qlog_resclose_details.pk_auto_id;\n\n\tvar contract_id = mainform.lb_supp_contract1.value;\n\t\/\/var units_contract = mainform.tb_units_assigned1.value;\n\tvar command_sql = \"\";\n\tvar xmlmc = new XmlMethodCall();\n\t\n\t\/\/Before saving the files we are going to delete all the attachments associate to this call\n\t\/\/so in that case we don't have duplicate files\n\tif (_swdoc.record_id){\n\t\n\t\tif (contract_id){\n\t\t\tcommand_sql = \"update qlog_resclose_files set fk_contract_id=\"+contract_id ;\/\/+ \" and support_units_avail=\"+units_contract;\n\t\t\t\/*xmlmc.SetValue(\"database\", \"swdata\");\t\t\n\t\t\txmlmc.SetValue(\"query\",command_sql);\n\t\t\t\n\t\t\tif (!xmlmc.Invoke(\"data\", \"sqlQuery\"))\n\t\t\t\tMessageBox(\"Failed to process record addition for Quick Log Detail Files (\" + xmlmc.GetLastError() + \"). Please contact your Supportworks Supervisor.\");*\/\n\t\t}\n\t\t\n\t\n\t\n\t\tcommand_sql = \"delete from qlog_resclose_files where fk_qlog_resclose_details=\"+_swdoc.record_id;\n\t\n\t\txmlmc.SetValue(\"database\", \"swdata\");\t\t\n\t\txmlmc.SetValue(\"query\",command_sql);\n\t\t\n\t\tif (!xmlmc.Invoke(\"data\", \"sqlQuery\"))\n\t\t\tMessageBox(\"Failed to process record addition for Quick Log Detail Files (\" + xmlmc.GetLastError() + \"). Please contact your Supportworks Supervisor.\");\n\t}\t\n\t\n\t\n\tfor(i=0; i<mainform.fl_attachments.rowCount();i++){\n \t\t\t\/\/ -- Check for Server file (These need to use serverFileAttachment)\n\t\t\tvar pathFile = mainform.fl_attachments.GetItemText(i,3);\n\t\t\tvar size = mainform.fl_attachments.GetItemText(i,1);\n\t\t\tvar last_modified = mainform.fl_attachments.GetItemText(i,2);\n\t\t\tvar strFileName = mainform.fl_attachments.GetItemText(i,0);\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\/\/Converting the date to epoch value\n\t\t\tnew_date = last_modified.split('-').join(',');\n\t\t\tvar epoch = new Date(new_date).getTime()\/1000;\n\n\t\t\t\n\t\t\tvar xmlmc = new XmlMethodCall();\n\t\t\txmlmc.SetValue(\"table\", \"qlog_resclose_files\");\t\t\n\t\t\txmlmc.SetData(\"filepath\",pathFile);\n\t\t\txmlmc.SetData(\"fk_qlog_resclose_details\",_swdoc.record_id);\n\t\t\txmlmc.SetData(\"filename\",strFileName);\n\t\t\txmlmc.SetData(\"filesize\",size);\n\t\t\txmlmc.SetData(\"last_modified\",epoch);\n\t\t\t\n\t\t\t\t\n\t\t\tif (xmlmc.Invoke(\"data\", \"addRecord\")){\n\t\t\t   var strXML = (app.bWebClient)? xmlmc._lastresult:xmlmc.GetReturnXml();\n\t\t\t   var objRes = app.XMCResult(strXML);\n\t\t\t   if (!objRes.success)\n\t\t\t \t  MessageBox(\"Failed to process record creation for Quick Log Details (\" + objRes.message + \"). Please contact your Supportworks Supervisor.\");\n\t\t\t}\t\n\t\t\t\n\t\t\telse\n\t\t\t\tMessageBox(\"Failed to process record creation. \" + xmlmc.GetLastError() + \". Please contact your Supportworks Supervisor.\");\n\t}\t\t\n\t\n\t\n}"},{"name":"(Globals)","code":"\/*function oForm()\n{\n\toForm = mainform\n}\n*\/\n\nvar record_id = \"\"; \/\/ The  auto id of the created record - populated after the record is saved (_swdoc.OnDataSaved)"},{"name":"(User Defined Functions)","code":"var arrCallrefs = new Array(); \/\/-- array - holds the callrefs we want to close or resolve\nvar CallrefsCommaString = \"\";  \/\/-- string - comma delimted callrefs\nvar strIssueref = \"\";\t\t   \/\/-- string - has issue refs in it if we are closing an issue\n\t\nvar arrSurveyNameSurvIDs = new Array(); \/\/-- array - holds list of survey ids \nvar arrContractNameIDs\t = new Array(); \/\/-- array - holds contract ids\nvar arrContractCMDBIDs\t = new Array(); \/\/-- array - holds contract ids\nvar arrCallStatuss \t\t = new Array(); \/\/-- array - holds list of the all the calls status\nvar arrCallOpenTasks \t = new Array(); \/\/-- araray - holds list of all the calls tasks\nvar boolMultipleCalls = false; \/\/-- we are working with multiple calls\n\nfunction get_support_unit_decrement(strContractID, oEle, strContractTxtID)\n{\n\tif((typeof strContractID !== \"undefined\")&&(strContractID!=\"\"))\n\t{\n\t\tvar recContract = new SqlRecord;\n\t\tif(recContract.GetRecord(\"contract\", strContractTxtID))\n\t\t{\n\t\t\tif(recContract.flg_support_unlimited==1)\n\t\t\t{\n\t\t\t\tapp._eva(oEle, \"0\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/ --- Get value for units to decrement by, by using Support Unit Decrement Method field set on\n\t\t\t\t\/\/ --- contract form\n\t\t\t\tvar dec_method = recContract.support_unit_dec_method;\n\t\t\t\t\/\/Nothing Selected\n\t\t\t\tif (dec_method == \"0\")\n\t\t\t\t{\t\t\t\t\n\t\t\t\t\t\/\/Do nothing, units should default to 0 and not mandatory!\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t\/\/Use Default Support Unit Decrement Value selected\n\t\t\t\telse if (dec_method == \"1\")\n\t\t\t\t{\n\t\t\t\t\t\/\/opencall.support_unit_cost = Math.round(recContract.support_unit_dec_amount);\n\t\t\t\t\t_swdoc.qlog_resclose_details.units_spend_call=recContract.support_unit_dec_amount;\n\t\t\t\t\tapp._eva(oEle, recContract.support_unit_dec_amount);\n\t\t\t\t}\t\t\t\t\n\t\t\t\t\/\/Prompt Analyst on Ticket Resolution\/Closure selected\n\t\t\t\telse if (dec_method == \"2\")\n\t\t\t\t{\n\t\t\t\t\tapp._eva(oEle, \"\");\n\t\t\t\t}\t\t\t\n\t\t\t\t\/\/Take from Contract\/Service Association selected\n\t\t\t\telse if (dec_method == \"3\")\n\t\t\t\t{\n\t\t\t\t\t\/\/ only dealing with the one contract and no services when storing a quick log definition\n\t\t\t\t\t_swdoc.qlog_resclose_details.units_spend_call=recContract.support_unit_dec_amount;\n\t\t\t\t\tapp._eva(oEle, recContract.support_unit_dec_amount);\n\t\t\t\n\t\t\t\t}\n\t\t\t\t\/\/Something else. Should never get here...\n\t\t\t\telse{\n\t\t\t\t\tMessageBox(\"Defaulted! \" + recContract.support_unit_dec_method);\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"610","height":"496","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Time Spent","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"14","left":"10","right":"120","bottom":"30"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"qlog_resclose_details.timespent"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"14","left":"130","right":"380","bottom":"30"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.timespent"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Minute Time Period","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","defaultValue":"5","borderColor":"#c0c0c0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"Action Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"34","left":"10","right":"120","bottom":"50"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"qlog_resclose_details.udcode"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"34","left":"130","right":"380","bottom":"50"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.udcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"General Update","properties":{"disabledBackgroundColor":"#eeeeee","defaultValue":"General Update","borderColor":"#c0c0c0","sqlSource":"swdata","storedQuery":"common.getSwLists","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ACTION-TYPE,CALL-ACTION-TYPE-RESOLVE','CALL-ACTION-TYPE-CLOSE"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Action Source","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"54","left":"10","right":"120","bottom":"70"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"qlog_resclose_details.udsource"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"54","left":"130","right":"380","bottom":"70"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.udsource"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"Telephone","properties":{"disabledBackgroundColor":"#eeeeee","defaultValue":"Telephone","sqlSource":"swdata","storedQuery":"common.getSwLists","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ACTION-SOURCE,CALL-ACTION-SOURCE-RESOLVE','CALL-ACTION-SOURCE-CLOSE","borderColor":"#c0c0c0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","caption":"Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"76","left":"10","right":"120","bottom":"92"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"qlog_resclose_details.updatetxt"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"76","left":"130","right":"380","bottom":"234"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.updatetxt"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"flg_ftf","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"100","left":"410","right":"552","bottom":"119"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.flg_first_time_fix"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"First time fix achieved^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_addKBase","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"80","left":"410","right":"552","bottom":"99"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.flg_add_to_kb"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"Add to KnowledgeBase^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_chargeable","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"60","left":"410","right":"551","bottom":"78"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.flg_chargeable"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"Call to be chargeable^1|","disabledBackgroundColor":"#eeeeee","defaultValue":"0"}}},{"general":{"name":"flg_emailcustomer","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"40","left":"410","right":"526","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.flg_email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"E-mail customer^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_updatepublic","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"20","left":"410","right":"539","bottom":"38"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.flg_public"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"Update to be public^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"13","caption":"Resolution Code","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"240","left":"4","right":"120","bottom":"256"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"qlog_resclose_details.fixcode"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_fixcodedescription","type":"Field"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"240","left":"130","right":"357","bottom":"256"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"qlog_resclose_details.fixcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#ffffff"}}},{"general":{"name":"btnBrowseProfile","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"15","caption":"...","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"238","left":"359","right":"385","bottom":"259"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"-1"}}},{"general":{"name":"btnGetProfileText","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"16","caption":"Add Profile Text","backgroundColor":"#ffffff","foregroundColor":"#0000ff","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"238","left":"390","right":"482","bottom":"259"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"fl_attachments","type":"FileListTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"true"},"group":"Tab1:0"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"340","left":"40","right":"511","bottom":"457"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"File Name","width":"160","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Size","width":"80","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Last Modified","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Full Local Path","width":"124","image":"-1","dataColumn":"3"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"content":"NAME=css-bug-raising.gif;PATH=C:\\Documents and Settings\\NeilWJ\\My Documents\\css\\css-bug-raising.gif;SIZE=18746;LASTMODIFIED=1091525370","borderColor":"#c0c0c0"}}},{"general":{"name":"btnAddFile","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"18","caption":"Add","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"346","left":"521","right":"585","bottom":"370"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"74","eventButtonIcon":"74"}}},{"general":{"name":"btnRemove","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"19","caption":"Remove","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"378","left":"521","right":"585","bottom":"402"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"cp_summary1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"20","caption":"Other Information","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"280","left":"20","right":"602","bottom":"474"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"name":"Tab1","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"21","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"311","left":"30","right":"594","bottom":"463"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"File Attachment","properties":"56=#ffcc66|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffcc66"}}},{"name":"Support Units","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"tabStyle":"0"}}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:1"},"appearance":{"index":"22","caption":"Associated Support Contract","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"350","left":"60","right":"211","bottom":"366"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_supp_contract1","type":"Field","group":"Tab1:1"},"appearance":{"index":"23","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"350","left":"218","right":"468","bottom":"366"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"qlog_resclose_details.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#c0c0c0","image":"#eeeeee","sqlSource":"swdata","distinctTable":"contract","distinctColumn":"pk_contract_id","displayColumn":"title","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:1"},"appearance":{"index":"24","caption":"Units To Spend On Call","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"373","left":"70","right":"209","bottom":"389"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_units_assigned1","type":"Field","group":"Tab1:1"},"appearance":{"index":"25","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"373","left":"218","right":"468","bottom":"389"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"qlog_resclose_details.units_spend_call"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Numeric","properties":{"borderColor":"#c0c0c0","image":"#eeeeee","disabledBackgroundColor":"#eeeeee","precision":"15","scale":"10","inputMask":"#########"}}}]},"javascript":{"methods":{"method":[{"name":"btnBrowseProfile_OnPressed","code":"btnBrowseProfile_OnPressed()\n{\n\t\/\/-- get resolution profile filter\n\t\n\t\/\/-- NWJ - 29.06.2006 - get close filter or resolve filter depending on call closure option (requested by Dan 47766)\n\/*\tif (cb_callaction.text == \"Resolve Call\")\n\t{\n\t\tvar Filter = dd.GetGlobalParamAsString(\"Close Call Form\/ResolveProfileFilter\");\n\t}\n\telse if (cb_callaction.text == \"Close Call\")\n\t{\n\t\tvar Filter = dd.GetGlobalParamAsString(\"Close Call Form\/CloseProfileFilter\");\n\t}\n\telse\n\t{*\/\n\t\tvar Filter = dd.GetGlobalParamAsString(\"Close Call Form\/ProfileCodeFilter\");\n\t\/\/}\n\t\n\tvar pc = new ChooseProfileCodeDialog;\n\t\/\/-- default analyst permission to auto fill the resolution text on resolve\/close call is set\n\n    pc.useDescriptionText =  app.session.IsDefaultOption(ANALYST_DEFAULT_AUTOFILLRESOLUTIONTEXT); \n    \n    pc.Open(true, true, _swdoc.qlog_resclose_details.fixcode, Filter, function(pc)\n    {\n    \t\/\/-- Get the fix code and split it into an array\n        var strCodeDesc = pc.codeDescription;\n        var strCode = pc.code;\n        \t\n       \t\/\/-- If no codes are found then stop or same as current code\n        if(strCode==_swdoc.qlog_resclose_details.fixcode) return;\n        \n        \/\/-- F0092364\n        if(strCode==\"\")\n        {\n \t\t\t_swdoc.qlog_resclose_details.fixcode = \"\";       \n        \tapp._ete(tb_fixcodedescription,\"\");\n        \t_swdoc.bUserSelectedFixCode = true;\n        \tapp._een(btnGetProfileText,false);\n        \treturn;\n        }\n                \n        \n        \/\/-- required for modeless message box\n        var funcUpdate = function()\n        {\n        \t\/\/-- add back to update record\n        \t_swdoc.qlog_resclose_details.updatetxt = strCurrentUpdateText;\n        \t_swdoc.UpdateFormFromData();\n        }\n        \n        \/\/-- required for modeless message box\n        var funcFinalProcessing = function()\n\t\t{\n\t\t\t\/\/-- if we are working with webclient\n\t\t\tif(app.bWebClient)\n\t\t\t{\n\t\t\t\tapp._een(btnGetProfileText,false);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t    \t\t\/\/-- enable \/ disable button if it has text\n\t    \t\tapp._een(btnGetProfileText,(pc.description!=\"\"));\n\t\t\t}\n\t\t}\n        \n        \n        \/\/-- Set the text in the resolution profile text box\n        \/\/-- 08.02.2007 - NWJ - set the opencall record value instead of the element name \n\t\t_swdoc.qlog_resclose_details.fixcode = strCode;  \n\t\/\/\tMessageBox(\"document.opencall.fixcode = \" + _swdoc.qlog_resclose_details.fixcode);    \n\t\tapp._ete(tb_fixcodedescription,strCodeDesc); \n                \n        \/\/-- Attempt to add the resolution profile description to the Action Description box if the\n        \/\/-- default analyst permission to auto fill the resolution text on resolve\/close call is set\n        if(pc.useDescriptionText)\n        {\n        \t\/\/-- 08.02.2007 - NWJ - set the opencall record value instead of the element name \n        \tvar strCurrentUpdateText = _swdoc.qlog_resclose_details.updatetxt;\n           \t\n        \tif(pc.description.length)\n        \t{\n        \t\t\/\/if(tb_updatetext.text.length)\n        \t\tif(strCurrentUpdateText.length)\n\t\t\t\t{\n\t\t\t\t\tvar Message = \"You have chosen to transfer the default profile text into the description field of the close call form. However, you have already entered some text into this field. Do you want to append the text you have typed?\\n\\nTo append the default text to the text you have already typed, click Yes\\nTo transfer the default text and overwrite what you have already typed, click No\\nTo ignore the default text and leave the text you have typed alone, click Cancel\";\n\t\t\t\t\t\n\t\t\t\t\tMessageBox(Message, MB_ICONQUESTION | MB_YESNOCANCEL, function(intDecision)\n\t\t\t\t\t{\n\t\t\t\t\t\tswitch(intDecision)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tcase IDYES:\n\t\t\t\t\t\t\t\tif(_swdoc.qlog_resclose_details.updatetxt.length)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\/\/-- add a line feed\n\t\t\t\t\t\t\t\t\tstrCurrentUpdateText += \"\\r\\n\";\n\t\t\t\t\t\t\t\t\t\/\/tempText = _swdoc.updatedb.updatetxt + \"\\r\\n\"; \n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tstrCurrentUpdateText += pc.description;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase IDNO:\n\t\t\t\t\t\t\t\tstrCurrentUpdateText = pc.description;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase IDCANCEL:\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfuncUpdate();\n\t\t\t\t\t\tfuncFinalProcessing();\n\t\t\t\t\t});\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstrCurrentUpdateText = pc.description;\n\t\t\t\t\tfuncUpdate();\n\t\t\t\t\tfuncFinalProcessing();\n\t\t\t\t}\n        \t}\n        \telse\n        \t{\n        \t\tfuncUpdate();\n        \t\tfuncFinalProcessing();\n        \t}\n        }\n        else\n        {\n        \tfuncFinalProcessing();\n        }\n    });\n}"},{"name":"btnGetProfileText_OnPressed","code":"btnGetProfileText_OnPressed()\n{\n\tvar funcUpdateResText = function()\n\t{\n\t\t\/\/-- get resolution profile description\t\n\t\tvar currentResProfileDesc = app.global.GetResolutionProfileDescription(_swdoc.qlog_resclose_details.fixcode);\n\t\t_swdoc.qlog_resclose_details.updatetxt = currentResProfileDesc.strDescription;\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\t\n\tif(_swdoc.qlog_resclose_details.updatetxt.length)\n\t{\n\t\tMessageBox(\"If you retrieve the default text description from the profile database you will overwrite the current Action Description text.\\n\\nDo you wish to continue?\", MB_ICONQUESTION | MB_YESNO, function(intDecision)\n\t\t{\n\t\t\tif (intDecision != IDYES)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tfuncUpdateResText();\n\t\t\t}\n\t\t});\n\t}\n\telse\n\t{\n\t\tfuncUpdateResText();\n\t}\n\t\n}"},{"name":"btnAddFile_OnPressed","code":"btnAddFile_OnPressed()\n{\n\t\/\/-- add files\n\t\/\/fl_attachments1.newFile = InvokeCallAttachmentFileDialog();\n\tfl_attachments.AddFiles();\n\n}"},{"name":"btnRemove_OnPressed","code":"btnRemove_OnPressed()\n{\n\t\/\/ -- remove selected files\n\tfor(i=fl_attachments.rowCount()-1; i>=0;i--)\n    {\n    \tif(fl_attachments.IsRowSelected(i))\n    \t{\n    \t\t\/\/-- remove\n    \t\tfl_attachments.RemoveRow(i);\n    \t}\n    }\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\");\n\tvar strCompanyCode = _swdoc.GetArg(\"company_code\");\n\tif (strCompanyCode != \"\")\n\t{\n\t\tvar strFilter = \"fk_company_id='\" + encodeURIComponent(strCompanyCode)+\"' and type = 'organisation'\";\n\t\t\/\/ The received arg may contain HTML characters which need to be reverted to their equivalent ASCII text\n\t\tstrFilter = app.g.string_replace(strFilter,\"%20\",\" \",true); \/\/ replace all occurrances of %20 with space - caters for Org IDs with spaces\n\t}\n\telse\n\t{\n\t\tstrFilter = \"type = 'organisation'\";\n\t}\n\tapp._slf(mainform.lb_supp_contract1,strFilter);\n\t\n\t\/\/We are going to load the information in case we got a number passed to this form\n\tif (_swdoc.qlog_resclose_details.pk_auto_id){\n\t\tvar objFilesAssociate = app.g.get_qlog_resclose_files(_swdoc.qlog_resclose_details.pk_auto_id);\n\n    \tfor (i=0 ; i<objFilesAssociate.length;i++){\n            \t\n            \tvar objectStep = objFilesAssociate[i];\n            \tvar url = \"attach;\"+\"displayname=\"+objectStep.filename +\"; path=\"+objectStep.filepath+\"; size=\"+objectStep.filesize+\"; lastmodified=\"+objectStep.last_modified;\n            \t\n            \tmainform.fl_attachments.AddAttachment(url);\n            \tmainform.fl_attachments.Refresh();\n    \t}\n    \t\n    \tapp._een(mainform.tb_units_assigned1,true); \/\/ allow entry of support decrement units\n\t}\n}"},{"name":"lb_supp_contract1_OnValueChanged","code":"lb_supp_contract1_OnValueChanged(strValue)\n{\n\t\/\/qlog_resclose_details.updatetxt += \"\";\n\t\/\/ TODO: Add your event handler code here\n\t\/\/-- Lookup units available for selected contract\n\tif(strValue!=\"\")\n\t{\n\t\t\/*var recContract = new SqlRecord;\n\t\tif(recContract.GetRecord(\"contract\", strValue)\n\t\t{\n\t\t\tvar contNumID = _swdoc.arrContractCMDBIDs[strValue];\n\t\t}*\/\t\n\t\t\n\t\t\/\/_swdoc.get_support_units_available(strValue, mainform.tb_avail_units1);\n\t\t_swdoc.get_support_unit_decrement(strValue, mainform.tb_units_assigned1, strValue);\n\t\t\n\t\t\n\t\t\/\/###20120731 app._ero(mainform.tb_units_assigned1,false);\n\t\tapp._een(mainform.tb_units_assigned1, true);\n\t}\n\telse\n\t{\n\t\t\/\/_eva(mainform.tb_avail_units1,0);\n\t\tapp._eva(mainform.tb_units_assigned1,0);\n\t\tapp._een(mainform.tb_units_assigned1,false);\n\t\t\/\/_evi(mainform.lbl_con_ser_assoc, false);\n\t\t\/\/_evi(mainform.lbl_no_con_ser_assoc, false);\n\t\t\/\/_evi(mainform.lbl_multi_services, false);\n\n\t\/*###\t\tapp._eva(mainform.tb_avail_units,0);\n\t\tapp._eva(mainform.tb_units_assigned,0);\n\t\tapp._ero(mainform.tb_units_assigned,true);\n\t\tmainform.elements['lbl_con_ser_assoc'].visible = false;\n\t\tmainform.elements['lbl_no_con_ser_assoc'].visible = false;\n*\/\n\t}\n\t\/\/qlog_resclose_details.fk_contract_id = strValue;\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}