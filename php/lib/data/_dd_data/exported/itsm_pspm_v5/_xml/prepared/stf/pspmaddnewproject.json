{"espForm":{"configuration":{"settings":{"name":"PSPMAddNewProject","title":"Add New Project","description":"New project detasils","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":[{"name":"opencall","type":"Related Table","mainDetailsColumn":"opencall","flags":"6"},{"name":"extoc_addnewproject","type":"Main Details Table","mainDetailsColumn":"opencall","flags":"4"}]},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"\/\/ will hold auth decision true, false, or null in the case of Accept, Reject, or Not Set\nvar authDecision = null;\n\n\/\/ flag to know whether or not to close the form after auth decision\nvar savedSuccessful = false;\n\nvar goToStatus = null;\n\n\/\/ populated in mainform.onFormLoaded()\n_swdoc.validatedElems = [];\nvar validatedElems = _swdoc.validatedElems;"},{"name":"OnPreValidate","code":"OnPreValidate()\n{\n\t\/\/ TODO: Add your event handler code here\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"(User Defined Functions)","code":"function addAuthUpdate () {\n    var updateMessage;\n\tif(_swdoc.authDecision === false) {\n\t\tupdateMessage = _swdoc.createRejectUpdate();\n\t} else if(_swdoc.authDecision === true) {\n\t\tupdateMessage = _swdoc.createAcceptUpdate();\n\t} else {\n\t\tMessageBox(\"Unknow decision selected \" + _swdoc.authDecision);\n\t\treturn;\n\t}\n\t\n\tvar xmlmc = new XmlMethodCall();\n\t\n\txmlmc.SetParam(\"callref\", _swdoc.opencall.callref.toString());\n\/\/\txmlmc.SetParam(\"callref\", _swdoc.extoc_addnewproject.opencall.toString());\n\txmlmc.SetParam(\"timeSpent\", \"1\");\n\txmlmc.SetParam(\"description\", updateMessage);\n\txmlmc.SetParam(\"publicUpdate\", \"true\");\n\txmlmc.SetParam(\"updateSource\", \"Auth Decision\");\n\tvar success = xmlmc.Invoke(\"helpdesk\", \"updateCalls\");\n\t\n\tif(!success) {\n\t\tMessageBox(xmlmc.GetLastError());\n\t}\n}\n\nfunction createAcceptUpdate() {\n\tvar updateMessage = \"\";\n\tfor(i = 0; i < _swdoc.validatedElems.length; i++ ) {\n\t\t\tif(_swdoc.updated(_swdoc.validatedElems[i])) {\n\t\t\t    updateMessage += _swdoc.validatedElems[i].name + \n\t\t\t    \" changed from \\\"\" + \n\t\t\t    _swdoc.validatedElems[i].originalVal + \n\t\t\t    \"\\\" to \\\"\" +\n\t\t\t    _swdoc.validatedElems[i].ele.value +\n\t\t\t    \"\\\"\\n\"\n\t\t    }\n\t\t}\n\tif (updateMessage.length>1)\n\t\tupdateMessage = app.session.analystId + \" approved this request with the following change(s):\\n\" + updateMessage + \"Comments: \" + mainform.comments.value;\n\telse\n\t\tupdateMessage = app.session.analystId + \" approved this request with no changes.\\nComments: \" + mainform.comments.value;\n\treturn updateMessage;\t\n}\n\nfunction createRejectUpdate() {\n\treturn app.session.analystId + \" rejected this request with the following comments: \" + mainform.comments.value;\n}\n\n\nfunction updated(validatedField) {\n\tvar elem = validatedField.ele;\n\tvar keyParts = elem.dataRef.split('.');\n\tvar keyTable = keyParts[0];\n\tvar keyColumn = keyParts[1];\n\tif(_swdoc[keyTable] && _swdoc[keyTable][keyColumn]) {\n\t\treturn validatedField.originalVal != _swdoc[keyTable][keyColumn]\n\t}\n\t\n\treturn false;\n} \n\n\nfunction getOriginalValue(elem) {\n\tvar keyParts = elem.dataRef.split('.');\n\tvar keyTable = keyParts[0];\n\tvar keyColumn = keyParts[1];\n\tvar clone = {};\n\tif(_swdoc[keyTable] && _swdoc[keyTable][keyColumn]) {\n\t\tclone.val = _swdoc[keyTable][keyColumn] || \"\";\n\t\treturn clone.val;\n\t}\n\t\n\treturn \"\";\n}\n\nfunction updateBpmAuth() {\n\tvar params = \"callref=\" + _swdoc.opencall.callref + \"&status=\" + (_swdoc.authDecision ? 'Authorised' : 'Rejected') + \"&flg_status=\" +  (_swdoc.authDecision ? 1 : 2) + \"&comments=\" + mainform.comments.value + \"&fk_stage_id=\" + _swdoc.opencall.bpm_stage_id;\n\t\/\/ var query = \"UPDATE bpm_oc_auth SET status ='\" + (_swdoc.authDecision ? 'Authorised' : 'Rejected') + \"', flg_status = \" + (_swdoc.authDecision ? 1 : 2) + \", comments = '\" + mainform.comments.value + \"' WHERE flg_status = 0 AND fk_auth_id = '\" + app.session.analystId + \"' AND fk_callref = \" + _swdoc.opencall.callref + \" and fk_stage_id = \" + _swdoc.opencall.bpm_stage_id;\n\t\/\/return app.global.SqlExecute(\"swdata\", query);\n\treturn app.global.StoredQueryExecute(\"form\/bpm_workflow\/update_auth_decision\", params);\n}\n\nfunction resetForm() {\n\tmainform.ResetFieldValues();\n\tmainform.UpdateFormFromData();\n\t_swdoc.UpdateFormFromData();\n}"},{"name":"OnSaveData","code":"OnSaveData()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\n\tif(_swdoc.authDecision === null) {\n\t\tMessageBox(\"Please Accept or Reject the request\");\n\t\treturn false;\n\t}\n\t\n\tif(_swdoc.authDecision === false) {\n\t    \/\/ if reject require comments\n\t\tif(!mainform.comments.value || mainform.comments.value === \"\") {\n\t\t\tMessageBox(\"Comments are required when rejecting the authorization\");\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t\/\/ reset the form so that no data is saved when rejecting, but preserve the comments\n\t\tvar comments = mainform.comments.value.split(\"\").join(\"\");\n\t\t_swdoc.resetForm();\n\t\t_eva(mainform.comments , comments);\n\t}\n\t\n\ttry {\n\t\t_swdoc.addAuthUpdate();\n\t\tvar updateStatus = _swdoc.updateBpmAuth();\n\t\tif(updateStatus === 0) {\n\t\t\tMessageBox(\"Your approval is not required at this time.\");\n\t\t\treturn false;\n\t\t} else if(updateStatus === -1) {\n\t\t\tthrow new Error(\"There was an error processing your authorization decision. Please contact your system administrator.\");\n\t\t\treturn false;\n\t\t}\n\t} catch(err) {\n\t\tMessageBox(err);\n\t\treturn false;\n\t}\t\n\tif(_swdoc.authDecision === false) {\n\t\t_swdoc.savedSuccessful = true;\n\t\treturn false;\n\t}\n\treturn true;\n}"},{"name":"OnDataSaved","code":"OnDataSaved()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.savedSuccessful = true;\n\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"550","height":"781","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"a_and_a_number","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"551","left":"287","right":"537","bottom":"572"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.AandAnumber"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"description","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"185","left":"287","right":"537","bottom":"249"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.description"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"2","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"impact","type":"Field"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"474","left":"287","right":"537","bottom":"538"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.impact"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"2","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"it_services","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"292","left":"287","right":"537","bottom":"313"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.itServices"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","listItems":"Yes|No|"}}},{"general":{"name":"justification","type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"324","left":"287","right":"537","bottom":"388"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.justification"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"2","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"division","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"647","left":"287","right":"537","bottom":"668"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.o_division"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"group","type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"615","left":"287","right":"537","bottom":"636"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.o_group"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"project_group_email","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"260","left":"287","right":"537","bottom":"281"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.operationsPOC"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"organization","type":"Field"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"583","left":"287","right":"537","bottom":"604"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.organization"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"project_name","type":"Field"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"153","left":"287","right":"537","bottom":"174"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.projectname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"supports","type":"Field"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"399","left":"287","right":"537","bottom":"463"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.supports"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"2","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"approver_display","type":"Field"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"121","left":"287","right":"537","bottom":"142"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"portfolio_display","type":"Field"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"89","left":"287","right":"537","bottom":"110"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"subportfolio_list","type":"Field"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"57","left":"287","right":"537","bottom":"78"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"extoc_addnewproject.subportfolio_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","listItems":"Test Subportfolio^1|","sqlSource":"swdata","storedQuery":"generic_filter.select","distinctTable":"cstm_cloudsubportfolio","distinctColumn":"id","displayColumn":"name"}}},{"general":{"name":"RejectButton","type":"EventButton"},"appearance":{"index":"14","caption":"Reject","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"}},"objectPlacement":{"position":{"top":"749","left":"16","right":"164","bottom":"778"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"39423"}}},{"general":{"name":"AcceptButton","type":"EventButton"},"appearance":{"index":"15","caption":"Approve","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"}},"objectPlacement":{"position":{"top":"749","left":"380","right":"537","bottom":"781"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"39423"}}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"16","caption":"Security A and A Number","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"551","left":"13","right":"275","bottom":"572"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"17","caption":"Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"185","left":"13","right":"275","bottom":"249"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"18","caption":"Impact of not having this project?","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"474","left":"13","right":"275","bottom":"538"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"19","caption":"Subportfolio","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"57","left":"13","right":"275","bottom":"78"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"20","caption":"Portfolio","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"89","left":"13","right":"275","bottom":"117"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"21","caption":"Portfolio Approver(s)","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"121","left":"13","right":"275","bottom":"142"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text7","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"22","caption":"Who does this project support?","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"399","left":"13","right":"275","bottom":"463"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text8","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"23","caption":"New Project Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"153","left":"13","right":"275","bottom":"174"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text9","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"24","caption":"Organization","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"583","left":"13","right":"275","bottom":"604"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text10","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"25","caption":"Project Group Email","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"260","left":"13","right":"275","bottom":"281"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text11","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"26","caption":"Group","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"615","left":"13","right":"275","bottom":"636"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text12","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"27","caption":"Division","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"647","left":"13","right":"275","bottom":"668"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text13","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"28","caption":"Why is this project needed?","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"324","left":"13","right":"275","bottom":"388"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text14","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"29","caption":"IT Services Needed","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"292","left":"13","right":"275","bottom":"313"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text15","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"30","caption":"New Project Request","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"14","@bold":"1","#text":"Arial Black"},"alignment":"Center","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"7","left":"14","right":"538","bottom":"34"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"portfolio_id","type":"Field"},"appearance":{"index":"31","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"80","left":"560","right":"630","bottom":"108"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"extoc_addnewproject.portfolio_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"comments","type":"Field"},"appearance":{"index":"32","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"677","left":"287","right":"537","bottom":"741"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"2","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text16","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"33","caption":"Approval\/Rejection Comments","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"12","@bold":"1","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"697","left":"12","right":"274","bottom":"718"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text17","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"34","caption":"Please make corrections as needed, then approve the request.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Center","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"28","left":"1","right":"552","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/*\n\t2019-05-07 code by BTI\/Robert to call user defined created to retrieve protfolio details\n\t*\/\n\tgetPortfolioDetail();\n\tpopulateFormElems();\n\n}"},{"name":"OnFieldValueChanged","code":"OnFieldValueChanged(strName, strValue)\n{\n\t\/*\n\t2019-05-07 code by BTI\/Robert to call user defined created to retrieve protfolio details\n\t*\/\n\tgetPortfolioDetail();\n}"},{"name":"(User Defined Functions)","code":"\/*\n2019-05-07 Code by BTI\/Robert to provide portfolio details based on subportfolio selection\nCode will be called during value change of the subportfolio selection list and when form is loaded.\n*\/\n\n\nfunction getPortfolioDetail(){\n    var strValue = subportfolio_list.value;\n    \/\/MessageBox(\"getPortfolioDetail Called with [\"+strValue+\"]\");\n    if (strValue)\n    {\n\t    \/\/MessageBox(\"Value Not NULL\");\n        getSubPortfolio = new SqlRecord;\n        if (getSubPortfolio.GetRecord(\"cstm_cloudsubportfolio\",strValue))\n        {\n        \t\/\/MessageBox(\"SP \"+strValue+\" is for [\"+getSubPortfolio.name+\"] under portfolio [\"+getSubPortfolio.portfolio_id+\"]\");\n        \t_eva(portfolio_id , getSubPortfolio.portfolio_id);\n        \tgetPortfolio = new SqlRecord;\n        \tif (getPortfolio.GetRecord(\"cstm_cloudportfolio\",portfolio_id.value))\n        \t{\n\t            _eva(portfolio_display , getPortfolio.name);\n    \t        _eva(approver_display , getPortfolioBusinessApprovers(getPortfolio));\n \t           \tif (getPortfolio.id != _swdoc.extoc_addnewproject.portfolio_id)\n \t           \t{\n                \t_swdoc.extoc_addnewproject.portfolio_id = portfolio_id.value;\n                \t_swdoc.extoc_addnewproject.subportfolio_id = strValue;\n                }\n            }\n        }\n        else\n        {\n        \t\/\/MessageBox(\"getPortfolioDetail failed to get subportfolio record\");\n        }\n    }\n    else\n    {\n\t    \/\/MessageBox(\"getPortfolioDetail passed NULL\");\n\t}\n}\n\nfunction getPortfolioBusinessApprovers(portfolioRecord) {\n\tvar approvers = [];\n\tvar cotr_approvers = portfolioRecord.cotr_approver.split(',');\n\tvar issm_approvers = portfolioRecord.issm_approver.split(',');\n\t\n\tfor(var i = 0; i < issm_approvers.length; i++) {\n\t\tif(cotr_approvers.indexOf(issm_approvers[i]) === -1) {\n\t\t\tcotr_approvers.push(issm_approvers[i]);\n\t\t}\n\t}\n\t\n\treturn cotr_approvers.join(',');\n}\n\nfunction populateFormElems() {\n\t_swdoc.validatedElems = [\n\t\t{\n\t\t\tname: \"Sub Portfolio\",\n\t\t\tele: mainform.subportfolio_list,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.subportfolio_list),\n\t\t},\n\t\t{\n\t\t\tname: \"Project Name\",\n\t\t\tele: mainform.project_name,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.project_name),\n\t\t},\n\t\t{\n\t\t\tname: \"Description\",\n\t\t\tele: mainform.description,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.description),\n\t\t},\n\t\t{\n\t\t\tname: \"Project Group Email\",\n\t\t\tele: mainform.project_group_email,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.project_group_email),\n\t\t},\n\t\t{\n\t\t\tname: \"IT Services Needed\",\n\t\t\tele: mainform.it_services,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.it_services),\n\t\t},\n\t\t{\n\t\t\tname: \"Justification\",\n\t\t\tele: mainform.justification,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.justification),\n\t\t},\n\t\t{\n\t\t\tname: \"Project Supports\",\n\t\t\tele: mainform.supports,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.supports),\n\t\t},\n\t\t{\n\t\t\tname: \"Impact\",\n\t\t\tele: mainform.impact,\t\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.impact),\n\t\t},\n\t\t{\n\t\t\tname: \"A and A number\",\n\t\t\tele: mainform.a_and_a_number,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.a_and_a_number),\n\t\t},\n\t\t{\n\t\t\tname: \"Organization\",\n\t\t\tele: mainform.organization,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.organization),\n\t\t},\n\t\t{\n\t\t\tname: \"Group\",\n\t\t\tele: mainform.group,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.group),\n\t\t},\n\t\t{\n\t\t\tname: \"Division\",\n\t\t\tele: mainform.division,\n\t\t\toriginalVal: _swdoc.getOriginalValue(mainform.division),\n\t\t}\n\t]\n}"},{"name":"subportfolio_list_OnValueChanged","code":"subportfolio_list_OnValueChanged(strValue)\n{\n\t\/*\n\t2019-05-07 code by BTI\/Robert to call user defined created to retrieve protfolio details\n\t*\/\n\tgetPortfolioDetail();\n}"},{"name":"RejectButton_OnPressed","code":"RejectButton_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.authDecision = false;\n\t_swdoc.Save();\n\t_swdoc.authDecision = null;\n\tif(_swdoc.savedSuccessful) _swdoc.CloseForm();\n\n\n}"},{"name":"AcceptButton_OnPressed","code":"AcceptButton_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.authDecision = true;\n\t_swdoc.Save();\n\t_swdoc.authDecision = null;\n\tif(_swdoc.savedSuccessful) _swdoc.CloseForm();\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{"methods":{"method":{"name":"(User Defined Functions)","code":""}}}}]}}}