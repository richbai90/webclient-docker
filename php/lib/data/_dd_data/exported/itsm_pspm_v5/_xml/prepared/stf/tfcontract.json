{"espForm":{"configuration":{"settings":{"name":"TfContract","title":"Support Contract","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"contract","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var boolInserting = false;\nvar arrDiary = Array();\nfunction oContract()\n{\n\treturn _swdoc.contract;\n}\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\n\nfunction init_form()\n{\n\t\/\/-- 27.10.2004\n\t\/\/-- fix date fields as getrecord does not process them correctly\n\tif (_swdoc.oContract().pk_contract_id !=\"\")\n\t{\t\n\t\t_swdoc.boolInserting=false;\n\t\t_swdoc.MF().TabContract.ShowTabItem(1,true);\t\t\n\t\t_swdoc.MF().TabContract.ShowTabItem(2,true);\t\t\n\t\t_swdoc.MF().TabContract.ShowTabItem(3,true);\n\t\t_swdoc.MF().TabContract.ShowTabItem(4,true);\n\t\t_swdoc.MF().TabContract.ShowTabItem(5,true);\n\t\t_swdoc.check_contract_state(true);\n\t\t_swdoc.refresh_contract_cis();\t\t\n\t}\n\telse\n\t{\t\n\t\t\/\/-- inserting\n\t\t_swdoc.boolInserting = true;\n\t\t_swdoc.oContract().fk_company_id= unescape(_swdoc.GetArg(\"fk_company_id\"));\n\t\t_swdoc.oContract().type = unescape(_swdoc.GetArg(\"type\"));\n\t\t_swdoc.MF().TabContract.ShowTabItem(1,false);\t\t\n\t\t_swdoc.MF().TabContract.ShowTabItem(2,false);\n\t\t_swdoc.MF().TabContract.ShowTabItem(3,false);\n\t\t_swdoc.MF().TabContract.ShowTabItem(4,false);\n\t\t_swdoc.MF().TabContract.ShowTabItem(5,false);\t\t\n\t}\t\n\t\n\t_swdoc.ResetModiedFlag('contract');\n}\n\n\n\/\/-- check contract state\nfunction check_contract_state(boolSave)\n{\t\n\tif(boolSave==undefined)boolSave = true;\n\t\/\/-- if the contract end date is less than todays date then set flag to 0\n\t\/\/-- or if the start date is greater than todays date (not started yet)\n\tif ( (app.g.fix_epoch(_swdoc.oContract().end_datex) < app.global.GetCurrentEpocTime()) || (app.g.fix_epoch(_swdoc.oContract().start_datex) > app.global.GetCurrentEpocTime())\t)\t\t\t\n\t{\n\t\t\/\/-- if system has not flagged it yet set flag and save\n\t\tif (_swdoc.oContract().flg_valid==\"1\")\n\t\t{\t\n\t\t\t_swdoc.oContract().flg_valid=\"0\";\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tif(boolSave)_swdoc.Save(0);\n\t\t}\n\t}\n\telse\n\t{\n\t\tif (_swdoc.oContract().flg_valid==0)\n\t\t{\t\n\t\t\t_swdoc.oContract().flg_valid=\"1\";\n\t\t\t_swdoc.oContract().flg_ewemail_sent=\"0\";\t\t\t\n\t\t\t_swdoc.oContract().flg_expemail_sent=\"0\";\t\t\t\t\t\t\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tif(boolSave)_swdoc.Save(0);\n\t\t}\n\t}\n}\n\n\/\/-- 26.02.2008 - nwj\n\/\/-- refresh contract ci list\nfunction refresh_contract_cis()\n{\n\tvar strCMDBids = app.cfg.get_contract_cikeys(_swdoc.oContract().pk_contract_id,true);\n\t_slf(_swdoc.MF().sl_contractci , \"pids=\" + strCMDBids + \"&sf=cilist_activebln\");\n\t_swdoc.MF().sl_contractci.SetRowSelected(0);\n}"},{"name":"OnDataSaved","code":"OnDataSaved()\n{\n\n    var pDoc = app.g.get_me_document(\"COMPANY\",_swdoc.oContract().fk_company_id);\n    if(pDoc)\n    {\n    \tvar intCurSel = pDoc.MF().sl_contracts.curSel;\n    \tpDoc.MF().sl_contracts.Refresh();\n    \tpDoc.MF().sl_contracts.SetRowSelected(intCurSel,true);\n    }\n\n    \/\/-- \n    \/\/-- NWJ - show tab - and also update parent _swdoc\n    if(_swdoc.boolInserting)\n    {\t\t\n    \t\/\/-- create cmdb relationship\n    \tif(pDoc)\n    \t{\n    \t\t\/\/-- need to reload site record to get fk_cmdb_id\n    \t\t_swdoc.LoadRecordData(\"swdata\", \"contract\", _swdoc.oContract().pk_contract_id);\n    \t\t\n    \t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgContractRelationship\");\n    \t\tapp.cmdb.generate_meconfigrelation(pDoc.oCompany().fk_cmdb_id,_swdoc.oContract().fk_cmdb_id,strRel);  \n    \t}\n\t\t_swdoc.boolInserting=false;\n\t}\n    \n\t\/\/RJC 05.01.09\n\t\/\/ITSM 2.4 FS 13.7\t\n\tvar strText = \"\";\n\tfor(var intNumberOfInsert=0;intNumberOfInsert<_swdoc.arrDiary.length;intNumberOfInsert++)\n\t{\n\t\tarrDetails = _swdoc.arrDiary[intNumberOfInsert]\n\t\tif(strText!=\"\")strText += \",\"\n\t\tstrText += arrDetails[0]+\" has been modified from '\"+arrDetails[1]+\"' to '\"+arrDetails[2]+\"'\";\n\t}\n\tif(strText!=\"\"){\n\t\tvar strParams = \"contract=\"+pfu(_swdoc.oContract().pk_contract_id)+\"&txt=\"+pfu(strText);\n\t\tapp.g.submitsqs(\"form\/tfcontract\/add_diary_entry\", strParams);\n\t}\n\t\n\t\n\t\/\/-- ensure tab is active after saving\n\t_swdoc.init_form();\n\n}"},{"name":"(User Defined Functions)","code":"function setup_history()\n{\n\t\/\/RJC 05.01.09\n\t\/\/ITSM 2.4 FS 13.7\n\t\/\/Create array of insert details\n\tvar arrInserts = new Array();\n\t\n\t\/\/-- get matching contract record\n\tvar oLiveContractRec = app.g.get_record(\"CONTRACT\",contract.pk_contract_id);\n\tvar liveVal=\"\";\n\t\/\/-- for each field check if diff from contract\n\tfor (x=0; x < dd.tables['contract'].columns.length;x++)\n\t{\n\t\n\t\tvar colName = dd.tables['contract'].columns[x].Name;\n\t\t\t\t\t\n\t\tif(colName==\"contract_notes\")continue;\n\t\t\n\t\t\/\/make sure the field exists\n\t\tif(oLiveContractRec[colName]!=undefined)\n\t\t{\n\t\t\t\/\/-- if values differ and value is not empty put into a field table\n\t\t\t\/\/-- if numeric value and = 0 then ignore\n\t\t\tvar FORM_VALUE = contract[colName];\n\t\t\tif((app.g.dd_isnumeric('contract',colName))&&(FORM_VALUE==0))continue;\n\t\t\t\n\t\t\tvar\tdispFormVal = FORM_VALUE;\n\t\t\tvar liveVal = oLiveContractRec[colName];\n\t\t\tvar dispLiveVal = liveVal;\n\t\t\tif(app.g.dd_isnumeric('contract',colName))\n\t\t\t{\n\t\t\t\tif(FORM_VALUE<0)\n\t\t\t\t{\n\t\t\t\t\tFORM_VALUE= app.g.fix_epoch(FORM_VALUE);\n\t\t\t\t\tdispFormVal = app.g.convert_epochddmmyyyy(FORM_VALUE);\n\t\t\t\t\tdispLiveVal = app.g.convert_epochddmmyyyy(liveVal);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif((liveVal!=FORM_VALUE))\n\t\t\t{\n\t\t\t\tarrInserts.push(new Array( app.g.dd_fieldlabel('contract',colName),app.g.pfs(dispLiveVal) , app.g.pfs(dispFormVal)))\n\t\t\t}\n\t\t}\t\n\t}\n\n\t_swdoc.arrDiary = arrInserts;\n}"},{"name":"OnSaveData","code":"OnSaveData()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.setup_history();\n\treturn true;\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"708","height":"389","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"tb_contract_ref","type":"Field","group":"TabContract:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"68","left":"135","right":"344","bottom":"86"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.pk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_contract_ref1","type":"Field","group":"TabContract:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"90","left":"135","right":"344","bottom":"108"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_contract_type","type":"Field","group":"TabContract:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"112","left":"135","right":"344","bottom":"130"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_contract_type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","distinctTable":"swlists","distinctColumn":"value","sqlSource":"swdata","borderColor":"#c0c0c0","displayColumn":"display_name","listFilter":"list_id = 'CONTRACT-TYPE'"}}},{"general":{"name":"lb_priority","type":"Field","group":"TabContract:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"157","left":"135","right":"344","bottom":"175"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","distinctTable":"priority","distinctColumn":"priority","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"common.filterByTableValues"}}},{"general":{"name":"tb_document_ref","type":"Field","group":"TabContract:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"179","left":"135","right":"344","bottom":"197"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.document_ref"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"flg_always","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"135","left":"130","right":"326","bottom":"153"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.flg_alwayssupport"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","flagItems":"Always provide support regardless^1|"}}},{"general":{"name":"tb_start_date","type":"Field","group":"TabContract:0"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"68","left":"443","right":"620","bottom":"86"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.start_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_end_date","type":"Field","group":"TabContract:0"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"90","left":"443","right":"620","bottom":"108"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.end_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_end_date1","type":"Field","group":"TabContract:0"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"112","left":"443","right":"620","bottom":"130"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.renew_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_ew","type":"Field","group":"TabContract:0"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"156","left":"443","right":"620","bottom":"174"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_ewanalyst"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"syscache","distinctTable":"swanalysts","distinctColumn":"AnalystID","displayColumn":"Name","dropdownButtonType":"1","storedQuery":"common.filterByTableValues"}}},{"general":{"name":"lb_sponsor","type":"Field","group":"TabContract:0"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"178","left":"443","right":"620","bottom":"196"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_manager"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"syscache","distinctTable":"swanalysts","distinctColumn":"AnalystID","displayColumn":"Name","dropdownButtonType":"1","storedQuery":"common.filterByTableValues"}}},{"general":{"name":"lb_cust","type":"Field","group":"TabContract:0"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"200","left":"443","right":"620","bottom":"218"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_userdb"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"userdb","distinctColumn":"keysearch","displayColumn":"fullname","dropdownButtonType":"0","listFilter":"_swc_fk_company_id=&[contract.fk_company_id]","storedQuery":"common.filterByTableValues"}}},{"general":{"name":"tb_notes","type":"Field","group":"TabContractCosts:2"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"253","left":"26","right":"610","bottom":"362"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"contract.contract_notes"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"13","caption":"Contract Details \/ Notes","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"33","left":"13","right":"700","bottom":"377"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"14","caption":"Support SLA","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"157","left":"26","right":"131","bottom":"175"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.fk_priority"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"15","caption":"Document Ref.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"179","left":"26","right":"131","bottom":"197"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.document_ref"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"flg_valid","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"135","left":"438","right":"565","bottom":"152"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.flg_valid"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","flagItems":"Contract is in force^1|"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"17","caption":"Expires On","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"90","left":"367","right":"439","bottom":"108"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.end_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"18","caption":"Valid From","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"68","left":"367","right":"439","bottom":"86"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.start_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"19","caption":"Contract Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"112","left":"26","right":"131","bottom":"130"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.fk_contract_type"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"TabContract","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"20","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"6","left":"4","right":"705","bottom":"386"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Contract Details \/ Notes","properties":"56=#dddddd|58=#0000ff|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#dddddd","activeTextColor":"#0000ff"}}},{"name":"Documents","properties":"56=#f09e9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f09e9f"}}},{"name":"Service Level Agreements","properties":"56=#baa6e1|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#baa6e1"}}},{"name":"CIs Supported in Contract","properties":"56=#dddddd|58=#0000ff|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#dddddd","activeTextColor":"#0000ff"}}},{"name":"Services","properties":"56=#9abfb4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#9abfb4"}}},{"name":"Audit Trail","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}}]},"selectedTextFont":{"@size":"8","#text":"Trebuchet MS"},"selectedTextColor":"#000000","deselectedTextColor":"#5f5f5f","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"21","caption":"Contract ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"68","left":"26","right":"131","bottom":"86"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.pk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"22","caption":"E.W. Analyst","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"156","left":"368","right":"439","bottom":"174"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_ewanalyst"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_contractci","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabContract:3"},"appearance":{"index":"23","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"58","left":"13","right":"626","bottom":"317"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"CI ID","width":"41","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration ID","width":"171","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"209","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"216","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"5"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"newRecordForm":"Form.cmdb_popup_ci","editRecordForm":"Form.cmdb_popup_ci","sqlSource":"swdata","table":"config_itemi","listFilter":"pids=0","storedQuery":"common.load_by_pkautoid"}}},{"general":{"name":"mbtn_contract_actions","type":"MenuButton","group":"TabContract:3"},"appearance":{"index":"24","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"30","left":"558","right":"623","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"Search && Associate^1|Disassociate^2|"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"25","caption":"Early Warning On","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"112","left":"341","right":"439","bottom":"130"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.renew_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"26","caption":"Owner","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"178","left":"368","right":"439","bottom":"196"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_manager"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"27","caption":"Title","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"90","left":"26","right":"131","bottom":"108"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.title"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"28","caption":"Sponsor","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"200","left":"368","right":"439","bottom":"218"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_userdb"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"mbtn_view_ci","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:3"},"appearance":{"index":"29","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"30","left":"480","right":"545","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Parent Dependencies^2|Child Dependencies^5|Change Schedule^4|"}}},{"general":{"name":"sl_contract_diary","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"TabContract:5"},"appearance":{"index":"30","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"37","left":"19","right":"624","bottom":"313"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_contract_id"},"name":"Contract","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"udcode"},"name":"Update","width":"93","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"updatetxt"},"name":"Description","width":"226","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"updatedonx"},"name":"Date","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"analystid"},"name":"Analyst","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"pk_auto_id","width":"120","image":"-1","dataColumn":"5"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"contract_diary","listFilter":"swc=fk_contract_id&kvs=&[contract.pk_contract_id]","newRecordForm":"Form.contract_diary","editRecordForm":"Form.contract_diary","storedQuery":"common.load_by_colname"}}},{"general":{"name":"sl_slas","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"TabContract:2"},"appearance":{"index":"31","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"58","left":"13","right":"626","bottom":"317"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"slad_id"},"name":"Name","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"type"},"name":"Type","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"createdonx"},"name":"Valid From","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"expiresonx"},"name":"Expires On","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_slad_id"},"name":"pk_slad_id","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cmdb_id"},"name":"fk_cmdb_id","width":"120","image":"-1","dataColumn":"5"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"itsmsp_slad","newRecordForm":"Form.itsmsp_slad","editRecordForm":"Form.itsmsp_slad","storedQuery":"common.load_by_colname","listFilter":"swc=pk_slad_id&kvs="}}},{"general":{"name":"mbtn_sla_actions","type":"MenuButton","group":"TabContract:2"},"appearance":{"index":"32","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"30","left":"558","right":"623","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"Associate^1|Dis-associate^2|"}}},{"general":{"name":"sl_services","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"TabContract:4"},"appearance":{"index":"33","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"41","left":"27","right":"616","bottom":"289"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"columns":{"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"service_name"},"name":"Name","width":"120","image":"-1","dataColumn":"0"}},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"sc_folio","newRecordForm":"Form.portfolio","editRecordForm":"Form.portfolio","storedQuery":"common.load_by_colname","listFilter":"swc=fk_cmdb_id&kvs="}}},{"general":{"name":"TabContractCosts","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"34","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"227","left":"19","right":"694","bottom":"374"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Cost","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Discount","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}},{"name":"Notes","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_discounts","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"TabContractCosts:1"},"appearance":{"index":"35","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"253","left":"28","right":"611","bottom":"361"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"pk_auto_id","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"New Column","width":"120","image":"-1","dataColumn":"1"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"1","borderColor":"#000000","sqlSource":"swdata","table":"contract_discounts","listFilter":"swc=fk_contract_id&kvs=&[contract.pk_contract_id]","storedQuery":"common.load_by_colname"}}},{"general":{"name":"lbl_amount","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"36","caption":"Amount","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"253","left":"184","right":"264","bottom":"272"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_cost","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"37","caption":"Cost","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"251","left":"280","right":"387","bottom":"276"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_discount","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"38","caption":"Discount","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"253","left":"437","right":"553","bottom":"275"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_slas","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"39","caption":"SLAs","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"284","left":"33","right":"96","bottom":"304"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_cis","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"40","caption":"CIs","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"308","left":"36","right":"94","bottom":"326"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_services","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"41","caption":"Services","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"336","left":"41","right":"91","bottom":"354"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_subtotal","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"42","caption":"Sub Total","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"355","left":"36","right":"109","bottom":"369"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field1","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"43","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"286","left":"174","right":"242","bottom":"302"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_amt_sla"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field2","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"44","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"306","left":"174","right":"242","bottom":"322"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_amt_ci"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field3","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"45","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"326","left":"174","right":"242","bottom":"342"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_amt_servs"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field4","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"46","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"287","left":"295","right":"363","bottom":"303"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_total_sla"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field5","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"47","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"309","left":"295","right":"363","bottom":"325"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_total_ci"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field6","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"48","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"331","left":"295","right":"363","bottom":"347"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_total_servs"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field7","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"49","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"285","left":"432","right":"500","bottom":"301"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_discount_sla"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field8","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"50","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"307","left":"432","right":"500","bottom":"323"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_discount_ci"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field9","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"51","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"329","left":"432","right":"500","bottom":"345"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_discount_servs"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field10","type":"Field","group":"TabContractCosts:0"},"appearance":{"index":"52","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"350","left":"601","right":"669","bottom":"366"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.cost_total"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lbl_total","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContractCosts:0"},"appearance":{"index":"53","caption":"Total","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"350","left":"512","right":"593","bottom":"368"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- 22.10.2004\n\t\/\/-- NWJ\n\t\/\/-- Get the passed in contract info\n\n\t\/\/-- load fields\n\t_swdoc.init_form();\n\n}"},{"name":"sl_contractci_OnItemSelected","code":"sl_contractci_OnItemSelected(nRow)\n{\n  \/\/-- Load CI info based on CI loaded\n    \n    var ci_id  = sl_contractci.GetItemTextRaw(nRow,'pk_auto_id');\n    if (ci_id == \"\")\n    {\n        _een(mbtn_view_ci , false);\n    }\n    else\n    {\n\t\t_een(mbtn_view_ci , true);\n    }\n\n}"},{"name":"mbtn_contract_actions_OnMenuItem","code":"mbtn_contract_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iAssignCI = 1;\n\tvar iRemoveCI = 2;\t\n\n\t\/\/-- get ci\n \tvar intCiID = sl_contractci.GetItemTextRaw(sl_contractci.curSel,\"pk_auto_id\");\t\n\t\n\tif(nItemID == iAssignCI)\n\t{\n\t\t\/\/-- associate org owned or used cis to the contract\n\t\tvar strCIS = app.cfg.get_company_cikeys(_swdoc.oContract().fk_company_id,true,true);\n\t\tvar arrUsedCIS = strCIS.split(\",\");\n\t\tapp.cmdb.search_ci(false, \"\", function(sResults)\n\t\t{\n\t\t\tif (sResults.selectedkeys==\"\") return;\n\n\t\t\tvar strCisToLink = \"\";\n\t\t\tvar strCiTextToLink = \"\";\n\t\t\tvar boolAlerted = false; \n\t\t\tvar arrLinkCIS = sResults.selectedkeys.split(\",\");\n\t\t\tvar arrLinkCITextS = sResults.selectedtext.split(\",\");\n\t\t\tvar start=\" \";\n\t\t\tvar end=\" was \";\n\t\t\tfor(var x=0; x<arrLinkCIS.length;x++)\n\t\t\t{\n\t\t\t\tvar boolInList = false;\n\t\t\t\tfor (var y=0; y < arrUsedCIS.length;y++)\n\t\t\t\t{\n\t\t\t\t\tif(arrLinkCIS[x]==arrUsedCIS[y])\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/-- store as a ci we can link\n\t\t\t\t\t\tif(strCisToLink!=\"\")strCisToLink+=\",\";\n\t\t\t\t\t\tstrCisToLink += arrUsedCIS[y];\n\t\t\t\t\t\tif(strCiTextToLink!=\"\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstrCiTextToLink+=\",\";\n\t\t\t\t\t\t\tstart = \"'s \";\n\t\t\t\t\t\t\tend = \" were \";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tstrCiTextToLink += arrLinkCITextS[x];\n\t\t\t\t\t\tboolInList = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\t\/\/-- if not a ci used by org and we havent told user tell them and then dont bother\n\t\t\t\tif((!boolInList)&&(!boolAlerted))\n\t\t\t\t{\n\t\t\t\t\tboolAlerted = true; \n\t\t\t\t\tMessageBox(\"One or more of the selected configuration items are not owned by or used by the organisation that this contract is for.\\nSuch configuration items will not be associated to the contract.\");\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif(strCisToLink==\"\")return;\n\t\n\t\t\t\/\/-- relate cis to contract ci   \t\t\n   \t\t\tif(_swdoc.oContract().fk_cmdb_id)\n   \t\t\t{\n\t\t\t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultContractCIRelationship\");   \t\t\n\t\t\t\tapp.cmdb.generate_meconfigrelation(_swdoc.oContract().fk_cmdb_id, strCisToLink, strRel);\n\t\t\t}\n\t\t\t\n\t\t\t\/\/RJC 05.01.09\n\t\t\t\/\/ITSM 2.4  FS 13.7\n\t\t\tvar strText = \"The CI\"+start+strCiTextToLink+end+\"associated to the contract\";\n\t\t\tvar strParams = \"contract=\"+pfu(_swdoc.oContract().pk_contract_id)+\"&txt=\"+pfu(strText)+\"&code=\"+pfu(\"CI Association\");\n\t\t\tapp.g.submitsqs(\"form\/tfcontract\/add_diary_entry\", strParams);\n\t\t\t\/\/-- prompt user if they want to associate the ci's to the company that contract is for?\n\t\t\t\n\t\t\t\/\/-- now need to refresh sqllist\n\t\t\t_swdoc.refresh_contract_cis();\n\t\t\treturn;\n\t\t});\n    }\n\telse if(nItemID == iRemoveCI)\n\t{\n\t\t\/\/-- remove link between ci and contract\n\t\tif (intCiID > 0)\n    \t{\n    \t\tif (!confirm(\"Are you sure you want to remove the selected configuration item from this contract ?\")) return;\n\n    \t\t\/\/--\n\t\t\t\/\/-- delete ci relationship (always assume that ME is parent)\n\t\t\tif(_swdoc.oContract().fk_cmdb_id>0)\n\t\t\t{\n\t\t\t\tapp.cmdb.delete_meconfigrelation(_swdoc.oContract().fk_cmdb_id, intCiID);\n\t\t\t}   \t\t\n\t\t\t\n\t\t\t\/\/RJC 05.01.09\n\t\t\t\/\/ITSM 2.4  FS 13.7\n \t\t\tvar intCiItem = sl_contractci.GetItemTextRaw(sl_contractci.curSel,\"ck_config_item\");\t\n\t\t\tvar strText = \"The CI \"+intCiItem+\" was disassociated to the contract\";\n\t\t\tvar strParams = \"contract=\"+pfu(_swdoc.oContract().pk_contract_id)+\"&txt=\"+pfu(strText)+\"&code=\"+pfu(\"CI Disassociation\");\n\t\t\tapp.g.submitsqs(\"form\/tfcontract\/add_diary_entry\", strParams);\n\t\t\t_swdoc.refresh_contract_cis();\n    \t} \t\t\n\t}\n\t\t\n}"},{"name":"lb_ew_OnLeftClick","code":"lb_ew_OnLeftClick()\n{\n\t\/\/-- 08.03.2005\n\t\/\/-- NWJ\n\t\/\/-- assign analyst to early warning\n\tapp.g.pick_analyst(\"Send Early Warning To\", function(oA)\n\t{\n\t\tif (oA)\n\t\t{\n\t\t\t_swdoc.oContract().fk_ewanalyst = oA.id ;\n\t\t}\n\n\t_swdoc.UpdateFormFromData();\n\t\n\t});\n\treturn false;\n}"},{"name":"lb_ew_OnRightClick","code":"lb_ew_OnRightClick()\n{\n\t\n\t\/\/-- clear lb\n\t_swdoc.oContract().fk_ewanalyst = \"\";\n\t_ete(lb_ew,\"\");\n\t_swdoc.UpdateFormFromData();\n\n\n\treturn true;\n}"},{"name":"lb_sponsor_OnRightClick","code":"lb_sponsor_OnRightClick()\n{\n\t\n\t\/\/-- clear lb\n\t_swdoc.oContract().fk_manager = \"\";\n\t_ete(lb_sponsor,\"\");\n\t_swdoc.UpdateFormFromData();\n\n\n\treturn true;\n}"},{"name":"lb_sponsor_OnLeftClick","code":"lb_sponsor_OnLeftClick()\n{\n\t\/\/-- 08.03.2005\n\t\/\/-- NWJ\n\t\/\/-- assign analyst to early warning\n\tapp.g.pick_analyst(\"Send Expiry Notification To\", function(oA)\n\t{\n\t\tif (oA)\n\t\t{\n\t\t\t_swdoc.oContract().fk_manager = oA.id ;\n\t\t}\n\n\t_swdoc.UpdateFormFromData();\n\t\n\t});\n\treturn false;\n}"},{"name":"mbtn_view_ci_OnMenuItem","code":"mbtn_view_ci_OnMenuItem(strName, nItemID)\n{\n  \tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_contractci,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_contractci,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"tb_start_date_OnValueChanged","code":"tb_start_date_OnValueChanged(strValue)\n{\n\t\n\t_swdoc.check_contract_state(false);\n}"},{"name":"tb_end_date_OnValueChanged","code":"tb_end_date_OnValueChanged(strValue)\n{\n\t_swdoc.check_contract_state();\n}"},{"name":"TabContract_OnTabSelected","code":"TabContract_OnTabSelected(nTab)\n{\n\tvar tSLA = 2;\n\tvar tServ = 7;\n\tvar tabAuditTrail = 8;\n\t\t\n\tif(nTab==tSLA)\n\t{\n\t\tvar strSLAs = app.g.get_contract_slas(_swdoc.oContract().pk_contract_id);\n\t\t_slf(_swdoc.MF().sl_slas, \"swc=pk_slad_id&kvs=\"+strSLAs);\n\t}\n\t\n\tif(nTab==tServ)\n\t{\n\t\tvar strServs = app.g.get_contract_services(_swdoc.oContract().pk_contract_id);\n\t\t_slf(_swdoc.MF().sl_slas, \"swc=fk_cmdb_id&kvs=\"+strServs);\n\t}\n\t\n\tif(nTab==tabAuditTrail)\n\t{\n\t\tmainform.sl_contract_diary.Refresh();\n\t}\n\n}"},{"name":"mbtn_sla_actions_OnMenuItem","code":"mbtn_sla_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iAddSLA = 1;\n\tvar iDeleteSLA = 2;\n\t\n\t\/\/-- Add Contract\n\tif(nItemID == iAddSLA)\n\t{\n\t\tapp.OpenForm(\"browse_slas\", \"mode=select\", true, function(x)\n\t\t{\n\t\t\tvar strKeys = x.document.strSelectedKey;\n\t\t\tif(strKeys==\"\")return;\n\t\t\tvar arrKeys = strKeys.split(\",\");\n\t\t\tfor (var x=0; x< arrKeys.length;x++)\n\t\t\t{\n\t\t\t\tvar fk_key = arrKeys[x];\n\t\t\t\tif(app.g.sl_findrow_byvalue(sl_slas,fk_key,\"pk_slad_id\")==-1)\n\t\t\t\t{\n            \t\tvar strRel = \"Uses\";\n            \t\tvar recSLA = app.g.get_record(\"itsmsp_slad\", fk_key);                               \n\t\t\t\t\tapp.cmdb.generate_meconfigrelation(_swdoc.oContract().fk_cmdb_id,recSLA.fk_cmdb_id,strRel);  \t\t\n\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t}\n\t\t\tvar strSLAs = app.g.get_contract_slas(_swdoc.oContract().pk_contract_id);\n\t\t\t_slf(_swdoc.MF().sl_slas, \"swc=pk_slad_id&kvs=\"+strSLAs);\n\t\t\t\t\n\t\t\tsl_slas.Refresh();\n\t\t\tsl_slas.SetRowSelected(0);\n\t\t\tsl_slas_OnItemSelected(0);\n\t\t});\n\t}\n\telse if(nItemID == iDeleteSLA)\n\t{\n\t\t\/\/-- 15.12.2004\n\t\t\/\/-- NWJ\n\t\t\/\/-- delete contract\n\t\tvar strSLAID = app.g.sl_getrawcolvalue(sl_slas,-1,\"pk_slad_id\");\n\t\tif (strSLAID!=\"\")\n\t\t{\n\n\t\t\tif (!confirm(\"Are you sure you want to dis-associate the selected SLA?\")) return;\n\t\t\t\n\t\t\tvar strSLACMDBID = app.g.sl_getcolvalue(sl_slas, -1, \"fk_cmdb_id\");\n\t\t\tapp.cmdb.delete_meconfigrelation(_swdoc.oContract().fk_cmdb_id,strSLACMDBID);\n\t\t\tvar strSLAs = app.g.get_contract_slas(_swdoc.oContract().pk_contract_id);\n\t\t\t_slf(_swdoc.MF().sl_slas, \"swc=pk_slad_id&kvs=\"+strSLAs);\n\t\t\t\t\n\t\t\tsl_slas.Refresh();\n\t\t\tsl_slas.SetRowSelected(0);\n\t\t\tsl_slas_OnItemSelected(0);\n\t\t\t\n\t\t}\n\t}\n\t\n\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}