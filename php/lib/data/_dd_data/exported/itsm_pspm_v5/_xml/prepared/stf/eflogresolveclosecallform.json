{"espForm":{"configuration":{"settings":{"name":"EfLogResolveCloseCallForm","title":"Resolve Close Call Form","options":{"allowResize":"true","showMenubar":"true","showToolbar":"false","showStatusBar":"false"}},"tables":{"table":[{"name":"updatedb","type":"Main Details Table","flags":"5"},{"name":"opencall","type":"Extended Details Table","mainDetailsColumn":"callref","flags":"0"}]},"javascript":{"methods":{"method":[{"name":"OnAdviseActionCompleted","code":"OnAdviseActionCompleted(nAction, stActionResultValues)\n{\n\tvar res = new String(stActionResultValues);\n\tvar ar = res.split(\"&\");\n\tif(nAction == LOG_CALL_ACTION)\n\t{\n\t\tvar i=0; \n\t\tfor( ; i< ar.length; i++)\n\t\t{\n\t\t\tvar pos = ar[i].indexOf(\"callref=\");\n\t\t\tif(pos != -1)\n\t\t\t{\n\t\t\t\tvar arCallref = ar[i].split(\"=\");\n\t\t\t\tvar strLogCallRef = arCallref[1];\n\t\t\t\tif(mainform.ResolveClose(strLogCallRef)) \n\t\t\t\t{\n\t\t\t\t\t\/\/mainform.onformloaded();\n\t\t\t\t\treturn true;\n\t\t\t\t}\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tif (confirm(\"There was a problem resolving the call you just logged. Would you like to view the call details?\"))\n\t\t\t\t\t{\n\t\t\t\t\t\tapp.global.OpenCallDetailsView(strLogCallRef);\n\t\t\t\t\t\treturn true;\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}"},{"name":"(User Defined Functions)","code":"var boolLogMode = false; \/\/-- boolean - is the form being displayed in a logcall forn\nvar boolClosing = false; \/\/-- boolean - is the call action to close calls\/s (if false resolving)\nvar arrSurveyNameSurvIDs = new Array(); \/\/-- array - holds list of survey ids \nvar arrCallStatuss \t\t = new Array(); \/\/-- array - holds list of the all the calls status\nvar arrCallOpenTasks \t = new Array(); \/\/-- araray - holds list of all the calls tasks\nvar boolFormFieldChanged = false;\t\/\/-- boolean - set to true when formfield is changed. Used when closing form\nvar boolSourceEmail = false; \/\/-- from opened from email\nvar boolHaveSubject = false; \/\/-- Is there a subject\nvar boolHaveSurveys = false; \/\/-- are there surveys available\nvar nBackdatePeriod = 0;\nvar arrContractNameIDs = new Array();\nvar boolConfirmSupportUnits = true;\n\nvar boolIsQuickLogCall = false;\n\n\/\/-- reset bound record so we dont get messages when leaving\nfunction resetData()\n{\n\t_swdoc.ResetModiedFlag(\"updatedb\");\n\t_swdoc.ResetModiedFlag(\"opencall\");\n}\n\n\/\/-- validate form data that user has set\nfunction ValidateForm()\n{\n\tif((_swdoc.updatedb.timespent < 1 || _swdoc.updatedb.timespent > 60000) && (mainform.tb_timespent.mandatory))\n\t{\n\t\tMessageBox(\"You must enter the amount of time you spent on this action\", MB_OK);\n\t\treturn false;\t\/\/ Make sure that the time spent is within range\n\t}\n\n\tif((_swdoc.updatedb.updatetxt == \"\") && (mainform.tb_updatetext.text==\"\"))\n\t{\n\t\tMessageBox(\"You must enter a description in the Action Description tab.\", MB_OK | MB_ICONINFORMATION );\n\t\treturn false;\t\/\/ Make sure we have some update text\n\t}\n\n\t\/\/-- check other required fields\n\tif (!_swdoc.check_mandatory_fields(\"updatedb\",mainform))return false;\t\t\n\tif (!_swdoc.check_mandatory_fields(\"opencall\",mainform))return false;\n\t\n\t\/\/-- check profile levels\n\tif(!mainform.check_profile_levels())return false;\n\t\n\t\/\/-- Check for available support units\n\tvar boolShow =dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1;\n\tif(boolShow)\n\t{\n\t\tif(_swdoc.boolConfirmSupportUnits)\n\t\t{\n\t\t\tif(mainform.tb_avail_units.value!=\"Unlimited\")\n\t\t\t{\n\t\t\t\tif((mainform.tb_units_assigned.value*1) > (mainform.tb_avail_units.value*1))\n\t\t\t\t{\n\t\t\t\t\tif(MessageBox(\"The number of support units entered exceeds those available for the selected contract.  Are you sure you want to continue?\", MB_OKCANCEL | MB_ICONINFORMATION )==2)\n\t\t\t\t\t{\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.boolConfirmSupportUnits = false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn TRUE;\n}\n\n\n\/\/-- 08.02.2007 - NWJ - Check mandatory fields on the form for a given table\n\/\/--\t\t\t\t\talert user if need be and return false\t\t\t\t\t\t\nfunction check_mandatory_fields(strTable,oForm)\n{\n    for (var x = 0; x<oForm.elements.length;x++)\n    {\n        var element = oForm.elements[x];\n        if ((element.mandatory) && (element.text ==\"\"))\n        {\n            var colName = \"\";\n            var fieldName = \"(not specified)\";\n            if(element.dataRef!=\"\")\n            {\n            \tvar arrInfo = element.dataRef.split(\".\");\n            \tvar strTable = arrInfo[0];\n            \tvar colName = arrInfo[1];\n            \tvar fieldName = dd.tables[strTable].columns[colName.toLowerCase()].DisplayName;\n            }\n            MessageBox(\"The field '\" + fieldName + \"' is a mandatory field and must be completed.\");\n            return false;\n        }\n    }\n    return true;\n}\n\n\nfunction setup_form_mode()\n{\n\t\/\/-- always make sure fixcode desc is disabled\n\t_een(mainform.tb_fixcodedescription,false);\n\t\t\t\t\n\tvar bResolveByDefault = app.session.IsDefaultOption(ANALYST_DEFAULT_RESOLVEBYDEFAULT);\t\t\t\n\t\/\/-- if user does not have the right to close calls then only allow resolve\n\tif(!app.session.HaveRight(ANALYST_RIGHT_A_GROUP,ANALYST_RIGHT_A_CANCLOSECALLS))\n\t{\n\t\t_een(mainform.cb_callaction,false);\n\t\tbResolveByDefault = true;\n\t}\n\n\t\/\/-- do they have option to resolve\n\tif(!app.session.HaveRight(ANALYST_RIGHT_A_GROUP,ANALYST_RIGHT_A_CANRESOLVECALLS))\n\t{\n\t\t_een(mainform.cb_callaction,false);\n\t\tbResolveByDefault = false;\n\t}\n\t\n\t\/\/-- set the default selection for the call action pick list based on the DD entry \n\tif(bResolveByDefault)\n\t{\n\t\tif(_swdoc.boolIsQuickLogCall==false)\n\t\t{\n\t\t\t_ete(mainform.cb_callaction,\"Resolve Call\");\n\t\t}\n\t}\n\telse\n\t{\n\t\t_ete(mainform.cb_callaction,\"Close Call\");\n\t\t\t\t\n\t\t\/\/-- sandra 30-07-2007 -- Bug 58558 set to close if ResolveByDefault is switched off. \n\t\t_swdoc.boolClosing = true;\n\t}\t\t\n\n\t\/\/-- we are in a quicklog\n\tif(_swdoc.boolIsQuickLogCall!=false)\n\t{\n\t\t\/\/-- quick log states close call\n\t\tif(mainform.cb_callaction.text == \"Close Call\")\n\t\t{\n\t\t\t_swdoc.boolClosing = true;\n\t\t}\n\t}\n\t\n\t\/\/--\n\t\/\/-- disable \/ enable form fields\n\t_een(mainform.dt_actiontime,(app.session.CanBackdateCallActions())); \/\/-- can backdate ?\n\t_een(mainform.btnGetProfileText,false);\n\t_een(mainform.btnBrowseProfile,true);\n\t\n\t\/\/-- setup various flags\t\n\t_swdoc.setup_charge_flag(true);\n\t_swdoc.setup_kbase_flag();\t\n\t_swdoc.setup_email_flag();\n\t_swdoc.setup_public_flag();\n\t_swdoc.setup_survey_options();\n\n\t\/\/-- if we have a fixcode - see if we need to enable text button\n\t_een(mainform.btnGetProfileText,false);\n\tif(_swdoc.opencall.fixcode!=\"\")\n\t{\n\t\t\/\/-- nwj if it has a dec text enable button to copy\n\t\tvar currentResProfileDesc = app.global.GetResolutionProfileDescription(_swdoc.opencall.fixcode);\t\n\t\t_een(mainform.btnGetProfileText,(currentResProfileDesc.strDescription!=\"\"));\n\t}\n}\n\n\n\/\/-- 08.02.2007 - NWJ - One function to handle which standard check boxes should be enabled\/disabled\n\/\/--\t\t\t\t\tchecked or unchecked, as old code fglas were set all over the place\nfunction setup_public_flag()\n{\n\t_een(mainform.flg_updatepublic,true);\n\tif(_swdoc.boolIsQuickLogCall==false)\n\t{\n\t\t_ete(mainform.flg_updatepublic,(app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSEPRIVATE) ? \"1\":\"0\"));\n\t}\n}\n\nfunction setup_kbase_flag()\n{\n\t\/\/-- does the user have the right to add to the kbase or we are worknig with multiple calls so dont add\n\tif(!app.session.HaveRight(ANALYST_RIGHT_C_GROUP,ANALYST_RIGHT_C_CANADDTOKNOWLEDGEBASE))\n\t{\n\t\t_ete(mainform.flg_addKBase,\"0\");\n\t\t_een(mainform.flg_addKBase,false);\n\t}\n\telse\n\t{\n\t\tif(_swdoc.boolIsQuickLogCall==false)\n\t\t{\n\t\t\t_ete(mainform.flg_addKBase,(app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSEKNOWLEDGEBASE) ? \"1\":\"0\"));\n        }\n        _een(mainform.flg_addKBase,true);\n\t}\n}\n\nfunction setup_charge_flag(boolOnload)\n{\n\tif (_swdoc.boolClosing)\n\t{\n\t\t\/\/-- if not a quicklog call then set default\n\t\t_een(mainform.flg_chargeable,true);\n\t\tif((_swdoc.boolIsQuickLogCall==false)||(boolOnload==false))\n\t\t{\n\t\t\t_ete(mainform.flg_chargeable,(app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSECHARGABLE) ? \"1\":\"0\"));\n\t\t}\n\t}\n\telse\n\t{\n\t\t\/\/-- resolving\n\t\t_een(mainform.flg_chargeable,false);\n\t\t_ete(mainform.flg_chargeable,0);\n\t}\n}\n\nfunction setup_email_flag()\n{\n\t\/\/--\n\t\/\/-- if we have a mailserver and can send mail set flg\n\tif(app.global.IsConnectedToMailServer() && app.global.CanSendMail())\n\t{\n\t\t\/\/-- if not a quicklog call then set default\n\t\tif(_swdoc.boolIsQuickLogCall==false)\n\t\t{\n\t\t\t_een(mainform.flg_emailcustomer,true);\n\t\t\t_ete(mainform.flg_emailcustomer,((app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSESENDEMAIL)) ? \"1\":\"0\"));\n\t\t}\n\t}\n\telse\n\t{\n\t\t_een(mainform.flg_emailcustomer,false);\n\t\t_ete(mainform.flg_emailcustomer,\"0\");\n\t}\n}\n\n\/\/--\n\/\/-- initialise the surveys options\nfunction setup_survey_options()\n{\n\t\/\/-- if they do not have surveys hide options\n\tif(!app.global.IsSurveyModuleEnabled())\n\t{\n\t\t_ete(mainform.flg_customersurvey,\"0\");\n\t\t_evi(mainform.flg_customersurvey,false);\n\t\t_evi(mainform.cb_surveys,false);\n\t}\n\telse\n\t{\n\t\t\/\/-- get survey options\n\t\t_swdoc.load_survey_list();\t\n\n\t\t\/\/-- if we dont have surveys on the system then hide\n\t\tif(!_swdoc.boolHaveSurveys)\t\n\t\t{\n\t\t\t_ete(mainform.flg_customersurvey,\"0\");\n\t\t\t_een(mainform.flg_customersurvey,false);\n\t\t\t_evi(mainform.cb_surveys,false);\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t\/\/-- have to set to true because if you set to hidden in code and then dev form it saves the state\n\t\t_evi(mainform.flg_customersurvey,true);\n\t\t_evi(mainform.cb_surveys,true);\n\t\t\t\n\t\t\/\/-- not allowed to change send survey options or there arent any surveys to send\n\t\tif(app.session.IsDefaultOption(ANALYST_DEFAULT_DISABLESENDSURVEY)) \n\t\t{\n\t\t\t\/\/--code change DavidJH 09.06.05\n\t\t\t_een(mainform.flg_customersurvey,false);\n\t\t\t_ete(mainform.flg_customersurvey,\"0\");\n\t\t\treturn false;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_een(mainform.flg_customersurvey,true);\n\t\t}\n\t\t\n\t\t\/\/-- default ticked setting\n\t\t\/\/-- if not a quicklog call then set default\n\t\tif(_swdoc.boolIsQuickLogCall==false)\n\t\t{\n\t\t\tif(app.session.IsDefaultOption(ANALYST_DEFAULT_SETSENDSURVEY))\n\t\t\t{\n\t\t\t\t_ete(mainform.flg_customersurvey,\"1\");\n\t\t\t\t_een(mainform.cb_surveys,true);\t\t\t\t\t\t\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_ete(mainform.flg_customersurvey,\"0\");\n\t\t\t\t_een(mainform.cb_surveys,false);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction load_survey_list()\n{\n\t\/\/-- empty the picklist\n\tmainform.cb_surveys.pickList = \"\";\n\t\n\t\/\/-- select all of the system mailboxes and add all shared mailboxes to an array\n\tvar SqlRecordSetObj\t= new SqlQuery;\n\t\n\t\/\/-- select all of the surveys and the mailbox they are associated to\n\tSqlRecordSetObj.Reset();\n\tSqlRecordSetObj.InvokeStoredQuery(\"form\/resolvecloseform\/getsurveys\",\"\");\n\t\t\n\tvar str = \"\";\n\tvar selected = \"\";\n\tvar strTemps = new Array();\n\tbselecteddefaultsurvey = false;\n\t\n\t\/\/-- loop through the surveys and and match those associated to shared mailboxes\n\t\/\/-- for each survey add it into an array and to the pick list string and when the \n\t\/\/-- first survey is found identify it as the default option for the survey picklist\n\twhile(SqlRecordSetObj.Fetch())\n\t{\n\t\t\/\/-- get the recordset value for survey name and id\n\t\tvar surveyname = SqlRecordSetObj.GetValueAsString(\"surveyName\");\n\t\tvar surveyid = SqlRecordSetObj.GetValueAsString(\"surveyid\");\n\t\t\n\t\t\/\/-- add the survey name\/id pair into the array\n\t\t_swdoc.arrSurveyNameSurvIDs[surveyname] = surveyid;\n\t\t\n\t\t\/\/-- build the picklist\toptions string\t\n\t\tstr += surveyname + \"|\";\n\t\t\/\/MessageBox(surveyname)\n\t\t_swdoc.boolHaveSurveys=true;\n\t\t\/\/-- identify the default survey (currently the first one added)\n\t\tfor(ID in _swdoc.arrSurveyNameSurvIDs)\n\t\t{\n\t\t\tif(_swdoc.arrSurveyNameSurvIDs[ID])\n\t\t\t{\n\t\t\t\tif(!bselecteddefaultsurvey)\n\t\t\t\t{\n\t\t\t\t\tbselecteddefaultsurvey = true;\n\t\t\t\t\tselected = surveyname;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\t\n\t}\n\t\/\/-- populate the surveys pick list\n\tmainform.cb_surveys.pickList = str;\n\t\n\t\/\/-- set the default selected survey\n\t_ete(mainform.cb_surveys,selected);\n\t\n}\n\nfunction setup_support_unit_assignment()\n{\n\t\t\/\/-- empty the picklist\n\t\tmainform.lb_supp_contract.pickList = \"\";\n\t\t\n\t\tvar SqlRecordSetObj\t= new SqlQuery;\t\t\t\t\n\t\tSqlRecordSetObj.Reset();\n\t\tvar strParams = \"company=\"+pfu(app.g.strLogAndResolveCompany);\n\t\tSqlRecordSetObj.InvokeStoredQuery(\"form\/resolvecloseform\/get_contract_support_units\", strParams);\n\t\t\t\n\t\tvar str = \"\";\n\t\tvar selected = \"\";\n\t\tvar strTemps = new Array();\n\t\t\n\t\twhile(SqlRecordSetObj.Fetch())\n\t\t{\n\t\t\t\/\/-- get the recordset value for contract id and title\n\t\t\tvar contractname = SqlRecordSetObj.GetValueAsString(\"title\");\n\t\t\tvar contractid = SqlRecordSetObj.GetValueAsString(\"pk_contract_id\");\n\t\t\t\t\t\t\n\t\t\t\/\/-- add the name\/id pair into the array\n\t\t\t_swdoc.arrContractNameIDs[contractname] = contractid;\n\t\t\t\n\t\t\t\/\/-- build the picklist\toptions string\t\n\t\t\tstr += contractname + \"|\";\n\t\t\t\n\t\t\t\/\/-- identify the default contract (one selected against the call if set)\n\t\t\tfor(ID in _swdoc.arrContractNameIDs)\n\t\t\t{\n\t\t\t\tif(app.g.strLogAndResolveContract!=\"\")\n\t\t\t\t{\n\t\t\t\t\tif(contractid==app.g.strLogAndResolveContract)\n\t\t\t\t\t{\n\t\t\t\t\t\tselected = contractname;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/-- populate the surveys pick list\n\t\tmainform.lb_supp_contract.pickList = str;\n\t\t\n\t\t\/\/-- set the default selected survey\n\t\t_ete(mainform.lb_supp_contract,selected);\n\t\n\t\t\/\/-- Lookup units available for selected contract\n\t\t_swdoc.get_support_units_available(_swdoc.arrContractNameIDs[selected], mainform.tb_avail_units);\n\t\t\n\t\n}\n\nfunction get_support_units_available(strContractID, oEle)\n{\n\tif((strContractID!=\"\")&&(strContractID!=undefined))\n\t{\n\t\tvar recContract = new SqlRecord;\n\t\tif(recContract.GetRecord(\"contract\", strContractID))\n\t\t{\n\t\t\tif(recContract.flg_support_unlimited==1)\n\t\t\t{\n\t\t\t\t_eva(oEle,\"Unlimited\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_eva(oEle,recContract.support_units_avail);\n\t\t\t}\n\t\t}\n\t}\n}"},{"name":"OnExecuteAction","code":"OnExecuteAction(nAction)\n{\n\t\/\/-- trigger an action from a menu bar (shortcusts)\t\t\n\t\/\/-- attaching a call to the action.\n\tif(nAction == ATTACHFILETOCALL_ACTION)\n\t{\n\t\tmainform.btnAddFile_OnPressed();\n\t\treturn true;\n\t}\n\n\treturn true;\n}"},{"name":"OnValidate","code":"OnValidate()\n{\n\t\/\/-- validate the form\n\tif(!_swdoc.ValidateForm())return VALIDATE_FAIL;\n\t\t\n\treturn VALIDATE_OK;\n}"},{"name":"(Globals)","code":"\/\/-- ALL vars and funcs are in the userdefined js area"},{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strClass)\n{\n\t\/\/-- set the logmode and is quick call\n\tif(_swdoc._form[\"logmode\"])_swdoc.boolLogMode = true;\n\tif(_swdoc._form[\"preloadtype\"]==3)_swdoc.boolIsQuickLogCall = true;\n\n\t\n\t\t\t\t\t\t\t\t\n\n}"},{"name":"OnFormClosing","code":"OnFormClosing()\n{\n\tif(!_swdoc.boolFormFieldChanged)_swdoc.resetData();\n\treturn true;\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"561","height":"424","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"tb_updatetext","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"490","left":"690","right":"1215","bottom":"630"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"updatedb.updatetxt"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"true","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","displayColumnValue":"this is resolution two","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel2","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Details","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"250","left":"680","right":"1071","bottom":"423"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"name":"dt_actiontime","type":"Field"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"300","left":"680","right":"887","bottom":"318"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"updatedb.updatetimex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"1166205163","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_timespent","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"300","left":"900","right":"959","bottom":"318"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"updatedb.timespent"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Minute Time Period","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"11","properties":{"defaultValue":"5","activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"cb_actionsource","type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"330","left":"680","right":"887","bottom":"348"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"updatedb.udsource"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"E-mail","properties":{"disabledBackgroundColor":"#eeeeee","defaultValue":"Telephone","distinctTable":"swlists","distinctColumn":"value","borderColor":"#c0c0c0","sqlSource":"swdata","displayColumn":"display_name","listFilter":"lid=CALL-ACTION-SOURCE","storedQuery":"common.getSwList"}}},{"general":{"name":"tb_actiontype","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"330","left":"900","right":"1061","bottom":"348"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":"updatedb.udcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"Called Customer","properties":{"defaultValue":"General Update","listItems":"General Update|Called Customer|E-mailed Customer|","activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ACTION-TYPE","storedQuery":"common.getSwList"}}},{"general":{"name":"btnBrowseProfile","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","caption":"...","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"400","left":"1040","right":"1066","bottom":"421"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"-1"}}},{"general":{"name":"tb_fixcodedescription","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"400","left":"680","right":"1039","bottom":"418"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"Resolution 1 -> Resoltuon 2","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel3","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Options","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"250","left":"1080","right":"1234","bottom":"423"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"name":"flg_emailcustomer","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"300","left":"1080","right":"1196","bottom":"319"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"1","properties":{"activeTextColor":"#eeeeee","flagItems":"E-mail customer^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_updatepublic","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"280","left":"1080","right":"1209","bottom":"298"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"1","properties":{"activeTextColor":"#eeeeee","flagItems":"Update to be public^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_chargeable","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"320","left":"1080","right":"1221","bottom":"338"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"1","properties":{"activeTextColor":"#eeeeee","flagItems":"Call to be chargeable^1|","disabledBackgroundColor":"#eeeeee","defaultValue":"0"}}},{"general":{"name":"flg_addKBase","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"340","left":"1080","right":"1222","bottom":"359"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"0","properties":{"activeTextColor":"#eeeeee","flagItems":"Add to KnowledgeBase^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_customersurvey","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"380","left":"1080","right":"1238","bottom":"401"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"0","properties":{"activeTextColor":"#eeeeee","flagItems":"Send customer survey:^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"cb_surveys","type":"Field"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"400","left":"1080","right":"1210","bottom":"418"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Rect1","type":"Rectange","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"15","backgroundColor":"#d4d0c8","foregroundColor":"#dddddd","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"220","left":"670","right":"1236","bottom":"245"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"cb_callaction","type":"Field"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"230","left":"740","right":"887","bottom":"246"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"Close Call","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","listItems":"Close Call|Resolve Call|Close Call|Resolve Call|"}}},{"general":{"name":"btnGetProfileText","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"17","caption":"Get Profile Text","backgroundColor":"#ffffff","foregroundColor":"#0000ff","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"430","left":"1120","right":"1212","bottom":"451"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Tab1","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"18","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"460","left":"680","right":"1226","bottom":"641"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Description","properties":"56=#d1e0ee|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#d1e0ee"}}},{"name":"File Attachment","properties":"56=#ffcc66|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffcc66"}}},{"name":"Support Units","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"tabStyle":"0"}}},{"general":{"name":"fl_attachments","type":"FileListTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"true"},"group":"Tab1:1"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"488","left":"688","right":"1146","bottom":"632"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"File Name","width":"160","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Size","width":"80","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Last Modified","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Full Local Path","width":"100","image":"-1","dataColumn":"3"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"content":"NAME=css-bug-raising.gif;PATH=C:\\Documents and Settings\\NeilWJ\\My Documents\\css\\css-bug-raising.gif;SIZE=18746;LASTMODIFIED=1091525370","borderColor":"#c0c0c0"}}},{"general":{"name":"btnAddFile","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:1"},"appearance":{"index":"20","caption":"Add","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"488","left":"1155","right":"1219","bottom":"512"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"74","eventButtonIcon":"74"}}},{"general":{"name":"btnRemove","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:1"},"appearance":{"index":"21","caption":"Remove","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"518","left":"1155","right":"1219","bottom":"542"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"22","caption":"Action Source","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"320","left":"680","right":"753","bottom":"332"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"updatedb.udsource"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"LabelCode","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"23","caption":"Action Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"320","left":"900","right":"966","bottom":"332"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"updatedb.udcode"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"24","caption":"Date\/Time of Action","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"280","left":"680","right":"792","bottom":"294"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"25","caption":"Time Spent","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"280","left":"900","right":"964","bottom":"294"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"updatedb.timespent"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"ResolProfile","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"26","caption":"Resolution Profile","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"380","left":"680","right":"880","bottom":"394"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btnAddFile","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"27","caption":"Attach File","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"230","left":"1120","right":"1216","bottom":"253"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"74","eventButtonIcon":"74","backgroundColor":"#ff9900"}}},{"general":{"name":"LabelAction","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"28","caption":"Call Action:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"230","left":"680","right":"742","bottom":"247"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"tb_fixcode","type":"Field"},"appearance":{"index":"29","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"290","left":"1010","right":"1039","bottom":"307"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.fixcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"RSLT-RSLT","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"cp_summary1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"30","caption":"Other information","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"430","left":"680","right":"1234","bottom":"646"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"name":"flg_ftf","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"31","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"360","left":"1080","right":"1222","bottom":"379"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.flg_firsttimefix"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"First time fix achieved^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:2"},"appearance":{"index":"32","caption":"Associated Support Contract","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"488","left":"698","right":"849","bottom":"511"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_supp_contract","type":"Field","group":"Tab1:2"},"appearance":{"index":"33","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"488","left":"855","right":"1017","bottom":"508"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","sqlSource":"syscache","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:2"},"appearance":{"index":"34","caption":"Available Support Units","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"513","left":"732","right":"849","bottom":"535"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_avail_units","type":"Field","group":"Tab1:2"},"appearance":{"index":"35","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"513","left":"855","right":"1017","bottom":"533"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:2"},"appearance":{"index":"36","caption":"Units Spent On This Call","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"536","left":"710","right":"849","bottom":"560"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_units_assigned","type":"Field","group":"Tab1:2"},"appearance":{"index":"37","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"538","left":"855","right":"1017","bottom":"558"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.support_unit_cost"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee","defaultValue":"0"}}},{"general":{"name":"Text5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"38","caption":"The option to \"Show Resolve\/Close Details tab\" is disabled by default within the Data Dictionary.","backgroundColor":"#000000","foregroundColor":"#ff0000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"13","left":"16","right":"538","bottom":"44"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#000000"}}},{"general":{"name":"Text6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"39","caption":"Please use \"Log & Resolve\/Close\" action through the \"Actions\" menu or button to achieve this functionality.","backgroundColor":"#000000","foregroundColor":"#ff0000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"34","left":"16","right":"544","bottom":"65"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#000000"}}},{"general":{"name":"Rect2","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"40","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"13","left":"13","right":"535","bottom":"66"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\n\t\/\/-- set up the form mode\n\t_swdoc.setup_form_mode();\n\t\n\t\/\/-- set updatetime\t\n\t_swdoc.updatedb.updatetimex = app.global.GetCurrentEpocTime();\t\t\t\n\t_swdoc.UpdateFormFromData();\n\t\n\tvar boolShow =dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1;\n\tmainform.Tab1.ShowTabItem(2,boolShow);\n\tif(boolShow)\n\t{\n\t\t_swdoc.setup_support_unit_assignment();\n\t}\n\n\t\t\n}"},{"name":"btnBrowseProfile_OnPressed","code":"btnBrowseProfile_OnPressed()\n{\n\t\/\/-- get resolution profile filter\n\t\n\t\/\/-- NWJ - 29.06.2006 - get close filter or resolve filter depending on call closure option (requested by Dan 47766)\n\tif (cb_callaction.text == \"Resolve Call\")\n\t{\n\t\tvar Filter = dd.GetGlobalParamAsString(\"Close Call Form\/ResolveProfileFilter\");\n\t}\n\telse\n\t{\n\t\tvar Filter = dd.GetGlobalParamAsString(\"Close Call Form\/ProfileCodeFilter\");\n\t}\n\t\n\tvar objPC = new ChooseProfileCodeDialog;\n\t\/\/-- default analyst permission to auto fill the resolution text on resolve\/close call is set\n\n    objPC.useDescriptionText =  app.session.IsDefaultOption(ANALYST_DEFAULT_AUTOFILLRESOLUTIONTEXT); \n    objPC.Open(true, true, _swdoc.opencall.fixcode, Filter, function(pc)\n    {\n     \tif(!pc)\n     \t\treturn;\n     \t\t\n     \t\/\/-- Get the fix code and split it into an array\n        var strCodeDesc = pc.codeDescription;\n        var strCode = pc.code;\n        \n        \/\/-- If no codes are found then stop\n        if((strCode==\"\")||(strCode==_swdoc.opencall.fixcode)) return;\n        \n        \/\/-- Set the text in the resolution profile text box\n        \/\/-- 08.02.2007 - NWJ - set the opencall record value instead of the element name \n\t\t_swdoc.opencall.fixcode = strCode;   \n\t\t_ete(tb_fixcode,strCode);\n\t\t_ete(tb_fixcodedescription,strCodeDesc);\n        \n        \/\/-- Attempt to add the resolution profile description to the Action Description box if the\n        \/\/-- default analyst permission to auto fill the resolution text on resolve\/close call is set\n        if(pc.useDescriptionText)\n        {\n        \t\/\/-- 08.02.2007 - NWJ - set the opencall record value instead of the element name \n        \tvar strCurrentUpdateText = _swdoc.updatedb.updatetxt;           \t\n        \tif(pc.description.length)\n        \t{\n        \t\t\/\/if(tb_updatetext.text.length)\n        \t\tif(strCurrentUpdateText.length)\n\t\t\t\t{\n\t\t\t\t\tvar Message = \"You have chosen to transfer the default profile text into the description field of the close call form. However, you have already entered some text into this field. Do you want to append the text you have typed?\\n\\nTo append the default text to the text you have already typed, click Yes\\nTo transfer the default text and overwrite what you have already typed, click No\\nTo ignore the default text and leave the text you have typed alone, click Cancel\";\n\t\t\t\t\tswitch(MessageBox(Message, MB_ICONQUESTION | MB_YESNOCANCEL))\n\t\t\t\t\t{\n\t\t\t\t\tcase IDYES:\n\t\t\t\t\t\tif(_swdoc.updatedb.updatetxt.length)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t \/\/-- add a line feed\n\t\t\t\t\t\t\t strCurrentUpdateText += \"\\r\\n\";\n\t\t\t\t\t\t\t \/\/tempText = _swdoc.updatedb.updatetxt + \"\\r\\n\"; \n\t\t\t\t\t\t}\n\t\t\t\t\t\tstrCurrentUpdateText += pc.description;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase IDNO:\n\t\t\t\t\t\tstrCurrentUpdateText = pc.description;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase IDCANCEL:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstrCurrentUpdateText = pc.description;\n\t\t\t\t}\n        \t}\n        \t\n        \t\/\/-- add back to update record\n        \t_swdoc.updatedb.updatetxt = strCurrentUpdateText;\n        }\n        _swdoc.UpdateFormFromData();\n        \t\n\t\t\/\/-- if we are working with webclient\n\t\tif(app.bWebClient)\n\t\t{\n\t\t\t_een(btnGetProfileText,false);\n\t\t}\n\t\telse\n\t\t{\n\t\t   \t\/\/-- enable \/ disable button if it has text\n\t\t   \t_een(btnGetProfileText,(pc.description!=\"\"));\n        \t\n\t\t}\n    });\n}"},{"name":"btnAddFile_OnPressed","code":"btnAddFile_OnPressed()\n{\n\t\/\/-- add files\n\t\/\/fl_attachments.newFile = InvokeCallAttachmentFileDialog();\n\tfl_attachments.AddFiles();\n\n}"},{"name":"btnRemove_OnPressed","code":"btnRemove_OnPressed()\n{\n\t\/\/ -- remove selected files\n\tfor(i=fl_attachments.rowCount()-1; i>=0;i--)\n    {\n    \tif(fl_attachments.IsRowSelected(i))\n    \t{\n    \t\t\/\/-- remove\n    \t\tfl_attachments.RemoveRow(i);\n    \t}\n    }\n\n}"},{"name":"btnGetProfileText_OnPressed","code":"btnGetProfileText_OnPressed()\n{\n\tif(_swdoc.updatedb.updatetxt.length)\n\t{\n\t\tif(MessageBox(\"If you retrieve the default text description from the profile database you will overwrite the current Action Description text.\\n\\nDo you wish to continue?\", MB_ICONQUESTION | MB_YESNO) != IDYES)\n\t\treturn;\n\t}\n\t\n\t\/\/-- get resolution profile description\t\n\tvar currentResProfileDesc = app.global.GetResolutionProfileDescription(_swdoc.opencall.fixcode);\n\t_swdoc.updatedb.updatetxt = currentResProfileDesc.strDescription;\n\t_swdoc.UpdateFormFromData();\n}"},{"name":"checkCustomerSurvey_OnValueChanged","code":"checkCustomerSurvey_OnValueChanged(strValue)\n{\n\tvar bChecked = checkCustomerSurvey.text == \"1\";\n\t_een(Surveys , bChecked);\n}"},{"name":"(User Defined Functions)","code":"\n\/\/-- function to check that user has selected correct number of profile codes\nfunction check_profile_levels()\n{\n\t\/\/-- get the number of profile levels the analyst HAS to choose\n\tvar nLevelNeeded = app.session.GetCloseProfileLevelRequired();\n\n\t\/\/-- determine the number of Profile levels the user has selected\n\t\/\/-- NWJ - can we turn this into a app.global.i.e. app.global.returnProfileLevelCount(strProfileCode);\n\tvar strTempProfileCodes = new String(_swdoc.opencall.fixcode);\n\tvar nLevels = 0;\n\twhile(strTempProfileCodes.indexOf('-') != -1)\n\t{\n\t\tnLevels++;\n\t\tstrTempProfileCodes = strTempProfileCodes.substr((strTempProfileCodes.indexOf('-')+1),strTempProfileCodes.length);\n\t}\n\t\n\tif(strTempProfileCodes.length)nLevels++;\n\t\n\t\/\/-- If insufficient profile levels are specified then alert the user\n\tif(nLevels < nLevelNeeded)\n\t{\n\t\tMessageBox(\"You must profile this call resolution. Your access control rights require you to choose at least \" + nLevelNeeded + \" profile level(s)\", MB_ICONSTOP);\n\t\treturn false;\n\t}\n\t\n\treturn true;\n}\n\n\/\/-- add call to kbase\nfunction add_call_to_knowledgebase(nFirstCallref)\n{\n\tvar strProbText = \"\";\n\tvar strProbCode = \"\";\n\t\/\/-- get the problem text and problem code from updatedb\/opencall\n\t\n\tvar aRSInfo = new SqlQuery;\n\tvar strParams = \"crf=\"+pfu(nFirstCallref);\n\tvar aRSInfo = app.g.get_sqrecordset(\"form\/resolvecloseform\/get_details_for_kb\",strParams);\n\tif(aRSInfo.Fetch())\n\t{\n\t\tstrProbText = aRSInfo.GetValueAsString(0);\n\t\tstrProbCode = aRSInfo.GetValueAsString(1);\t\t\n\t}\n\taRSInfo.Reset();\t\n\t\n\t\/\/-- call api\n\t\/\/MessageBox(\"Add KB \" + _swdoc.updatedb.updatetxt)\n   \tapp.global.AddResolutionToKnowledgeBase(strProbText, strProbCode, _swdoc.updatedb.updatetxt, _swdoc.opencall.fixcode, nFirstCallref);\n}\n\n\/\/-- resolve or close the call\nfunction ResolveClose(intLoggedCallref)\n{\t\n\t\/\/-- validate the form\n\tif(!_swdoc.ValidateForm())return false;\n\t\n\t\/\/-- check profile levels\n\tif(!mainform.check_profile_levels())return false;\n\t\t\n\t\/\/-- determine status\n\tvar nStatus = CS_CLOSED;\n\tif(!_swdoc.boolClosing)\n\t{\n\t\tnStatus = CS_RESOLVED;\n\t}\n\telse\n\t{\n\t\t\/\/-- closing and chargeable?\n\t\tif(flg_chargeable.text == \"1\")\tnStatus = CS_CLOSEDCHARGABLE;\n\t}\n\t\t\n\t\/\/-- handle web client - any reason for this ??\n\tif((app.bWebClient && app.global==undefined)&&(_swdoc.boolClosing))\n\t{\n\t \tnStatus = CS_CLOSED;\n\t \t_ete(flg_chargeable,\"0\");\n\t}\t\n\n\t\/\/-- create a new HD connection and connection\n\tvar hdcon = new HelpdeskSession;\n\tif(!hdcon.Connect())return false;\n\n\t\/\/-- check if we are sending a survey\n\tvar bSendSurveyToCustomer = false;\n\tvar SurveyID = 0;\n\tvar SurveyName = \"\";\n\tif(app.global.IsSurveyModuleEnabled() && flg_customersurvey.text == \"1\" && cb_surveys.text.length)\n\t{\n\t\t\/\/-- get surveyid from the SurveyNameSurvIdMap\n\t\tSurveyName = cb_surveys.text;\t\t\n\t\tSurveyID = _swdoc.arrSurveyNameSurvIDs[SurveyName]; \n\t\tif(SurveyID!=undefined)bSendSurveyToCustomer = true;\n\t\n\t\t\/\/-- send survey request to the server\t\t\t\n\t\tif (bSendSurveyToCustomer)\n\t\t{\n\t\t\thdcon.SendCustomerSurvey(SurveyID, intLoggedCallref);\n\t\t}\n\t}\n\t\t\n\n\t\/\/-- NWJ - 08.02.2007 - We might want to update call values before closing i.e. for customisation\n\t\/\/-- update opencall fields - we need to do this by looping through form elements\t\n\t\/\/-- problem is BeginCallValueUpdates doesnt accept multiple callrefs so have to do a call update per callref\n\tvar arrUpdateCallValues = new Array();\n\tvar boolCallUpdates = false;\n\tvar rec = _swdoc.GetRecord(\"opencall\");\t\t\t\n\tif(rec)\n\t{\n\t\tvar nColCount = rec.GetCount();\n\t\tfor(x=0; x<nColCount; x++)\n\t\t{\n\t\t\tif(!rec.IsModified(x))continue;\n\t\t\tboolCallUpdates = true;\n\t\t\tarrUpdateCallValues[rec.GetColumnName(x)] = rec.GetValue(x);\n\t\t}\n\n\t\t\n\t\t\/\/-- if we have opencall values to update\n\t\tif(boolCallUpdates)\n\t\t{\n\t\t\t\/\/-- start to update this call\n\t\t\tif(hdcon.BeginCallValueUpdates(intLoggedCallref,\"On ResolveClose Call\"))\n\t\t\t{\n\t\t\t\t\/\/-- for each opencall field that needs updating send\n\t\t\t\tfor (fieldName in arrUpdateCallValues)\n\t\t\t\t{\n\t\t\t\t\thdcon.SendValue(\"opencall.\" + fieldName, arrUpdateCallValues[fieldName]);\n\t\t\t\t}\n        \t\thdcon.Commit();\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\/\/-- We start a new transaction to update the specified call (complex req)\n\tif(hdcon.BeginCloseCall(intLoggedCallref))\n\t{   \n    \tvar bSendSuccess = true;\n    \t\n       \t\/\/-- send update db values\n\t\tvar rec = _swdoc.GetRecord(\"updatedb\");\t\t\t\n\t\tif(rec)\n\t\t{\n\t\t\tvar nColCount = rec.GetCount();\n\t\t\tfor(x=0; x<nColCount; x++)\n\t\t\t{\n\t\t\t\t\/\/-- if not modified then continue\n\t\t\t\tif(!rec.IsModified(x))continue;\n\t\t\t\t\/\/-- send the false\n\t\t\t\tif(!hdcon.SendValue(\"updatedb.\" + rec.GetColumnName(x), rec.GetValue(x)))\n\t\t\t\t{\n\t\t\t\t\tbSendSuccess = false;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\n\t\t\/\/-- if send of info worked  \t\t\t\n    \tif(bSendSuccess && hdcon.SendNumber(\"status\", nStatus) && \n\t\t\thdcon.SendText(\"updatetxt\", tb_updatetext.text) &&    \t\t\t\t\n\t\t\thdcon.SendText(\"fixcode\", tb_fixcode.text) &&    \t\n\t \t\thdcon.SendNumber(\"backdateperiod\", _swdoc.nBackdatePeriod) &&\n\t   \t\thdcon.SendBoolean(\"publicupdate\", flg_updatepublic.text) &&\n\t   \t\thdcon.SendBoolean(\"delaycacheflush\", flg_emailcustomer.text) &&\n\t   \t\thdcon.SendNumber(\"timespent\", mainform.tb_timespent.value))\n\t\t{\n\t\t\n\t\t\t\/\/-- send attachments\n\t\t\tfor(i=0; i<fl_attachments.rowCount();i++)\n\t\t    {\n    \t\t\tif(!hdcon.SendFile(\"attach\", fl_attachments.GetItemText(i,0), fl_attachments.GetItemText(i,3)))\n    \t\t\t\treturn false;\n    \t\t}\n    \t\t\t\n    \t\t\/\/-- commit our data send\n    \t\tif(hdcon.Commit())\n    \t\t{\n    \t\t\t\/\/-- failed HD\n    \t\t\tif(!hdcon.GetResult()) return false;\n    \t\t\t\t\t\n    \t\t\t\/\/-- The returned data is in the format \"updateref=<callref>.<udindex>\"\n    \t\t\t\/\/-- The following regex will put the callref into arrCallInfo[1] and the udindex\n    \t\t\t\/\/-- into arrCallInfo[2]\n    \t\t\tvar arrCallInfo = hdcon.GetCallUpdateResultData();\t\n    \t\t\t\n    \t\t\t\/\/ If we have been invoked to update a call from an e-mail message, this update will \n\t\t\t\t\t\/\/ only relate to a single call. We can only handle e-mail audit trail if we are working\n\t\t\t\t\t\/\/ on a single-call update.\n\t\t\t\t\tif(_swdoc._form[\"messagesource\"] && \t\/\/ Are we woring from an e-mail message?\n\t\t\t\t\t\tdd.GetGlobalParamAsNumber(\"Email Audit Trail\/StoreEmailAuditTrail\")) \/\/ Are we configured?\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/ The message source string contains the \"mailbox name\\message id\". We need \n\t\t\t\t\t\t\/\/ to split these out for the following function\n\t\t\t\t\t\tvar arrMsgInfo = _swdoc._form[\"messagesource\"].split('\\\\');\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/ Check config to see if we need to include the file attachments in the message too\n\t\t\t\t\t\tvar bIncludeAttachments = dd.GetGlobalParamAsNumber(\"Email Audit Trail\/IncludeAttachmentsInMessage\");\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/ We need to specify the folder to which the message should be moved to based\n\t\t\t\t\t\t\/\/ on the options set in the DD. \n\t\t\t\t\t\tvar strMoveMessageToFolder = \"\";\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/ Next, see if we have specified a specific folder to move the message to\n\t\t\t\t\t\tstrMoveMessageToFolder = dd.GetGlobalParamAsString(\"Mail Move Folders\/CloseCallMailFolder\");\n\t\t\t\t\t\t\n\t\t\t\t\t\tif (strMoveMessageToFolder.length == 0)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\/\/ First we see if the config tells us to move the message to the deleted items folder\n\t\t\t\t\t\t\tif(dd.GetGlobalParamAsNumber(\"Email Audit Trail\/MoveToDeletedItems\"))\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstrMoveMessageToFolder = \"Deleted Items\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/ As we are going to use the Email Subject in the name of the audit trail file we are saving\n\t\t\t\t\t\t\/\/ we need to check it for characters that are invalid in a filename and replace them with \"-\"\n\t\t\t\t\t\t\tvar strEmailSubject = \"\";\n\t\t\t\t\t\t\tif(_swdoc._form[\"subject\"])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tstrEmailSubject = replaceIllegalFileCharacters(_swdoc._form[\"subject\"]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/ The following function does a number of things. It tells the server to encode\n\t\t\t\t\t\t\/\/ and attach the specified message to the call. It sets the state icon of the \n\t\t\t\t\t\t\/\/ call update to \"mail-received\" in this instace. If the strMoveMessageToFolder\n\t\t\t\t\t\t\/\/ contains a valid folder, it will move the specified mail message to the folder\n\t\t\t\t\t\tif(!app.global.AttachMessageToCall(arrMsgInfo[0], \t\t\t\t\t\t\t\t\/\/ Mailbox name\n\t\t\t\t\t\t\t\t\t\t\t\tarrMsgInfo[1], \t\t\t\t\t\t\t\t\/\/ Message ID\n\t\t\t\t\t\t\t\t\t\t\t\t\"Received-\" + strEmailSubject + \".swm\", \t\/\/ File name\n\t\t\t\t\t\t\t\t\t\t\t\tintLoggedCallref, \t\t\t\t\t\t\t\/\/ Call reference\n\t\t\t\t\t\t\t\t\t\t\t\tarrCallInfo[intLoggedCallref],\t\t\t\t\/\/ UdIndex\n\t\t\t\t\t\t\t\t\t\t\t\t\"mail-received\",\t\t\t\t\t\t\t\/\/ Indicate that this is a received message\n\t\t\t\t\t\t\t\t\t\t\t\tbIncludeAttachments,\t\t\t\t\t\t\/\/ Include File attachments?\n\t\t\t\t\t\t\t\t\t\t\t\tstrMoveMessageToFolder))\t\t\t\t\t\/\/ Move the message to this folder\n\t\t\t\t\t\t{\n\t\t\t\t    \t\tMessageBox(\"There was an error attaching the originating e-mail to this call.\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tapp.global.CloseMailMessageWindow(arrMsgInfo[1]);\n\t\t\t\t\t\t}\n\t\t\t\t    }\n\n    \t\t\t\n       \t\t\t\/\/-- add knowledge base\tbut only if we have one call\n    \t\t\tif(flg_addKBase.text == \"1\")\n    \t\t\t{\n    \t\t\t\tadd_call_to_knowledgebase(intLoggedCallref);\n    \t\t\t}\n    \t\t\t    \t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\/\/-- if we want to send an email to the customer AND there are file attachments, obtain the \n    \t\t\t\/\/-- attachments to attach to the email as well\t\n\t\t\t\tif(mainform.flg_emailcustomer.value && app.global.IsConnectedToMailServer())\n   \t\t\t\t{\n    \t\t\t\t\/\/-- OK, we are going to send the customer(s) an e-mail message to confirm the \n\t\t\t\t\t\/\/-- call closure. If we have uploaded file attachments, we can ask the session\n\t\t\t\t\t\/\/-- for a list of the files. If available, the session variables will include\n\t\t\t\t\t\/\/-- a _serverpath variable for each file. The returned list, is a list of \n\t\t\t\t\t\/\/-- strings that is suitable for passing to the compose message function\t\n\t\t\t\t\tapp.global.ComposeCallUpdateEmail(arrCallInfo,\t\t\t\/\/Array: Call Reference-UdIndex\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttb_updatetext.text, \t\t\/\/Message Text\n\t\t\t\t\t\t\t\t\t\t\t\t\t\thdcon.GetSessionFileInfo(), \/\/File Attachments\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttb_timespent.text,\t\t\t\/\/Time spent on Last Action\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"CloseCallMailTemplate\", \t\/\/Template Name\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tTEMPLATE_CLOSECALL );\t\t\/\/Template Type\n\t\t\t\t}\n\t\t\t\t    \n    \t\t\thdcon.Close();\t\n    \t\t\t_swdoc.boolFormFieldChanged = false;\t\t\n\t\t\t\t_swdoc.resetData();    \t\t\t\n    \t\t\t_swdoc.CloseForm();\n    \t\t\treturn true;\t\n    \t\t}\n\t\t    else\n\t\t    {\n\t\t    \tMessageBox(hdcon.GetLastErrorStr());\n\t\t    }\/\/-- if(hdcon.Commit())\n\t\t}\n\t\telse\n\t\t{\n\t\t    \tMessageBox(hdcon.GetLastErrorStr());\n\t\t}\/\/-- if send of info worked  \t\t\t\n\t}\n\t\n\t\/\/-- if we got here we failed\n\thdcon.Close();\n\treturn false;\n}\n\nfunction getReadableDatefromEpoch(dt_epochdate)\n{\n\tvar strFormattedDate = \"\";\n\tvar theDate = new Date(dt_epochdate);\n\tdateString = theDate.toString();\n\tarrDateStr = dateString.split(\" \");\n\tstrFormattedDate = arrDateStr[2] + \"\/\" + getNumericMonth(arrDateStr[1]) + \"\/\" + arrDateStr[3] + \" \" + arrDateStr[4].substr(0,2) + \":\";\n\tstrFormattedDate += arrDateStr[4].substr(3,2) + \":\" + arrDateStr[4].substr(6,2);\n\treturn strFormattedDate;\n}\n\nfunction getNumericMonth(strMonth)\n{\n\tvar arrMonth = new Array(\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\");\n\tfor(i=0; i<arrMonth.length; i++)\n\t{\n\t\tif(strMonth == arrMonth[i])\n\t\t\treturn i+1;\n\t}\n}\n\nfunction replaceIllegalFileCharacters(strText)\n{\n\t\/\/-- This function is used to replace characters in the passed in string that \n\t\/\/-- are not suitable for use in filenames and return the modified string \n\t\n\tstrOutput = strText;\n\tstrReplacement = \"-\";\n\tvar i = 0;\n\t\n\twhile(i < strOutput.length)\n\t{\n\t\tstrOutput = strOutput.replace('\/', strReplacement);\n\t\tstrOutput = strOutput.replace(':', strReplacement);\n\t\tstrOutput = strOutput.replace('*', strReplacement);\n\t\tstrOutput = strOutput.replace('?', strReplacement);\n\t\tstrOutput = strOutput.replace('\"', strReplacement);\n\t\tstrOutput = strOutput.replace('\\'', strReplacement);\n\t\tstrOutput = strOutput.replace('<', strReplacement);\n\t\tstrOutput = strOutput.replace('>', strReplacement);\n\t\t\n\t\ti++;\n\t}\n\t\n\treturn strOutput;\n}"},{"name":"cb_callaction_OnValueChanged","code":"cb_callaction_OnValueChanged(strValue)\n{\n\t\/\/-- set mode and then setup defaults for that mode\n\t_swdoc.boolClosing = (strValue!=\"Resolve Call\");\n\t_swdoc.setup_charge_flag(false);\n\n}"},{"name":"flg_customersurvey_OnValueChanged","code":"flg_customersurvey_OnValueChanged(strValue)\n{\n\t\/\/-- enable disable\n\tvar bChecked = flg_customersurvey.text == \"1\";\n\t_een(cb_surveys,bChecked);\n\n}"},{"name":"OnFieldValueChanged","code":"OnFieldValueChanged(strName, strValue)\n{\n\t\/\/-- This value is set when a field value has been changed.\n\t\/\/-- We check this variable on from closing to see if there are any data changes that need to be saved.\n\t_swdoc.boolFormFieldChanged = true;\n\n\n}"},{"name":"dt_actiontime_OnValueChanged","code":"dt_actiontime_OnValueChanged(strValue)\n{\n\n\t\/\/-- NWJ - 09.02.2007 - Back date call\n\tvar nBackdatePeriod = 0;\n\t\n\t\/\/--Calculate the BackDate Period\n    var currentTime\t= app.global.GetCurrentEpocTime() ;\n\tvar updateDateTime = dt_actiontime.text;\n\tnBackdatePeriod = currentTime - updateDateTime;\n\t\t\t\n\t\/\/-- If attempted to forward date then deny\n\tif(nBackdatePeriod < 0)\n\t{\n\t\tMessageBox(\"You have attempted to forward date this call update which is not allowed.\");\n\t\tnBackdatePeriod=0;\t\n\t}\n\telse\n\t{\n\t\n\t\t\/\/-- If backdate period > the analyst max backdate period then prompt to use current time or cancel\n\t\tif(nBackdatePeriod > app.session.GetMaxBackdatePeriodAllowed())\n\t\t{\n\t\t\tvar dTime\t= new Date();\n\t\t\tdTime = (currentTime - app.session.GetMaxBackdatePeriodAllowed()) * 1000;\n\t\t\tvar message = \"You have attempted to backdate this call update further than you have sufficient privileges to do so.\\n\\nDo you want to use the oldest date\/time that you are allowed: \";\n\t\t\tif(MessageBox(message + mainform.getReadableDatefromEpoch(dTime), MB_ICONQUESTION | MB_YESNO) != IDYES)\t\n\t\t\t{\n\t\t\t\tnBackdatePeriod = 0;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- update field\n\t\t\t\tnBackdatePeriod = app.session.GetMaxBackdatePeriodAllowed();\n\t\t\t\t_swdoc.updatedb.updatetimex = app.global.GetCurrentEpocTime() - nBackdatePeriod;\t\t\t\t\n\t\t\t}\n\t\t}\n\t}\t\t\n\t\n\t\/\/Set the _swdoc level variable for use in the resolve\/close and return true\n\tif(nBackdatePeriod==0)\n\t{\n\t\t_swdoc.updatedb.updatetimex = app.global.GetCurrentEpocTime();\t\n\t}\n\t\n\t_swdoc.nBackdatePeriod = nBackdatePeriod;\n\t_swdoc.UpdateFormFromData();\n\t\n}"},{"name":"lb_supp_contract_OnValueChanged","code":"lb_supp_contract_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t\/\/-- Lookup units available for selected contract\n\tif(strValue!=\"\")\n\t{\n\t\t_swdoc.get_support_units_available(_swdoc.arrContractNameIDs[strValue], mainform.tb_avail_units);\n\t}\n\telse\n\t{\n\t\t_eva(mainform.tb_avail_units,0);\n\t}\n\n}"},{"name":"Tab1_OnTabSelected","code":"Tab1_OnTabSelected(nTab)\n{\n\tif(nTab==2)\n\t\t_swdoc.setup_support_unit_assignment();\n}"},{"name":"OnShowWindow","code":"OnShowWindow(bShow)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tif(bShow)\n\t{\n\t\tif(mainform.Tab1.tab==2)\n\t\t{\n\t\t\tTab1_OnTabSelected(2);\n\t\t}\n\t}\n\t\n}"},{"name":"tb_units_assigned_OnValueChanged","code":"tb_units_assigned_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.boolConfirmSupportUnits = true;\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}