{"espForm":{"configuration":{"settings":{"name":"Change Proposal","title":"Log New Change Proposal","callClass":"Change Proposal","profileFilter":"code_status not like 'deactivate%'","options":{"showExtendedDetails":"true","showWorkflow":"false","showFileAttachments":"true","showAffectedCustomers":"false","showAffectedContacts":"true","showCustomHtmlTab":"false","showPartsUsedTab":"false","allowLog":"true","allowLogAssign":"true","allowLogAccept":"true","allowLogClose":"true","allowLogAcceptTake":"true","showMassageBar":"false","showCloseDetails":"false","useEmailDateToLogCall":"false","hideToolbar":"false","hideMenubar":"false","hideFromMenu":"false","extendedDetailsTable":{"title":"Associated Information"}}},"tables":{"table":[{"name":"opencall","type":"Main Details Table","flags":"0"},{"name":"updatedb","type":"Diary Updates Table","flags":"0"},{"name":"itsm_opencall_rfc","type":"Extended Details Table","description":"Associated Information","mainDetailsColumn":"callref","recordPicklist":"Customer","addRecordForm":"Form.tfCustomer","editRecordForm":"Form.tfCustomer","flags":"0"},{"name":"userdb","type":"Related Table","description":"Customer Details","mainDetailsColumn":"cust_id","recordPicklist":"Customer","addRecordForm":"Form.tfCustomer","editRecordForm":"Form.tfCustomer","flags":"0","assignments":{"assignment":[{"expression":"keysearch","masterRecordColumn":"opencall.cust_id"},{"expression":"firstname + \" \" + surname","masterRecordColumn":"opencall.cust_name"},{"expression":"postcode","masterRecordColumn":"opencall.postcode"},{"expression":"fk_manager","masterRecordColumn":"opencall.bpm_managerid"}]}},{"name":"bpm_workflow","type":"Related Table","mainDetailsColumn":"bpm_workflow_id","recordPicklist":"Business Process","flags":"0","assignments":{"assignment":{"expression":"pk_workflow_id","masterRecordColumn":"opencall.bpm_workflow_id"}}},{"name":"company","type":"Related Table","mainDetailsColumn":"fk_company_id","recordPicklist":"Company","addRecordForm":"Form.TfCompany","editRecordForm":"Form.TfCompany","flags":"0","assignments":{"assignment":[{"expression":"companyname","masterRecordColumn":"opencall.companyname"},{"expression":"pk_company_id","masterRecordColumn":"opencall.fk_company_id"}]}}]},"showMeItems":{"action":[{"name":"Change Customer","id":"9","attrib1":"Customer","displayName":"Change Customer"},{"name":"Customer Properties","id":"2","attrib1":"Form.TfCustomer","attrib2":"&[userdb.keysearch]","displayName":"Customer Properties"},{"name":"Organisation Properties","id":"2","attrib1":"Form.TfCompany","attrib2":"&[company.pk_company_id]","displayName":"Organisation Properties"},{"name":"Search CIs to Change","id":"3","attrib1":"search_for_cis();","displayName":"Search CIs to Change"},{"name":"Search Services to Change","id":"3","attrib1":"search_for_services();","displayName":"Search Services to Change"},{"name":"Selfservice Wizard Input","id":"3","attrib1":"if(_swdoc.OC().logcall_source=='SELFSERVICE')\r\n{\r\n    var strParams = 'in_callref='+_swdoc.OC().callref;\r\n    var intCount = app.g.get_sqrecordset(\"call\/common\/count_wiz_qs\",strParams);\r\n    if(intCount>0)\r\n    {\r\n \t\tvar strServer = '&[app.webroot]';\r\n\t\tvar strCurrentdd = '&[app.currentdd]';\r\n\r\n\t\tapp.global.OpenHtmlWindow(\"wssm_wiz_input\", \"frame\", strServer + \"\/clisupp\/details\/\"+ strCurrentdd +\"\/wssm_wiz_input.php?sessionid=\"+app.session.sessionId+\"&fk_callref=\"+_swdoc.OC().callref, \"Selfservice Wizard Input\", true, 950, 700);\r\n    }\r\n    else\r\n    {\r\n        MessageBox(\"resolved call count = \" + intCount);\r\n    }\r\n}\r\nelse\r\n{\r\n\tMessageBox('Call was not logged via selfservice.')\r\n}","displayName":"Selfservice Wizard Input"},{"name":"Store Resolution Details","id":"3","attrib1":"strURL= \"company_code=\"+_swdoc.oCompany().pk_company_id;\r\n        \r\nif (_swdoc.OC().custom_i3){\r\n        app.OpenFormForEdit(\"itsmEfQLogResCloseData\", _swdoc.OC().custom_i3,strURL,true, function(aForm){});\r\n}       \r\nelse\r\n{\r\n\tapp.OpenFormForAdd(\"itsmEfQLogResCloseData\", \"\", strURL, true, function(aForm){\r\n\t\tif (aForm)\r\n\t\t{\r\n\t\t\tvar newRecId = aForm.document.record_id;\r\n\t\t\tif (newRecId != \"\"){\r\n\t\t\t\t_swdoc.OC().custom_i3 = newRecId;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tMessageBox(\"No Resolution \/ Closure details were created. If this form is saved as a Quick Log Call, there will be no Resolution \/ Closure details.\");\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}","displayName":"Store Resolution Details"}]},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\nvar _kbidentifier = app.session.sessionId+app.global.GetCurrentEpocTime();\n\nvar boolFormLoaded = false;\nvar boolRFCTitleSetManually = false;\nvar boolResolvingCust = false;\nvar strSearchFor = \"\";\n\n\/\/###\nvar strPreSelectedCompany = \"\";\n\/\/ store CI IDs for each company\nvar multi_companyCIIDS = new Array();\n\nvar companyCIIDS = \"\";\n\nvar strDefaultImpact = \"\";\nvar strDefaultUrgency = \"\";\nvar strCurrentPriority = \"\";\nvar strCurrentSLADef = 0;\nvar strCurrentSLAName = \"\";\n\nvar boolSLAEnforced = false;\nvar boolChangeSLASetManually = false;\nvar boolChangeProfile = false;\nvar arrOrigSettings = new Array();\n\n\/\/ DTH: 20120131 \nvar boolILAEnabled = false; \/\/ Impact Level Assessment Enabled\nvar boolILAMandatory = false; \/\/ Impact Level Assessment Mandatory\nvar boolILAAllowAlteration = false; \/\/ Impact Level Assessment Allow Alteration\nvar strILAOptions = \"\"; \/\/ Will contain a comma separated string of the ID's of selected ILA Options\n\n\/\/-- F0105032\nvar oOpencall = null;\nvar oExtended = null;\n\/\/-- EOF F0105032\n\n\nvar strSLACallClass = \"Change Proposal\";\n\n\n\/\/ DTH: F0097668 Lead Time Check\nvar arrImpactLeadTimes = new Array();\n\n\/\/-- RJC\nvar arrABAAssocTypes = new Array();\n\/\/-- NWJ\n\/\/-- record pointers\nfunction OC()\n{\n\treturn _swdoc.opencall;\n}\n\nfunction RFC_EXT()\n{\n\treturn _swdoc.itsm_opencall_rfc;\n}\n\n\/\/-- form pointers\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction EF()\n{\n\treturn extform;\n}\n\nfunction oCust()\n{\n\treturn _swdoc.userdb;\n}\n\nfunction oCompany()\n{\n\treturn _swdoc.company;\n}\n\n\n\/\/###20120801\nfunction multi_c_set_company(companyId){\n\n\tvar c = app.g.get_record(\"company\", companyId);\n\t\n\t\n\tif (c){\n\t\t_swdoc.OC().fk_company_id = c.pk_company_id;\t\n\t\t_swdoc.OC().companyname = c.companyname;\n\t\t\n\t\t_eva(_swdoc.MF().pl_oc_org , c.pk_company_id);\n\t\t_ete(_swdoc.MF().pl_oc_org , c.pk_company_id);\n\t\t_swdoc.MF().pl_oc_org.display = c.companyname;\n\t\t\n    \t_swdoc.set_org_filter();\n\t}\n}\n\nfunction set_org_filter(){\n \tif (\"\"!=_swdoc.OC().cust_id){\n\t\tvar strKeyValues = \"pk_company_id=\"+pfu(_swdoc.OC().fk_company_id) + \"&fk_user_id=\"+pfu(_swdoc.OC().cust_id);\n\t\t_slf(_swdoc.MF().pl_oc_org , strKeyValues);\n\t} else {\n\t\t_slf(_swdoc.MF().pl_oc_org , \"pk_company_id=\");\n\t}\n\tvar strCompFilter = \"_swc_fk_company_id=\" + _swdoc.MF().pl_oc_org.value;\n\t_slf(_swdoc.MF().fld_oc_dept , strCompFilter);\n\t_slf(_swdoc.MF().lb_oc_site1 , strCompFilter);\n\t_slf(_swdoc.MF().lb_oc_cc1 , strCompFilter);\n\n\t_swdoc.OC().site = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().site;\n\t_swdoc.OC().fk_dept_code = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().department;\n\t_swdoc.OC().costcenter = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().costcenter;\n\t_swdoc.OC().fk_contract_id = \"\";\n\t_swdoc.handle_set_contract(\"\");\t\n\t_swdoc.UpdateFormFromData();\n}\n\n\n\n\/\/-- given an analyst object (from app.global.js) load values for either monitored \/ raised by analyst\n\/\/-- for the rfc\nfunction set_rfc_analyst(oAnalyst,boolMonitoredBy)\n{\n\tif(!oAnalyst) \n\t{\n\t\t\/\/-- invalid so clear fields\n\t\toAnalyst = app.g.get_blank_analyst();\n\t}\n\t\n\tif(boolMonitoredBy)\n\t{\n\t\t_swdoc.RFC_EXT().monitored_by_analystid = oAnalyst.id;\n\t\t_swdoc.RFC_EXT().monitored_by_name = oAnalyst.name;\n\t\t_swdoc.RFC_EXT().monitored_by_group = oAnalyst.supportgroup;\n\t\t_swdoc.RFC_EXT().monitored_by_telephone =  oAnalyst.telephone;\n\t\t_swdoc.RFC_EXT().monitored_by_email = oAnalyst.email;\t\n\t}\n\telse\n\t{\n\t\t_swdoc.RFC_EXT().raised_by_analystid = oAnalyst.id;\n\t\t_swdoc.RFC_EXT().raised_by_name = oAnalyst.name;\n\t\t_swdoc.RFC_EXT().raised_by_group = oAnalyst.supportgroup;\n\t\t_swdoc.RFC_EXT().raised_by_telephone =  oAnalyst.telephone;\n\t\t_swdoc.RFC_EXT().raised_by_email = oAnalyst.email;\n\t}\n\t_swdoc.UpdateFormFromData();\t\n}\n\n\n\/\/-- given a ci or list of cis link it to problem cause list\nfunction link_cause_cis_to_change(strLinkCIs)\n{\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_configitems1, strLinkCIs,0);\n\t\n\tvar arrCIs = strLinkCIs.split(\",\");\n\t\n\t\/\/Bespoke Terms variables\n\tvar itemType = \"Configuration Item\";\t\n\t\/\/--End of Bespoke Terms variables\n\t\n\tfor(var x = 0; x<arrCIs.length; x++)\n\t{\n\t\tvar oCI = app.g.get_record('config_itemi', arrCIs[x]);\n\t\tvar strParams = \"ci_item=\"+oCI.ck_config_item;\n   \t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_ci_abas\",strParams);\n\t\twhile(oRS.Fetch())\n\t\t{\n\t\t\tstrABA = app.g.get_field(oRS,\"FK_BUS_AREA_ID\");\n\t\t\t_swdoc.arrABAAssocTypes[strABA] = \"CI\";\n\t\t\/\/\tapp.g.sl_kv_appendfilter(_swdoc.MF().sl_ABAs1, strABA,0);\n\t\t\tvar strKeys = app.g.sqllist_get_valuesdel(_swdoc.MF().sl_ABAs1, \"pk_area_id\", \",\", \"\");\t\n\t\t\tif(strKeys!=\"\")strKeys+=\",\";\n\t\t\tvar strParams = \"aid=1&_kv=\"+strKeys+strABA;\n\t\t\t_slf(_swdoc.MF().sl_ABAs1,strParams);\n\t\t\t_swdoc.MF().sl_ABAs1.Refresh();\n\t\t}\n\t}\n\tbespokeTermsProcessing(strLinkCIs, itemType);\n\t\/\/END OF BESPOKE TERMS PROCESSING\n\t\n\t\/\/-- if only 1 CI use it default profile unless blank\n\tif(_swdoc.EF().sl_configitems1.rowCount()==1)\n\t{\n\t\tvar strCode = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems1,0,\"fk_profilecode\");\n\t\tif(strCode!=\"\")\n\t\t{\n\t\t\t_swdoc.OC().probcode = strCode;\n\t\t\t_swdoc.UpdateFormFromData();\t\t\n\t\t}\n\t}\n\t_swdoc.EF().sl_configitems1.Refresh();\n}\n\n\/\/-- given a ci or list of cis link it to problem cause list\nfunction link_cause_services_to_change(strLinkCIs)\n{\n\t\/\/-- F0101301\n\tvar arrCIs = strLinkCIs.split(\",\");\n\t\n\t\/\/Bespoke Terms variables\n\tvar countBespokeTerms = 0;\n\tbespokeTermsArray = new Array();\n\tvar itemType = \"Service\";\t\n\t\/\/--End of Bespoke Terms variables\n\t\n\tfor(var x = 0; x<arrCIs.length; x++)\n\t{\n\t\tvar oCI = app.g.get_record('config_itemi', arrCIs[x]);\n\t\tvar strParams = \"ci_item=\"+oCI.ck_config_item;\n   \t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_ci_abas\",strParams);\n\t\twhile(oRS.Fetch())\n\t\t{\n\t\t\tstrABA = app.g.get_field(oRS,\"FK_BUS_AREA_ID\");\n\t\t\t_swdoc.arrABAAssocTypes[strABA] = \"CI\";\n\t\t\/\/\tapp.g.sl_kv_appendfilter(_swdoc.MF().sl_ABAs1, strABA,0);\n\t\t\tvar strKeys = app.g.sqllist_get_valuesdel(_swdoc.MF().sl_ABAs1, \"pk_area_id\", \",\", \"\");\t\n\t\t\tif(strKeys!=\"\")strKeys+=\",\";\n\t\t\tvar strParams = \"aid=1&_kv=\"+strKeys+strABA;\n\t\t\t_slf(_swdoc.MF().sl_ABAs1,strParams);\n\t\t\t_swdoc.MF().sl_ABAs1.Refresh();\n\t\t}\n\t\t\n\t\t\/\/ -- SG, 21\/08\/2012, F0103324\n\t\t\/\/ Process Bespoke Terms\n\t\tif(oCI && oCI.recordresolvedmsg != '')\n\t\t{\n    \t\tbespokeTermsArray[countBespokeTerms] = new Array(2);\n    \t\tbespokeTermsArray[countBespokeTerms][0] = oCI.ck_config_item;\n    \t\tbespokeTermsArray[countBespokeTerms][1] = oCI.recordresolvedmsg;\n    \t\tcountBespokeTerms++;\n\t\t}\n\t}\n\tbespokeTermsOutput(bespokeTermsArray, arrCIs.length, itemType);\n\t\/\/END OF BESPOKE TERMS PROCESSING\n\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_services, strLinkCIs,0);\n\n\t\/\/-- if only 1 CI use it default profile unless blank\n\tif(_swdoc.EF().sl_services.rowCount()==1)\n\t{\n\t\tvar strCode = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"fk_profilecode\");\n\t\tif(strCode!=\"\")\n\t\t{\n\t\t\t_swdoc.OC().probcode = strCode;\n\t\t\t_swdoc.UpdateFormFromData();\t\t\n\t\t}\n\t}\n\t_swdoc.EF().sl_services.Refresh();\n\n}\n\n\/\/-- given a ci or list of cis link it to problem affect list\nfunction link_affect_cis_to_change(strLinkCIs)\n{\n\t\n\t\/\/Bespoke Terms variables\n\tvar arrCIs = strLinkCIs.split(\",\");\n\tvar countBespokeTerms = 0;\n\tbespokeTermsArray = new Array();\n\tvar itemType = \"Configuration Item\";\t\n\t\/\/--End of Bespoke Terms variables\n\t\n\tfor(var x = 0; x<arrCIs.length; x++)\n\t{\n\t\t\/\/ -- SG, 21\/08\/2012, F0103324\n\t\t\/\/ Process Bespoke Terms\n\t\tvar pk_ci_id = arrCIs[x];\n\t\tvar rec = app.g.get_record(\"config_itemi\", pk_ci_id);\n\t\tif(rec && rec.recordresolvedmsg != '')\n\t\t{\n    \t\tbespokeTermsArray[countBespokeTerms] = new Array(2);\n    \t\tbespokeTermsArray[countBespokeTerms][0] = rec.ck_config_item;\n    \t\tbespokeTermsArray[countBespokeTerms][1] = rec.recordresolvedmsg;\n    \t\tcountBespokeTerms++;\n    \t\tMessageBox(countBespokeTerms);\n\t\t}\n\t}\n\tbespokeTermsOutput(bespokeTermsArray, arrCIs.length, itemType);\n\t\/\/END OF BESPOKE TERMS PROCESSING\t\n\t\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_impactcis1, strLinkCIs,\"pk_auto_id\");\n\t_swdoc.EF().sl_impactcis1.Refresh();\t\n}\n\n\/\/-- for removed incidents prompt user to remove attached CIs linked to those incidents\nfunction remove_selected_incident_cis(strSelectedIncs)\n{\n\tvar array_RemoveImpactCIS = new Array();\n\t\n\tif(_swdoc.EF().sl_impactcis1.rowCount()<1) return;\n\t\n\t\/\/--\n\t\/\/-- get linked inc cis and see if they are linked to problem\n\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\tif(strLinkedCIs==\"0\")return;\n\n\tvar arrayCIS = strLinkedCIs.split(\",\");\n\tfor(var z=0;z<arrayCIS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_impactcis1,arrayCIS[z],\"pk_auto_id\")>-1)\t\n\t\t{\n\t\t\tarray_RemoveImpactCIS[array_RemoveImpactCIS.length++] = arrayCIS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveImpactCIS.length>0)\n\t{\n\t\tif(confirm(\"There are associated impact configuration items, that are linked to the incidents you are removing. Do you want to remove these items as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveImpactCIS.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_impactcis1,array_RemoveImpactCIS[y],\"pk_auto_id\", null,0);\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().sl_impactcis1.Refresh();\n}\n\nfunction remove_selected_ke_incs(strSelectedKes)\n{\n\tvar array_RemoveKEincs = new Array();\n\t\n\tif(_swdoc.EF().sl_incs1.rowCount()<1) return;\n\t\n\t\/\/--\n\t\/\/-- get linked inc cis and see if they are linked to problem\n\tvar strLinkedINCs = app.g.get_slave_calls(strSelectedKes , \"PROBLEM-INCIDENT\", \"\");\n\tif(strLinkedINCs==\"0\")return;\n\n\tvar arrayINCS = strLinkedINCs.split(\",\");\n\tfor(var z=0;z<arrayINCS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_incs1,arrayINCS[z],\"callref\")!=-1)\t\n\t\t{\n\t\t\tarray_RemoveKEincs[array_RemoveKEincs.length++] = arrayINCS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveKEincs.length>0)\n\t{\n\t\tif(confirm(\"There are associated incident records, that are linked to the known error you are removing. Do you want to remove these records as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveKEincs.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_incs1,array_RemoveKEincs[y],\"callref\", null,0);\n\t\t\t}\n\t\t\t\/\/--\n\t\t\t\/\/-- remove linked incident CIs\n\t\t\t_swdoc.remove_selected_incident_cis(strLinkedINCs);\n\t\t}\n\t}\n\t_swdoc.EF().sl_incs1.Refresh();\n}\n\n\/\/-- for removed incidents prompt user to remove attached CIs linked to those incidents\nfunction remove_selected_ke_cis(strSelectedKes)\n{\n\tif((_swdoc.EF().sl_impactcis1.rowCount()<1)&&(_swdoc.EF().sl_configitems1.rowCount()<1)) return;\n\n\t_swdoc.remove_selected_ke_causeci(strSelectedKes);\n\t_swdoc.remove_selected_ke_impactci(strSelectedKes);\t\n}\n\nfunction remove_selected_ke_causeci(strSelectedKes)\n{\t\/\/--\n\t\/\/-- get linked ke cis and see if they are linked to problem\n\tvar array_RemoveCIS = new Array();\n\tvar strLinkedCauseCIs = app.cmdb.get_call_cis(strSelectedKes , \"PROBLEM-CAUSE\", \"\");\n\tif(strLinkedCauseCIs==\"0\")return;\n\n\t\n\tvar arrayCIS = strLinkedCauseCIs.split(\",\");\n\tfor(var z=0;z<arrayCIS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems1,arrayCIS[z],\"pk_auto_id\")>-1)\n\t\t{\n\t\t\tarray_RemoveCIS[array_RemoveCIS.length++] = arrayCIS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveCIS.length>0)\n\t{\n\t\tif(confirm(\"There are associated change configuration items, that are linked to the known errors you are removing. Do you want to remove these items as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveCIS.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_configitems1,array_RemoveCIS[y],\"pk_auto_id\", null,0);\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().sl_configitems1.Refresh();\n}\n\nfunction remove_selected_ke_impactci(strSelectedKes)\n{\t\/\/--\n\t\/\/-- get linked ke cis and see if they are linked to problem\n\tvar array_RemoveCIS = new Array();\n\tvar strLinkedImpactCIs = app.cmdb.get_call_cis(strSelectedKes , \"PROBLEM-AFFECT\", \"\");\n\tif(strLinkedImpactCIs==\"0\")return;\n\n\tvar arrayCIS = strLinkedImpactCIs.split(\",\");\n\tfor(var z=0;z<arrayCIS.length;z++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_impactcis1,arrayCIS[z],\"pk_auto_id\")!=-1)\t\n\t\t{\n\t\t\tarray_RemoveCIS[array_RemoveCIS.length++] = arrayCIS[z];\t\t\t\n\t\t}\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveCIS.length>0)\n\t{\n\t\tif(confirm(\"There are associated impact configuration items, that are linked to the known errors you are removing. Do you want to remove these items as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveCIS.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_impactcis1,array_RemoveCIS[y],\"pk_auto_id\", null,0);\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().sl_impactcis1.Refresh();\n}\n\nfunction filter_ke_impact(strKErefs)\n{\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_kes1, strKErefs,0);\n\t_swdoc.EF().sl_kes1.Refresh();\n\t\/\/-- check if we should add ke incidents\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyErrorIncidents\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar strLinkIncidents = app.g.get_slave_calls(strKErefs,\"PROBLEM-INCIDENT\");\n\t\tif(strLinkIncidents!=\"0\")\n\t\t{\n \t\t\t_swdoc.filter_inc_impact(strLinkIncidents);\n\t\t}\n\t}\n\n\t\/\/-- Now check if we should link new ke ci items as being affect or cause (or both)\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyErrorCauseCIs\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar oCis = app.cmdb.get_call_ci_info(strKErefs , \"PROBLEM-CAUSE\", \"cis_excludeservice\");\n\t\tif(oCis.keys!=\"\")\n\t\t\t_swdoc.link_cause_cis_to_change(oCis.keys);\n\t\t\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar oServices = app.cmdb.get_call_ci_info(strKErefs , \"PROBLEM-CAUSE\", \"cis_servicesonly\");\n\t\tif(oServices.keys!=\"\")\n\t\t\t_swdoc.link_cause_services_to_change(oServices.keys);\n\t}\n\t\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyErrorImpactCIs\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strKErefs , \"PROBLEM-AFFECT\", \"\");\n\t\t_swdoc.link_affect_cis_to_change(strLinkedCIs);\n\t}\n}\n\n\/\/-- link incidents\nfunction filter_inc_impact(strIncidentRefs)\n{\n\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_incs1,strIncidentRefs ,0);\n\t_swdoc.EF().sl_incs1.Refresh();\n\n\t\/\/-- Now check if we should link new ci items as being affect\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/CopyIncidentCIs\")==1)\n\t{\n\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strIncidentRefs , \"INCIDENT\", \"\");\n\t\t_swdoc.link_affect_cis_to_change(strLinkedCIs);\n\t}\n\n}\n\nfunction filter_impact_customers(oForm)\n{\n\t\/\/-- get list of customers impacted by these incidents and refresh cust impact list\n\tvar strCustFilter = app.g.sl_get_valuesdel(oForm.sl_incs1,'cust_id',\",\",\"\",true);\n\toForm.sl_incs1.Refresh();\n\t\/\/-- get customers that use affected cis\n\tvar strImpactedCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_impactcis1,'pk_auto_id',\",\");\t\n\tvar strCustIidsFromImpactCIs = app.cmdb.get_ci_customer_ids(strImpactedCIs,true);\n\tif(strCustIidsFromImpactCIs!=\"\")\n\t{\n\t\tif(strCustFilter!=\"\")strCustFilter+=\",\";\n\t\tstrCustFilter+=strCustIidsFromImpactCIs;\t\n\t}\n\n\t\/\/-- get customers affected by the associated kes\n\tvar strKeCallrefs = app.g.sl_get_valuesdel(oForm.sl_kes1,'callref',\",\");\n\tif(strKeCallrefs==\"\")strKeCallrefs=\"0\";\n\tvar strCustIidsFromImpactKes = app.itsm.get_problem_impact_customerids(strKeCallrefs,true);\n\tif(strCustFilter!=\"\")strCustFilter+=\",\";\n\tstrCustFilter+=strCustIidsFromImpactKes;\t\n\n\tif(_swdoc.oCust().keysearch!=\"\")\n\t\tstrCustFilter+=\",\"+_swdoc.oCust().keysearch;\t\n\t\n\t_slf(oForm.sl_customerimpact, \"_kv=\" + strCustFilter);\n\toForm.sl_customerimpact.Refresh();\t\t\t\n}\n\nfunction filter_impact_orgs(oForm)\n{\n\t\/\/-- get list of orgs impacted by impacted customer\n\tvar strOrgFilter = app.g.sl_get_valuesdel(oForm.sl_incs1,'fk_company_id',\",\",\"\",true);\n\t\n\t\/\/-- get orgs that use affected cis\n\tvar strImpactedCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_impactcis1,'pk_auto_id',\",\");\t\n\tvar strOrgIDSFromCIs = app.cmdb.get_ci_company_ids(strImpactedCIs,true);\n\tif(strOrgIDSFromCIs!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")\n\t\t\tstrOrgFilter+=\",\";\n\t\tstrOrgFilter+=strOrgIDSFromCIs;\n\t}\n\n\t\/\/-- 2.4 include orgs that use change ci\n\t\/\/-- get orgs that use change cis\n\tvar strChangeCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems1,'pk_auto_id',\",\");\t\n\tvar strOrgIDSFromCIs = app.cmdb.get_ci_company_ids(strChangeCIs,true);\n\tif(strOrgIDSFromCIs!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")strOrgFilter+=\",\";\n\t\tstrOrgFilter+=strOrgIDSFromCIs;\n\t}\n\n\t\/\/-- get orgs affected by the associated kes\n\tvar strKeCallrefs = app.g.sl_get_valuesdel(oForm.sl_kes1,'callref',\",\");\n\tif(strKeCallrefs==\"\")strKeCallrefs=\"0\";\n\tvar strOrgIdsFromImpactKes = app.itsm.get_problem_impact_orgids(strKeCallrefs,true);\n\tif(strOrgIdsFromImpactKes!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")strOrgFilter+=\",\";\n\t\tstrOrgFilter+=strOrgIdsFromImpactKes;\n\t}\n\n\tif(_swdoc.oCompany().pk_company_id!=\"\")\n\t{\n\t\tif(strOrgFilter!=\"\")strOrgFilter+=\",\";\n\t\tstrOrgFilter+=_swdoc.oCompany().pk_company_id;\n\t}\n\t_slf(oForm.sl_orgimpact, \"_kv=\"+strOrgFilter);\n\toForm.sl_orgimpact.Refresh();\t\n}\n\nfunction get_company_cis(strCompanyID)\n{\n\t\/\/###20120801 - rewrite to accommodate multiple organisations\n\tvar strKeyValues = app.cfg.get_company_cikeys(strCompanyID,true,true);\t\n\n\tvar strParams = \"fk_company_id=\"+pfu(strCompanyID);\n    var oRS = app.g.get_sqrecordset(\"general\/get_company_sites\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tif(strKeyValues!=\"\")strKeyValues+=\",\";\t\n\t\tvar strSiteName = app.g.get_field(oRS,\"site_name\");\n\t\tstrKeyValues+= app.cmdb.get_site_cis(strSiteName);\n\t}\t\n\t\n\tif(strKeyValues==\"\")\n\t\tstrKeyValues = \"-1\";\n\t_swdoc.multi_companyCIIDS[strCompanyID] = strKeyValues;\n\n}\n\nfunction check_cis()\n{\n\tvar oList =_swdoc.EF().sl_configitems1;\n\tif(oList.rowCount() ==\"\")\n\t\treturn;\n\tvar boolCIRemoved = false;\n\t\/\/###20120801\n\tvar strCompanyID = _swdoc.OC().fk_company_id;\n\tif(typeof _swdoc.multi_companyCIIDS[strCompanyID] === \"undefined\")\n\t\t_swdoc.get_company_cis(strCompanyID);\n\t\t\n\tvar arrCIS = _swdoc.multi_companyCIIDS[strCompanyID].split(\",\");\n\tfor (var x=oList.rowCount();x > -1;x--)\n\t{\n\t\tvar strValue = oList.GetItemText(x,0);\n\t\tif(strValue !=\"\"){\n\t\t\tif(in_array(arrCIS,strValue))\n\t\t\t{\n\t\t\t\toList.SetRowSelected(x,false,true);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\toList.SetRowSelected(x,true,true);\n\t\t\t\tboolCIRemoved = true;\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.EF().mbtn_cci_actions1_OnMenuItem('test',1);\n\tif(boolCIRemoved)\n\t\tMessageBox(\"CIs were removed from this call, as they were not associated with the currently selected Organisation\");\n}\n\nfunction search_for_cis(funcCallback)\n{\n   \tvar strURL = \"canreset=1&fk_company_id=\" + pfu(_swdoc.oCompany().pk_company_id);\n\tapp.cmdb.search_ci(true,strURL,function(sResults)\n\t{\n\t\tif (sResults.selectedkeys==\"\")\n\t\t{\n\t\t\tif ((funcCallback != undefined) && (funcCallback != null))\n\t\t\t{\n\t\t\t\tfuncCallback();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n   \t\t\tvar strType = sResults.selectedtypes;\n  \t\t\tif(strType.indexOf(\"Service\")>-1)\n  \t\t\t{\n  \t\t\t\tvar strServiceKeys = \"\";\n  \t\t\t\tvar strKeys = \"\";\n  \t\t\t\tvar arrTypes = strType.split(\",\");\n  \t\t\t\tvar arrKeys = sResults.selectedkeys.split(\",\");\n  \t\t\t\tfor(var x in arrKeys)\n  \t\t\t\t{\n  \t\t\t\t\tvar strThisType = arrTypes[x];\n  \t\t\t\t\t\/\/MessageBox(strThisType.indexOf(\"Service\"));\n  \t\t\t\t\tif(strThisType.indexOf(\"Service\")>-1)\n  \t\t\t\t\t{\n  \t\t\t\t\t\tif(strServiceKeys!=\"\")\n  \t\t\t\t\t\t\tstrServiceKeys+=\",\";\n  \t\t\t\t\t\tstrServiceKeys += arrKeys[x];\n  \t\t\t\t\t}else\n  \t\t\t\t\t{\n  \t\t\t\t\t\tif(strKeys!=\"\")\n  \t\t\t\t\t\t\tstrKeys+=\",\";\n  \t\t\t\t\t\tstrKeys += arrKeys[x];\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t\tif(strKeys!=\"\")\n\t\t\t\t\t_swdoc.link_cause_cis_to_change(strKeys);\n  \t\t\t\tif(strServiceKeys!=\"\")\n\t\t\t\t\t_swdoc.link_cause_services_to_change(strServiceKeys);\n  \t\t\t}\n  \t\t\telse\n\t\t\t\t_swdoc.link_cause_cis_to_change(sResults.selectedkeys);\n\t\t\n\t\t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\t\tapp.cfg.process_call_contract_check(sResults.selectedkeys, true,_swdoc);\n\t\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\t\tif ((funcCallback != undefined) && (funcCallback != null))\n\t\t\t{\n\t\t\t\tfuncCallback();\n\t\t\t}\n\t\t\t\n\t\t}\n\t});\t\n}\n\nfunction search_for_services()\n{\n\t\/\/-- JPG - 22.01.2015\n\t\/\/Definition mode for the new window\n\tvar strURL = \"searchmode=1&multiselect=1&canreset=1&fk_company_id=\" + pfu(_swdoc.oCust().fk_company_id);\n\t\/\/Path of the new window\n\tapp.g.popup(\"manage_portfolio\", strURL, function(sResults)\n\t{\n\t\tif(!sResults) return;\n\t\tif (sResults.document.strSelectedKeys==\"\") return;\n\t\t\n\t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\t_swdoc.link_cause_services_to_change(sResults.document.strSelectedKeys);\n\t\tapp.cfg.process_call_contract_check(sResults.document.strSelectedKeys, true,_swdoc);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t});\n}\n\n\n\n\/\/ITSM MEROPE\n\n\/\/-- check if there is alternative slad settings based on the customers department\nfunction check_customer_department_slad(strSLADID, strDepartment)\n{\n\tif(strDepartment==\"\")\n\t\treturn;\n\tvar strParams = \"fk_slad_id=\" +pfu(strSLADID)+ \"&fk_dept=\" +pfu(strDepartment);\n \tvar oRecSLD = app.g.get_sqrecordset(\"call\/incident\/get_dept_sla\",strParams);\n\tif(oRecSLD.Fetch())\n\t{\n\t\t\/\/-- load cost center option\n\t\tvar strNewCC = app.g.get_field(oRecSLD,\"chargeto_cc\");\n\t\tswitch(strNewCC)\n\t\t{\n\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\tbreak;\n\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\tbreak;\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/-- eof cc option\n\t\t\t\n\t\t\/\/-- set oc values\n\t\tif(strNewCC!=\"\") _swdoc.OC().costcenter = strNewCC;\n\t\t_swdoc.OC().priority = app.g.get_field(oRecSLD,\"fk_sla\");\n\t}\n}\n\n\/\/-- load sld info and settings\nfunction handle_set_sladef(strNewSLD, boolValidate, boolOnResolve)\n{\n\tif(_swdoc.boolSLAEnforced)\n\t{\n\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t_swdoc.UpdateFormFromData();\n\t\tMessageBox(\"SLA is being enforced from the process.\");\n\t\treturn;\n\t}\n\n\tif(boolValidate==undefined)\n\t\tboolValidate==false;\n\tvar strDisplaySLD = strNewSLD;\n\n\tvar strUseSLD = strNewSLD;\n\tvar boolRelative = false;\n\tvar strRelative = \"\";\n\n\t\/\/-- get actual SLD ID if getting from related record\n\tswitch(strNewSLD)\n\t{\n\t\tcase \"[Use Profile SLA]\":\n\t\t\tif(_swdoc.OC().probcode!=\"\")\n\t\t\t{\n\t\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\t\t\t\tif(oRecSLD)\n\t\t\t\t{\n\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\tboolRelative = true;\n\t\t\t\t\tstrRelative = \"[Use Profile Priority]\";\n\t\t\t\t\t\/\/return false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Profile SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No profile has been set for this request. The Profile SLA cannot be used.\",16);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"[Use Charge Centre SLA]\":\n\t\t\tif(_swdoc.OC().costcenter!=\"\")\n\t\t\t{\n\t\t\t\tvar strCCUse = _swdoc.OC().costcenter;\n\t\t\t\tif(_swdoc.OC().costcenter==\"[Use Customer Charge Centre]\")\n\t\t\t\t{\n\t\t\t\t\tstrCCUse = _swdoc.oCust().costcenter;\n\t\t\t\t}\n\t\t\t\tif(strCCUse==\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Charge Centre SLA]\";\n\t\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tif(boolValidate)\n\t\t\t\t\t\tMessageBox(\"No charge centre has been set for this request. The charge centre SLA cannot be used.\");\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n                    \/\/-- 992268 Add the below line\n\t\t\t\t\t_swdoc.OC().costcenter = strCCUse;\n\t\t\t\t\tvar oRec = app.g.get_record(\"costcent\", strCCUse);\n\t\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\t\t\t\t\tif(oRecSLD)\n\t\t\t\t\t{\n\t\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\t\tboolRelative = true;\n\t\t\t\t\t\tstrRelative = \"[Use Charge Centre Priority]\";\n\t\t\t\t\t\t\/\/return false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Charge Centre SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No charge centre has been set for this request. The charge centre SLA cannot be used.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"[Use Customer SLA]\":\n\t\t\tif(_swdoc.oCust().keysearch==\"\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Customer SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No customer selected, cannot resolve customer SLA. Please select a valid SLA.\",16);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(_swdoc.oCust().sld==\"\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No Default SLA is associated to this Customer. Please select a valid SLA.\",16);\n\t\t\t\telse\n\t\t\t\t\tMessageBox(\"Customer does not have a default SLA.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.oCust().sld);\n\t\t\tif(oRecSLD)\n\t\t\t{\n\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\tboolRelative = true;\n\t\t\t\tstrRelative = \"[Use Customer Priority]\";\n\t\t\t\t\/\/return false;\n\t\t\t}\n\t\tbreak;\t\t\n\t\tcase \"[Use Process SLA]\":\n\t\t\tif(bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t{\n\t\t\t\tif(bpm_workflow.fk_default_sla_new==\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"No SLA has been set for the requests Business Process. The Process SLA cannot be used.\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar strSLA = bpm_workflow.fk_default_sla_name;\n\t\t\t\t\tif(strSLA.indexOf(\"[Use\")>-1 && strSLA.indexOf(\"SLA]\")>-1)\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.handle_set_sladef(bpm_workflow.fk_default_sla_name);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/var oRec = app.g.get_record(\"costcent\", strCCUse);\n\t\t\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", bpm_workflow.fk_default_sla_new);\n\t\t\t\t\t\tif(oRecSLD)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\t\t\tboolRelative = true;\n\t\t\t\t\t\t\tstrRelative = \"[Use Process Priority]\";\n\t\t\t\t\t\t\t\/\/return false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Process SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No process has been set for this request. The Process SLA cannot be used.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\t}\n\n  \tvar oRecSLD = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strUseSLD);\n\tif(oRecSLD.Fetch())\n\t{\t\n\t\t\/\/-- load cost center option\n\t\tvar strNewCC = app.g.get_field(oRecSLD, \"chargeto_cc\");\n\t\tswitch(strNewCC)\n\t\t{\n\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\tbreak;\n\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\tbreak;\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/-- eof cc option\n\t\t\t\n\t\t\/\/-- set oc values\n\t\tif(strNewCC!=\"\") _swdoc.OC().costcenter = strNewCC;\n\t\t_swdoc.OC().itsm_sladef = \tapp.g.get_field(oRecSLD, \"pk_slad_id\");\n\t\t_swdoc.OC().itsm_slaname = app.g.get_field(oRecSLD, \"slad_id\");\n\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\n\t\tvar strFKSsla = app.g.get_field(oRecSLD, \"fk_ssla\");\n\t\tif(boolRelative)\n\t\t\t_swdoc.handle_set_priority(strRelative);\n\t\telse\n\t\t\t_swdoc.handle_set_priority(strFKSsla);\n\t\t\n\t\t\/\/-- check if customer dept has nay alternative settings\n\t\t_swdoc.check_customer_department_slad(strNewSLD,_swdoc.oCust().department);\n\t\t\n\t\t_een(_swdoc.MF().lbl_oc_priority, true);\n\t\t_een(_swdoc.MF().lb_oc_sla, true);\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\telse\n\t{\n\t\tMessageBox(\"Failed to retrieve service level definition record for '\" + strDisplaySLD + \"'. Please contact your Supportworks Administrator\");\n\t\treturn false;\n\t}\n\treturn true;\n}\n\nfunction handle_set_priority(strValue)\n{\n\tif(strValue==\"[Use SLA Default Priority]\")\n\t{\n\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.OC().itsm_sladef);\n\t\tif(oRecSLD)\n\t\t{\t\n\t\t\t_swdoc.OC().priority = oRecSLD.fk_ssla;\n\t\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Customer Priority]\")\n\t{\n\t\tif(_swdoc.oCust().keysearch!=\"\")\n\t\t{\n\t\t\tif(_swdoc.oCust().sld==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\tif(_swdoc.oCust().priority==\"[Use SLA Default Priority]\")\n\t\t\t\t\t_swdoc.handle_set_priority(\"[Use SLA Default Priority]\");\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.oCust().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The customer SLA is not the same as the currently selected SLA. The Customer priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\")\n\t\t\t\t{\n\t\t\t\t\t_een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\t_een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"No customer selected. The Customer priority cannot be used.\");\n\t\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Profile Priority]\")\n\t{\n\t\tif(_swdoc.OC().probcode!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.sla);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The Profile SLA is not the same as the currently selected SLA. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority=\"[Use Profile Priority]\";\n\t\t\t\t_een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t_een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No profile has been set for this request. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Charge Centre Priority]\")\n\t{\n\t\tif(_swdoc.OC().costcenter!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.priority);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t\t{\n\t\t\t\t\t_een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\t_een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"The cost center SLA is not the same as the currently selected SLA. The cost center priority cannot be used.\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t{\n\t\t\t\t_een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t_een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No cost center has been set for this request. The cost center priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Process Priority]\")\n\t{\n\t\tif(bpm_workflow.pk_workflow_id!=\"\")\n\t\t{\n\t\t\t\/\/var oRec = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(bpm_workflow.fk_default_sla_new==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(bpm_workflow.fk_default_sla);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The Process SLA is not the same as the currently selected SLA. The Process priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tMessageBox(\"No process has been set for this request. The process priority cannot be used.\");\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse\n\t{\n\t\tif (_swdoc.boolChangeSLASetManually)\n\t\t{\n\t\t\t_swdoc.OC().priority = strValue;\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t_swdoc.UpdateFormFromData();\n\t\treturn false;\n\t}\n}\nfunction handle_set_contract(strNewSLD)\n{\n\tvar strDefaultContract = app.g.filter_company_contracts(_swdoc.OC().fk_company_id, _swdoc.MF().lb_contract, strNewSLD);\n\tif(strDefaultContract!=\"\")\n\t{\n\t\t_swdoc.OC().fk_contract_id = strDefaultContract;\n\t\tapp.g.strLogAndResolveContract = strDefaultContract;\n\t}\n\t_swdoc.UpdateFormFromData();\n\t\t\n}\n\nfunction process_impact_urgency_change()\n{\n    if(_swdoc.OC().itsm_sladef!=\"\")\n    {\n    \t\/\/-- if use incident assessment over ci\n    \t\/\/if(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/UseCIAssessmentLevels\")!=1)\n    \t\/\/{\n    \t\tvar strPriority = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level);\n    \t\tif(strPriority!=\"\")\n\t\t\t\t_swdoc.handle_set_priority(strPriority);\n    \t\t_swdoc.UpdateFormFromData();\n    \t\/\/}\n    }\n}"},{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strCallclass)\n{\n\t\/\/-- can they raise a record of this class\n\n\tif(app.itsm.can_create(strCallclass,true)==false) return false;\n\n\treturn true;\n}"},{"name":"OnRecordValueChanged","code":"OnRecordValueChanged(strTable, strColumn, strValue, strOldValue)\n{\n\t\/\/-- NWJ - check to see if user has changed the itsm_opencall_rfc table field\n\t\/\/-- to search for raised by and monitored by analyst - so it works like resolving a customer.\n\tif(strTable==\"itsm_opencall_rfc\")\n\t{\n\t\tvar oAnalyst = false;\n\t\tif((strColumn.indexOf(\"raised_\") == 0)||(strColumn.indexOf(\"monitored_\") == 0))\n\t\t{\n\t\t\t\/\/-- get db col name based on passed in col name\n\t\t\tvar strDBCol=\"\";\n\t\t\t\/\/MessageBox(strColumn.split(\"_\")[2])\n\t\t\tswitch(strColumn.split(\"_\")[2])\n\t\t\t{\n\t\t\t\tcase \"analystid\":\n\t\t\t\t\tstrDBCol=\"analystid\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"name\":\n\t\t\t\t\tstrDBCol=\"name\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"group\":\t\t\t\t\t\n\t\t\t\t\tstrDBCol=\"supportgroup\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"telephone\":\n\t\t\t\t\tstrDBCol=\"contactb\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"email\":\n\t\t\t\t\tstrDBCol=\"contacte\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tMessageBox(\"The extended rfc column (\" + strColumn + \") cannot be matched to swanalysts. please contact your Supportworks Administrator.\");\n\t\t\t\t\t_swdoc.set_rfc_analyst(false,true);\n\t\t\t\t\treturn;\n\t\t\t\t\tbreak;\t\t\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tif(strColumn.indexOf(\"raised_\") == 0)\n\t\t{\n\t\t\t\/\/-- auto search raised by\n\t\t\tapp.g.resolve_analyst(strDBCol,strValue,function(oAnalyst)\n\t\t\t{\n\t\t\t\tif(oAnalyst) _swdoc.set_rfc_analyst(oAnalyst,false);\n\t\t\t});\t\n\t\t}\n\t\telse if (strColumn.indexOf(\"monitored_\") == 0)\n\t\t{\n\t\t\t\/\/-- auto search monitored by\n\t\t\tapp.g.resolve_analyst(strDBCol,strValue,function(oAnalyst)\n\t\t\t{\n\t\t\t\tif(oAnalyst) _swdoc.set_rfc_analyst(oAnalyst,true);\n\t\t\t});\t\t\t\n\t\t}\n\t}\n\telse if(strColumn==\"priority\" && strTable == \"opencall\")\n    {\n    \tif(_swdoc.boolChangeProfile)\n    \t{\n\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\tvar oSLA = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\n\t\t\t_swdoc.handle_set_sladef(oSLA.slad_id);\n\t\t\t_swdoc.boolChangeSLASetManually = true;\n\t\t\t_swdoc.handle_set_priority(oRec.sla);\n \t\t\t_swdoc.UpdateFormFromData();\n   \t\t}\n    }\t\n    else if(strColumn==\"probcode\" && strTable == \"opencall\")\n    {\n    \t_swdoc.boolChangeProfile = true;\n    \tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n  \t\tmainform.SetTimer(4, 100);\n  \t}\n  \telse if( (strColumn==\"itsm_impact_level\")||(strColumn==\"itsm_urgency_level\") )\n    {\n    \t_swdoc.boolChangeSLASetManually = true; \/\/--107865\n    \t_swdoc.process_impact_urgency_change();\n    }\n    else if (strColumn==\"fk_company_id\"||strColumn==\"site\"||strColumn==\"fk_dept_code\"||strColumn==\"costcenter\"||strColumn==\"pk_workflow_id\")\n\t{\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n\n    \n\n\n    \n\t\n\n\n}"},{"name":"OnCallLoggedOK","code":"OnCallLoggedOK(nCallRef, dateRespondBy, dateFixBy, strCustName, strSla)\n{\n\t\/\/-- NWJ - 12-02.2007 - after logging problem link its CIs and Incidents\n    \/\/-- nwj \n    \/\/-- 15.03.2004\n    var intCallRef = app.g.callref_unpad(nCallRef);\n\n    \/\/-- loop through causing CI and assign them to this call\n\tvar strDiaryText = \"The following Configuration Items are to be changed.\\n\";\n\tvar boolCIs = false;\n    var olist = _swdoc.EF().sl_configitems1;\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolCIs =true;\n        var pk_ci_id = olist.GetItemTextRaw(x,0);\n        var ci_item_key = olist.GetItemTextRaw(x,1);\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'CPR-CAUSE'))\n\t\t{\n\t\t\t\/\/ DTH: F0097653 Adding Affected Business Areas from CI to the Call\n\t\t\t\/\/app.g.add_affected_bus_area_to_call(intCallRef, \"CI\", ci_item_key, \"\", false);\n\t\t\tstrDiaryText    += \"Configuration Item (\" + ci_item_key + \"). \\n\";\n\t\t}\n    }\n\n\tvar strServiceDiaryText = \"The following Services are to be changed.\\n\";\n\tvar boolServices = false;\n    var olist = _swdoc.EF().sl_services;\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolServices =true;\n        var pk_ci_id = olist.GetItemTextRaw(x,0);\n        var ci_item_key = olist.GetItemTextRaw(x,1);\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'CPR-CAUSE'))\n\t\t{\n\t\t\tstrServiceDiaryText    += \"Service (\" + ci_item_key + \"). \\n\";\n\t\t}\n    }\n\n\t\/\/-- affected CIs\n    var olist = _swdoc.EF().sl_impactcis1;\n    var boolAffCIs = false;\n\tvar strCauseDiaryText = \"\\nThe following Configuration Items will be impacted by change.\\n\";    \n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolAffCIs = true;\n        var pk_ci_id = olist.GetItemTextRaw(x,0);\n        var ci_item_key = olist.GetItemTextRaw(x,1);\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'CPR-AFFECT'))\n\t\t{\n\t\t\tstrCauseDiaryText    += \"Configuration Item (\" + ci_item_key + \"). \\n\"\n\t\t}\n    }    \n    \n    \/\/-- if we have CI to add add it\n    if (boolCIs)\n    {\n\t\tvar strActionSource = \"Change Management\";\n\t\tvar strCode\t\t\t= \"Linking Configuration Items\";\n\t\tif(boolAffCIs) strDiaryText += strCauseDiaryText;\n\t\tapp.g.new_dairyevent(intCallRef,strDiaryText,strActionSource,strCode);    \n    }\n    \n       \/\/-- if we have CI to add add it\n    if (boolServices)\n    {\n\t\tvar strActionSource = \"Change Management\";\n\t\tvar strCode\t\t\t= \"Linking Services\";\n\t\tapp.g.new_dairyevent(intCallRef,strServiceDiaryText,strActionSource,strCode);    \n    }\n\n    \/\/ -- If we have a CI or Service, then check whether the first Stage requires Authorisations for Service Owner, Technical Owner and CI Owner\n    if(boolCIs || boolServices)\n    {\n\t\tvar xmlmc = new XmlMethodCall();\n\t\txmlmc.SetParam(\"in_callref\", intCallRef);\n\t\txmlmc.Invoke(\"vpme\", \"checkStageAuth\");\n\t}\n\t\n\n    \/\/-- insert a relationship between change proposal and rfcs\n    var strIncidents = app.g.sl_get_valuesdel(_swdoc.EF().sl_rfcs,0,\",\");\n    if (strIncidents !=\"\")\n    {\n    \tvar strText = \"This change proposal has been associated with the following change requests\\n\\n\";\n    \tvar arrIncidents = strIncidents.split(\",\");\n    \tfor(var x=0; x < arrIncidents.length; x++)\n    \t{\n\t\t\t\/\/-- call g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrIncidents[x],intCallRef,'RFC-CPR'))\n\t\t\t{\n\t\t\t\tstrText += \"Change Request (\" + app.g.pad_callref(arrIncidents[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrIncText = \"The change proposal (\" + nCallRef + \") has been associated to this change request\";\n\t\t\t\tapp.g.new_diaryevent(arrIncidents[x],strIncText,\"Change Management\",\"Change Proposal Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Change Management\",\"Change Request Association\");\n    }\n   \n   \/\/-- insert a relationship between rfc and problem \/ ke\n    var strProblems = app.g.sl_get_valuesdel(_swdoc.EF().sl_kes1,0,\",\");\n    if (strProblems !=\"\")\n    {\n    \tvar strText = \"This change request has been associated with the following Known Errors\\n\\n\";\n    \tvar arrProblems = strProblems.split(\",\");\n    \tfor(var x=0; x < arrProblems.length; x++)\n    \t{\n\t\t\t\/\/-- call g method to link problem to incident\n\t\t\tif(app.g.relate_calls(intCallRef,arrProblems[x],'RFC-ERROR'))\n\t\t\t{\n\t\t\t\tstrText += \"Known Error (\" + app.g.pad_callref(arrProblems[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrPrbText = \"The change request (\" + nCallRef + \") has been associated to this known error.\";\n\t\t\t\tapp.g.new_diaryevent(arrProblems[x],strPrbText,\"Change Management\",\"Change Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Change Management\",\"Known Error Association\");\n    }\n\n\n      \/\/-- insert a relationship between rfc and sr\n    var strSRs = app.g.sl_get_valuesdel(_swdoc.EF().sl_srs,0,\",\");\n    if (strSRs !=\"\")\n    {\n    \tvar strText = \"This change request has been associated with the following Service Requests\\n\\n\";\n    \tvar arrSRs = strSRs.split(\",\");\n    \tfor(var x=0; x < arrSRs.length; x++)\n    \t{\n\t\t\t\/\/-- call g method to link problem to incident\n\t\t\tif(app.g.relate_calls(intCallRef,arrSRs[x],'REQUEST-CHANGE'))\n\t\t\t{\n\t\t\t\tstrText += \"Service Request (\" + app.g.pad_callref(arrSRs[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrRelText = \"The change request (\" + nCallRef + \") has been associated to this Service Request.\";\n\t\t\t\tapp.g.new_diaryevent(arrSRs[x],strRelText,\"Change Management\",\"Change Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Change Management\",\"Service Request Association\");\n    }\n\n    \/\/-- insert a relationship between incs and doc\n    if(!app.g.use_sw_knowledgebase())\n\t{\n\t\tif(strKnowledgebaseDefaultTool.toLowerCase()==\"rightanswers\")\n\t\t{\n\t\t\tvar strDocs = app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\");\n    \t\tif (strDocs !=\"\")\n    \t\t{\n    \t\t\tvar strText = \"This change request has been associated with the following Knowledgebase Documents\\n\\n\";\n    \t\t\tvar arrDocs = strDocs.split(\",\");\n    \t\t\tfor(var x=0; x < arrDocs.length; x++)\n    \t\t\t{\n\t\t\t\t\t\/\/-- call g method to link problem to incident\n\t\t\t\t\tapp.g.relate_call_to_rakb(arrDocs[x],intCallRef,'Used','Change',false);\n\t\t\t\t\tstrText += \"Knowledgebase Document (\" + arrDocs[x] + \") associated\\n\";\n\t\t\t\t}\t\t\t\n\t\t\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Change Management\",\"Knowledgebase Document Association\");\n    \t\t}\n\t\t}\n\t}\n\telse\n\t{\n    \tvar strDocs = app.g.sl_get_valuesdel(_swdoc.EF().sl_kbs1,0,\",\");\n    \tif (strDocs !=\"\")\n    \t{\n    \t\tvar strText = \"This change request has been associated with the following Knowledgebase Document\\n\\n\";\n    \t\tvar arrDocs = strDocs.split(\",\");\n    \t\tfor(var x=0; x < arrDocs.length; x++)\n    \t\t{\n\t\t\t\t\/\/-- call g method to link problem to incident\n\t\t\t\tapp.oKB.relate_call_to_kb(arrDocs[x],intCallRef,'CPR-KB');\n\t\t\t\tstrText += \"Knowledgebase Document (\" + arrDocs[x] + \") associated\\n\";\n\t\t\t}\t\t\t\n\t\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Change Management\",\"Knowledgebase Document Association\");\n    \t}\n   }\n    \n    \/\/ DTH: F0097668 20120202\n    \/\/ If Impact Level Assessment was enabled and completed, load the selected options into cmn_rel_opencall_ila\n\tif (_swdoc.boolILAEnabled && _swdoc.OC().flg_ila_complete)\n\t{\n\t\tapp.g.relate_ila_options_to_call(intCallRef, \"Change Log Call Form\", _swdoc.strILAOptions);\n\t}\n\t\n\t\/\/-- RJC - F0099436 ABAs as authorisers in first stage\n    var strABAs = app.g.sl_get_valuesdel(_swdoc.MF().sl_ABAs1,0,\",\");\n    if (strABAs !=\"\")\n    {\n    \tvar arrABAs = strABAs.split(\",\");\n    \tfor(var x=0; x < arrABAs.length; x++)\n    \t{\n    \t\tvar strRelType = _swdoc.arrABAAssocTypes[arrABAs[x]];\n\t\t\tif(strRelType==\"CI\")\n\t\t\t{\n\t\t\t\t\/\/ link the ABA to the call\n\t\t\t\tvar xmlmc = new XmlMethodCall();\n\t\t\t\txmlmc.SetParam(\"table\", \"cmn_rel_opencall_aba\");\n\t\t\t\txmlmc.SetData(\"fk_callref\", intCallRef);\n\t\t\t\txmlmc.SetData(\"fk_bus_area_id\", arrABAs[x]);\n\t\t\t\txmlmc.SetData(\"status\", 'Active');\n\t\t\t\txmlmc.SetData(\"source\", \"CI\");\n\t\t\t\txmlmc.Invoke(\"data\", \"addRecord\");\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- call g method to link problem to incident\n\t\t\t\tapp.g.add_affected_bus_area_to_call(intCallRef, strRelType, \"\", arrABAs[x], false);\n\t\t\t}\n\t\t}\n\t\t\/\/-- has ABAs, so check if 1st stage requires Auth\n\t\tvar xmlmc = new XmlMethodCall();\n\t\txmlmc.SetParam(\"in_callref\", intCallRef);\n\t\txmlmc.Invoke(\"vpme\", \"checkABAAuth\");\n    }\n\n    \/\/ DTH: Create a history record for the selected Impact Level Assessment Options\n\tif (_swdoc.strILAOptions != \"\")\n\t{\t\n\t\tvar xmlmc = new XmlMethodCall;\n\n\t\t\/\/ Set up our input parameters\n\t\txmlmc.SetValue(\"analystid\", app.session.analystId);\n\t\txmlmc.SetValue(\"callref\", intCallRef);\n\t\txmlmc.SetValue(\"weighting\", _swdoc.OC().ila_weighting);\n\t\txmlmc.SetValue(\"impact_level\", _swdoc.OC().itsm_impact_level);\n\t\txmlmc.SetValue(\"usage_area\", \"Change Log Call Form\");\n\t\txmlmc.SetValue(\"ila_options\", _swdoc.strILAOptions);\n\t\txmlmc.SetValue(\"create_diary\", 0); \/\/ Not creating a Diary entry when logging a call\n\t\txmlmc.SetValue(\"prev_impact_level\", \"\");\n\t\txmlmc.SetValue(\"prev_weighting\", 0);\n\t\t\n\t\t\/\/ Invoke the method\n\t\tif(!xmlmc.Invoke(\"VPME\", \"ilaCreateCallHist\"))\n\t\t{\n\t\t\tMessageBox(xmlmc.GetLastError());\n\t\t}\n\t}\n\t\n\t\/\/-- F0105032 - audit trail if incoming call\t\n\tif(_swdoc._form.PreloadType==2)\n\t{\n\t\tif(_swdoc.OC().bpm_workflow_id!=\"\")\n\t\t{\n\t\t\tvar intEpochTime = app.global.GetCurrentEpocTime();\n\t\t\tvar oAnalyst = app.g.get_sys_record(\"swanalysts\",app.session.analystId);\n\t\t\tvar oGroup = app.g.get_sys_record(\"swgroups\",app.session.groupId);\n\t\t\tvar strParams = \"fk_workflow_id=\"+pfu(_swdoc.OC().bpm_workflow_id);\n   \t\t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_audit_fields\",strParams);\n\t\t\twhile(oRS.Fetch())\n\t\t\t{\n\t\t\t\tvar strBinding = app.g.get_field(oRS,\"fieldname\");\n\t\t\t\tarrBinding = strBinding.split(\".\");\n\t\t\t\tvar strTable = arrBinding[0];\n\t\t\t\tvar strColName = arrBinding[1];\n\t\t\t\t\n\t\t\t\tvar oldValue = \"\";\n\t\t\t\tif(strTable==\"opencall\")\n\t\t\t\t\tvar oldValue = _swdoc.oOpencall[strColName];\n\t\t\t\telse\n\t\t\t\t\tvar oldValue = _swdoc.oExtended[strColName];\n\t\t\t\t\n\t\t\t\tvar newValue = _swdoc[strTable][strColName];\n\t\t\t\tif(app.g.dd_isnumeric(strTable, strColName))\n\t\t\t\t{\n\t\t\t\t\tif(newValue<0)\n\t\t\t\t\t\tnewValue = app.g.fix_epoch(newValue);\n\t\t\t\t\tif(oldValue<0)\n\t\t\t\t\t\toldValue = app.g.fix_epoch(oldValue);\n\t\t\t\t}\n\t\t\t\tif(oldValue!=newValue)\n\t\t\t\t{\n\t\t\t\t\tvar strFieldDisplay = dd.tables[LC(strTable)].columns[strColName].DisplayName;\n\t\t\t\t\tvar strFmtOldValue = app.g.dd_format(strTable, strColName, oldValue);\n\t\t\t\t\tvar strFmtNewValue = app.g.dd_format(strTable, strColName, newValue);\n\t\t\t\t\tvar oInsertTmp = new oXmlmcInsert('oc_audit');\n\t\t\t\t\toInsertTmp.setfield('fk_callref',_swdoc.OC().callref);\n\t\t\t\t\toInsertTmp.setfield('updatetimex',intEpochTime);\n\t\t\t\t\toInsertTmp.setfield('updatedby',app.session.analystId);\n\t\t\t\t\toInsertTmp.setfield('updatedbyname',oAnalyst.name);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroup',app.session.groupId);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroupname',oGroup.name);\n\t\t\t\t\toInsertTmp.setfield('databinding',strBinding);\n\t\t\t\t\toInsertTmp.setfield('bindingfield',arrBinding[1]);\n\t\t\t\t\toInsertTmp.setfield('bindingtable',arrBinding[0]);\n\t\t\t\t\toInsertTmp.setfield('fielddisplay',strFieldDisplay);\n\t\t\t\t\toInsertTmp.setfield('oldvalue',oldValue);\n\t\t\t\t\toInsertTmp.setfield('newvalue',newValue);\n\t\t\t\t\toInsertTmp.setfield('fmtoldvalue',strFmtOldValue);\n\t\t\t\t\toInsertTmp.setfield('fmtnewvalue',strFmtNewValue);\n\t\t\t\t\toInsertTmp.execute();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\/\/-- EOF F0105032 \n\t\n}"},{"name":"OnValidate","code":"OnValidate()\n{\n\n\t\t\/\/-- nwj - hide confirmation if we have no customer\n\tif(userdb.keysearch==\"\")\n\t{\n\t\tapp.g.bPromptToOpenCallDetails = true;\n\t\tapp.g.bDoNotShowLogCallConfirmation = true;\n\t}\n\telse\n\t{\n\t\tapp.g.bDoNotShowLogCallConfirmation = false;\n\t}\t\n\n\t\n\tif(bpm_workflow.flg_requireci==1)\n\t{\n\t\tif(_swdoc.EF().sl_configitems1.rowCount() < 1)\n\t\t{\n\t\t\tif(_swdoc.EF().sl_services.rowCount() < 1)\n\t\t\t{\n\t\t\t\tif(_swdoc.EF().sl_kbs1.rowCount() < 1)\n\t\t\t\t{\n\t\t\t\t\tMessageBox(\"Before logging this Change Proposal you have to associate at least one change Configuration Item, Service or Knowledgebase Document.\");\n\t\t\t\t\treturn VALIDATE_FAIL;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t\/\/-- 108840 : Check if we have required number of CIs \n\tvar strCallType = \"Change\";\n\tvar intCurCINo = _swdoc.EF().sl_configitems1.rowCount() + _swdoc.EF().sl_services.rowCount() + _swdoc.EF().sl_kbs1.rowCount();\n\tif(!app.itsm.mandatory_ci_check(strCallType, intCurCINo))\n\t{\n\t\tvar intReqCINo = oSettings.get_setting(\"int\" + strCallType + \"OnLoggingRequiredCINo\");\n\t\tvar strPlural = \"\";\n\t\tif (intReqCINo > 1)\n\t\t{\n\t\t\tstrPlural= \"s\";\n\t\t}\n\t\tMessageBox(\"Before logging this \" + strCallType + \" Proposal you have to associate at least \" + intReqCINo + \" change configuration item\" + strPlural + \", service\" + strPlural + \" or Knowkedgebase Document\" + strPlural + \".\");\n\t\treturn VALIDATE_FAIL;\n\t}\n\n\t\/\/-- check that planned dates dont conflict \/ prompt user to confirm\n\tvar strMessage = \"\";\n\tvar strCIids = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems1,\"pk_auto_id\",\",\",\"\");\n\t_swdoc.RFC_EXT().dow_note = updatedb.updatetxt;\n\t\n\n\t\/\/-- get schedule for ci or cis\n\/*\tif(_swdoc.MF().tb_schedstart.value>_swdoc.MF().tb_schedend.value)\n\t{\n\t\tMessageBox(\"The schedule from date is greater than the scheduled to date. Please revise.\");\n\t\treturn VALIDATE_FAIL;\n\t}\n\t\n\tvar array_schedule = app.cmdb.check_change_schedule(strCIids, _swdoc.MF().tb_schedstart.value, _swdoc.MF().tb_schedend.value);\n\tfor(intCI in array_schedule)\n\t{\n\t\t\/\/-- for each ci in that has a conflicting schedule get callref (note ci may have more than one conflicting schedule)\n\t\tfor(intCallref in array_schedule[intCI])\n\t\t{\n\t\t\tvar arrayInfo \t = array_schedule[intCI][intCallref].split(\",\");\n\t\t\tvar intRow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems1,intCI,\"pk_auto_id\");\n\t\t\tvar conflictItem = app.g.sl_field(_swdoc.EF().sl_configitems1,intRow,\"ck_config_item\");\n\t\t\t\n\t\t\tvar startDate = app.g.convert_epochdate(arrayInfo[0]);\n\t\t\tvar endDate = app.g.convert_epochdate(arrayInfo[1]);\t\t\t\n\t\t\t\n\t\t\tstrMessage += \"Change Item (\" + conflictItem + \") \\n\";\n\t\t\t \/\/(\" + g.pad_callref(intCallref) + \") between the dates of \" + startDate + \" and \" + endDate + \"\\n\";\n\t\t}\n\t}\n\tif(strMessage!=\"\")\n\t{\n\t\tstrMessage = \"The following items are already scheduled for change during the schedule dates your provided. Do you still wish to submit this request? \\n \\n\" + strMessage;\n\t\tif(confirm(strMessage))\n\t\t{\n\t\t\n\t\t}\n\t\telse\n\t\t{\n\t\t\treturn VALIDATE_FAIL;\n\t\t}\n\t}\n\t*\/\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"OnRecordResolved","code":"OnRecordResolved(strTable)\n{\n\/\/###MessageBox(\"Resolved : \" + strTable) ;\n\tif(IsObjectDefined(\"mainform\") && (strTable==\"bpm_workflow\"))\n\t{\n\t\tvar boolSet = true;\n\t\tvar boolEnable = true;\n\n\t\tif(bpm_workflow.fk_default_sla_new>0)\n\t\t{\n\t\t\tvar boolSLA = bpm_workflow.flg_sla_apply>0;\n\t\t\tif(boolSLA)\n\t\t\t{\n\t\t\t\tvar boolSet = true;\n\t\t\t\tif(_swdoc.boolChangeSLASetManually)\n\t\t\t\t{\n\t\t\t\t\tvar boolOverride = confirm(\"It is recommended to use SLA set against the process.\\n\\n\\Would you like to set the SLA to the process value?\");\n\t\t\t\t\tif(!boolOverride)\n\t\t\t\t\t\tboolSet = false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(boolSet)\n\t\t\t\t{\n\t\t\t\t\tif(bpm_workflow.flg_sla_enforce==1)\n\t\t\t\t\t\tboolEnable = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tboolSet = false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tboolSet = false;\n\t\t}\n\t\t\n\t\tif(boolSet)\n\t\t{\n\t\t\t\/\/-- F0107934\n\t\t\t_swdoc.boolSLAEnforced = false;\n\t\t\t_swdoc.handle_set_sladef(bpm_workflow.fk_default_sla_name,false,true);\n\t\t\tvar boolTempSLASetManually = _swdoc.boolChangeSLASetManually;\n\t\t\t_swdoc.boolChangeSLASetManually = true;\n\t\t\t_swdoc.handle_set_priority(bpm_workflow.fk_default_sla);\n\t\t\t_swdoc.boolChangeSLASetManually = boolTempSLASetManually;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\/\/END\n\t\t\tif(!boolEnable)\n\t\t\t{\n\t\t\t\t_een(mainform.lb_oc_slad1,false);\n\t\t\t\t_een(mainform.label_itsm_sladef,false);\n\t\t\t\t_swdoc.boolSLAEnforced = true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(boolEnable)\n\t\t{\n\t\t\t_een(mainform.lb_oc_slad1,true);\n\t\t\t_een(mainform.label_itsm_sladef,true);\n\t\t\t_swdoc.boolSLAEnforced = false;\n\t\t}\n\n\t\tapp.g.reset_bpm_form_attribute_check(_swdoc);\n\t\tapp.g.process_bpm_form_attribute_check(_swdoc,bpm_workflow.pk_workflow_id);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n\n    if (IsObjectDefined(\"mainform\") && strTable == \"userdb\")\n    {\n      \t\/\/_swdoc.setup_customer_details()\n    \t\n    \t\/\/-- rjc - 2.4.0 - customer changed and site selected, confirm site part of new customers organisation\n\t\tif(_swdoc.OC().site!=\"[Use Customers Site]\"){\n\t\t\tvar recSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\t\tif(recSite)\n\t\t\t{\n\t\t\t\tif(recSite.fk_company_id!=_swdoc.OC().fk_company_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().site = \"[Use Customers Site]\";\n\t\t\t\t\t_ete(_swdoc.MF().lb_oc_site1, \"[Use Customers Site]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(_swdoc.OC().fk_dept_code!=\"[Use Customer Department]\"){\n\t\t\tvar recCC = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(recCC.fk_company_id!=_swdoc.OC().fk_company_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().fk_dept_code = \"[Use Customer Department]\";\n\t\t\t\t\t_ete(_swdoc.MF().fld_oc_dept, \"[Use Customer Department]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/-- check if customer is in active    \t\n    \tvar strCustStatusMsgValue = dd.GetGlobalParamAsString(\"Application Settings\/CustomerStatusMessages\/\" + _swdoc.oCust().status);\n\t\tif(strCustStatusMsgValue!=\"\")\n\t\t{\n\t\t\tMessageBox(strCustStatusMsgValue);\n\t\t}\n\t\t\n\t\t\/\/-- nwj - 2.3.2 - load company record for customer - and show company on resolve message\n\t\t\/\/###20120801\n\t\tif(_swdoc.oCust().fk_company_id != \"\" && _swdoc.oCust().fk_company_id != _swdoc.OC().fk_company_id)\n\t\t{\n\t\t\t\/\/-- rjc - 2.4 - resolve company record if company doesnt exist\n\t\t\t_swdoc.ResolveRecord('company','pk_company_id',_swdoc.oCust().fk_company_id);\n\t\t\tif(_swdoc.oCompany())\n\t\t\t{\n\t\t\t\tif(_swdoc.oCompany().recordresolvedmsg!=\"\")MessageBox(_swdoc.oCompany().recordresolvedmsg);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- there is adata issue here as the customers organisation does not exist\n\t\t\t\tMessageBox(\"The organisation that this customer belongs to cannot be found on the system. Please contact your Supportworks administrator.\");\n\t\t\t}\n\t\t} else if (_swdoc.oCust().fk_company_id != \"\" && _swdoc.oCust().fk_company_id == _swdoc.OC().fk_company_id){\n\t\t\t\/\/###to update dropdown for company correctly.\n\t\t\t_swdoc.multi_c_set_company();\n\t\t}\n\t\t\/\/--F0110887 Start\n\t\tvar intExpiryEpoch = app.g.fix_epoch(_swdoc.oCompany().supportexpiryx);\n\t\tapp.g.checkOrgSupport(_swdoc.oCust().fk_company_id, intExpiryEpoch, true);\n\t\t\/\/--F0110887 End\n\t\t\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\t\n    }    \n    if (IsObjectDefined(\"mainform\") && strTable == \"company\")\n    {\n \n    \t\/\/###20120801\n    \t_swdoc.multi_c_set_company(_swdoc.oCompany().pk_company_id);\n        \n    \tapp.g.strLogAndResolveCompany = _swdoc.OC().fk_company_id;\n \/*###\n    \tif(_swdoc.oCompany().pk_company_id!=_swdoc.oCust().fk_company_id)\n    \t{\n    \t\t_swdoc.ResetRecord('userdb');\n\t\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/OnOrganisationResolveCustomer\")==1)\n\t\t\t{\n\t\t\t\t_swdoc.boolResolvingCust = true;\n\t\t\t\tmainform.SetTimer(1, 10);\n\t\t\t}\n\t\t}\n*\/\t\t\n\t\tif(_swdoc.oCompany().recordresolvedmsg!=\"\")MessageBox(_swdoc.oCompany().recordresolvedmsg);\n\t\t\n\t\tif(_swdoc.OC().site!=\"[Use Customers Site]\"){\n\t\t\tvar recSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\t\tif(recSite)\n\t\t\t{\n\t\t\t\tif(recSite.fk_company_id!=_swdoc.oCompany().pk_company_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().site = \"[Use Customers Site]\";\n\t\t\t\t\t_ete(_swdoc.MF().lb_oc_site1, \"[Use Customers Site]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(_swdoc.OC().costcenter!=\"\"){\n\t\t\tvar recCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(recCC.fk_company_id!=_swdoc.oCompany().pk_company_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().costcenter = \"\";\n\t\t\t\t\t_ete(_swdoc.MF().lb_oc_cc1, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(_swdoc.OC().fk_dept_code!=\"[Use Customer Department]\"){\n\t\t\tvar recCC = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(recCC.fk_company_id!=_swdoc.oCompany().pk_company_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().fk_dept_code = \"[Use Customer Department]\";\n\t\t\t\t\t_ete(_swdoc.MF().fld_oc_dept, \"[Use Customer Department]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/-- Filter Contracts for Company\n\t\tapp.g.filter_company_contracts(_swdoc.OC().fk_company_id, _swdoc.MF().lb_contract);\n\t\t\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\t\n  \t\t_swdoc.check_cis();\n \t\t_swdoc.UpdateFormFromData();\n\t}\n\n}"},{"name":"OnResolveRecord","code":"OnResolveRecord(strTable, strColumn, strValue)\n{\n\/\/###MessageBox(\"Resolve : \" + strTable + \".\" + strColumn + \" = \" + strValue);\n \t\/\/-- resolving the customer record\n \tif(IsObjectDefined(\"mainform\") && strTable == 'userdb' && _swdoc.boolResolvingCust == false && strValue!=\"\")\n \t{\n \t\tvar strWhere = \"\";\n\t\tif (\"companyname\" == strColumn && \"\" != strValue){\n\t\t\t_swdoc.ResolveRecord(\"company\",\"companyname\",strValue);\n \t\t\t_swdoc.strPreSelectedCompany = strValue;\n\t\t}\n  \t\tif(strColumn ==\"firstname!surname\")\n  \t\t{\n  \t\t\t\/\/-- if using customer name search on firstname and lastname\n  \t\t\t\/\/-- 2.4.1 bug fix 79046\n   \t\t\tarrNames = strValue.split(\" \");\n   \t\t\tif(arrNames[1]==undefined)\n   \t\t\t{\n      \t\t\tvar strParams = \"_swc_firstname=\"+arrNames[0];\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0];\n    \t\t}\n   \t\t\telse\n   \t\t\t{\n    \t\t\tvar strLastName=\"\";\n    \t\t\tfor(var y=1;y<arrNames.length;y++)\n    \t\t\t{\n     \t\t\t\tif(y>1)strLastName = strLastName+\" \";\n     \t\t\t\tstrLastName = strLastName+arrNames[y];\n    \t\t\t}\n       \t\t\tvar strParams =  \"_swc_firstname=\"+arrNames[0]+\"&_swc_surname=\"+strLastName;\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0]+\"&surname=\"+strLastName;\n   \t\t\t}\n  \t\t}\n  \t\telse\n  \t\t{\n       \t\tvar strParams =  \"_swc_\"+strColumn+\"=\"+strValue;\n   \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n  \t\t\tvar strSearch = strColumn+\"=\"+strValue;\n   \t\t}\n\t\tif(intCount!=1)\n\t\t{\n\t\t\t_swdoc.strSearchFor = strSearch;\n  \t\t\tmainform.SetTimer(1, 100);\n  \t\t\t_swdoc.boolResolvingCust = true;\n  \t\t\treturn \"\";\n \t\t}\n \t}\n \t if(strTable == \"company\")\n \t{\n \t\t\/\/-- Grab Company Record\n \t\tvar oCompanyTemp = app.g.get_record(\"company\",strValue,'companyname');\n \t\t\/\/--F0110887 Start\n\t\tvar intExpiryEpoch = app.g.fix_epoch(oCompanyTemp.supportexpiryx);\n\t\tapp.g.checkOrgSupport(_swdoc.oCust().companyname, intExpiryEpoch, true);\n\t\t\/\/--F0110887 End\n \t}\n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'company' && strValue ==\"\")\n \t{\n\t\tapp.g.strLogAndResolveCompany = \"\";\n  \t\t\/\/2.4 clear down list if user is being unselected\n  \t\t_swdoc.ResetRecord('userdb');\n \t} \n\n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'bpm_workflow' && strValue ==\"\")\n \t{\n\t\t_een(mainform.lbl_oc_slad1,true);\n\t\t_een(mainform.label_itsm_sladef,true);\n \t\tapp.g.reset_bpm_form_attribute_check(_swdoc);\n \t} \n \n return strValue;\n}"},{"name":"OnLogAndAssignCall","code":"OnLogAndAssignCall(strGroupID, strAnalystID)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.OC().suppgroup = strGroupID;\n\tvar strDefaultGroup = dd.GetGlobalParamAsString(\"Application Settings\/Change\/DefaultAssignmentGroup\");\n\tif(strDefaultGroup!=\"\")\n\t{\n\t\tif(strDefaultGroup!=_swdoc.OC().suppgroup)\n\t\t{\n\t\t\tvar strDefaultAnalyst = dd.GetGlobalParamAsString(\"Application Settings\/Change\/DefaultAssignmentAnalyst\");\n\t\t\tvar strDisplayAnalyst = \":\"+strDefaultAnalyst;\n\t\t\tif(strDefaultAnalyst==\"\")\n\t\t\t\tstrDisplayAnalyst = \"\";\n\t\t\tvar boolConfirm = confirm('The default assignment for change records is '+strDefaultGroup+strDisplayAnalyst+'. Do you want to use the default?');\n\t\t\tif(boolConfirm)\n\t\t\t{\n\t\t\t\t_swdoc.OC().suppgroup = strDefaultGroup;\n\t\t\t\t_swdoc.OC().owner = strDefaultAnalyst;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_swdoc.OC().custom_i3=0;\n\t\n\treturn true;\n}"},{"name":"OnLogCall","code":"OnLogCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strDefaultGroup = dd.GetGlobalParamAsString(\"Application Settings\/Change\/DefaultAssignmentGroup\");\n\tvar strDefaultAnalyst = dd.GetGlobalParamAsString(\"Application Settings\/Change\/DefaultAssignmentAnalyst\");\n\tif(strDefaultGroup!=\"\")\n\t{\n\t\t_swdoc.OC().suppgroup = strDefaultGroup;\n\t\t_swdoc.OC().owner = strDefaultAnalyst;\n\t}\n\t\n\t_swdoc.OC().custom_i3=0;\n\t\n\t\n\treturn true;\n}"},{"name":"OnPreValidate","code":"OnPreValidate()\n{\n\tvar funcFinalValidation = function()\n\t{\n\t\tif (!app.g.resolve_default_priority(_swdoc.OC().priority,_swdoc,\"Change Proposal\"))\n\t\t{\n\t\t\treturn VALIDATE_FAIL;\n\t\t}\n\t\treturn VALIDATE_DEFAULT;\n\t}\n\t\n\t\/\/--F0110887 Start\n\tvar intExpiryEpoch = app.g.fix_epoch(_swdoc.oCompany().supportexpiryx);\n\tvar boolOrgSupported = new Boolean(app.g.checkOrgSupport(_swdoc.oCust().companyname, intExpiryEpoch, false));\n\tif (boolOrgSupported==false)\n\t{\n\t\t MessageBox(\"You cannot log a call for this customer as the '\" + _swdoc.oCust().companyname + \"' organisation is no longer supported.\");\n\t\t return VALIDATE_FAIL;\n\t}\n\t\/\/--F0110887 End\n\t\n\tvar boolResolve = false;\n\tif(\t_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\"||_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Workflow SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\tboolResolve = true;\n\t\t\n\tif(boolResolve)\n\t{\n\t\tvar boolOK = _swdoc.handle_set_sladef(_swdoc.OC().itsm_slaname,true);\n\t\tif(!boolOK)\n\t\t\treturn VALIDATE_FAIL;\n\t}\n\t\n\t\/\/ DTH: F0097667 Impact Level Assessment. Enforce selection of Options for ILA Criteria if ILA is Enabled AND Mandatory\n\tif (_swdoc.boolILAEnabled && _swdoc.boolILAMandatory)\n\t{\n\t\tif (_swdoc.OC().flg_ila_complete != 1)\n\t\t{\n\t\t\tMessageBox(\"Impact Level Assessment must be complete before the request can be logged\");\n\t\t\treturn VALIDATE_FAIL;\n\t\t}\n\t}\n\t\n\t\/\/ DTH: F0097668 Lead Time Check. Enforce certain options and field population if the Lead Time linked to the Impact is > 0\n\tvar intRequestedDate = app.g.fix_epoch(_swdoc.OC().requested_start_datex);\n\tif ((_swdoc.arrImpactLeadTimes[_swdoc.OC().itsm_impact_level] > 0) && (intRequestedDate > 0))\n\t{\n\t\tvar intNow = new Date();\n\t\tintNow = Math.round(intNow.getTime() \/ 1000);\n\t\tvar intLeadTimeExpiry = app.g.get_sla_end_date(intNow, _swdoc.OC().priority, Number(_swdoc.arrImpactLeadTimes[_swdoc.OC().itsm_impact_level]) + Number(1));\n\t\tif (intLeadTimeExpiry > intRequestedDate)\n\t\t{\n\t\t\tif ((_swdoc.RFC_EXT().justification == \"\") || ((_swdoc.OC().itsm_rfc_timing != \"Emergency\") && (_swdoc.OC().itsm_rfc_timing != \"Urgent\")))\n\t\t\t{\n\t\t\t\tvar strMessage = \"The Desired Start for this request occurs before the Lead Time associated with the Impact.\\n\";\n\t\t\t\tstrMessage += \"You must either alter the Desired Start or enter a Justification and set the Timing to Urgent or Emergency.\";\n\t\t\t\tMessageBox(strMessage);\n\t\t\t\treturn VALIDATE_FAIL;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\/\/ DTH: Lead Time Check. Check that the Desired (Requested) End date is after the Desired Start Date\n\tvar intRequestedEnd = app.g.fix_epoch(_swdoc.OC().requested_end_datex);\n\tif ((intRequestedDate > 0) && (intRequestedEnd > 0) && (intRequestedEnd < intRequestedDate))\n\t{\n\t\tMessageBox(\"The Desired End Date must occur after the Desired Start Date\");\n\t\treturn VALIDATE_FAIL;\n\t}\n\n\n\t\/\/###20120802 check cc, dept, site in org?\n\tvar iCaptureMistakes = 0;\n\tvar intMistakeCounter = 0;\n\tvar tDept; \/\/ needs to remain outside as department name is NOT the fk_dept_code but dept_name\n\tif (\"\" !== _swdoc.OC().site && \"[Use Customer's Site]\" !== _swdoc.OC().site){\n\t\ttSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\tif (tSite.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 1;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (\"\" !== _swdoc.OC().costcenter ){\n\t\tvar tCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\tif (tCC.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 2;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (\"\" !== _swdoc.OC().fk_dept_code && \"[Use Customer's Department]\" !== _swdoc.OC().fk_dept_code){\n\t\ttDept = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\tif (tDept.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 4;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (iCaptureMistakes > 0)\n\t{\n\t\tvar strDetectedMistakes = \"\";\n\t\tvar intDealtWithMistakes = 0;\n\t\tif ( 1 == (iCaptureMistakes % 2) ) {\n\t\t\tstrDetectedMistakes += \"site (\" + _swdoc.OC().site + \")\";\n\t\t\tintDealtWithMistakes++;\n\t\t}\n\t\tif ( 1 == (Math.floor(iCaptureMistakes \/ 2) % 2) ) {\n\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":((2==intMistakeCounter)?\" and \":\", \")) + \"charge centre (\" + _swdoc.OC().costcenter + \")\";\n\t\t\tintDealtWithMistakes++;\n\t\t}\n\t\tif ( 1 == (Math.floor(iCaptureMistakes \/ 4) % 2) ) {\n\t\t\tif(!tDept.dept_name)\n\t\t\t{\n\t\t\t\t\/\/-- F0108424\n\t\t\t\t_swdoc.oCust = app.g.get_record(\"userdb\", _swdoc.OC().cust_id);\n\t\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":\" and \") + \"department (\"+_swdoc.oCust.department+\") does not exist and\";\n\t\t\t}else\n\t\t\t{\n\t\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":\" and \") + \"department (\" + tDept.dept_name + \")\";\n\t\t\t}\n\t\t\t\/\/-- F0108424\n\n\t\t}\n\t\tMessageBox(\"The \" + strDetectedMistakes + \" \" + ((1==intMistakeCounter)?\"is\":\"are\") + \" NOT part of \" + _swdoc.OC().companyname + \".\\n\\nSelect 'OK' to proceed with the current data.\", MB_OKCANCEL | MB_ICONEXCLAMATION , function(intResponse)\n\t\t{\n\t\t\tif (2==intResponse)\n\t\t\t{\n\t\t\t\treturn VALIDATE_FAIL;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn funcFinalValidation();\n\t\t\t}\n\t\t});\n\t\t\n\t}\n\telse\n\t{\n\t\treturn funcFinalValidation();\n\t}\t\n}"},{"name":"OnFormClosing","code":"OnFormClosing()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tapp.g.strLogAndResolveContract = \"\";\n\tapp.g.strLogAndResolveCompany = \"\";\n\t\n\tapp.strRAKbDocFilter=\"\";\n\t\n\treturn true;\n}"},{"name":"OnAcceptCall","code":"OnAcceptCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\n\t_swdoc.OC().custom_i3=0;\n\n\treturn true;\n}"},{"name":"OnTakeCall","code":"OnTakeCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\n\t_swdoc.OC().custom_i3=0;\n\n\treturn true;\n}"}]}}},"layout":{"appearance":{"width":"874","height":"459","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Field10","type":"Field","group":"TabCust:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"118","left":"99","right":"320","bottom":"136"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.raised_by_analystid"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field10","type":"Field","group":"TabCust:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"140","left":"99","right":"320","bottom":"158"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.raised_by_name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_rbsupp","type":"Field","group":"TabCust:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"162","left":"99","right":"320","bottom":"180"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.raised_by_group"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"General Support","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","sqlSource":"syscache","distinctTable":"swgroups","distinctColumn":"id","displayColumn":"name","borderColor":"#c0c0c0","storedQuery":"common.getSupGroups"}}},{"general":{"name":"Field7","type":"Field","group":"TabCust:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"184","left":"99","right":"320","bottom":"202"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.raised_by_telephone"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field8","type":"Field","group":"TabCust:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"206","left":"99","right":"320","bottom":"224"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.raised_by_email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"btn_pick_rb","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"5","caption":"Pick Analyst","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"228","left":"216","right":"320","bottom":"251"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"tb_title","type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"304","left":"107","right":"863","bottom":"322"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"opencall.itsm_title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_update","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"326","left":"107","right":"863","bottom":"450"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"updatedb.updatetxt"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_profile","type":"Field"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"279","left":"478","right":"865","bottom":"297"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"data":{"binding":"opencall.probcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Click on this field to browse for and select a category for this call","activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_oc_slad1","type":"Field","group":"TabDet:0"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"113","left":"430","right":"581","bottom":"131"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_slaname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"itsmsp_slad","distinctColumn":"slad_id","listFilter":"_swc_archive=0","extraOptions":"[Use Customer SLA]=&[userdb.sld_name]^[Use Profile SLA]=&[_form.profilesla]^[Use Charge Centre SLA]=&[costcent.itsm_sla]^[Use Process SLA]=&[bpm_workflow.fk_default_sla_new]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"requests.filter_itsm_sla"}}},{"general":{"name":"Field9","type":"Field","group":"TabDet:0"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"135","left":"430","right":"528","bottom":"153"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Critical|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_impact_lvl","distinctColumn":"pk_impact","storedQuery":"generic.select"}}},{"general":{"name":"Field11","type":"Field","group":"TabDet:0"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"157","left":"430","right":"581","bottom":"175"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_urgency_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Immediate|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_urgency_lvl","distinctColumn":"pk_urgency","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_sla","type":"Field","group":"TabDet:0"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"179","left":"430","right":"581","bottom":"197"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"itsmsp_slad_priority","distinctColumn":"fk_priority","listFilter":"_swc_flg_sla=1&_swc_fk_slad=&[opencall.itsm_sladef]","extraOptions":"[Use SLA Default Priority]=&[itsmsp_slad.fk_priority]^[Use Customer Priority]=&[userdb.priority]^[Use Charge Centre Priority]=&[costcent.priority]^[Use Profile Priority]=&[_form.probcodesla]^[Use Process Priority]=&[bpm_workflow.fk_default_sla]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lb_contract","type":"Field","group":"TabDet:0"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"201","left":"430","right":"581","bottom":"219"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"contract","distinctColumn":"pk_contract_id","displayColumn":"title","disabledBackgroundColor":"#eeeeee","storedQuery":"requests.filter_company_contracts"}}},{"general":{"name":"fld_environment","type":"Field","group":"TabDet:0"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"238","left":"430","right":"581","bottom":"256"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.environment"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","storedQuery":"common.getSwLists","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ORIGIN","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"btn_ila_assess","type":"EventButton","group":"TabDet:0"},"appearance":{"index":"15","caption":"Assess","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"133","left":"533","right":"581","bottom":"153"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"pl_oc_org","type":"Field","group":"TabDet:0"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"107","left":"692","right":"843","bottom":"125"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Organisation]=[Use Customer's Organisation]","hintText":"The organisation for this call","image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"company","distinctColumn":"pk_company_id","displayColumn":"companyname","disabledBackgroundColor":"#eeeeee","storedQuery":"requests.filter_multi_organisation"}}},{"general":{"name":"lb_oc_cc1","type":"Field","group":"TabDet:0"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"129","left":"692","right":"843","bottom":"147"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"The charge centre for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[opencall.fk_company_id]","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_site1","type":"Field","group":"TabDet:0"},"appearance":{"index":"18","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"151","left":"692","right":"843","bottom":"169"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.site"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Site]","hintText":"The site at which change request is being implemented","distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[opencall.fk_company_id]","extraOptions":"[Use Customer's Site]=&[userdb.site]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_oc_dept","type":"Field","group":"TabDet:0"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"173","left":"692","right":"843","bottom":"191"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Department]","sqlSource":"swdata","distinctTable":"department","distinctColumn":"pk_dept_code","listFilter":"_swc_fk_company_id=&[opencall.fk_company_id]","extraOptions":"[Use Customer's Department]=&[userdb.department]","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee","storedQuery":"generic.select","displayColumn":"dept_name"}}},{"general":{"name":"tb_schedstart2","type":"Field","group":"TabDet:0"},"appearance":{"index":"20","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"195","left":"692","right":"843","bottom":"213"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.itsm_requiredbyx"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_bpm_workflow","type":"Field","group":"TabDet:0"},"appearance":{"index":"21","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"217","left":"692","right":"843","bottom":"235"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"bpm_workflow.pk_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","sqlSource":"swdata","distinctTable":"bpm_workflow","distinctColumn":"pk_workflow_id","disabledBackgroundColor":"#eeeeee","listFilter":"_swc_callclass=Change Proposal&_swc_flg_active=1","borderColor":"#c0c0c0","storedQuery":"requests.filter_bpm_selection"}}},{"general":{"name":"Field2","type":"Field","group":"TabDet:0"},"appearance":{"index":"22","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"238","left":"692","right":"843","bottom":"256"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","storedQuery":"common.getSwLists","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ORIGIN","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"mb_cust","type":"MenuButton","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"23","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"38","left":"276","right":"338","bottom":"63"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900","commands":"Search Customer^1|Customer Properties^2|Selfservice Wizard Input^3|"}}},{"general":{"name":"TabDet","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"24","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"69","left":"359","right":"865","bottom":"264"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Assessment \/ Options","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Timing","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}},{"name":"Assessment","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"flg_notify_sw","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"25","backgroundColor":"#f2eedd","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"710","left":"50","right":"309","bottom":"730"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.itsm_swtoday_on"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"Display notification on Supportworks today page^1|","disabledBackgroundColor":"#336699"}}},{"general":{"name":"flg_notify_ss","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"26","backgroundColor":"#f2eedd","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"710","left":"370","right":"566","bottom":"730"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.itsm_selfservice_on"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"Display notification on SelfService^1|","disabledBackgroundColor":"#336699"}}},{"general":{"name":"TabCust","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"27","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"69","left":"9","right":"336","bottom":"264"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Analyst","properties":"56=#ffffff|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f"}}},{"name":"Monitored By","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Customer","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"Field10","type":"Field","group":"TabCust:1"},"appearance":{"index":"28","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"118","left":"99","right":"320","bottom":"136"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.monitored_by_analystid"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field10","type":"Field","group":"TabCust:1"},"appearance":{"index":"29","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"140","left":"99","right":"320","bottom":"158"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.monitored_by_name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_mbsupp","type":"Field","group":"TabCust:1"},"appearance":{"index":"30","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"162","left":"99","right":"320","bottom":"180"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.monitored_by_group"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","sqlSource":"syscache","distinctTable":"swgroups","distinctColumn":"id","displayColumn":"name","borderColor":"#c0c0c0","storedQuery":"common.getSupGroups"}}},{"general":{"name":"Field7","type":"Field","group":"TabCust:1"},"appearance":{"index":"31","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"184","left":"99","right":"320","bottom":"202"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.monitored_by_telephone"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field8","type":"Field","group":"TabCust:1"},"appearance":{"index":"32","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"206","left":"99","right":"320","bottom":"224"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.monitored_by_email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel2","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"33","caption":"Settings","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"39","left":"354","right":"869","bottom":"270"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_alarm.png"}}},{"general":{"name":"lb_company","type":"Field","group":"TabCust:2"},"appearance":{"index":"34","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"103","left":"106","right":"327","bottom":"121"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.companyname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_customerid","type":"Field","group":"TabCust:2"},"appearance":{"index":"35","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"125","left":"106","right":"327","bottom":"143"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"SearchField1","type":"DualSearchField","group":"TabCust:2"},"appearance":{"index":"36","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"147","left":"106","right":"327","bottom":"165"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.firstname!surname"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"name":"fld_userdb_site","type":"Field","group":"TabCust:2"},"appearance":{"index":"37","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"169","left":"106","right":"327","bottom":"187"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.site"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfSite","editRecordForm":"Form.EfSite","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_userdb_costcenter","type":"Field","group":"TabCust:2"},"appearance":{"index":"38","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"582","left":"106","right":"327","bottom":"600"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"tb_tel","type":"Field","group":"TabCust:2"},"appearance":{"index":"39","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"212","left":"106","right":"327","bottom":"230"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"Field","group":"TabCust:2"},"appearance":{"index":"40","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"234","left":"106","right":"327","bottom":"252"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageList":"Helpdesk Icons","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_ttel","type":"Field","group":"TabCust:2"},"appearance":{"index":"41","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"670","left":"107","right":"328","bottom":"688"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_temptel"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_temail","type":"Field","group":"TabCust:2"},"appearance":{"index":"42","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"692","left":"107","right":"328","bottom":"710"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_tempemail"},"controlInfo":{"mouseOverCursor":"Window Default","type":"E-mail Address","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageList":"Helpdesk Icons","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"43","caption":"Requested By","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"39","left":"1","right":"345","bottom":"270"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_group.png"}}},{"general":{"name":"Rect1","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"44","backgroundColor":"#ffffff","foregroundColor":"#c0c0c0","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"101","left":"368","right":"596","bottom":"233"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#c0c0c0"}}},{"general":{"name":"Text1","type":"Text","group":"TabDet:0"},"appearance":{"index":"45","caption":"Assessment Levels","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"92","left":"375","right":"479","bottom":"111"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_oc_priority","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"46","caption":"Priority","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"179","left":"372","right":"425","bottom":"197"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"name":"Rect1","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"47","backgroundColor":"#ffffff","foregroundColor":"#c0c0c0","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"101","left":"603","right":"856","bottom":"260"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#c0c0c0"}}},{"general":{"name":"Text11","type":"Text","group":"TabDet:0"},"appearance":{"index":"48","caption":"Options","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"92","left":"611","right":"658","bottom":"111"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"49","caption":"Customer ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"125","left":"17","right":"102","bottom":"143"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"50","caption":"Customer Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"147","left":"17","right":"102","bottom":"165"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"51","caption":"Main Site","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"169","left":"17","right":"102","bottom":"187"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.site"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfSite","editRecordForm":"Form.EfSite","sqlSource":"swdata"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"52","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"582","left":"17","right":"102","bottom":"600"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","sqlSource":"swdata"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"53","caption":"Tel. No.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"212","left":"17","right":"102","bottom":"230"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"54","caption":"E-Mail","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"234","left":"17","right":"102","bottom":"252"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"55","caption":"Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"140","left":"10","right":"95","bottom":"158"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"56","caption":"Support Group","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"162","left":"10","right":"95","bottom":"180"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"57","caption":"Telephone","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"184","left":"10","right":"95","bottom":"202"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"58","caption":"Email","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"206","left":"10","right":"95","bottom":"224"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"59","caption":"Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"140","left":"10","right":"95","bottom":"158"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"60","caption":"Support Group","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"162","left":"10","right":"95","bottom":"180"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"61","caption":"Telephone","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"184","left":"10","right":"95","bottom":"202"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"62","caption":"Email","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"206","left":"10","right":"95","bottom":"224"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_pick_mb","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"63","caption":"Pick Analyst","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"228","left":"216","right":"320","bottom":"251"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"64","caption":"Analyst ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"118","left":"10","right":"95","bottom":"136"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"65","caption":"Analyst ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"118","left":"10","right":"95","bottom":"136"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_bpm_workflow","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"66","caption":"Process","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"217","left":"612","right":"688","bottom":"235"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.bpm_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text31","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"67","caption":"Impact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"135","left":"376","right":"425","bottom":"153"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text32","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"68","caption":"Urgency","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"157","left":"376","right":"425","bottom":"175"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"CaptionPanel3","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"69","caption":"Description","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"276","left":"2","right":"869","bottom":"455"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_document.png"}}},{"general":{"name":"t4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"70","caption":"Category","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"279","left":"416","right":"474","bottom":"297"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"71","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"129","left":"612","right":"688","bottom":"147"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"lbl_company","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"72","caption":"Main Organisation","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"103","left":"34","right":"102","bottom":"121"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.companyname"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"73","caption":"Preferred Tel. No.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"670","left":"18","right":"103","bottom":"688"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.itsm_temptel"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"74","caption":"Preferred E-Mail","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"692","left":"18","right":"103","bottom":"710"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.itsm_tempemail"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"75","caption":"Site Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"151","left":"612","right":"688","bottom":"169"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.site"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"Label17","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"76","caption":"Summary","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"304","left":"8","right":"97","bottom":"322"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.itsm_title"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label8","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:2"},"appearance":{"index":"77","caption":"Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"191","left":"39","right":"102","bottom":"207"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.department"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_userdb_dept","type":"Field","group":"TabCust:2"},"appearance":{"index":"78","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"191","left":"106","right":"327","bottom":"209"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.department"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"department","distinctColumn":"pk_dept_code","displayColumn":"dept_name","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","newRecordForm":"Form.EfDepartment","storedQuery":"generic.select"}}},{"general":{"name":"Label9","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"79","caption":"Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"173","left":"612","right":"688","bottom":"189"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"CaptionPanel4","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"80","caption":"Log New Change Proposal","backgroundColor":"#c0a0ff","foregroundColor":"#003366","font":{"@size":"18"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"5","left":"1","right":"869","bottom":"35"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#f1f1f1","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"30","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"81","caption":"Details","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"326","left":"12","right":"97","bottom":"344"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"label_itsm_sladef","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"82","caption":"SLA","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"113","left":"370","right":"425","bottom":"131"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"name":"Label14","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"83","caption":"Required By","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"195","left":"615","right":"688","bottom":"213"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_requiredbyx"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_oc_slad2","type":"Field"},"appearance":{"index":"84","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"196","left":"890","right":"1041","bottom":"214"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"itsmsp_slad","distinctColumn":"pk_slad_id","extraOptions":"[Use Customer SLA]=&[userdb.sld]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","displayColumn":"slad_id"}}},{"general":{"name":"lbl_contract","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"85","caption":"Contract","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"202","left":"376","right":"425","bottom":"218"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label21","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:1"},"appearance":{"index":"86","caption":"Justification","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"162","left":"348","right":"434","bottom":"178"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.justification"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field21","type":"Field","group":"TabDet:1"},"appearance":{"index":"87","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"162","left":"438","right":"848","bottom":"202"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.justification"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label22","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:1"},"appearance":{"index":"88","caption":"Desired Start","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"118","left":"348","right":"434","bottom":"136"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.requested_start_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field22","type":"Field","group":"TabDet:1"},"appearance":{"index":"89","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"118","left":"438","right":"589","bottom":"136"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.requested_start_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"dateFormatMode":"0","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label23","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:1"},"appearance":{"index":"90","caption":"Desired End","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"118","left":"612","right":"693","bottom":"136"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.requested_end_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field23","type":"Field","group":"TabDet:1"},"appearance":{"index":"91","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"118","left":"697","right":"848","bottom":"136"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.requested_end_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"dateFormatMode":"0","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label24","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:1"},"appearance":{"index":"92","caption":"Timing","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"140","left":"348","right":"434","bottom":"158"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_rfc_timing"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field24","type":"Field","group":"TabDet:1"},"appearance":{"index":"93","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"140","left":"438","right":"589","bottom":"158"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_rfc_timing"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"sqlSource":"swdata","distinctTable":"swlists","distinctColumn":"value","listFilter":"lid=CHANGE-TIMING","image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee","storedQuery":"common.getSwList"}}},{"general":{"name":"sl_ABAs1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"tabRisk:0"},"appearance":{"index":"94","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"143","left":"371","right":"855","bottom":"252"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_area_id"},"name":"Business Area","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"known_as"},"name":"Known As","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"principle_contact"},"name":"Contact","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"group_email_address"},"name":"Email","width":"120","image":"-1","dataColumn":"3"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#d3c9b6","sqlSource":"swdata","table":"affected_bus_area","listFilter":"_kv=-1","editRecordForm":"Form.EfAffectedBusinessArea","selectionMode":"1","storedQuery":"request.change.log.aba_tabledata"}}},{"general":{"name":"mb_email_aba1","type":"MenuButton","group":"tabRisk:0"},"appearance":{"index":"95","caption":"Action","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"119","left":"661","right":"723","bottom":"140"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900","commands":"Email Selected^1|Email All^2|"}}},{"general":{"name":"btn_remove_aba1","type":"EventButton","group":"tabRisk:0"},"appearance":{"index":"96","caption":"Remove","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"119","left":"728","right":"790","bottom":"140"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_add_aba1","type":"EventButton","group":"tabRisk:0"},"appearance":{"index":"97","caption":"Add New","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"119","left":"794","right":"856","bottom":"140"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"tabRisk","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:2"},"appearance":{"index":"98","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"94","left":"365","right":"860","bottom":"257"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"tabStyle":"Top","tabSize":"19","items":{"item":{"name":"Affected Business Area","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}}},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:1"},"appearance":{"index":"99","caption":"Estimated Downtime","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"141","left":"593","right":"697","bottom":"157"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.est_downtime"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field1","type":"Field","group":"TabDet:1"},"appearance":{"index":"100","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"140","left":"697","right":"848","bottom":"158"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"itsm_opencall_rfc.est_downtime"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Minute Time Period","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lbl_oc_company","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"101","caption":"Organisation","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"107","left":"612","right":"691","bottom":"125"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.companyname"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field30","type":"Field"},"appearance":{"index":"102","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"480","left":"670","right":"874","bottom":"496"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.itsm_hide_fsc"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"1","flagItems":"Hide Proposal from Change Schedule^1|","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"103","caption":"Origin","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"238","left":"652","right":"688","bottom":"254"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_environment","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"104","caption":"Environment","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"240","left":"364","right":"425","bottom":"256"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.environment"},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"btn_pick_worka_OnPressed","code":"btn_pick_worka_OnPressed()\r\n{\r\n    \/\/ TODO: Add your event code here\r\n    MessageBox(\"Open list of analysts to select from for the analyst to do work\",MB_OK);\r\n    \r\n}\r\n\r\n"},{"name":"btn_pick_raiseda_OnPressed","code":"btn_pick_raiseda_OnPressed()\r\n{\r\n    \/\/-- NWJ 17.03.2004\r\n   \/\/-- open analyst search form in select mode\r\n\r\n    \/\/ Create an instance of a PopupForm class\r\n    var form = new PopupForm();\r\n\r\n    \/\/ Open the form TbSites\r\n    if(form.Open(\"tbAnalysts\",\"\",\"\"))\r\n    {\r\n        \/\/-- Access the forms _swdoc and call the _swdoc.GetVariable() method with the name of the variable\r\n        var stranalystid = form.document.analystid;\r\n        if (stranalystid == \"\") return;\r\n\r\n        \/\/-- assign values\r\n        var oe = elements;\r\n        _ete(oe[\"db.rfc_sb_id\"] , stranalystid);\r\n        _ete(oe[\"db.rfc_sb_name\"] , form.document.name);\r\n        _ete(oe[\"db.rfc_sb_sg\"] , form.document.group);\r\n        _ete(oe[\"db.rfc_sb_tel\"] ,form.document.phone);\r\n        _ete(oe[\"db.rfc_sb_email\"] , form.document.email);\r\n    }\r\n}\r\n\r\n"},{"name":"btn_pick_sb_OnPressed","code":"btn_pick_sb_OnPressed()\r\n{\r\n   \/\/-- NWJ 17.03.2004\r\n   \/\/-- open analyst search form in select mode\r\n\r\n    \/\/ Create an instance of a PopupForm class\r\n    var form = new PopupForm();\r\n\r\n    \/\/ Open the form TbSites\r\n    if(form.Open(\"tbAnalysts\",\"\",\"\"))\r\n    {\r\n        \/\/-- Access the forms _swdoc and call the _swdoc.GetVariable() method with the name of the variable\r\n        var stranalystid = form.document.analystid;\r\n        if (stranalystid == \"\") return;\r\n\r\n        \/\/-- assign values\r\n        var oe = elements;\r\n        _ete(oe[\"db.rfc_sb_id\"] , stranalystid);\r\n        _ete(oe[\"db.rfc_sb_name\"] , form.document.name);\r\n        _ete(oe[\"db.rfc_sb_sg\"] , form.document.group);\r\n        _ete(oe[\"db.rfc_sb_tel\"] ,form.document.phone);\r\n        _ete(oe[\"db.rfc_sb_email\"] , form.document.email);\r\n                _swdoc.opencall.itsm_rfc_sb_id = stranalystid;\r\n                _swdoc.opencall.itsm_rfc_sb_name = form.document.name;\r\n                _swdoc.opencall.itsm_rfc_sb_group = form.document.group;\r\n                _swdoc.opencall.itsm_rfc_sb_tel = form.document.phone;\r\n                _swdoc.opencall.itsm_rfc_sb_email = form.document.email;\r\n    }\r\n    \r\n}\r\n\r\n"},{"name":"btn_pick_rb_OnPressed","code":"btn_pick_rb_OnPressed()\n{\n\t\/\/-- select analyst who requested this change\n\tapp.g.pick_analyst(\"Select raised by Analyst\", function(oAnalyst)\n\t{\n\t\tif(oAnalyst)\n\t\t{\n\t\t\t_swdoc.set_rfc_analyst(oAnalyst,false);\n\t\t}\n\t});\n}"},{"name":"btn_pick_sb_as_rb_OnPressed","code":"btn_pick_sb_as_rb_OnPressed()\r\n{\r\n        \/\/-- NWJ - 18.03.2004\r\n        \/\/-- assign same values to sb as rb analyst\r\n        var oe = elements;\r\n        _ete(oe[\"db.rfc_sb_id\"], oe[\"db.rfc_rb_id\"].text) \r\n        _ete(oe[\"db.rfc_sb_name\"], oe[\"db.rfc_rb_name\"].text) \r\n        _ete(oe[\"db.rfc_sb_sg\"],oe[\"db.rfc_rb_sg\"].text) \r\n        _ete(oe[\"db.rfc_sb_tel\"] , oe[\"db.rfc_rb_tel\"].text) \r\n        _ete(oe[\"db.rfc_sb_email\"] , oe[\"db.rfc_rb_email\"].text) \r\n        _swdoc.opencall.itsm_rfc_sb_id = oe[\"db.rfc_sb_id\"].text;\r\n        _swdoc.opencall.itsm_rfc_sb_name = oe[\"db.rfc_sb_name\"].text;\r\n        _swdoc.opencall.itsm_rfc_sb_group = oe[\"db.rfc_sb_sg\"].text;\r\n        _swdoc.opencall.itsm_rfc_sb_tel = oe[\"db.rfc_sb_tel\"].text\r\n        _swdoc.opencall.itsm_rfc_sb_email = oe[\"db.rfc_sb_email\"].text\r\n    \r\n}\r\n\r\n"},{"name":"btn_logrfc_OnPressed","code":"btn_logrfc_OnPressed()\r\n{\r\n    \/\/-- NWJ - 17.03.2004\r\n    \/\/-- log new rfc\r\n\r\n    MessageBox(\"RFC Logged\")\r\n\r\n    var hdcon = new HelpdeskSession;\r\n    If(hdcon.Connect())\r\n    {\r\n\r\n        if(hdcon.BeginLogCall())\r\n        {   \r\n            \/\/ We send our transaction values one by one\r\n            hdcon.SendText (\"description\", \"Attached is my win.ini\");\r\n\r\n            if(hdcon.Commit())MessageBox(\"RFC Created\");\r\n        }\r\n\r\n        \/\/ We have finished with the connection, close it.    \r\n        hdcon.Close();\r\n    } \r\n    \r\n}\r\n\r\n"},{"name":"btn_sb_analyst_OnPressed","code":"btn_sb_analyst_OnPressed()\r\n{\r\n    \/\/ TODO: Add your event code here\r\nmainform.UpdateFormFromData();\r\n    \r\n}\r\n\r\n"},{"name":"btn_pick_mb_OnPressed","code":"btn_pick_mb_OnPressed()\n{\n\t\/\/-- select analyst that should monitor the progress or be contact in case on any problems\n\tvar oAnalyst = app.g.pick_analyst(\"Select monitoring Analyst\");\n\t_swdoc.set_rfc_analyst(oAnalyst,true);\t\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- Workaround for Analyst Portal to load global js on load functions if not loaded\n\tif(!gbl_initialised)\n\t\tglobal_init_configuration();\n\n\t\/\/-- F0105032\n\tif(_swdoc._form.PreloadType==2)\n\t{\n\t\t_swdoc.oOpencall = app.g.get_sys_record(\"opencall\", _swdoc.OC().callref);\n\t\t_swdoc.oExtended = app.g.get_record(\"itsm_opencall_rfc\", _swdoc.OC().callref);\n\t}\n\t\/\/-- EOF F0105032\n\n\t\/\/-- F0105553\n\tif(_swdoc.oCust().keysearch)\n\t{\n\t\tif(_swdoc.oCust().fk_company_id!=_swdoc.oCompany().pk_company_id)\t\n\t\t{\n\t\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", _swdoc.oCust().fk_company_id);\n\t\t}\n\t}\n\t\/\/-- EOF F0105553\n\t\/\/ -- Update Main Organisation on the form if only the Organisation is set\n\tif(_swdoc.oCompany().pk_company_id && _swdoc.oCust().keysearch ==\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"userdb\", \"fk_company_id\", _swdoc.oCompany().pk_company_id);\n\t}\n\t\t\n\t\/\/-- 12.07.2008 \n\t\/\/-- disable or hide company field if internal support only\n\tvar boolExternalCompanies =dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1;\n\t_een(_swdoc.MF().lb_company, boolExternalCompanies);\n\t_evi(_swdoc.MF().lb_contract, boolExternalCompanies);\n\t_evi(_swdoc.MF().lbl_contract, boolExternalCompanies);\n\tif(!_swdoc.MF().lb_company.enable)\n\t{\n\t\t\/\/-- check if we should hide\n\t\tvar boolHideCompanyField = (dd.GetGlobalParamAsString(\"Application Settings\/HideCompanyField\")!=1);\n\t\t_evi(_swdoc.MF().lb_company, boolHideCompanyField);\t\t\n\t\t\/\/alter filter if we do not support external\n\t\t\n\t\t_slf(_swdoc.MF().fld_userdb_site,\"\");\n\t\t_slf(_swdoc.MF().fld_userdb_costcenter,\"\");\n\t\t_slf(_swdoc.MF().fld_userdb_dept,\"\");\t\n\t\t_slf(_swdoc.MF().lb_oc_cc1,\"\");\n\t\t_slf(_swdoc.MF().lb_oc_site1,\"\");\n\t\t_slf(_swdoc.MF().fld_oc_dept,\"\");\n\t}\n\t\/\/###20120801 ensure correct field for organisation is showing - workaround because distinct picklist with Display is broken\n\tvar boolCompanyFieldVisible = (_swdoc.MF().lb_company.visible);\n\t_evi(_swdoc.MF().lbl_oc_company, boolCompanyFieldVisible);\n\n\tvar boolCompanySet = (\"\" !== _swdoc.OC().fk_company_id);\n\t\n\t_evi(_swdoc.MF().pl_oc_org, boolCompanyFieldVisible);\n\t_een(_swdoc.MF().pl_oc_org, boolExternalCompanies);\n\t\n\t_evi(_swdoc.MF().lbl_company, boolCompanyFieldVisible);\t\n\t\/\/-- eof hide \/ enable\t    \n\n\t\/\/--\n\t\/\/-- if logging ofr a customer\n\tif(app.g.LOG_CALL_FOR_USER!=\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", app.g.LOG_CALL_FOR_USER);\n\t\tapp.g.LOG_CALL_FOR_USER=\"\";\n\t}\n\telse if(app.g.LOG_FOR_ORGID!=\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", app.g.LOG_FOR_ORGID);\t\n\t\tapp.g.LOG_FOR_ORGID=\"\";\n\t}\n\t\n\t\n\t\/\/-- NWJ - 28.02.2006\n\t\/\/--      get any incoming cis (logged from ss)\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems1, _swdoc.OC().callref ,\"INCOMING\",\"\")\t\n\n\t\/\/F0108068\n\tif(app.g.LOG_CALL_FOR_CI!=\"\")\n\t{\n\t\tvar strCIKey = \"\"+app.g.LOG_CALL_FOR_CI;\n\t\t_swdoc.link_cause_cis_to_change(strCIKey);\n\t\t\/\/app.g.sl_appendfilter(_swdoc.EF().sl_configitems1, app.g.LOG_CALL_FOR_CI,'pk_auto_id');\n \t\tapp.g.LOG_CALL_FOR_CI=\"\";\n\t}\n\n\tvar oAnalyst = app.g.get_analyst_detail(app.session.analystId);\n\t_swdoc.set_rfc_analyst(oAnalyst,false);\t\n\t\n\n\t\/\/--\n\t\/\/-- check if we are raising this problem from an incident\n\tif(app.g.LOG_FROM_CALL!=null)\n\t{\t\n\t\t\/\/-- store incident record info (uses global params to determine what to store)\n\t\tif(app.g.LOG_FROM_CALL.callclass==\"Incident\")\t\t\n\t\t{\n\t\t\t_swdoc.filter_inc_impact(app.g.LOG_FROM_CALL.callref);\t\t\t\n\t\t}\n\t\t\n\t\t\/\/-- store prob\/ke record (uses global params to determine what to store)\n\t\tif(app.g.LOG_FROM_CALL.callclass==\"Known Error\")\n\t\t{\n\t\t\t_swdoc.filter_ke_impact(app.g.LOG_FROM_CALL.callref);\n\t\t}\n\t\t\n\t\t\/\/-- show customer impacted by the log from call\n\t\tif(app.g.LOG_FROM_CALL.cust_id!=\"\")\n\t\t{\n\t\t\t_swdoc.filter_impact_customers(_swdoc.EF());\n\t\t\t_swdoc.ResolveRecord(\"userdb\",\"keysearch\", app.g.LOG_FROM_CALL.cust_id);\n\t\t}\n\t\t\/\/-- copy over prob text\n\t\tupdatedb.updatetxt = app.g.CALLINFO[app.g.LOG_FROM_CALL.callref].origupdatetxt\n\t\t\t\t\n\t\t\/\/-- copy over prob code into recog prob code\n\t\t_swdoc.OC().probcode = app.g.LOG_FROM_CALL.probcode;\n\t\t\/\/-- copy of cost center\n\t\t_swdoc.OC().costcenter = app.g.LOG_FROM_CALL.costcenter;\n\t\t\n\t\t_swdoc.OC().itsm_title = app.g.LOG_FROM_CALL.itsm_title;\n\t\tif(_swdoc.OC().itsm_title!=\"\")\n\t\t\t_swdoc.boolRFCTitleSetManually = true;\n\t\t\n\t\t\/\/-- impact \/ urgency \/ priority level \n\t\t_swdoc.OC().itsm_impact_level \t= app.g.LOG_FROM_CALL.itsm_impact_level;\n\t\t_swdoc.OC().itsm_urgency_level\t= app.g.LOG_FROM_CALL.itsm_urgency_level;\n\t\t_swdoc.OC().itsm_sladef\t\t\t= app.g.LOG_FROM_CALL.itsm_sladef;\n\t\t_swdoc.OC().itsm_slaname\t\t\t= app.g.LOG_FROM_CALL.itsm_slaname;\n\t\t_swdoc.OC().priority\t\t\t= app.g.LOG_FROM_CALL.priority;\n\t\tif(_swdoc.OC().itsm_sladef>0)\n\t\t{\n\t\t\t_een(_swdoc.MF().lbl_oc_priority,true);\n\t\t\t_een(_swdoc.MF().lb_oc_sla, true);\n\t\t}\n\t\t\n\t\t\n\t\t\/\/-- update form\n\t\t_swdoc.UpdateFormFromData();\n\t\t\n\t\t\/\/-- important - null record\t\t\n\t\tapp.g.LOG_FROM_CALL=null;\n\t}\t\n\t\n\t\/\/-- RJC - F0105434\n\tapp.g.get_default_process(_swdoc,'Change Proposal',_swdoc.MF().fld_bpm_workflow,_swdoc.MF().lbl_bpm_workflow);\n\t\/\/-- EOF - F0105434\n\t\t\n\t\/\/-- F0094989\n\tif(_swdoc.OC().itsm_slaname.indexOf(\"[Use \")<0 && _swdoc.OC().itsm_slaname.indexOf(\" SLA]\")<0 )\n\t{\n\t\tif(_swdoc.OC().itsm_slaname!=\"\")\n\t\t{\n\t\t\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+_swdoc.OC().itsm_slaname);\n\t\t\tif(slarec.Fetch())\n\t\t\t{\n\t\t\t\tvar intSLAId = app.g.get_field(slarec,\"slad_id\");\n\t\t\t\tif(intSLAId!=\"\") {\n\t\t\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t\t\t\t\t_swdoc.handle_set_sladef(intSLAId);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_swdoc.strDefaultImpact = (_swdoc.OC().itsm_impact_level);\n\t_swdoc.strDefaultUrgency = (_swdoc.OC().itsm_urgency_level);\n\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\n\t\/\/ DTH: Populate _swdoc variables relating to Impact Level Assessment (ILA) settings\n\t_swdoc.boolILAEnabled = app.g.ila_changelogcall_enabled(); \/\/ Impact Level Assessment Enabled\n\t_swdoc.boolILAMandatory = app.g.ila_changelogcall_mandatory(); \/\/ Impact Level Assessment Mandatory\n\t_swdoc.boolILAAllowAlteration = app.g.ila_changelogcall_allow_alteration(); \/\/ Impact Level Assessment Allow Alteration\n\n\t_een(_swdoc.MF().btn_ila_assess, _swdoc.boolILAEnabled); \/\/ enable the Assessment button based on setting\n\tif (_swdoc.boolILAEnabled && _swdoc.boolILAMandatory)\n\t{\n\t\t_een(_swdoc.MF().Field9, false); \/\/ disable selection of Impact Level until Assessment is completed\n\t}\t\n\t\n\t\/\/-- F0105629 RJC\n\tif(oSettings.get_setting(\"boolChangeHideFromFSCDefault\"))\n\t\t_swdoc.OC().itsm_hide_fsc = 1;\n\t\/\/-- EOF F0105629\n\t\t\n\tvar strTable = \"config_reli\";\n\n\t\/\/ DTH: F0097668 Lead Time Check - populat an array of Lead Time for each Impact\n\t_swdoc.arrImpactLeadTimes = app.g.get_impact_lead_times();\n\t\n\t\/\/ES -- START F0107205 : When logging call from email...\n\tif(_swdoc.OC().itsm_slaname == \"[Use Customer SLA]\" && _swdoc.oCust().sld_name != \"\")\n\t{\n\t\t_swdoc.MF().lb_oc_slad1_OnValueChanged(\"[Use Customer SLA]\");\n\t\t\n\t\t\/\/-- If priority not set...\n\t\tif (_swdoc.OC().priority == \"\")\n\t\t{\n\t\t\t\/\/-- ...try to find priority from matrix\n\t\t\t_swdoc.OC().priority = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level);\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t}\n\t\/\/-- END F0107205\n\t\n\t\/\/-- F0108825 : A newly logged call should not have resolve\/close text\n\t\/\/\t         even when it has been copied from a resloved\/closed call\n\t_swdoc.OC().resolve_text=\"\";\n\t_swdoc.OC().close_text=\"\";\n\t\/\/\tPM00143977 : values copied from parent call\n\t_swdoc.OC().lastactdatex=\"\";\t\n\t_swdoc.OC().lastactdate=\"\";\t\n\t_swdoc.OC().lastactby=\"\";\t\n\t_swdoc.OC().assigndatx=\"\";\t\n\t_swdoc.OC().withinresp=\"\";\t\n\t_swdoc.OC().resp_time=\"\";\t\n\t_swdoc.OC().slaresp=\"\";\t\n\t_swdoc.OC().assigndate=\"\";\t\n\t\/\/-- TK Set Summary Based on Email Subject\n\tif((_swdoc._form['emailsubject']) && (oSettings.get_setting(\"boolUseSubjectasSummary\")=='True'))\n\t{\n\t\t_swdoc.OC().itsm_title = _swdoc._form['emailsubject'];\n\t\t_swdoc.boolRFCTitleSetManually = true;\n\t}\n\t_swdoc.strDefaultPriority = _swdoc.MF().lb_oc_sla.value;\n}"},{"name":"mb_cust_OnMenuItem","code":"mb_cust_OnMenuItem(strName, nItemID)\n{\n\tvar iProperties = 2;\n\tvar iSearch=1;\t\n\t\n\t\n\tif(nItemID==iSearch)\n\t{\n\t\tapp.g.search_for(\"customers\",true,\"\",function(sResults)\n\t\t{\n\t\t\tif(sResults.selectedkeys==\"\") return;\n    \n    \t\tvar arrKey = sResults.selectedkeys.split(\",\");\n    \t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", arrKey[0]);\n\t\t});\n    }\n    \n    \n}"},{"name":"TabCust_OnTabSelected","code":"TabCust_OnTabSelected(nTab)\n{\n\t\/\/-- if on customer tab show\n\t_evi(mb_cust, (nTab==2));\n\n\n}"},{"name":"tb_title_OnLeftClick","code":"tb_title_OnLeftClick()\n{\n\t_swdoc.boolRFCTitleSetManually = true;\n\treturn true;\n}"},{"name":"OnTimer","code":"OnTimer(nTimer)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(nTimer==1)\n\t{\n\t\tmainform.KillTimer(1);\n\n\t\tvar strURL = \"searchmode=1&multiselect=0&autorun=1&searchtype=1&canreset=1&fk_company_id=\" + _swdoc.OC().fk_company_id+\"&\"+_swdoc.strSearchFor;\n\t\t\n\t\t\n\t\t_swdoc.strSearchFor=\"\";\n\n        \n        app.g.popup(\"search_customers\",strURL, function(aForm){\n\t\t\n\t\t\tif (!aForm)\n    \t\t{\n \t\t\t\t_swdoc.boolResolvingCust = false;\n   \t\t\t\treturn;\n    \t\t}\n\t\t\t\n\t\t\tvar sResults = new Object();\n\t\t\t\n\t\t\tsResults.selectedkeys = aForm.document.strSelectedKeys;\n\t\t\tsResults.selectedpfskeys = app.g.pfs_keys(aForm.document.strSelectedKeys);\n\t\t\tsResults.selectedtext = aForm.document.strSelectedText;\n\t\t\tsResults.selectedother = aForm.document.strSelectedOther;\n\t\t\tsResults.selectedcmdbids = aForm.document.strSelectedCMDBIDs;\n\t\t\tsResults.selectedcompanyids = aForm.document.strSelectedCompIDs;\n\t\t\tsResults.strSearchedCompanyRedux = aForm.document.strSearchedCompanyRedux;\n    \t\tif(sResults.selectedkeys==\"\") \n    \t\t{\n \t\t\t\t_swdoc.boolResolvingCust = false;\n   \t\t\t\treturn;\n    \t\t}\n    \t\tvar arrKey = sResults.selectedkeys.split(\",\");\n    \t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", arrKey[0]);\n\t\n\t\t\t\/\/###20120801\t\n    \t\tif(\"\"!=sResults.strSearchedCompanyRedux){\n\t\t\t\t_swdoc.multi_c_set_company(sResults.strSearchedCompanyRedux);\n\t\t\t}\n\t\t\t_swdoc.boolResolvingCust = false;\n\t\t});\t\n\t}\n\tif(nTimer==4)\n\t{\n\t\tmainform.KillTimer(4);\n\t\t_swdoc.boolChangeProfile = false;\n\n\t}\n\n}"},{"name":"tb_update_OnValueChanged","code":"tb_update_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\titsm_opencall_rfc.dow_note = strValue;\n\n}"},{"name":"lb_oc_slad1_OnValueChanged","code":"lb_oc_slad1_OnValueChanged(strValue)\n{\n\n\t_swdoc.boolChangeSLASetManually = true;\n\t_swdoc.handle_set_sladef(strValue);\n\t\n\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strValue);\n\tif(slarec.Fetch())\n\t{\n\t\tvar intSLAId = app.g.get_field(slarec,\"pk_slad_id\");\n\t\tif(intSLAId!=\"\")\n\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t}\n\n}"},{"name":"fld_bpm_workflow_OnValueChanged","code":"fld_bpm_workflow_OnValueChanged(strValue)\n{\n\t\/\/-- if title not set - set it to match workflow name\n\tif(!_swdoc.boolRFCTitleSetManually)\n\t{\n\t\t_swdoc.OC().itsm_title=strValue;\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\n}"},{"name":"lb_oc_slad2_OnValueChanged","code":"lb_oc_slad2_OnValueChanged(strValue)\n{\n\t_swdoc.handle_set_sladef(strValue);\n\n\n}"},{"name":"lb_oc_sla_OnValueChanged","code":"lb_oc_sla_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.handle_set_priority(strValue);\n\tapp.g.fix_priority(_swdoc.OC().itsm_slaname, _swdoc.OC().priority, _swdoc);\n}"},{"name":"lb_contract_OnValueChanged","code":"lb_contract_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.strLogAndResolveContract = strValue;\n\n}"},{"name":"btn_ila_assess_OnPressed","code":"btn_ila_assess_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\n\tvar strURL = \"ila_options=\"+_swdoc.strILAOptions+\"&appcode=\"+app.itsm.get_session_param(\"dataset\")+\"&usage_area=Change Log Call Form&mode=log form\";\n\tapp.OpenForm(\"EfImpactAssessmentEntry\", strURL, true, function(oRes)\n\t{\n\t\tif (oRes.document.boolApplied)\n\t\t{\n\t\t\t_swdoc.strILAOptions = oRes.document.strSelectedKeys;\n\t\t\t_swdoc.OC().flg_ila_complete = 1;\t\t\n\t\t\t_swdoc.OC().ila_weighting = oRes.document.intWeighting;\n\t\t\t_swdoc.OC().itsm_impact_level = oRes.document.strImpactLevel;\n\t\t\tif (_swdoc.boolILAEnabled && _swdoc.boolILAMandatory && _swdoc.boolILAAllowAlteration)\n\t\t\t\t_een(_swdoc.MF().Field9, true); \/\/ Enable alteration of Impact Level\n\t\t\t_swdoc.process_impact_urgency_change(); \/\/ Apply default functionality relating to a change in the Impact Level\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t});\n}"},{"name":"mb_email_aba1_OnMenuItem","code":"mb_email_aba1_OnMenuItem(strName, nItemID)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar nEmailSelected = 1;\n\tvar nEmailAll = 2;\n\t\n\tvar boolEmailAll = (nItemID == nEmailAll)?true:false;\n\t\n\n\t\/\/ Load the configured mailbox and email template\n\t\/\/ if these don't exist, inform the Analyst and exit ???\n\tvar strMailbox = app.g.get_ChangeABAMailbox();\n\tvar strEmailTemplate = app.g.get_ChangeABAMailTemplate();\n\tif ((strMailbox == \"\") || (strEmailTemplate == \"\"))\n\t{\n\t\tMessageBox(\"The settings which are required to send an email have not been configured.\\nPlease contact your Supportworks Administrator.\");\n\t\treturn false;\n\t}\n\t\n\t\/\/ Launch a form to capture the extra text to be placed in the body of the email\n\tapp.OpenFormForAdd(\"popup_aba_adhoc_email\", \"\", \"\", true, function(aForm){\n\t\tvar strAdditionalEmailBody = aForm.document.strEmailBody;\n\t\tif (aForm.document.boolCancelled){\n\t\t\treturn false; \/\/ The Analyst cancelled the previous form\n\t\t}\n\t\n\t\tvar strABA_Details = \"\"; \/\/ this will contain the IDs and Email address to which the email is sent\n\t\t\/\/ send the emails\n\t\tfor (x=0; x<sl_ABAs1.rowCount(); x++){\n\t\t\tif ((sl_ABAs1.IsRowSelected(x)) || (boolEmailAll)){\n\t\t\t\t\/\/ Call VPME script to send the email, pass in mailbox, email template, email address, additional body of email\t\t\t\n\t\t\t\tvar xmlmc = new XmlMethodCall;\n\t\t\t\n\t\t\t\t\/\/ Set up our input parameters\n\t\t\t\txmlmc.SetValue(\"callref\", _swdoc.OC().callref);\n\t\t\t\txmlmc.SetValue(\"mailbox\", strMailbox);\n\t\t\t\txmlmc.SetValue(\"emailtemplate\", strEmailTemplate);\n\t\t\t\txmlmc.SetValue(\"aba_email\", sl_ABAs1.GetItemTextRaw(x, 3));\n\t\t\t\txmlmc.SetValue(\"aba_id\", sl_ABAs1.GetItemTextRaw(x, 0));\n\t\t\t\txmlmc.SetValue(\"add_content\", strAdditionalEmailBody);\n\t\t\t\n\t\t\t\t\/\/ Invoke the method\n\t\t\t\tif(!xmlmc.Invoke(\"VPME\", \"emailAffectedBusArea\")){\n\t\t\t\t\tMessageBox(xmlmc.GetLastError());\n\t\t\t\t}\n\t\t\t\tif (strABA_Details != \"\") strABA_Details += \"\\n\";\n\t\t\t\t\tstrABA_Details += sl_ABAs1.GetItemTextRaw(x, 0) + \" (\"+sl_ABAs1.GetItemTextRaw(x, 3)+\")\";\n\t\t\t}\n\t\t}\n\t\n\t\t\/\/ create a diary entry \n\t\tvar xmlmc = new XmlMethodCall;\n\n\t\t\/\/ Set up our input parameters\n\t\txmlmc.SetValue(\"callref\", _swdoc.OC().callref);\n\t\txmlmc.SetValue(\"aba_details\", strABA_Details);\n\t\txmlmc.SetValue(\"add_content\", strAdditionalEmailBody);\n\t\n\t\t\/\/ Invoke the method\n\t\tif(!xmlmc.Invoke(\"VPME\", \"abaCreateDiary\")){\n\t\t\tMessageBox(xmlmc.GetLastError());\n\t\t}\n\t});\n}"},{"name":"btn_remove_aba1_OnPressed","code":"btn_remove_aba1_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t\/\/ check for APP Right if source is Analyst\n\tvar boolProceed = false;\t\t\n\tboolProceed = app.session.HaveAppRight(PG_RFC, RFC_BUS_AREA_REMOVE, app.session.dataDictionary);\n\tif (!boolProceed)\n\t{\n\t\tMessageBox(\"You are not authorised to remove Affected Business Areas from Change Requests.\\nIf you require authorisation please contact your Supportworks Administrator.\");\n\t\treturn false;\n\t}\n\/\/ there is no call ref so the following will not work\n\t\/\/app.g.remove_affected_bus_area_from_call(_swdoc.OC().callref, sl_ABAs1, \"\", \"Analyst\");\n\t\n\t\n\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\tvar strFilter = \"\";\n\tfor (var x=sl_ABAs1.rowCount()-1;x > -1;x--)\n\t{\n\t\tif (!sl_ABAs1.IsRowSelected(x))\n\t\t{\n\t\t\t\/\/-- add to filter\n\t\t\tvar value = sl_ABAs1.GetItemTextRaw(x,\"pk_area_id\");\n\t\t\tif (value != \"\")\n\t\t\t{\n    \t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\tstrFilter += value;\n\t\t\t}\n\t\t}\n\t}\n\tif(strFilter==\"\")\n\t\tstrFilter=\"-1\";\n\tstrFilter = \"aid=2&_kv=\"+strFilter;\n\n\t_slf(_swdoc.MF().sl_ABAs1, strFilter);  \n\t_swdoc.MF().sl_ABAs1.Refresh();\n\t_swdoc.MF().sl_ABAs1.SetRowSelected(0);\n\n\n\t\/\/ Refresh the list\n\/\/\tapp.g.sl_load_call_ABAs(_swdoc.MF().sl_ABAs1, _swdoc.OC().callref);\n}"},{"name":"btn_add_aba1_OnPressed","code":"btn_add_aba1_OnPressed()\n{\n\t\/\/ Associate an Affected Business Area with the call\n\t\n\t\/\/ check for APP Right if source is Analyst\n\tvar boolProceed = false;\t\t\n\tboolProceed = app.session.HaveAppRight(PG_RFC, RFC_BUS_AREA_ADD, app.session.dataDictionary);\n\tif (!boolProceed)\n\t{\n\t\tMessageBox(\"You are not authorised to associate Affected Business Areas with Change Requests.\\nIf you require authorisation please contact your Supportworks Administrator.\");\n\t\treturn false;\n\t}\n\t\t\n\t\/\/ Search for an ABA, then link it to the call\n\tvar oRes = app.g.search_for(\"bus_area\", true,\"\");\n\tvar strKeys = oRes.selectedkeys;\n\n\tif(strKeys==\"\") return;\n\tvar arrKeys = strKeys.split(\",\");\n\tfor (var x=0; x< arrKeys.length;x++)\n\t{\n\t\tvar fk_key = arrKeys[x];\n\t\tif(app.g.sl_findrow_byvalue(sl_ABAs1,fk_key,\"pk_area_id\")==-1)\n\t\t{\t\n\t\t\tvar strKeys = app.g.sqllist_get_valuesdel(_swdoc.MF().sl_ABAs1, \"pk_area_id\", \",\", \"\");\t\n\t\t\tif(strKeys!=\"\")strKeys+=\",\";\n\t\t\tvar strParams = \"aid=1&_kv=\"+strKeys+fk_key;\n\t\t\t_slf(_swdoc.MF().sl_ABAs1,strParams);\n\t\t\tif(_swdoc.arrABAAssocTypes[fk_key]==undefined)\n\t\t\t\t_swdoc.arrABAAssocTypes[fk_key] = \"Analyst\";\n\t\t\t\/\/app.g.add_affected_bus_area_to_call(_swdoc.OC().callref, \"Analyst\", \"\", fk_key, false);\n\t\t}\n\t}\n\t\n\t_swdoc.MF().sl_ABAs1.Refresh();\n\t\/\/ Refresh the list\n\t\/\/app.g.sl_load_call_ABAs(_swdoc.MF().sl_ABAs1, _swdoc.OC().callref);\n\n}"},{"name":"pl_oc_org_OnValueChanged","code":"pl_oc_org_OnValueChanged(strValue)\n{\n\n\t_swdoc.multi_c_set_company(strValue);\n\n}"},{"name":"fld_environment_OnDropDown","code":"fld_environment_OnDropDown()\n{\n\t \/\/ ES - F0111761 - Ability to specify an environment within call forms\n     var strSimpleListId = \"ENVIRONMENT\";\n     var p = {};\n     p.id = strSimpleListId;\n     var dbValues = app.g.get_sqrecordset(\"GENERAL\/get.simple_list\", p);\n     var arrEnvironments = new Array();\n     var strEnvironments = \"\";\n     var splitResult = \"\";\n     var intCount = 0;\n     \/\/ Store ENVIRONMENT values from swlists in an array\n     while (dbValues.Fetch())\n     {\n          arrEnvironments[intCount] = app.g.get_field(dbValues, \"value\");\n          intCount++;          \n     }\n     var strTemp = \"\";\n     \/\/ Add | at the end of each value to set up the picklist\n     for (var i=0; i<arrEnvironments.length;i++)\n     {\n          strTemp = arrEnvironments[i];\n          splitResult = strTemp.split(\",\");\n          strEnvironments += splitResult[0];\n          strEnvironments += \"|\";\n     }\n     _swdoc.MF().fld_environment.pickList = strEnvironments;\n     \/\/ END - F0111761;\n\n\n\n\n\treturn true;\n}"},{"name":"fld_environment_OnValueChanged","code":"fld_environment_OnValueChanged(strValue)\n{\n\t_swdoc.opencall.environment = strValue;\n}"}]}}},"extendedLayout":{"appearance":{"width":"916","height":"201","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"TabRel","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f2eedd","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"5","left":"3","right":"911","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Configuration Items","properties":"56=#ffffff|58=#000000|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","activeTextColor":"#000000","inactiveTextColor":"#5f5f5f"}}},{"name":"Services To Change","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Associated Change Requests","properties":"56=#ffffff|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f"}}},{"name":"Associated Service Requests","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Known Errors To Fix","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Incidents To Fix","properties":"56=#f7b683|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#f7b683"}}},{"name":"Knowledgebase Documents","properties":"56=#d8abc0|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#d8abc0"}}},{"name":"Impact","properties":"56=#8aa8e4|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#8aa8e4"}}},{"name":"Knowledgebase Documents","properties":"56=#8aa8e4|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#8aa8e4"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"mbtn_cci_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCI:0"},"appearance":{"index":"1","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"55","left":"720","right":"776","bottom":"73"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|"}}},{"general":{"name":"mbtn_cci_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCI:0"},"appearance":{"index":"2","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"55","left":"780","right":"836","bottom":"73"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|"}}},{"general":{"name":"btn_search_cci1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCI:0"},"appearance":{"index":"3","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"55","left":"840","right":"896","bottom":"73"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_configitems1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabCI:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"74","left":"18","right":"895","bottom":"185"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration ID","width":"133","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"126","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"240","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pids=0&sf=","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_impactcis1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabCI:1"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"74","left":"18","right":"895","bottom":"185"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration ID","width":"133","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"126","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"240","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"_kv=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_ici_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCI:1"},"appearance":{"index":"6","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"55","left":"720","right":"776","bottom":"73"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|"}}},{"general":{"name":"mbtn_ici_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCI:1"},"appearance":{"index":"7","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"55","left":"780","right":"836","bottom":"73"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|"}}},{"general":{"name":"btn_search_ici1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCI:1"},"appearance":{"index":"8","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"55","left":"840","right":"896","bottom":"73"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_rfcs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:2"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_rfcs_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"10","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Change Request Detail^1|"}}},{"general":{"name":"mbtn_rfcs_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"11","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Proposal^1|"}}},{"general":{"name":"btn_srch_rel1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"12","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_kes1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:4"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_ke_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"14","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Known Error Detail^1|"}}},{"general":{"name":"mbtn_ke_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"15","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|Inherit Causative Known Error CIs^2|Inherit Affected Known Error CIs^3|"}}},{"general":{"name":"btn_srch_kes1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"16","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_incs1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:5"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"178","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_name"},"name":"Customer","width":"150","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_id"},"name":"Customer ID","width":"120","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_id"},"name":"Org ID","width":"120","image":"-1","dataColumn":"12"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_inc_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:5"},"appearance":{"index":"18","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Incident Detail^1|Customer Detail^2|"}}},{"general":{"name":"mbtn_inc_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:5"},"appearance":{"index":"19","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|Inherit Incident Cis for Change^2|Inherit Incident CIs as Affected^3|"}}},{"general":{"name":"btn_search_inc1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:5"},"appearance":{"index":"20","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_customerimpact","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabImpact:0"},"appearance":{"index":"21","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"63","left":"21","right":"894","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"161","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"keysearch"},"name":"Customer ID","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"firstname"},"name":"First  Name","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"surname"},"name":"Last Name","width":"191","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telext"},"name":"Telephone","width":"148","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"email"},"name":"Email","width":"268","image":"-1","dataColumn":"5"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"userdb","listFilter":"_kv=-1","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_orgimpact","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabImpact:1"},"appearance":{"index":"22","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"63","left":"21","right":"894","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_company_id"},"name":"Organisation ID","width":"133","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"193","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_industry_type"},"name":"Industry Category","width":"161","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_type"},"name":"Industry Sector","width":"174","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telephone"},"name":"Telephone","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"address_1"},"name":"Address 1","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"address_2"},"name":"Address 2","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"town"},"name":"Town","width":"120","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"county"},"name":"County","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"country"},"name":"Country","width":"120","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"postcode"},"name":"Postcode","width":"103","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"company","editRecordForm":"Form.TfCompany","newRecordForm":"Form.entCompany","sqlSource":"swdata","highlightStyle":"0","selectionMode":"1","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_srs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:3"},"appearance":{"index":"23","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_srs_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"24","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Request Detail^1|"}}},{"general":{"name":"mbtn_srs_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"25","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|"}}},{"general":{"name":"btn_srch_srs","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"26","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_services","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:1"},"appearance":{"index":"27","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Service ID","width":"133","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Service Name","width":"220","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"service_type"},"name":"Service Type","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"catalog_type"},"name":"Service Category","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status_portfolio"},"name":"Portfolio Status","width":"120","image":"-1","dataColumn":"16"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status_lifecycle"},"name":"Lifecycle Status","width":"120","image":"-1","dataColumn":"17"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pk_auto_id=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_cci_views2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"28","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|"}}},{"general":{"name":"mbtn_cci_actions2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"29","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|"}}},{"general":{"name":"btn_search_cci2","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"30","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_kbs1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:6"},"appearance":{"index":"31","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docref"},"name":"Document Reference","width":"203","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"title"},"name":"Title","width":"334","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docstatus"},"name":"Status","width":"120","image":"-1","dataColumn":"2"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"swkb_articles","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"_kv=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_inc_views3","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:6"},"appearance":{"index":"32","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Document Details^1|"}}},{"general":{"name":"mbtn_inc_actions3","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:6"},"appearance":{"index":"33","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_search_inc3","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:6"},"appearance":{"index":"34","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"TabCI","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"35","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"32","left":"13","right":"900","bottom":"191"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Configuration Items To Change","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Affected Configuration Items","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"TabImpact","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:7"},"appearance":{"index":"36","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"35","left":"13","right":"901","bottom":"190"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"<< Impacted Customers","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"<< Impacted Organisations","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"mbtn_inc_views4","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"37","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"728","right":"784","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Document Details^1|"}}},{"general":{"name":"mbtn_inc_actions4","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"38","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"788","right":"844","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Change^1|"}}},{"general":{"name":"btn_search_inc4","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"39","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"28","left":"848","right":"904","bottom":"46"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_rakb","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabRel:8"},"appearance":{"index":"40","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"10","right":"903","bottom":"187"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docref"},"name":"Document Reference","width":"203","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"title"},"name":"Title","width":"567","image":"-1","dataColumn":"1"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"rakb_articles","listFilter":"_kv=-1","storedQuery":"common.extendedform.tabledata"}}}]},"javascript":{"methods":{"method":[{"name":"mbtn_cci_views1_OnMenuItem","code":"mbtn_cci_views1_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_configitems1,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_configitems1,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_cci_actions1_OnMenuItem","code":"mbtn_cci_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"_kv=-1\";\n\t\tfor (var x=sl_configitems1.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tif (!sl_configitems1.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tvar value = sl_configitems1.GetItemTextRaw(x,\"pk_auto_id\");\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter += value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- row is selected - so therefor being removed, so remove associated ABA's\n\t\t\t\tvar strCIName = sl_configitems1.GetItemTextRaw(x,\"ck_config_item\");\n\t\t\t\tif (strCIName != \"\")\n\t\t\t\t{\n\t\t\t\t\tvar strParams = \"ci_item=\"+strCIName;\n   \t\t\t\t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_ci_abas\",strParams);\n\t\t\t\t\twhile(oRS.Fetch())\n\t\t\t\t\t{\n\t\t\t\t\t\tstrABA = app.g.get_field(oRS,\"FK_BUS_AREA_ID\");\n\t\t\t\t\t\tvar intRow = app.g.sl_findrow_byvalue(_swdoc.MF().sl_ABAs1,strABA,0);\n\t\t\t\t\t\tif(intRow>-1)_swdoc.MF().sl_ABAs1.RemoveRow(intRow);\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n       _slf(_swdoc.EF().sl_configitems1, strFilter);  \n       _swdoc.EF().sl_configitems1.Refresh();\n       _swdoc.EF().sl_configitems1.SetRowSelected(0);\n       return;\n\t}     \n}"},{"name":"btn_search_cci1_OnPressed","code":"btn_search_cci1_OnPressed()\n{\n\t_swdoc.search_for_cis();\n}"},{"name":"sl_configitems1_OnHeaderItemClicked","code":"sl_configitems1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_configitems1.Refresh();\n}"},{"name":"sl_configitems1_OnItemSelected","code":"sl_configitems1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_configitems1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_configitems1);\t\n\t_een(mbtn_cci_views1, (selCount==1));\n\t_een(mbtn_cci_actions1, boolActive);\n\n}"},{"name":"sl_impactcis1_OnHeaderItemClicked","code":"sl_impactcis1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_impactcis1.Refresh();\n\n\n}"},{"name":"sl_impactcis1_OnItemSelected","code":"sl_impactcis1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_impactcis1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_impactcis1);\t\n\t_een(mbtn_ici_views1, (selCount==1));\n\t_een(mbtn_ici_actions1,boolActive);\n\n\n}"},{"name":"mbtn_ici_views1_OnMenuItem","code":"mbtn_ici_views1_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_impactcis1,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_impactcis1,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_ici_actions1_OnMenuItem","code":"mbtn_ici_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"_kv=-1\";\n\t\tfor (var x=sl_impactcis1.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tif (!sl_impactcis1.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tvar value = sl_impactcis1.GetItemTextRaw(x,\"pk_auto_id\");\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter += value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n       _slf(sl_impactcis1, strFilter);  \n       sl_impactcis1.Refresh();\n       sl_impactcis1.SetRowSelected(0);\n       return;\n\t}\n       \n}"},{"name":"btn_search_ici1_OnPressed","code":"btn_search_ici1_OnPressed()\n{\n    \/\/-- NWJ 08.03.2004\n    \/\/-- open CI search form in select mode\n   \tvar strURL = \"canreset=1&fk_company_id=\" + pfu(_swdoc.oCompany().pk_company_id);\n\tapp.cmdb.search_ci(true,strURL,function(sResults)\n\t{\n\t\tif (sResults.selectedkeys==\"\") return;\n\n  \t\t _swdoc.link_affect_cis_to_change(sResults.selectedkeys);\n\t});\n    \n\t\n\n}"},{"name":"sl_rels1_OnHeaderItemClicked","code":"sl_rels1_OnHeaderItemClicked(strOrder, nCol)\n{\n\n\tsl_rels1.Refresh();\n\n}"},{"name":"sl_rels1_OnItemSelected","code":"sl_rels1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_rels1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rels1);\t\n\t_een(mbtn_rel_views1,(selCount==1));\n\t_een(mbtn_rel_actions1, boolActive);\n\n\n}"},{"name":"btn_srch_rel1_OnPressed","code":"btn_srch_rel1_OnPressed()\n{\n\tvar strURL = \"canreset=1\";  \n\tapp.itsm.search_calls(\"RFC\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\t\t\n\t\tapp.g.sl_appendfilter(sl_rfcs, oResults.selectedkeys,0);\n\t\t_swdoc.EF().sl_rfcs.Refresh();\n\t});\n}"},{"name":"sl_kes1_OnHeaderItemClicked","code":"sl_kes1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_kes1.Refresh();\n\n\n}"},{"name":"sl_kes1_OnItemSelected","code":"sl_kes1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_kes1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_kes1\t);\t\n\t_een(mbtn_ke_views1, (selCount==1));\n\t_een(mbtn_ke_actions1, boolActive);\n\n\n}"},{"name":"mbtn_ke_views1_OnMenuItem","code":"mbtn_ke_views1_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\tsl_kes1.EditRecord(sl_kes1.curSel);\n\t\t\tbreak;\n\t}\t\n}"},{"name":"mbtn_ke_actions1_OnMenuItem","code":"mbtn_ke_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iClear = 1;\n\tvar iLinkCauseCI = 2;\n\tvar iLinkImpactCI = 3;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- get select incidents\n\t\t\tvar strSelectedKes = app.g.sl_getselected_valuesdel(sl_kes1,0,\",\",\"\");\n\t\t\t_swdoc.remove_selected_ke_incs(strSelectedKes);\t\t\t\n\t\t\t_swdoc.remove_selected_ke_cis(strSelectedKes);\n\t\t\tapp.g.sl_clearselected(sl_kes1,sl_kes1_OnItemSelected,0);\t\t\n\t\t\tbreak;\n\t\tcase iLinkCauseCI:\n\t\t\tvar strSelectedKes = app.g.sl_getselected_valuesdel(sl_kes1,0,\",\",\"\");\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedKes , \"PROBLEM-CAUSE\", \"\");\n\t\t\t_swdoc.link_cause_cis_to_change(strLinkedCIs);\t\n\t\t\tbreak;\n\t\tcase iLinkImpactCI:\n\t\t\tvar strSelectedKes = app.g.sl_getselected_valuesdel(sl_kes1,0,\",\",\"\");\t\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedKes , \"PROBLEM-AFFECT\", \"\");\n\t\t\t_swdoc.link_affect_cis_to_change(strLinkedCIs);\n\t\t\tbreak;\n\t}\n\t_swdoc.EF().sl_kes1.Refresh();\t\n}"},{"name":"btn_srch_kes1_OnPressed","code":"btn_srch_kes1_OnPressed()\n{\n\tvar strURL = \"canreset=1\";  \n\tapp.itsm.search_calls(\"KE\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\t\t\n\t\t_swdoc.filter_ke_impact(oResults.selectedkeys);\n\t\t_swdoc.EF().sl_kes1.Refresh();\t\n   });\n  \n}"},{"name":"sl_incs1_OnHeaderItemClicked","code":"sl_incs1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_incs1.Refresh();\n\n\n}"},{"name":"sl_incs1_OnItemSelected","code":"sl_incs1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_incs1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_incs1);\t\n\t_een(mbtn_inc_views1, (selCount==1));\n\t_een(mbtn_inc_actions1, boolActive);\n\n\n}"},{"name":"mbtn_inc_views1_OnMenuItem","code":"mbtn_inc_views1_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tvar iCust = 2\n\tif(nItemID == iDetails)\n\t{\n\t\tif(sl_incs1.curSel > -1)sl_incs1.EditRecord(sl_incs1.curSel);\n\t}\n\telse if (nItemID==iCust)\n\t{\n\t\tif(sl_incs1.curSel > -1)\n\t\t{\n\t\t\tvar strKeySearch = app.g.sl_getcolvalue(sl_incs1,-1,\"cust_id\");\n\t\t\tif(strKeySearch!=\"\")app.OpenFormForEdit(\"tfCustomer\", strKeySearch, \"\", true);\n\t\t}\n\t}\n}"},{"name":"mbtn_inc_actions1_OnMenuItem","code":"mbtn_inc_actions1_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\tvar iLinkCauseCI = 2;\n\tvar iLinkImpactCI = 3;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- get select incidents\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs1,\"callref\",\",\",\"\");\n\t\t\tapp.g.sl_clearselected(sl_incs1,null,0);\t\t\t\n\t\t\t_swdoc.remove_selected_incident_cis(strSelectedIncs);\n\t\t\tbreak;\n\t\tcase iLinkCauseCI:\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs1,\"callref\",\",\",\"\");\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\t\t\t_swdoc.link_cause_cis_to_change(strLinkedCIs);\t\t\n\t\t\tbreak;\n\t\tcase iLinkImpactCI:\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs1,\"callref\",\",\",\"\");\t\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\t\t\t_swdoc.link_affect_cis_to_change(strLinkedCIs);\t\t\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc1_OnPressed","code":"btn_search_inc1_OnPressed()\n{\n\tvar strURL = \"canreset=1\";  \n\tapp.itsm.search_calls(\"INC\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\n\t\t_swdoc.filter_inc_impact(oResults.selectedkeys);\n\t});\n}"},{"name":"TabRel_OnTabSelected","code":"TabRel_OnTabSelected(nTab)\n{\n\tif(nTab==7)\n\t{\n\t\t_swdoc.filter_impact_customers(_swdoc.EF()); \n\t\t_swdoc.filter_impact_orgs(_swdoc.EF()); \n\t}\n\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tTabRel.ShowTabItem(9,((dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1)));\n\t_etab(TabRel,0);\n\n\t\/\/-- Show appropriate KB Tab\n\tvar tTab = _swdoc.EF().TabRel.tab;\n\tif(!app.g.use_sw_knowledgebase())\n\t{\n\t\tif(strKnowledgebaseDefaultTool.toLowerCase()==\"rightanswers\")\n\t\t{\n\t\t\t_swdoc.EF().TabRel.ShowTabItem(8,true);\n\t\t\t_swdoc.EF().TabRel.ShowTabItem(6,false);\n\t\t\t_etab(_swdoc.EF().TabRel, tTab);\n\t\t}\n\t}\n\telse\n\t{\n\t\t_swdoc.EF().TabRel.ShowTabItem(8,false);\n\t\t_swdoc.EF().TabRel.ShowTabItem(6,true);\n\t\t_etab(_swdoc.EF().TabRel, tTab);\n\t}\n\n}"},{"name":"sl_srs1_OnItemSelected","code":"sl_srs1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_srs1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_srs1);\t\n\t_een(mbtn_srs_views1 , (selCount==1));\n\t_een(mbtn_srs_actions1 , boolActive);\n\n\n}"},{"name":"btn_srch_srs_OnPressed","code":"btn_srch_srs_OnPressed()\n{\n\tvar strURL = \"canreset=1\";  \n\tapp.itsm.search_calls(\"SR\",strURL,true,function(oResults)\n\t{\n\t\tif(oResults.selectedkeys==\"\") return;\n\t\n\t\tapp.g.sl_appendfilter(sl_srs, oResults.selectedkeys,0);\n\t\tsl_srs.Refresh();\n\t});\t\n}"},{"name":"mbtn_srs_actions_OnMenuItem","code":"mbtn_srs_actions_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(sl_srs ,null,0);\n\t\t\tbreak;\n\t}\n\n\n}"},{"name":"mbtn_srs_views_OnMenuItem","code":"mbtn_srs_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\tsl_srs.EditRecord(sl_srs.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"sl_srs_OnItemSelected","code":"sl_srs_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_srs.rowCount() > 0);\n\tvar selCount = app.g.sl_getselected_count(sl_srs);\t\t\n\t_een(mbtn_srs_views, (selCount==1));\n\t_een(mbtn_srs_actions, boolActive);\n\n}"},{"name":"sl_configitems2_OnHeaderItemClicked","code":"sl_configitems2_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_configitems2.Refresh();\n}"},{"name":"sl_configitems2_OnItemSelected","code":"sl_configitems2_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_configitems2.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_configitems2);\t\n\t_een(mbtn_cci_views2 , (selCount==1));\n\t_een(mbtn_cci_actions2 , boolActive);\n\n}"},{"name":"mbtn_cci_views2_OnMenuItem","code":"mbtn_cci_views2_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_services,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_services,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_cci_actions2_OnMenuItem","code":"mbtn_cci_actions2_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"_kv=-1\";\n\t\tfor (var x=sl_services.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tif (!sl_services.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tvar value = sl_services.GetItemTextRaw(x,\"pk_auto_id\");\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter += value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- row is selected - so therefor being removed, so remove associated ABA's\n\t\t\t\tvar strCIName = sl_services.GetItemTextRaw(x,\"ck_config_item\");\n\t\t\t\tif (strCIName != \"\")\n\t\t\t\t{\n\t\t\t\t\tvar strParams = \"ci_item=\"+strCIName;\n   \t\t\t\t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_ci_abas\",strParams);\n\t\t\t\t\twhile(oRS.Fetch())\n\t\t\t\t\t{\n\t\t\t\t\t\tstrABA = app.g.get_field(oRS,\"FK_BUS_AREA_ID\");\n\t\t\t\t\t\tvar intRow = app.g.sl_findrow_byvalue(_swdoc.MF().sl_ABAs1,strABA,0);\n\t\t\t\t\t\tif(intRow>-1)_swdoc.MF().sl_ABAs1.RemoveRow(intRow);\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n       _slf(sl_services, strFilter);  \n       sl_services.Refresh();\n       sl_services.SetRowSelected(0);\n       return;\n\t}\n       \n}"},{"name":"btn_search_cci2_OnPressed","code":"btn_search_cci2_OnPressed()\n{\n\t_swdoc.search_for_services();\n\n}"},{"name":"sl_services_OnItemSelected","code":"sl_services_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_services.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_services);\t\n\t_een(mbtn_cci_views2, (selCount==1));\n\t_een(mbtn_cci_actions2, boolActive);\n\n\n}"},{"name":"sl_incs2_OnHeaderItemClicked","code":"sl_incs2_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_incs2.Refresh();\n\n\n}"},{"name":"sl_incs2_OnItemSelected","code":"sl_incs2_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_incs2.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_incs2);\t\n\t_een(mbtn_inc_views2 , (selCount==1));\n\t_een(mbtn_inc_actions2 , boolActive);\n\n\n}"},{"name":"sl_kbs1_OnItemSelected","code":"sl_kbs1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_kbs1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_kbs1);\t\n\t_een(mbtn_inc_views3,(selCount==1));\n\t_een(mbtn_inc_actions3, boolActive);\n\n\n\n}"},{"name":"sl_kbs1_OnItemDoubleClicked","code":"sl_kbs1_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_kbs1, nRow, \"fk_kbdoc\");\n\tapp.OpenFormForEdit(\"kb_docadd\", \"\", \"docref=\"+strKeyValue, false);\n\n\n}"},{"name":"mbtn_inc_views3_OnMenuItem","code":"mbtn_inc_views3_OnMenuItem(strName, nItemID)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_kbs1, sl_kbs1.curSel, \"fk_kbdoc\");\n\tapp.oKB.open_article_form(strKeyValue);\n}"},{"name":"mbtn_inc_actions3_OnMenuItem","code":"mbtn_inc_actions3_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\tvar iLinkCauseCI = 2;\n\tvar iLinkImpactCI = 3;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- get select incidents\n\t\t\t\/\/var strSelectedIncs = app.g.sl_getselected_valuesdel(sl_kbs1,0,\",\",\"\");\n\t\t\tapp.g.sl_clearselected(sl_kbs1,null,0);\t\t\t\n\t\t\t\/\/_swdoc.remove_selected_incident_cis(strSelectedIncs);\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc3_OnPressed","code":"btn_search_inc3_OnPressed()\n{\n    app.g.search_for(\"swkb\", true,\"\",function(oRes)\n    {\n    \tvar strKeys = oRes.selectedkeys;\n\t\tif(strKeys==\"\")return;\n\t\tvar arrKeys = strKeys.split(\",\");\n\t\tfor (var x=0; x< arrKeys.length;x++)\n\t\t{\n\t\t\tvar fk_key = arrKeys[x];\n\t\t\tif(app.g.sl_findrow_byvalue(sl_kbs1,fk_key,\"docref\")==-1)\n\t\t\t{\n\t\t\t\tapp.g.sqllist_kv_appendfilter(sl_kbs1, fk_key, \"docref\");\t\t\n\t\t\t}\n\t\t}\n\t\tsl_kbs1.Refresh();\n\t\tsl_kbs1.SetRowSelected(0);\n\t\tsl_kbs1_OnItemSelected(0);\n\t\treturn;\n    });\n}"},{"name":"mbtn_inc_views4_OnMenuItem","code":"mbtn_inc_views4_OnMenuItem(strName, nItemID)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_rakb, sl_rakb.curSel, \"docref\");\n\tapp.g.open_article(strKeyValue);\n\t\n}"},{"name":"mbtn_inc_actions4_OnMenuItem","code":"mbtn_inc_actions4_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(sl_rakb,null,0);\t\t\n\t\t\tvar strFilter = app.g.sl_get_valuesdel(sl_rakb,0,\",\",\"\",\"\");\n\t\t\tif(strFilter==\"\") strFilter=\"-1\";\n\t\t\t_slf(sl_rakb , \"_kv=\" + strFilter);\t\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc4_OnPressed","code":"btn_search_inc4_OnPressed()\n{\n   if(!app.g.use_sw_knowledgebase())\n\t\t\t{\n\t\t\t\tapp.allocatekbdoc(_swdoc._kbidentifier,_swdoc);\n\t\t\t\tapp.g.open_third_party_kb_search(true, \"\",\"\",app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\"), _swdoc._kbidentifier);\n\t}\n   \treturn;\n   \n\n\n\n}"},{"name":"sl_rakb_OnItemDoubleClicked","code":"sl_rakb_OnItemDoubleClicked(nRow, nCol)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_rakb, nRow, \"docref\");\n\tapp.g.open_article(strKeyValue);\n\n}"},{"name":"sl_rakb_OnItemSelected","code":"sl_rakb_OnItemSelected(nRow)\n{\n\n\tvar boolActive = (sl_rakb.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rakb);\t\n\t_een(mbtn_inc_views4, (selCount==1));\n\t_een(mbtn_inc_actions4, boolActive);\n\n}"},{"name":"sl_rfcs_OnItemSelected","code":"sl_rfcs_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tvar boolActive = (sl_rfcs.rowCount() > 0);\n\tvar selCount = app.g.sl_getselected_count(sl_rfcs);\t\t\n\t_een(mbtn_rfcs_views, (selCount==1));\n\t_een(mbtn_rfcs_actions, boolActive);\n}"},{"name":"mbtn_rfcs_views_OnMenuItem","code":"mbtn_rfcs_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\tsl_rfcs.EditRecord(sl_rfcs.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"mbtn_rfcs_actions_OnMenuItem","code":"mbtn_rfcs_actions_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(sl_rfcs\t,null,0);\n\t\t\tbreak;\n\t}\n\n\n}"}]}}}}}