<?xml version="1.0" encoding="utf-8" ?>
<espForm>
	<configuration>
		<settings>
			<name>EfDepartment</name>
			<title>Department</title>
			<printTemplates>
			</printTemplates>
			<options>
				<allowResize>true</allowResize>
				<showMenubar>false</showMenubar>
				<showToolbar>true</showToolbar>
				<showStatusBar>false</showStatusBar>
			</options>
		</settings>
		<tables>
			<table>
				<name>department</name>
				<type>Main Details Table</type>
				<flags>0</flags>
				<assignments>
				</assignments>
			</table>
		</tables>
		<showMeItems>
		</showMeItems>
		<javascript>
			<methods>
				<method>
					<name>(Globals)</name>
					<code>
						<![CDATA[var boolInserting = false;
var strComanyID = "";
var strDeptID = "";

function MF()
{
	return mainform;
}

function oDept()
{
	return _swdoc.department;
}

function setup_dept_form(bDataReloaded)
{
	_swdoc.strCompanyID = _swdoc.oDept().fk_company_id;
	_swdoc.strDeptID = _swdoc.oDept().fk_dept_id;
	
	//--124775: Only show Subscription actions button if you have writes and you are not inserting
	_evi(_swdoc.MF().mb_serv_action, (app.service.can_manage_cost_and_subs(false) && !_swdoc.boolInserting))

}

function load_dept_customers(intSelRow)
{
	if(intSelRow==undefined)intSelRow=0;
	var strKeys = app.cfg.get_dept_customers(_swdoc.oDept().pk_dept_code, true, "", _swdoc.oDept().fk_cmdb_id);
	_slf(_swdoc.MF().sl_contacts ,  "swc=keysearch&kvs=" + strKeys);
	_swdoc.MF().sl_contacts.SetRowSelected(intSelRow);				

}]]>
					</code>
				</method>
				<method>
					<name>OnDataSaved</name>
					<code>
						<![CDATA[OnDataSaved()
{
 
	// TODO: Add your event handler code here
   	if(_swdoc.oDept().fk_company_id!=""){
       	var pDoc = app.g.get_me_document("COMPANY",_swdoc.oDept().fk_company_id);
    	if(pDoc)
    	{
    		var intCurSel = pDoc.MF().sl_depts1.curSel;
    		pDoc.MF().sl_depts1.Refresh();
    		pDoc.MF().sl_depts1.SetRowSelected(intCurSel,true);
    	}
	
		if(_swdoc.boolInserting)
		{
			//-- do not delete relationship
		}
		else
		{
			//-- not inserting, and company has changed
			if(_swdoc.strCompanyID!=_swdoc.oDept().fk_company_id)
			{
				//-- company has changed
     			app.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, "ME->COMPANY");
			}			
		}
		
  		//-- create cmdb relationship
    	if(pDoc)
    	{
    		//-- need to reload site record to get fk_cmdb_id
    		_swdoc.LoadRecordData("swdata", "Department", _swdoc.oDept().pk_dept_code);
    		
			//-- check if have default rel if so form silently ..
    		var strRel = "is department of";//dd.GetGlobalParamAsString("Application Settings/CMDB/Types/DefaultOrgSiteRelationship");
   			app.cmdb.generate_meconfigrelation(pDoc.oCompany().fk_cmdb_id,_swdoc.oDept().fk_cmdb_id,strRel);  
    	}
    	else
    	{
			var rec = app.g.get_record("COMPANY", _swdoc.oDept().fk_company_id);
			if(rec)
			{
				var fetchKey  = rec.fk_cmdb_id;
    			var strRel = "is department of";//dd.GetGlobalParamAsString("Application Settings/CMDB/Types/DefaultOrgSiteRelationship");
  				app.cmdb.generate_meconfigrelation(fetchKey,_swdoc.oDept().fk_cmdb_id,strRel);  
			}
    	}
    }
	else if(_swdoc.strCompanyID!=_swdoc.oDept().fk_company_id)
	{
		//-- company is now blank, but wasnt previously
     	app.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, "ME->COMPANY");
	}

  	if(_swdoc.oDept().fk_dept_id!=""){
       	var pDoc = app.g.get_me_document("DEPARTMENT",_swdoc.oDept().fk_dept_id);
    	if(pDoc)
    	{
    		//var intCurSel = pDoc.MF().sl_orgs.curSel;
    		//pDoc.MF().sl_orgs.Refresh();
    		//pDoc.MF().sl_orgs.SetRowSelected(intCurSel,true);
    	}
	
		if(_swdoc.boolInserting)
		{
			//-- do not delete relationship
		}
		else
		{
			//-- not inserting, and Dept has changed
			if(_swdoc.strDeptID!=_swdoc.oDept().fk_dept_id)
			{
				if(_swdoc.strDeptID!="")
				{
					//-- dept has changed, dept wasnt blank, delete previous relationship
     				app.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, "ME->DEPARTMENT");
     			}
			}			
		}

  		//-- create cmdb relationship
    	if(pDoc)
    	{
    		//-- need to reload site record to get fk_cmdb_id
    		_swdoc.LoadRecordData("swdata", "Department", _swdoc.oDept().pk_dept_code);
    		
 			//-- check if have default rel if so form silently ..
    		var strRel = "is department of";//dd.GetGlobalParamAsString("Application Settings/CMDB/Types/DefaultOrgSiteRelationship");
   			app.cmdb.generate_meconfigrelation(pDoc.oDept().fk_cmdb_id,_swdoc.oDept().fk_cmdb_id,strRel);  
    	}
    	else
    	{
			var rec = app.g.get_record("DEPARTMENT", _swdoc.oDept().fk_dept_id);
			if(rec)
			{
				var fetchKey  = rec.fk_cmdb_id;
    			var strRel = "is department of";//dd.GetGlobalParamAsString("Application Settings/CMDB/Types/DefaultOrgSiteRelationship");
   				app.cmdb.generate_meconfigrelation(fetchKey,_swdoc.oDept().fk_cmdb_id,strRel);  
			}
    	
    	}
    		
	}
	else if(_swdoc.strDeptID!=_swdoc.oDept().fk_dept_id)
	{
     	app.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, "ME->DEPARTMENT");
	}


}]]>
					</code>
				</method>
			</methods>
		</javascript>
	</configuration>
	<layouts>
		<layout>
			<appearance>
				<width>429</width>
				<height>204</height>
				<backgroundColor>#ffffff</backgroundColor>
				<fillColour>#ffffff</fillColour>
				<textColour >#000000</textColour >
				<font  size="8">Arial</font>
			</appearance>
			<controls>
				<control>
					<general>
						<name>fld_dept_code</name>
						<type>Field</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>0</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>66</top>
							<left>139</left>
							<right>389</right>
							<bottom>84</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.pk_dept_code</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>true</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>false</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fld_dept_name</name>
						<type>Field</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>1</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>88</top>
							<left>139</left>
							<right>389</right>
							<bottom>106</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.dept_name</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>true</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>false</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fld_fk_dept_id</name>
						<type>Field</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>2</index>
						<backgroundColor>#eeeeee</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>110</top>
							<left>139</left>
							<right>389</right>
							<bottom>128</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.fk_dept_id</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>true</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<dropdownButtonType>1</dropdownButtonType>
							<sqlSource>swdata</sqlSource>
							<distinctTable>department</distinctTable>
							<distinctColumn>pk_dept_code</distinctColumn>
							<borderColor>#c0c0c0</borderColor>
							<displayColumn>dept_name</displayColumn>
							<storedQuery>generic.select</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fld_fk_dept_manager</name>
						<type>Field</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>3</index>
						<backgroundColor>#eeeeee</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>132</top>
							<left>139</left>
							<right>389</right>
							<bottom>150</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.fk_dept_manager</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>true</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
							<dropdownButtonType>1</dropdownButtonType>
							<sqlSource>swdata</sqlSource>
							<distinctTable>userdb</distinctTable>
							<distinctColumn>keysearch</distinctColumn>
							<displayColumn>fullname</displayColumn>
							<storedQuery>generic.select</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fld_telephone</name>
						<type>Field</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>4</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>154</top>
							<left>139</left>
							<right>389</right>
							<bottom>172</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.telephone</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fld_email</name>
						<type>Field</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>5</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>176</top>
							<left>139</left>
							<right>389</right>
							<bottom>194</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.email</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Departments</name>
						<type>TabControl</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>6</index>
						<caption>Tab1</caption>
						<backgroundColor>#ded7ce</backgroundColor>
						<foregroundColor>#ffffff</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>10</top>
							<left>10</left>
							<right>425</right>
							<bottom>200</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<tabStyle>Top</tabStyle>
					<tabSize>19</tabSize>
					<items>
						<item>
							<name>Department Details</name>
							<properties>56=#8aa8e4|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#8aa8e4</tabColor>
								</properties>
							</controlInfo>
						</item>
						<item>
							<name>Notes</name>
							<properties>56=#ffdb75|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#ffdb75</tabColor>
								</properties>
							</controlInfo>
						</item>
						<item>
							<name>Customers</name>
							<properties>56=#bdcd9f|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#bdcd9f</tabColor>
								</properties>
							</controlInfo>
						</item>
						<item>
							<name>Services</name>
							<properties>56=#f09e9f|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#f09e9f</tabColor>
								</properties>
							</controlInfo>
						</item>
						<item>
							<name>Service Level Agreements</name>
							<properties>56=#baa6e1|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#baa6e1</tabColor>
								</properties>
							</controlInfo>
						</item>
					</items>
					<selectedTextFont  size="8">Arial</selectedTextFont>
					<selectedTextColor>#000000</selectedTextColor>
					<deselectedTextColor>#000000</deselectedTextColor>
					<tabSlopeLeft>2</tabSlopeLeft>
					<tabSlopeRight>2</tabSlopeRight>
					<deselectedTabHeightOffset>1</deselectedTabHeightOffset>
					<tabSpacing>0</tabSpacing>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>mb_view1</name>
						<type>MenuButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>true</toolbarButtonStyle>
							<cache>true</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>7</index>
						<caption>View</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>35</top>
							<left>355</left>
							<right>418</right>
							<bottom>59</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor>#ff9900</backgroundColor>
							<commands>Parent Dependancies^2|Child Dependancies^1|</commands>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fld_notes</name>
						<type>Field</type>
						<group>Departments:1</group>
					</general>
					<appearance>
						<index>8</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>36</top>
							<left>16</left>
							<right>418</right>
							<bottom>193</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.notes</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>true</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>sl_contacts</name>
						<type>SqlTable</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
							<showHeader>true</showHeader>
							<verticalGridLines>true</verticalGridLines>
							<horizontalGridLines>true</horizontalGridLines>
							<autoLoad>false</autoLoad>
							<allowMultiSelect>false</allowMultiSelect>
						</flags>
						<group>Departments:2</group>
					</general>
					<appearance>
						<index>9</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>70</top>
							<left>20</left>
							<right>410</right>
							<bottom>190</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<columns>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>keysearch</column>
							</properties>
							<name>Customer ID</name>
							<width>104</width>
							<image>-1</image>
							<dataColumn>1</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>firstname</column>
							</properties>
							<name>Forename</name>
							<width>131</width>
							<image>-1</image>
							<dataColumn>4</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>surname</column>
							</properties>
							<name>Surname</name>
							<width>125</width>
							<image>-1</image>
							<dataColumn>5</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>location</column>
							</properties>
							<name>Location</name>
							<width>137</width>
							<image>-1</image>
							<dataColumn>6</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>email</column>
							</properties>
							<name>E-Mail</name>
							<width>169</width>
							<image>-1</image>
							<dataColumn>7</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>telext</column>
							</properties>
							<name>Telephone</name>
							<width>116</width>
							<image>-1</image>
							<dataColumn>8</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>true</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>fk_cmdb_id</column>
							</properties>
							<name>CMDB ID</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>6</dataColumn>
						</controlInfo>
					</columns>
					<sortColumn>2</sortColumn>
					<sortDescending>false</sortDescending>
					<headerHeight>16</headerHeight>
					<rowHeight>16</rowHeight>
					<selectedColor>#00008b</selectedColor>
					<selectedTextColor>#ffffff</selectedTextColor>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<newRecordForm>Form.TfCustomer</newRecordForm>
							<editRecordForm>Form.TfCustomer</editRecordForm>
							<sqlSource>swdata</sqlSource>
							<table>userdb</table>
							<listFilter>empty=1</listFilter>
							<storedQuery>common.load_by_colname</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>mbtn_contact_view</name>
						<type>MenuButton</type>
						<group>Departments:2</group>
					</general>
					<appearance>
						<index>10</index>
						<caption>View</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>38</top>
							<left>275</left>
							<right>340</right>
							<bottom>62</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<backgroundColor>#ff9900</backgroundColor>
							<commands>Properties^1|</commands>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>mbtn_contact_actions</name>
						<type>MenuButton</type>
						<group>Departments:2</group>
					</general>
					<appearance>
						<index>11</index>
						<caption>Actions</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>38</top>
							<left>345</left>
							<right>410</right>
							<bottom>62</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor>#ff9900</backgroundColor>
							<commands>Create New^1|Search &amp;&amp; Associate^3|Disassociate^4|Delete^2|Start Remote Support^5|</commands>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>lb_company1</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>12</index>
						<backgroundColor>#eeeeee</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>390</top>
							<left>410</left>
							<right>660</right>
							<bottom>408</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.fk_company_id</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>true</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
							<sqlSource>swdata</sqlSource>
							<distinctTable>company</distinctTable>
							<distinctColumn>pk_company_id</distinctColumn>
							<displayColumn>companyname</displayColumn>
							<dropdownButtonType>1</dropdownButtonType>
							<storedQuery>generic.select</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>popup_pcompany1</name>
						<type>Image</type>
					</general>
					<appearance>
						<index>13</index>
						<caption>&amp;[app.webroot]/clisupp/formimages/itsm/form.gif</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="0"/>
						<alignment>ExactSize</alignment>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>390</top>
							<left>670</left>
							<right>683</right>
							<bottom>403</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>popup_pdept</name>
						<type>Image</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>14</index>
						<caption>&amp;[app.webroot]/clisupp/formimages/itsm/form.gif</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="0"/>
						<alignment>ExactSize</alignment>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>110</top>
							<left>399</left>
							<right>412</right>
							<bottom>123</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>popup_pdeptman</name>
						<type>Image</type>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>15</index>
						<caption>&amp;[app.webroot]/clisupp/formimages/itsm/form.gif</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="0"/>
						<alignment>ExactSize</alignment>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>132</top>
							<left>399</left>
							<right>412</right>
							<bottom>145</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>16</index>
						<caption>Fk Company Id</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>390</top>
							<left>290</left>
							<right>400</right>
							<bottom>406</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.fk_company_id</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>CaptionPanel1</name>
						<type>CaptionBar</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>true</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>17</index>
						<caption>Department Details</caption>
						<backgroundColor>#f1f1f1</backgroundColor>
						<foregroundColor>#003366</foregroundColor>
						<font  size="10" bold="1">Trebuchet (MS)</font>
						<alignment>Left</alignment>
						<fillStyle>Vertical Gradient</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>35</top>
							<left>20</left>
							<right>419</right>
							<bottom>196</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor2>#d8d8d8</backgroundColor2>
							<imageHSpace>10</imageHSpace>
							<slope>12</slope>
							<borderColor>#d3c9b6</borderColor>
							<headerHeight>23</headerHeight>
							<hasBorder>1</hasBorder>
							<panelBorderColor>#d3c9b6</panelBorderColor>
							<fillStyle>0</fillStyle>
							<panelBackgroundColor>#f2eedd</panelBackgroundColor>
							<panelBackgroundColor2>#000000</panelBackgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>18</index>
						<caption>Department Code</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>66</top>
							<left>25</left>
							<right>135</right>
							<bottom>82</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.pk_dept_code</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>19</index>
						<caption>Department Name</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>88</top>
							<left>25</left>
							<right>135</right>
							<bottom>104</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.dept_name</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>20</index>
						<caption>Parent Department</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>110</top>
							<left>25</left>
							<right>135</right>
							<bottom>126</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.fk_dept_id</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>21</index>
						<caption>Department Manager</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>132</top>
							<left>25</left>
							<right>135</right>
							<bottom>148</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.fk_dept_manager</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>22</index>
						<caption>Telephone</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>154</top>
							<left>25</left>
							<right>135</right>
							<bottom>170</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.telephone</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:0</group>
					</general>
					<appearance>
						<index>23</index>
						<caption>Email</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>176</top>
							<left>25</left>
							<right>135</right>
							<bottom>192</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>department.email</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>sl_services</name>
						<type>SqlTable</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
							<showHeader>true</showHeader>
							<verticalGridLines>true</verticalGridLines>
							<horizontalGridLines>true</horizontalGridLines>
							<autoLoad>false</autoLoad>
							<allowMultiSelect>false</allowMultiSelect>
						</flags>
						<group>Departments:3</group>
					</general>
					<appearance>
						<index>24</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>70</top>
							<left>20</left>
							<right>410</right>
							<bottom>190</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<columns>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>service_name</column>
							</properties>
							<name>Service Name</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>0</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Subscription Type</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>1</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Subscription Start Date</name>
							<width>140</width>
							<image>-1</image>
							<dataColumn>2</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>true</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>fk_cmdb_id</column>
							</properties>
							<name>fk_cmdb_id</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>3</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>true</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>New Column</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>4</dataColumn>
						</controlInfo>
					</columns>
					<sortColumn>-1</sortColumn>
					<sortDescending>false</sortDescending>
					<headerHeight>18</headerHeight>
					<rowHeight>16</rowHeight>
					<selectedColor>#00008b</selectedColor>
					<selectedTextColor>#ffffff</selectedTextColor>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<highlightStyle>0</highlightStyle>
							<borderColor>#d3c9b6</borderColor>
							<sqlSource>swdata</sqlSource>
							<table>sc_folio</table>
							<storedQuery>department.load_services</storedQuery>
							<listFilter>dept_code=&amp;[department.pk_dept_code]</listFilter>
							<selectionMode>1</selectionMode>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>mb_serv_action</name>
						<type>MenuButton</type>
						<group>Departments:3</group>
					</general>
					<appearance>
						<index>25</index>
						<caption>Actions</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>38</top>
							<left>345</left>
							<right>410</right>
							<bottom>62</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor>#ff9900</backgroundColor>
							<commands>Associate^1|Disassociate^2|View Subscription^3|</commands>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>sl_defslas</name>
						<type>SqlTable</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
							<showHeader>true</showHeader>
							<verticalGridLines>true</verticalGridLines>
							<horizontalGridLines>true</horizontalGridLines>
							<autoLoad>false</autoLoad>
							<allowMultiSelect>false</allowMultiSelect>
						</flags>
						<group>Departments:4</group>
					</general>
					<appearance>
						<index>26</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>62</top>
							<left>18</left>
							<right>418</right>
							<bottom>194</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<columns>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>callclass</column>
							</properties>
							<name>Call Class</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>0</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>fk_slad_name</column>
							</properties>
							<name>SLA</name>
							<width>114</width>
							<image>-1</image>
							<dataColumn>1</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>fk_priority</column>
							</properties>
							<name>Priority</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>2</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>true</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>pk_auto_id</column>
							</properties>
							<name>pk_auto_id</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>3</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>true</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
								<column>fk_slad</column>
							</properties>
							<name>fk_slad</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>4</dataColumn>
						</controlInfo>
					</columns>
					<sortColumn>-1</sortColumn>
					<sortDescending>false</sortDescending>
					<headerHeight>18</headerHeight>
					<rowHeight>16</rowHeight>
					<selectedColor>#000099</selectedColor>
					<selectedTextColor>#ffffff</selectedTextColor>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<highlightStyle>0</highlightStyle>
							<borderColor>#000000</borderColor>
							<sqlSource>swdata</sqlSource>
							<table>itsm_sla_class_matrix</table>
							<newRecordForm>Form.tf_rel_sla_class</newRecordForm>
							<editRecordForm>Form.tf_rel_sla_class</editRecordForm>
							<storedQuery>entity.common.class_slas</storedQuery>
							<listFilter>pk_auto_id = -1</listFilter>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btn_add_class</name>
						<type>EventButton</type>
						<group>Departments:4</group>
					</general>
					<appearance>
						<index>27</index>
						<caption>Add</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>35</top>
							<left>350</left>
							<right>415</right>
							<bottom>59</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor>39423</backgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btn_rem_class</name>
						<type>EventButton</type>
						<group>Departments:4</group>
					</general>
					<appearance>
						<index>28</index>
						<caption>Remove</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>35</top>
							<left>280</left>
							<right>345</right>
							<bottom>59</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor>39423</backgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>lbl_sl</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Departments:4</group>
					</general>
					<appearance>
						<index>29</index>
						<caption>Call Class Default SLAs</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>44</top>
							<left>21</left>
							<right>145</right>
							<bottom>58</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
			</controls>
			<formActions>
			</formActions>
			<javascript>
				<methods>
					<method>
						<name>OnFormLoaded</name>
						<code>
							<![CDATA[OnFormLoaded(bDataReloaded)
{
	// TODO: Add your event handler code here
   //-- 26.07.2004
    //-- NWJ
    if ((_swdoc.oDept().pk_dept_code == "") || (_swdoc.oDept().dept_name == ""))
    {	
        //--disable stuff 
        _swdoc.boolInserting=true;
        _swdoc.oDept().fk_company_id = unescape(_swdoc.GetArg("fk_company_id"));
        _swdoc.ResetModiedFlag('department');
        Departments.ShowTabItem(2,false);
        Departments.ShowTabItem(3, false);
         Departments.ShowTabItem(4, false);
        _etab(Departments, 0);
        _evi(_swdoc.MF().mb_view1, false);
        
    }
    else if (_swdoc.oDept().pk_dept_code != '')
    {
  
    	//-- load company details
    	_swdoc.boolInserting=false;  	
    	Departments.ShowTabItem(2,true);
    	_etab(Departments, 0);
    }
   
	_swdoc.setup_dept_form(bDataReloaded);

}]]>
						</code>
					</method>
					<method>
						<name>lb_company1_OnDropDown</name>
						<code>
							<![CDATA[lb_company1_OnDropDown()
{
	//-- DJH - 06.08.07
	//-- load company parent browser
	//-- Call new style company search form and resolve company if one is selected

	app.g.search_for("company",true,"",function(oRes)
	{
		if(oRes.selectedkeys=="")return;
	
		var arrKeys = oRes.selectedkeys.split(",");
		var arrName = oRes.selectedother.split(",");	
		strHash = arrKeys[0];
		strName = arrName[0];
		if ((strHash == '') || (strHash == 'none')) return;
			
		_swdoc.oDept().fk_company_id = strHash;	
		_swdoc.oDept().companyname = strName;	
		
		_swdoc.UpdateFormFromData();	
		return false;
	});
}]]>
						</code>
					</method>
					<method>
						<name>lb_company1_OnRightClick</name>
						<code>
							<![CDATA[lb_company1_OnRightClick()
{
	_swdoc.oDept().fk_company_id = "";	
	_swdoc.oDept().companyname = "";	
	_ete(lb_company1, "");

	return false;
}]]>
						</code>
					</method>
					<method>
						<name>popup_pcompany1_OnLeftClick</name>
						<code>
							<![CDATA[popup_pcompany1_OnLeftClick()
{
	//-- NWJ
	//-- show parent company record
	if (_swdoc.oDept().fk_company_id != "")
	{
		app.OpenFormForEdit("TfCompany", _swdoc.oDept().fk_company_id, "", true, function(){
			_swdoc.UpdateFormFromData();
			return true;
		});
	}
	return true;
	
}]]>
						</code>
					</method>
					<method>
						<name>fld_fk_dept_id_OnDropDown</name>
						<code>
							<![CDATA[fld_fk_dept_id_OnDropDown()
{
	// TODO: Add your event handler code here
	app.g.search_for("dept",true,"fk_company_id="+department.fk_company_id,function(oRes)
	{
		if(oRes.selectedkeys=="")return;
	
		var arrKeys = oRes.selectedkeys.split(",");
		var arrName = oRes.selectedother.split(",");	
		strHash = arrKeys[0];
		strName = arrName[0];
		if ((strHash == '') || (strHash == 'none')) return;
			
		if(strHash==department.pk_dept_code)
		{
			MessageBox('Department cannot be parent of itself');
			return false;
		}
		
		_swdoc.oDept().fk_dept_id = strHash;	
		
		_swdoc.UpdateFormFromData();	
		return false;
	});
}]]>
						</code>
					</method>
					<method>
						<name>fld_fk_dept_id_OnRightClick</name>
						<code>
							<![CDATA[fld_fk_dept_id_OnRightClick()
{
	// TODO: Add your event handler code here
	_swdoc.oDept().fk_dept_id = "";	
	_ete(fld_fk_dept_id, "");


	return true;
}]]>
						</code>
					</method>
					<method>
						<name>popup_pdept_OnLeftClick</name>
						<code>
							<![CDATA[popup_pdept_OnLeftClick()
{
	//-- NWJ
	//-- show parent company record
	if (_swdoc.oDept().fk_dept_id != "")
	{
		app.OpenFormForEdit("EfDepartment", _swdoc.oDept().fk_dept_id, "", true, function(){
			_swdoc.UpdateFormFromData();
			return true;
		});
	}
	return true;
	
}]]>
						</code>
					</method>
					<method>
						<name>fld_fk_dept_manager_OnDropDown</name>
						<code>
							<![CDATA[fld_fk_dept_manager_OnDropDown()
{
	// TODO: Add your event handler code here
	var strURL = "canreset=1&fk_company_id=" + _swdoc.oDept().fk_company_id;
	app.g.search_for("customers",true,strURL,function(oRes)
	{
		if(oRes.selectedkeys=="")return;
		
		var arrKeys = oRes.selectedkeys.split(",");
		var arrName = oRes.selectedother.split(",");	
		var arrCMDBIDs = oRes.selectedcmdbids.split(",");
			
		_swdoc.oDept().fk_dept_manager = arrKeys[0];
		
		_swdoc.UpdateFormFromData();	
		return false;
	});
}]]>
						</code>
					</method>
					<method>
						<name>popup_pdeptman_OnLeftClick</name>
						<code>
							<![CDATA[popup_pdeptman_OnLeftClick()
{
	//-- NWJ
	//-- show parent company record
	if (_swdoc.oDept().fk_dept_manager != "")
	{
		app.OpenFormForEdit("tfCustomer", _swdoc.oDept().fk_dept_manager, "", true, function(){
			_swdoc.UpdateFormFromData();
			return true;
		});
	}
	return true;
	
}]]>
						</code>
					</method>
					<method>
						<name>sl_contacts1_OnItemSelected</name>
						<code>
							<![CDATA[sl_contacts1_OnItemSelected(nRow)
{
 	//-- 26.07.2004
    //-- NWJ
    //-- Load contact details when selected.
    var contact_id  = sl_contacts1.GetItemTextRaw(nRow,'keysearch');
    if (contact_id != "")
    {
     
        //-- show the update and delete button
        _een(mbtn_contact_view1,true);
    }    
    else
    {
    
    	if (sl_contacts1.rowCount() > 0 )
    	{
    		sl_contacts1.SetRowSelected(0);
    		sl_contacts1_OnItemSelected(0);
    	}
    	else
    	{
    		_een(mbtn_contact_view1,false);
        }
    }

    
    return;


}]]>
						</code>
					</method>
					<method>
						<name>sl_contacts1_OnItemDoubleClicked</name>
						<code>
							<![CDATA[sl_contacts1_OnItemDoubleClicked(nRow, nCol)
{
		sl_contacts1.EditRecord(nRow);
		_swdoc.load_site_customers(nRow);
		return false;
}]]>
						</code>
					</method>
					<method>
						<name>mbtn_contact_view_OnMenuItem</name>
						<code>
							<![CDATA[mbtn_contact_view_OnMenuItem(strName, nItemID)
{
	var iProperties = 1;
	
	if(nItemID == iProperties)
	{
		sl_contacts.EditRecord(sl_contacts.curSel);
		_swdoc.load_site_customers(sl_contacts.curSel);
	}


}]]>
						</code>
					</method>
					<method>
						<name>mbtn_contact_actions_OnMenuItem</name>
						<code>
							<![CDATA[mbtn_contact_actions_OnMenuItem(strName, nItemID)
{
	var iNewContact = 1;
	var iDeleteContact = 2;
	var iSearchAdd = 3;
	var iRemove = 4;
	var iSupport = 5;
	
	if(nItemID == iRemove)
	{
		var strKey = sl_contacts.GetItemTextRaw(sl_contacts.curSel, 'keysearch');
		var intCI = sl_contacts.GetItemTextRaw(sl_contacts.curSel, 'fk_cmdb_id');
		if(strKey=="")return;
		    			
		if(confirm("Are you sure you want to disassociate the selected customer from this site?"))
		{
			//-- delete ci relationship (always assume that ME is parent)
			if(_swdoc.oDept().fk_cmdb_id>0)
			{
				app.cmdb.delete_meconfigrelation(_swdoc.oDept().fk_cmdb_id, intCI);
			}   		
				
			//-- update userdb where site is this site and is selected customer - using simple sql
			var p = {};
			p.ks = strKey;
			p.pdc = _swdoc.oDept().pk_dept_code;
			app.g.submitsimplesql("efdepartment.cleardepartment", p);
		}
		
		_swdoc.load_dept_customers();
		_swdoc.MF().sl_contacts.Refresh();
	}	
	else if(nItemID == iNewContact)
	{
		//-- NWJ
    	//-- Open new contact form
    	//-- pass in pk_company_auto_id so that we can link the two
    	var strURL = "fk_company_id=" + pfu(_swdoc.oDept().fk_company_id) + "&department=" + pfu(_swdoc.oDept().pk_dept_code);
		app.g.sl_openformforadd(sl_contacts,"TfCustomer", strURL, 1,null, function()
		{
			_swdoc.load_dept_customers();
			_swdoc.MF().sl_contacts.Refresh();
		});
	}
	else if(nItemID == iDeleteContact)
	{
		
		//-- 29.07.2004
    	//-- NWJ
    	//-- Delete the selected contact
    	var selectedRow     = sl_contacts.curSel;
    	var strConfirm		= "Are you sure you want to delete this customer from the database ?";
    
		app.g.sl_deldbrow(sl_contacts,selectedRow,'keysearch',null,strConfirm);
		_swdoc.load_dept_customers();
		_swdoc.MF().sl_contacts.Refresh();
	}
	else if (nItemID == iSearchAdd)
	{
	
		//-- show list of company customers, that are not currently linked to this site, that can link to this site
		var strURL = "fk_company_id=" + pfu(_swdoc.oDept().fk_company_id);
		app.g.search_for("customers", true,strURL,function(oData)
		{
			if (oData.selectedkeys=="") return;
		 	
			//--
			//-- create ci relationship (always assume that customer always uses a CI)
			if(_swdoc.oDept().fk_cmdb_id>0)
			{
				var strRel = dd.GetGlobalParamAsString("Application Settings/CMDB/Types/DefaultDeptCustRelationship");
				//MessageBox(oData.selectedcmdbids +":"+_swdoc.oDept().fk_cmdb_id)
				app.cmdb.generate_meconfigrelation(_swdoc.oDept().fk_cmdb_id, oData.selectedcmdbids, strRel);
			}   		
   			
			
			var p = {};
			p.ks =  oData.selectedpfskeys;
			p.pdc = _swdoc.oDept().pk_dept_code;
			app.g.submitsimplesql("efdepartment.setdepartment", p);
			
			_swdoc.load_dept_customers();
			_swdoc.MF().sl_contacts.Refresh();
					
			return;
		});
	}
	else if(nItemID == iSupport)
	{

		//-- Remote Support Enabled?
		if(app.g.remote_support_enabled())
		{
			//-- Attempt to launch a pinned support session
			var strEmail = app.g.sl_getrawcolvalue(sl_contacts,-1,"email");
			app.g.start_remote_support(strEmail);
		}	
		else
		{
			MessageBox("Remote Support is not available for this customer");
		}
	}


}]]>
						</code>
					</method>
					<method>
						<name>Departments_OnTabSelected</name>
						<code>
							<![CDATA[Departments_OnTabSelected(nTab)
{
	// TODO: Add your event handler code here
	if(nTab == 2)
	{
		_swdoc.load_dept_customers();
		_swdoc.MF().sl_contacts.Refresh();
	}
	else if (nTab == 3)
	{
		_swdoc.MF().sl_services.Refresh();
	}
	else if (nTab == 4)
	{
		_slf(_swdoc.MF().sl_defslas, "reltype=DEPT&fk_rel_id="+pfu(department.pk_dept_code));
		_swdoc.MF().sl_defslas.Refresh();
	}

}]]>
						</code>
					</method>
					<method>
						<name>mb_view1_OnMenuItem</name>
						<code>
							<![CDATA[mb_view1_OnMenuItem(strName, nItemID)
{
	if(nItemID==1)
	{
		app.cmdb.view_vcm(_swdoc.oDept().fk_cmdb_id,false);
	}
	else if(nItemID==2)
	{
		app.cmdb.view_vcm(_swdoc.oDept().fk_cmdb_id,true);
	}


}]]>
						</code>
					</method>
					<method>
						<name>sl_contacts_OnItemSelected</name>
						<code>
							<![CDATA[sl_contacts_OnItemSelected(nRow)
{
	// TODO: Add your event handler code here
    //-- Load contact details when selected.
    var contact_id  = sl_contacts.GetItemTextRaw(nRow,'keysearch');
    if (contact_id != "")
    {
     
        //-- show the update and delete button
        _een(mbtn_contact_view, true);
    }    
    else
    {
    
    	if (sl_contacts.rowCount() > 0 )
    	{
    		sl_contacts.SetRowSelected(0);
    		sl_contacts_OnItemSelected(0);
    	}
    	else
    	{
    		_een(mbtn_contact_view, false);
        }
    }

    
    return;


}]]>
						</code>
					</method>
					<method>
						<name>sl_contacts_OnItemDoubleClicked</name>
						<code>
							<![CDATA[sl_contacts_OnItemDoubleClicked(nRow, nCol)
{
	// TODO: Add your event handler code here

	sl_contacts.EditRecord(nRow);
	_swdoc.load_dept_customers(nRow);
	return false;
}]]>
						</code>
					</method>
					<method>
						<name>sl_services_OnItemDoubleClicked</name>
						<code>
							<![CDATA[sl_services_OnItemDoubleClicked(nRow, nCol)
{
	// TODO: Add your event handler code here
	var pk_id  = _swdoc.MF().sl_services.GetItemText(nRow,'fk_cmdb_id');
	app.OpenFormForEdit("portfolio", pk_id,'',false, function(){});
}]]>
						</code>
					</method>
					<method>
						<name>mb_serv_action_OnMenuItem</name>
						<code>
							<![CDATA[mb_serv_action_OnMenuItem(strName, nItemID)
{
	app.itsm.subscription_actions_OnMenuItem(strName, nItemID, "Department", _swdoc.MF().sl_services, _swdoc.oDept());
	_swdoc.MF().sl_services.Refresh();
}]]>
						</code>
					</method>
					<method>
						<name>OnFieldValueChanged</name>
						<code>
							<![CDATA[OnFieldValueChanged(strName, strValue)
{
	// TODO: Add your event handler code here


}]]>
						</code>
					</method>
					<method>
						<name>btn_rem_class_OnPressed</name>
						<code>
							<![CDATA[btn_rem_class_OnPressed()
{
    var selectedRow     = sl_defslas.curSel;
    var strConfirm		= "Are you sure you want to remove this associated SLA/Call Class?";
    
	if(app.g.sl_deldbrow(sl_defslas,selectedRow,"pk_auto_id",null,strConfirm))
	{
		_swdoc.MF().sl_defslas.Refresh();
	}
}]]>
						</code>
					</method>
					<method>
						<name>btn_add_class_OnPressed</name>
						<code>
							<![CDATA[btn_add_class_OnPressed()
{
	var strURL = "reltype=DEPT&fk_rel_id=" + pfu(department.pk_dept_code);
    app.OpenFormForAdd("tf_rel_sla_class" ,"", strURL, true, function()
    {
    	_swdoc.MF().sl_defslas.Refresh();
    });  	
}]]>
						</code>
					</method>
				</methods>
			</javascript>
		</layout>
		<layout>
			<appearance>
				<width>360</width>
				<height>220</height>
				<backgroundColor>#ffffff</backgroundColor>
				<fillColour>#ffffff</fillColour>
				<textColour >#000000</textColour >
				<font  size="8">Arial</font>
			</appearance>
			<controls>
			</controls>
			<formActions>
			</formActions>
			<javascript>
				<methods>
				</methods>
			</javascript>
		</layout>
	</layouts>
</espForm>
