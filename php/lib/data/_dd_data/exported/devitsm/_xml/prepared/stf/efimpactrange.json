{"espForm":{"configuration":{"settings":{"name":"EfImpactRange","title":"Assessment (Ranges)","description":"Setting ranges of Impact Level Assessment. Each Range will result in an Impact Level","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"ila_range","type":"Main Details Table","flags":"3"}},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined('_bHtmlWebClient'))?top:_swdoc;\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\n\nvar str_usage_area = \"\";\nvar strEditMode = \"Edit\";"},{"name":"OnPreValidate","code":"OnPreValidate()\n{\n\t\/\/ TODO: Add your event handler code here\n\tif (_swdoc.ila_range.lower_limit > _swdoc.ila_range.upper_limit)\n\t{\n\t\tMessageBox(\"The Lower Limit must be less or equal to the Upper Limit\");\n\t\treturn VALIDATE_FAIL;\n\t}\n\n\treturn VALIDATE_DEFAULT;\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"390","height":"70","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"pl_impact_level","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"10","left":"130","right":"380","bottom":"26"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"ila_range.impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_impact_lvl","distinctColumn":"pk_impact","storedQuery":"generic.select"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Lower Limit","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"30","left":"10","right":"120","bottom":"46"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ila_range.lower_limit"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Field"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"30","left":"130","right":"380","bottom":"46"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"ila_range.lower_limit"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Upper Limit","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"50","left":"10","right":"120","bottom":"66"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"ila_range.upper_limit"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"50","left":"130","right":"380","bottom":"66"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"ila_range.upper_limit"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Numeric","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lbl_level","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"5","caption":"Level","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"10","left":"10","right":"120","bottom":"26"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"pl_level","type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"10","left":"130","right":"380","bottom":"26"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"ila_range.impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","listItems":"E-Mail|Telephone|Fax|Post|Web|In Person|Online Forum|","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=","storedQuery":"common.getSwLists"}}}]},"javascript":{"methods":{"method":{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strFilter = \"\";\n\tif (_swdoc.GetArg(\"EditMode\") == \"Add\")\n\t{\n\t\t_swdoc.str_usage_area = _swdoc.GetArg(\"usage_area\");\n\t\t_swdoc.ila_range.usage_area = _swdoc.str_usage_area;\n\t\tstrFilter = \"lid=\" + pfu(_swdoc.GetArg(\"levelfilter\"));\n\t}\n\telse \/\/ the filters and Usage should be based on the data in the record\n\t{\n\t\t_swdoc.str_usage_area = _swdoc.ila_range.usage_area;\n\t\n\t\tswitch (_swdoc.str_usage_area)\n\t\t{\n\t\t\tcase \"Release Risk\" :\n\t\t\t\tstrFilter = \"lid=ASSESS-RELEASE-RISK\";\n\t\t\tbreak;\t\t\n\t\t}\n\t}\n\t\n\t_slf(_swdoc.MF().pl_level,strFilter);\n\n\t_ema(_swdoc.MF().pl_impact_level, (_swdoc.str_usage_area == \"Change Log Call Form\"));\n\t_evi(_swdoc.MF().pl_impact_level, (_swdoc.str_usage_area == \"Change Log Call Form\"));\n\t\/\/_evi(_swdoc.MF().lbl_impact_level, (_swdoc.str_usage_area == \"Change Log Call Form\"));\n\t\n\t_ema(_swdoc.MF().pl_level, !(_swdoc.str_usage_area == \"Change Log Call Form\"));\n\t_evi(_swdoc.MF().pl_level, !(_swdoc.str_usage_area == \"Change Log Call Form\"));\n\t\/\/_evi(_swdoc.MF().lbl_level, !(_swdoc.str_usage_area == \"Change Log Call Form\"));\n\n}"}}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}