{"espForm":{"configuration":{"settings":{"name":"cmdb_staging","title":"Manage Configuration Item Staging Records","description":"Search on opencall table","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\nvar webclient = IsObjectDefined(\"_bHtmlWebClient\");\nvar strSelectedKeys= \"\";\nvar strSelectedText = \"\";\nvar strSelectedTypes = \"\";\nvar strSelectedDesc = \"\";\nvar currentList = null;\nvar arrUpdateProcess = new Array();\nvar arrDeleteRecords = new Array();\n\nvar arrSites = new Array();\nvar arrOrgs = new Array();\nvar arrSLAs = new Array();\n\nvar strStatus = \"\";\nvar timer = 0;\nvar boolFromRefreshBtn = false;\n\n\/\/-- Paging Variables\nvar intPageNo = 1; \/\/ Page Number To Pass to Query\nvar strFilter = \"\"; \/\/ CI search filter\nvar intCIsPerPage = oSettings.get_setting(\"sysSqlPaging\"); \/\/ defines the maximum amount of records to be displayed per page\nif (_swdoc.webclient) _swdoc.intCIsPerPage = 100; \/\/overide for _swdoc.webclient\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\nfunction reset_page()\n{\n\t_een(_swdoc.MF().btn_next,false);\n\t_een(_swdoc.MF().btn_prev,false);\t\n}\nfunction reset_form_fields()\n{\n\t\/\/-- clear search fields\n\tapp.g.clear_form_fields(\"cmdb_stage\",mainform,\"\",false);\n\t_ete(_swdoc.MF().flg_awatingonly, \"1\");\n\t_ete(_swdoc.MF().flg_delete, \"0\");\n}\n\/\/--TK used to refresh fields in history\nfunction history_refresh()\n{\n\t\/\/--TK If strStatus is empty then load the latest value from the mainform value\n\tif(!_swdoc.strStatus)_swdoc.strStatus = mainform.status;\n\t\n\t\/\/-- Clear Main Form Value Ready for it to be Refreshed from the DB\n\t_ete(mainform.status , \"\");\n\t_ete(mainform.complete , \"\");\n\t\n\t\/\/--Get Latest Process Details\n\tvar oRS = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_stage_process\");\n\twhile(oRS.Fetch())\n\t{\n\t\tvar strID = app.g.get_field(oRS, \"pk_id\");\n\t\tvar strStatus = app.g.get_field(oRS, \"status\");\n\t\tvar strComplete = app.g.get_field(oRS, \"per_complete\");\n\t}\n\t\/\/--Set Main Form Value to that just taken from the database\n\tif(strStatus) _ete(mainform.status , strStatus);\n\tif(strComplete)\t_ete(mainform.complete , strComplete+\"%\");\n\n\tif(strStatus == \"Complete\" && _swdoc.boolFromRefreshBtn)\n\t{\n\t\tMessageBox(\"Process Complete\");\t\n\t\t\/\/-- Once Complete Kill Timer\n\t\t\/\/_swdoc.timer = 0;\n\t\t\/\/mainform.KillTimer(2);\n\t}\n\t_swdoc.boolFromRefreshBtn = false;\n\t\/\/--If the Latest Value is Processing then Kick Off Timer only if _swdoc.timer not already running\n\t\/*\n\tif((strStatus == \"Processing\" || strStatus == \"Starting\") && (_swdoc.timer == 0))\n\t{\n\t\t\/\/--TK Set Timer Running\n\t\t\/\/_swdoc.timer = 1;\n\t\t\/\/mainform.SetTimer(2, 30000);\n\t\t\n\t}\n\t*\/\n\t\/\/--Refresh SL List\n\t\/\/if(_swdoc.timer)\n\t\/\/\t_swdoc.MF().sl_history.Refresh();\n}\n\/\/--\n\/\/-- process staged records\nfunction process_staging_records(boolSelectedOnly)\n{\n\tapp.global.LogInfo(\"Process Records\", \"On Pressed\", \"Start\", 1);\n\t_swdoc.arrUpdateProcess = new Array();\n\t_swdoc.arrDeleteRecords = new Array();\n\tvar boolAwaitingOnly = (_swdoc.MF().flg_awatingonly.text==\"1\");\n\tvar checkAddColVals = \"\";\n\tif(boolAwaitingOnly)\n\t{\n\t\t\/\/-- we want to process those where import status = \"awaiting or \"\"\n\t\tcheckAddColVals = \"import_status=awaiting\";\n\t}\n\t\/\/-- get list of identifiers we want to create\n\t\n\tvar boolSuccess = true;\n\t\n\tif (_swdoc.currentList == undefined)\n\t{\n\t\t_swdoc.currentList = _swdoc.MF().sl_results;\n\t}\n\t\n\tvar strCreateItemIDs = app.g.sl_get_valuesdel_andcheckcolvalue(_swdoc.currentList,\"ck_config_item\",\"import_action\",\"create\",checkAddColVals,\"©\",\"\",boolSelectedOnly);\n\tif(strCreateItemIDs!=\"\")\n\t{\n\t\tif(!_swdoc.process_create_records(strCreateItemIDs)) \n\t\t\tboolSuccess = false;\n\t}\n\t\n\tif(boolSuccess)\n\t{\n\t\t\/\/-- get list of identifiers we want to baseline and update\n\t\tvar strUpdateItemIDs = app.g.sl_get_valuesdel_andcheckcolvalue(_swdoc.currentList,\"ck_config_item\",\"import_action\",\"update\",checkAddColVals,\"©\",\"\",boolSelectedOnly);\n\t\tif(strUpdateItemIDs!=\"\")\n\t\t{\n\t\t\tif(!_swdoc.process_update_records(strUpdateItemIDs))\n\t\t\t\tboolSuccess = false;\n\t\t}\n\t}\n\n\t\/\/-- update cmdb stage records with status\n\tfor(var i in _swdoc.arrUpdateProcess)\n\t{\n\t\tvar p ={};\n\t\tp.stageditems = _swdoc.arrUpdateProcess[i];\n\t\tp.status = i;\n\t\tapp.g.submitsqs(\"cmdb\/process\/stagedimport\/update_import_status\",p);\n\t}\n\t\t\n\t\/\/-- Delete staging records\n\tfor(var i in _swdoc.arrDeleteRecords)\n\t{\n\t\tvar p ={};\n\t\tp.stageditems = _swdoc.arrDeleteRecords[i];\n\t\tp.table = i;\n\t\tapp.g.submitsqs(\"cmdb\/process\/stagedimport\/delete_extended_stageditems\",p);\n\t}\n\tapp.global.LogInfo(\"Process Records\", \"On Pressed\", \"End\", 1);\n\t\n\t\n\tif(boolSuccess)\tMessageBox(\"Processing Completed.\")\n}\n\n\/\/--\n\/\/-- baseline and update existing records\nfunction process_update_records(strUpdateItemIDs, funcCallback)\n{\n\tvar arrUpdateItems = strUpdateItemIDs.split(\"©\");\n\tvar strItems = \"\";\n\tfor(var x=0; x < arrUpdateItems.length;x++)\n\t{\n\t\tif(strItems!=\"\")strItems+=\",\";\n\t\tstrItems += arrUpdateItems[x];\n\t}\t\n\n\t\/\/-- get pk_auto_id from config_itemi\n\tvar p={};\n\tp.stageditems = strItems;\n\tvar oCountRS = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_affected_configitem_count\",p,true);\n\tif(oCountRS.Fetch())\n\t{\n\t\tvar intItemCount = oCountRS.GetValueAsString(\"CNT\");\n\t\tif (intItemCount > 0)\n\t\t{\n\t\t\tvar strDiaryDescription = \"\";\n\t\t\t\/\/-- prompt for a diary update\n\t\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/CMDB\/OnBaselinePromptDiary\")==1)\n\t\t\t{\n\t\t\t\n\t\t\t\tstrPlural = \"s\";\n\t\t\t\tif (intItemCount==1)\n\t\t\t\t{\n\t\t\t\t\tstrPlural = \"\";\n\t\t\t\t}\n\t\t\t\t\/\/-- Open form for analyst to add entry\n\t\t\t\tstrPromptText = \"Please enter diary text for the \" + intItemCount + \" CI\" + strPlural + \" to be updated:\";\n\t\t\t\tstrDiaryDescription = prompt(strPromptText,\"\");\n\t\t\t\t\n\t\t\t}\n\t\t\tvar oRS = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_affected_configitems\",p,true);\n\t\t\twhile(oRS.Fetch())\n\t\t\t{\n\t\t\t\tvar updItem = oRS.GetValueAsString(\"ck_config_item\");\n\t\t\t\tvar intID = oRS.GetValueAsString(\"pk_auto_id\");\n\t\t\t\tvar strType = oRS.GetValueAsString(\"ck_config_type\");        \t\n\t\t\t\tvar intBLNID = oRS.GetValueAsString(\"baselineid\");\n\t\t\t\t\n\t\t\t\t\/\/set vars for ci relationship creation\n\t\t\t\tvar intOrigSLD = oRS.GetValueAsString(\"fk_sld\");\n\t\t\t\tvar strOrigSite = oRS.GetValueAsString(\"fk_site\");\n\t\t\t\tvar strOrigCompany = oRS.GetValueAsString(\"fk_company_id\");\n\t\t\t\tvar strStageExtTable = \"\";\n\t\t\t\t\/\/-- create new baseline\n\t\t\t\tvar newCMDBID = app.cmdb.create_baseline_silent(intID, intBLNID,strType, true,strDiaryDescription);\n\t\t\t\t\n\t\t\t\tif(newCMDBID>0)\n\t\t\t\t{\t\t\n\t\t\t\t\tvar boolSite = false;\n\t\t\t\t\tvar boolCompany = false;\n\t\t\t\t\tvar boolSLA = false;\n\t\t\t\t\tvar intNewSLD = 0;\n\t\t\t\t\tvar strNewSite = \"\";\n\t\t\t\t\tvar strNewCompany = \"\";\n\t\t\t\t\t\n\t\t\t\t\t\/\/-- now update new CI with values from staging table\n\t\t\t\t\t\/\/-- select fields from cmdb_stagefields\n\t\t\t\t\tvar strUpdateCI = \"\";\n\t\t\t\t\tvar strUpdateExt = \"\";\n\t\t\t\t\tvar strExtTable = \"\";\n\t\t\n\t\t\t\t\tvar p={};\n\t\t\t\t\tp.stageditem = updItem;\n\t\t\t\t\tvar oRSFields = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_item_stagefields\",p);\n\t\t\t\t\t\n\t\t\t\t\twhile(oRSFields.Fetch())\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/--\n\t\t\t\t\t\tvar strNewValue = oRSFields.GetValueAsString(\"newvalue\");\n\t\t\t\t\t\tvar strColName  = oRSFields.GetValueAsString(\"targetcol\");\n\t\t\t\t\t\tvar strTableName  = oRSFields.GetValueAsString(\"targettable\");\n\t\t\n\t\t\t\t\t\tif(strTableName==\"config_itemi\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\/\/set flags and values for ci relationship checks\n\t\t\t\t\t\t\tif(strColName==\"fk_site\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar boolSite = true;\n\t\t\t\t\t\t\t\tvar strNewSite = strNewValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(strColName==\"fk_company_id\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar boolCompany = true;\n\t\t\t\t\t\t\t\tvar strNewCompany = strNewValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif(strColName==\"fk_sld\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar boolSLA = true;\n\t\t\t\t\t\t\t\tvar intNewSLD = strNewValue;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tif(strUpdateCI!=\"\")strUpdateCI+=\"&\";\n\t\t\t\t\t\t\tstrUpdateCI += \"_swc_\" + strColName + \"=\" + pfu(strNewValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstrExtTable = strTableName;\n\t\t\t\t\t\t\tstrStageExtTable = strExtTable+\"_stage\";\n\t\t\t\t\t\t\tif(strUpdateExt!=\"\")strUpdateExt+=\"&\";\n\t\t\t\t\t\t\tstrUpdateExt += \"_swc_\" + strColName + \"=\" + pfu(strNewValue);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\/\/-- perform updates\n\t\t\t\t\t\n\t\t\t\t\t\/\/-- config_itemi\n\t\t\t\t\tif(strUpdateCI!=\"\")\n\t\t\t\t\t{\n\t\t\n\t\t\t\t\t\tvar boolRes = app.g.submittableupdate(\"config_itemi\",newCMDBID,strUpdateCI)\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\/\/-- ext table\n\t\t\t\t\tif(strUpdateExt!=\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\tvar boolRes = app.g.submittableupdate(strExtTable,newCMDBID,strUpdateExt);\t\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t\tif(!boolRes)\n\t\t\t\t\t{\n\t\t\t\t\t\tMessageBox(\"Failed to update staging record (\" + updItem + \"). Please contact your Supportworks Administrator.\");\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/if updates successful, update CI relations\n\t\t\t\t\t\tvar boolCheckOrg = true;\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/if site has changed\n\t\t\t\t\t\tif(boolSite)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\/\/if site is not already loaded, load site\n\t\t\t\t\t\t\tvar strSite = strOrigSite;\n\t\t\t\t\t\t\trecSite = false;\n\t\t\t\t\t\t\tif(_swdoc.arrSites[strSite]!=undefined)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar recSite = _swdoc.arrSites[strSite];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get Site\", strSite, 1);\n\t\t\t\t\t\t\t\tvar recSite = app.g.get_record(\"site\", strSite);\n\t\t\t\t\t\t\t\t_swdoc.arrSites[strSite] = recSite;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\/\/clear current site relationship\n\t\t\t\t\t\t\tif(recSite)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tapp.cmdb.delete_meconfigrelation(recSite.fk_cmdb_id,newCMDBID);  \n\t\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t\t\/\/if site is set\n\t\t\t\t\t\t\tif(strNewSite != \"\")    \t\t\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultSiteCIRelationship\");\n\t\t\t\t\t\t\t\tvar strSite = strNewSite;\n\t\t\t\t\t\t\t\trecSite = false;\n\t\t\t\t\t\t\t\tif(_swdoc.arrSites[strSite]!=undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar recSite = _swdoc.arrSites[strSite];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get Site\", strSite, 1);\n\t\t\t\t\t\t\t\t\tvar recSite = app.g.get_record(\"site\", strSite);\n\t\t\t\t\t\t\t\t\t_swdoc.arrSites[strSite] = recSite;\n\t\t\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t\t\tif(recSite!=false)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tapp.cmdb.generate_meconfigrelation(recSite.fk_cmdb_id,newCMDBID, strRel);\n\t\t\t\t\t\t\t\t\t\/\/ PM00131778 - Remove code that prevents the creation of Org relationship\n\t\t\t\t\t\t\t\t\t\/\/ boolCheckOrg = false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}else\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\/\/site has been cleared\n\t\t\t\t\t\t\t\tboolCheckOrg = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t\t\/\/will only be run if no site link\n\t\t\t\t\t\tif(boolCheckOrg)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\/\/site has been set blank or unable to create site rel, create org rel to new company\n\t\t\t\t\t\t\tif(boolCompany)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\/\/remove current company link\n\t\t\t\t\t\t\t\tvar strOrg = strOrigCompany;\n\t\t\t\t\t\t\t\trecOrg = false;\n\t\t\t\t\t\t\t\tif(_swdoc.arrOrgs[strOrg]!=undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar recOrg = _swdoc.arrOrgs[strOrg];\/\/app.g.get_record(\"CONFIG_TYPEI\", );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get Organisation\", strOrg, 1);\n\t\t\t\t\t\t\t\t\tvar recOrg = app.g.get_record(\"company\", strOrg);\n\t\t\t\t\t\t\t\t\t_swdoc.arrOrgs[strOrg] = recOrg;\n\t\t\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t\t\tif(recOrg)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tapp.cmdb.delete_meconfigrelation(recOrg.fk_cmdb_id,newCMDBID);  \n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\tif(strNewCompany!=\"\")\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgCIRelationship\");\n\t\t\n\t\t\t\t\t\t\t\t\tvar strOrg = strNewCompany;\n\t\t\t\t\t\t\t\t\trecOrg = false;\n\t\t\t\t\t\t\t\t\tif(_swdoc.arrOrgs[strOrg]!=undefined)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tvar recOrg = _swdoc.arrOrgs[strOrg];\/\/app.g.get_record(\"CONFIG_TYPEI\", );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get Organisation\", strOrg, 1);\n\t\t\t\t\t\t\t\t\t\tvar recOrg = app.g.get_record(\"company\", strOrg);\n\t\t\t\t\t\t\t\t\t\t_swdoc.arrOrgs[strOrg] = recOrg;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(recOrg!=false)\n\t\t\t\t\t\t\t\t\t\tapp.cmdb.generate_meconfigrelation(recOrg.fk_cmdb_id,newCMDBID,strRel);  \n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if(boolSite)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\/\/site has been set blank or unable to create site rel, create org rel with unchanged org\n\t\t\t\t\t\t\t\tif(strOrigCompany!=\"\")\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgCIRelationship\");\n\t\t\n\t\t\t\t\t\t\t\t\tvar strOrg = strOrigCompany;\n\t\t\t\t\t\t\t\t\trecOrg = false;\n\t\t\t\t\t\t\t\t\tif(_swdoc.arrOrgs[strOrg]!=undefined)\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tvar recOrg = _swdoc.arrOrgs[strOrg];\/\/app.g.get_record(\"CONFIG_TYPEI\", );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get Organisation\", strOrg, 1);\n\t\t\t\t\t\t\t\t\t\tvar recOrg = app.g.get_record(\"company\", strOrg);\n\t\t\t\t\t\t\t\t\t\t_swdoc.arrOrgs[strOrg] = recOrg;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tif(recOrg!=false)\n\t\t\t\t\t\t\t\t\t\tapp.cmdb.generate_meconfigrelation(recOrg.fk_cmdb_id,newCMDBID,strRel);  \n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t\t\/\/sla changed\n\t\t\t\t\t\tif(boolSLA)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\/\/remove current sla link\n\t\t\t\t\t\t\tvar strSLA = intOrigSLD;\n\t\t\t\t\t\t\trecSLA = false;\n\t\t\t\t\t\t\tif(_swdoc.arrSLAs[strSLA]!=undefined)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar recSLA = _swdoc.arrSLAs[strSLA];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get SLA\", strSLA, 1);\n\t\t\t\t\t\t\t\tvar recSLA = app.g.get_record(\"itsmsp_slad\", strSLA);\n\t\t\t\t\t\t\t\t_swdoc.arrSLAs[strSLA] = recSLA;\n\t\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t\tif(recSLA)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tapp.cmdb.delete_meconfigrelation(recSLA.fk_cmdb_id,newCMDBID);  \n\t\t\t\t\t\t\t}\n\t\t\n\t\t\t\t\t\t\t\/\/if SLA has been set - not cleared, create new sla\n\t\t\t\t\t\t\tif(intNewSLD>0)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar strRel = \"Uses\";\n\t\t\t\t\t\t\t\tvar strSLA = intNewSLD;\n\t\t\t\t\t\t\t\trecSLA = false;\n\t\t\t\t\t\t\t\tif(_swdoc.arrSLAs[strSLA]!=undefined)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tvar recSLA = _swdoc.arrSLAs[strSLA];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get SLA\", strSLA, 1);\n\t\t\t\t\t\t\t\t\tvar recSLA = app.g.get_record(\"itsmsp_slad\", strSLA);\n\t\t\t\t\t\t\t\t\t_swdoc.arrSLAs[strSLA] = recSLA;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif(recSLA!=false)\n\t\t\t\t\t\t\t\t\tapp.cmdb.generate_meconfigrelation(recSLA.fk_cmdb_id,newCIid,strRel); \n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t\t\/\/-- successfully created - so mark as processed\n\t\t\t\t\t\/\/MessageBox(boolRes)\n\t\t\t\t\t_swdoc.mark_record_processed(updItem,!boolRes,strStageExtTable);\t\n\t\t\t\t}\t\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tMessageBox(\"Failed to update staging record (\" + updItem + \"). Please contact your Supportworks Administrator.\");\n\t\t\t\t\t_swdoc.mark_record_processed(updItem,true,\"\");\t\n\t\t\t\t\treturn false;\n\t\t\t\t}\n    \t\t\t\n\t\t\t}\n\t\t}\n\t}\n\treturn true;\t\n}\n\n\/\/--\n\/\/-- create new cmdb records\nfunction process_create_records(strCreateItemIDs)\n{\n\tvar arrCITypes = new Array();\n\tvar array_default_values = new Array();\n\tvar strMissingType = \"\";\n\tvar intCountMissingTypes=0;\n\t\n\tvar arrDefaultCIValues = new Array();\n\tarrDefaultCIValues['isactivebaseline'] = 'Yes';\n\tarrDefaultCIValues['isunavailable'] = 'Yes';\n\tarrDefaultCIValues['isactive'] = 'Yes';\n\tarrDefaultCIValues['isauthorised'] = 'Yes';\n\t\t\n\tvar arrCreateItems = strCreateItemIDs.split(\"©\");\n\tvar strItems = \"\";\n\tfor(var x=0; x < arrCreateItems.length;x++)\n\t{\n\t\tif(strItems!=\"\")strItems+=\",\";\n\t\tstrItems += arrCreateItems[x];\n\t}\t\n\n\t\/\/-- get staged items\n\tvar p={};\n\tp.stageditems = strItems;\n\tvar oRS = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_stageditems\",p);\t\n\twhile(oRS.Fetch())\n\t{\n\t\t\/\/-- Check if staus values are provided\n\t\tvar boolCmdbStatusSet = false;\n\t\tvar boolFkStatusLevelSet = false;\n\t\t\n\t\tvar strCmdbStatus = oRS.GetValueAsString(\"cmdb_status\");\n\t\tif (strCmdbStatus!=\"\")\n\t\t{\n\t\t\tboolCmdbStatusSet = true;\n\t\t}\n\t\t\n\t\tvar strFkStatusLevel = oRS.GetValueAsString(\"fk_status_level\");\n\t\tif (strFkStatusLevel!=\"\")\n\t\t{\n\t\t\tboolFkStatusLevelSet = true;\n\t\t}\n\n\t\t\/\/-- item id to create\n\t\tvar createItem = oRS.GetValueAsString(\"ck_config_item\");\n\n\t\t\/\/-- get config_itemi_stage record\n\t\tvar oCopyRec = _swdoc.convertRStoRec(oRS);\n\n\t\t\/\/-- If type does not exist then skip record\n\t\tif(oCopyRec.import_newtype==\"Yes\")\n\t\t{\n\t\t\tif(strMissingType!=\"\") strMissingType += \"\\r\\n\";\n\t\t\tstrMissingType += oCopyRec.ck_config_type;\n\t\t\tintCountMissingTypes++;\n\t\t\tcontinue;\n\t\t}\n\t\t\n\t\t\/\/-- perform insert into config_itemi table (ck_config_item, ck_config_type\n\t\tvar strSkipFields = \"import_analystid|import_datex|import_newtype|import_status|import_action\";\n\t\t\/\/MessageBox(11)\n\t\tvar newCIid = app.g.copy_sw_record(\"config_itemi\",oCopyRec,strSkipFields,new Array());\n\t\t\/\/MessageBox(22)\n\t\tif(newCIid>0)\n\t\t{\n\t\t\t\/\/-- now create CMDB me relationships for site, company and SLA if set\n\t\t\t\/\/-- if customer has a site then relate it as a ci (so can see in vcm company -> site -> customer)\n\t\t\tvar boolCheckOrg = true;\n\n\t\t\tif(oCopyRec['fk_site'] != \"\")    \t\t\n\t\t\t{\n\t\t\t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultSiteCIRelationship\");\n\n\t\t\t\t\/\/if site is not already loaded, load site\n\t\t\t\tvar strSite = oCopyRec['fk_site'];\n\t\t\t\trecSite = false;\n\t\t\t\tif(_swdoc.arrSites[strSite]!=undefined)\n\t\t\t\t{\n\t\t\t\t\tvar recSite = _swdoc.arrSites[strSite];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get Site\", strSite, 1);\n\t\t\t\t\tvar recSite = app.g.get_record(\"site\", strSite);\n\t\t\t\t\t_swdoc.arrSites[strSite] = recSite;\n\t\t\t\t}\n\n\t\t\t\tif(recSite!=false)\n\t\t\t\t{\n\t\t\t\t\tapp.cmdb.generate_meconfigrelation(recSite.fk_cmdb_id,newCIid, strRel);\n\t\t\t\t\t\/\/ PM00131778 - Remove code that prevents the creation of Org relationship\n\t\t\t\t\t\/\/boolCheckOrg = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(boolCheckOrg)\n\t\t\t{\n\t\t\t\tif(oCopyRec['fk_company_id']!=\"\")\n\t\t\t\t{\n\t\t\t\t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgCIRelationship\");\n\n\t\t\t\t\tvar strOrg = oCopyRec['fk_company_id'];\n\t\t\t\t\trecOrg = false;\n\t\t\t\t\tif(_swdoc.arrOrgs[strOrg]!=undefined)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar recOrg = _swdoc.arrOrgs[strOrg];\/\/app.g.get_record(\"CONFIG_TYPEI\", );\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get Organisation\", strOrg, 1);\n\t\t\t\t\t\tvar recOrg = app.g.get_record(\"company\", strOrg);\n\t\t\t\t\t\t_swdoc.arrOrgs[strOrg] = recOrg;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(recOrg!=false)\n\t\t\t\t\t\tapp.cmdb.generate_meconfigrelation(recOrg.fk_cmdb_id,newCIid,strRel);  \n   \t\t\t\t}\n   \t\t\t}\n\t\t\n\t\t\tif(oCopyRec['fk_sld']>0)\n\t\t\t{\n\t\t\t\tvar strRel = \"Uses\";\n\n\t\t\t\tvar strSLA = oCopyRec['fk_sld'];\n\t\t\t\trecSLA = false;\n\t\t\t\tif(_swdoc.arrSLAs[strSLA]!=undefined)\n\t\t\t\t{\n\t\t\t\t\tvar recSLA = _swdoc.arrSLAs[strSLA];\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\t\t\t\t\t\n\t\t\t\t\tapp.global.LogInfo(\"Process Import\", \"Get SLA\", strSLA, 1);\n\t\t\t\t\tvar recSLA = app.g.get_record(\"itsmsp_slad\", strSLA);\n\t\t\t\t\t_swdoc.arrSLAs[strSLA] = recSLA;\n\t\t\t\t}\n\n\t\t\t\tif(recSLA!=false)\n\t\t\t\t\tapp.cmdb.generate_meconfigrelation(recSLA.fk_cmdb_id,newCIid,strRel); \n\t\t\t}\n\t\t\t\n\t\t\t\n\t\t\t\/\/-- now update new CI with values from staging table\n\t\t\t\/\/-- select fields from cmdb_stagefields\n\t\t\tvar strUpdateCI = \"\";\n\t\t\tvar strUpdateExt = \"\";\n\t\t\tvar strExtTable = \"\";\n\t\t\tvar strStageExtTable = \"\";\n\t\t\tvar arrCols = new Array();\n\n\t\t\tvar p={};\n\t\t\tp.stageditem = createItem;\n\t\t\tvar oRSFields = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_item_stagefields\",p);\t\t\t\n\t\t\twhile(oRSFields.Fetch())\n\t\t\t{\n\t\t\t\t\/\/--\n\t\t\t\tvar strNewValue = oRSFields.GetValueAsString(\"newvalue\");\n\t\t\t\tvar strColName  = oRSFields.GetValueAsString(\"targetcol\");\n\t\t\t\tvar strTableName  = oRSFields.GetValueAsString(\"targettable\");\n\t\t\t\tif(app.g.dd_isnumeric(strTableName, strColName))\n\t\t\t\t{\n\t\t\t\t\tif(strNewValue<0)\n\t\t\t\t\t\tstrNewValue = app.g.fix_epoch(strNewValue);\n\t\t\t\t}\n\t\t\t\tif(strTableName==\"config_itemi\")\n\t\t\t\t{\n\t\t\t\t\tif(strUpdateCI!=\"\")strUpdateCI+=\"&\";\n\t\t\t\t\tstrUpdateCI += \"_swc_\" + strColName + \"=\" + pfu(strNewValue);\n\t\t\t\t\tarrCols.push(strColName);\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tstrExtTable = strTableName;\n\t\t\t\t\tstrStageExtTable = strExtTable+\"_stage\";\n\t\t\t\t\tif(strUpdateExt!=\"\")strUpdateExt+=\"&\";\n\t\t\t\t\tstrUpdateExt += \"_swc_\" + strColName + \"=\" + pfu(strNewValue);\t\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\t\/\/-- ensure certain system defaults are set\n\t\t\tif(strUpdateCI!=\"\")strUpdateCI+=\"&\";\n\t\t\tstrUpdateCI += \"_swc_baselineid=\" + newCIid;\n\t\t\t\n\t\t\t\/\/-- If cmdb_status value is not provided set to 'Active'\n\t\t\tif (!boolCmdbStatusSet)\n\t\t\t{\n\t\t\t\tif(strUpdateCI!=\"\") strUpdateCI+=\"&\";\n\t\t\t\tstrUpdateCI += \"_swc_cmdb_status=Active\";\n\t\t\t}\n\t\t\t\/\/-- If fk_status_level value is not provided set to 'Operational'\n\t\t\tif (!boolFkStatusLevelSet)\n\t\t\t{\n\t\t\t\tif(strUpdateCI!=\"\")strUpdateCI+=\"&\";\n\t\t\t\tstrUpdateCI += \"_swc_fk_status_level=Operational\";\n\t\t\t}\t\t\n\t\t\t\n\t\t\tfor(var strKey in arrDefaultCIValues)\n\t\t\t{\n\t\t\t\tif(!in_array(arrCols,strKey))\n\t\t\t\t{\t\t\t\t\n\t\t\t\t\tif(strUpdateCI!=\"\")strUpdateCI+=\"&\";\n\t\t\t\t\tstrUpdateCI += \"_swc_\" + strKey + \"=\" + arrDefaultCIValues[strKey];\n\t\t\t\t}\t\n\t\t\t}\n\t\t\t\n\t\t\t\/\/-- config_itemi\n\t\t\tif(strUpdateCI!=\"\")\n\t\t\t{\n\t\t\t\tvar boolRes = app.g.submittableupdate(\"config_itemi\",newCIid,strUpdateCI)\t\t\n\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\/\/create the staging record\n\t\t\t\/\/-- check if has an extended table - if so check ext stage record values against main extended\n\t\t\tif (strExtTable!=\"\")\n\t\t\t{\n\t\t\t\tif (boolRes)\n\t\t\t\t{\n\t\t\t\t\t\/\/Add the values from the stagefields table\n\t\t\t\t\tif(strUpdateExt!=\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/-- extended table record is created in OnRecordAdded VPME for config_itemi so just need to  \n\t\t\t\t\t\t\/\/-- Add the values from the stagefields table \n\t\t\t\t\t\tvar boolRes = app.g.submittableupdate(strExtTable,newCIid,strUpdateExt)\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tMessageBox(\"Failed to complete creating staging record (\" + createItem + \"). Please contact your Supportworks Administrator.\");\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/-- successfully created - so mark as processed\n\t\t\t_swdoc.mark_record_processed(createItem,false,strStageExtTable);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tMessageBox(\"Failed to create staging record (\" + createItem + \"). Please contact your Supportworks Administrator.\");\n\t\t\t_swdoc.mark_record_processed(createItem,true,\"\");\t\n\t\t\treturn false;\n\t\t}\n\n\t}\n\t\n\tif(intCountMissingTypes>0)\n\t\tMessageBox(intCountMissingTypes+\" items have been skipped as their specified configuration type does not exist.\\r\\nThe following missing configuration types were identified:\\r\\n\\r\\n\"+strMissingType+\"\\r\\n\\r\\nPlease create any appropriate types and re-process\");\n\t\n\treturn true;\n}\n\n\n\/\/-- marks a single staging record as processed\nfunction mark_record_processed(strItemID,boolFailed,strStageExtTable)\n{\n\tif((_swdoc.MF().flg_delete.text==\"1\")&&(!boolFailed))\n\t{\n\t\t\/\/-- add keys to be deleted from cmdb_stage table\n\t\tif(_swdoc.arrDeleteRecords['cmdb_stage']!=undefined)\n\t\t{\n\t\t\t_swdoc.arrDeleteRecords['cmdb_stage'] = _swdoc.arrDeleteRecords['cmdb_stage']+\",\" + strItemID;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_swdoc.arrDeleteRecords['cmdb_stage'] = strItemID;\n\t\t}\n\n\t\t\/\/-- add keys to be deleted from cmdb_stagefields table\n\t\tif(_swdoc.arrDeleteRecords['cmdb_stagefields']!=undefined)\n\t\t{\n\t\t\t_swdoc.arrDeleteRecords['cmdb_stagefields'] = _swdoc.arrDeleteRecords['cmdb_stagefields']+\",\" + strItemID;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_swdoc.arrDeleteRecords['cmdb_stagefields'] = strItemID;\n\t\t}\n\n\t\t\/\/-- add keys to be deleted from extended table\n\t\tif(strStageExtTable!=\"\")\n\t\t{\n\t\t\tif(_swdoc.arrDeleteRecords[strStageExtTable]!=undefined)\n\t\t\t{\n\t\t\t\t_swdoc.arrDeleteRecords[strStageExtTable] = _swdoc.arrDeleteRecords[strStageExtTable]+\",\" + strItemID;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.arrDeleteRecords[strStageExtTable] = strItemID;\n\t\t\t}\n\t\t}\n\t}\n\telse\n\t{\n\t\tvar strKey= (boolFailed)?\"Failed\":\"Completed\";\n\t\tif(_swdoc.arrUpdateProcess[strKey]!=undefined)\n\t\t{\n\t\t\t_swdoc.arrUpdateProcess[strKey] = _swdoc.arrUpdateProcess[strKey]+\",\" + strItemID;\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_swdoc.arrUpdateProcess[strKey] = strItemID;\n\t\t}\n\t}\n}\n\n\n\/\/--\n\/\/-- Decline records\nfunction decline_records(boolDeclineAll)\n{\n\tif(boolDeclineAll)\n\t{\n\t\t\/\/-- declining all those in list\n\t\tvar strTitleItemIDs = app.g.sqllist_get_valuesdel(_swdoc.currentList, \"ck_config_item\", \",\", \"\");\n\t\tvar strURL = \"declineditems=\" +  strTitleItemIDs;\n\t\tvar strDeclineItemIDs = app.g.sqllist_get_valuesdel(_swdoc.currentList, \"ck_config_item\", \"©\", \"\");\n\t\t\n\t\t\/\/-- popup decline form to get reject reason\n\t\tapp.OpenFormForAdd(\"cmdb_decline\", \"\", strURL, true, function(aForm){\n\t\t\tif((aForm)&&(aForm.document.strReason!=\"\")&&(aForm.document.boolApplied)){\n\t\t\t\t\/\/-- loop through each and prompt for reason\n\t\t\t\tvar arrItems = strDeclineItemIDs.split(\"©\");\n\t\t\t\tfor (var x=0;x < arrItems.length;x++)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.decline_item(arrItems[x],aForm.document.strReason);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(aForm.document.boolApplied)\t\n\t\t\t\t\tMessageBox(\"The list items were not declined as you did not provide a reason for rejecting them\");\n\t\t\t}\n\t\t});\n\t}\n\telse\n\t{\n\t\t\/\/-- declining all those in list\n\t\tvar strTitleItemIDs = app.g.sl_getselected_valuesdel(_swdoc.currentList,\"ck_config_item\",\",\",\"\");\t\t\n\t\tvar strURL = \"declineditems=\" +  strTitleItemIDs;\n\t\tvar strDeclineItemIDs = app.g.sl_getselected_valuesdel(_swdoc.currentList,\"ck_config_item\",\"©\",\"\");\t\t\n\t\t\n\t\t\/\/-- popup decline form to get reject reason\n\t\tapp.OpenFormForAdd(\"cmdb_decline\", \"\", strURL, true, function(aForm){\n\t\t\tif((aForm)&&(aForm.document.strReason!=\"\")&&(aForm.document.boolApplied)){\n\t\t\t\t\/\/-- loop through each and prompt for reason\n\t\t\t\tvar arrItems = strDeclineItemIDs.split(\"©\");\n\t\t\t\tfor (var x=0;x < arrItems.length;x++)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.decline_item(arrItems[x],aForm.document.strReason);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif (aForm.document.boolApplied)\t\n\t\t\t\t   MessageBox(\"The list items were not declined as you did not provide a reason for rejecting them\");\n\t\t\t}\n\t\t});\n\t}\n}\n\n\/\/--\n\/\/-- decline item - create record in ci_declined and removes it from the staging table\nfunction decline_item(strItemID,strReason)\n{\n\t\/\/-- get row pos then get other value\n\tvar intRow = app.g.sl_findrow_byvalue(_swdoc.currentList,strItemID,\"ck_config_item\");\n\tif(intRow>-1)\n\t{\n\t\tvar strType = _swdoc.currentList.GetItemText(intRow, \"ck_config_type\");\n\t\tvar strAction = _swdoc.currentList.GetItemText(intRow, \"import_action\");\n\t\tvar intDate = app.global.GetCurrentEpocTime();\n\t\t\n\t\tvar oType  = app.g.get_record(\"config_typei\", strType);\n\t\t\/\/-- create decline record\n\t\tvar p = {};\n\t\tp.ck_config_item = strItemID;\n\t\tp.ck_config_type = strType;\n\t\tp.import_action = strAction;\n\t\tp.datetimex\t= intDate;\n\t\tp.rejectdesc = strReason;\t\t\n\t\tif(app.g.submittableinsert(\"ci_declined\",p))\t\n\t\t{\n\t\t\tvar strExtTable = oType.extended_table;\n\t\t\tif(strExtTable)\n\t\t\t{\n\t\t\t\t\/\/-- 87558\n\t\t\t\tapp.g.delete_tablebycol(oType.extended_table+\"_stage\",\"ck_config_item\",strItemID);\n\t\t\t}\n\t\t\t\/\/--F0104885\n\t\t\t\/\/-- delete staging record\n\t\t\treturn app.g.sl_deldbrow(_swdoc.currentList,intRow,'ck_config_item',null,\"\")\n\t\t}\n\t}\n\treturn false\n}\n\nfunction isSystemField(colName)\n{\n\tswitch(colName)\n\t{\n\t\tcase \"baselineid\":\n\t\tcase \"cmdb_status\":\n\t\tcase \"flg_inherit_reqtypes\":\n\t\tcase \"import_action\":\n\t\tcase \"import_analystid\":\n\t\tcase \"import_datex\":\n\t\tcase \"import_newtype\":\n\t\tcase \"import_status\":\t\t\n\t\t\treturn true;\n\t\t\tbreak;\n\t}\n\treturn false;\n}\n\n\nfunction convertRStoRec(oRS)\n{\n\tvar intCols = oRS.GetColumnCount();\n\n\toRec = new Object();\n\tfor (x=0; x < intCols;x++)\n\t{\n\t\tvar colName = oRS.GetColumnName(x);\n\t\tvar colValue = app.g.get_field(oRS,x);\n\t\toRec[LC(colName)] = colValue;\n\t}\n\treturn oRec;\n}"},{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strClass)\n{\n\t\/\/-- is the user allowed to manage staging records\n\treturn app.cmdb.can_managestage(true);\n\n\n\t\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"590","height":"566","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"43","left":"123","right":"287","bottom":"61"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.ck_config_item"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lb_types","type":"Field","group":"TabSearch:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"60","left":"123","right":"287","bottom":"78"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.ck_config_type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","distinctTable":"config_itemi_stage","distinctColumn":"ck_config_type"}}},{"general":{"name":"lb_profile","type":"Field","group":"TabSearch:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"77","left":"123","right":"287","bottom":"95"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_profilecode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Click here to select profile","content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","distinctTable":"pcdesc","distinctColumn":"code","displayColumn":"info"}}},{"general":{"name":"lb_status","type":"Field","group":"TabSearch:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"94","left":"123","right":"287","bottom":"112"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_status_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","distinctTable":"ct_statusl","distinctColumn":"status_level"}}},{"general":{"name":"lb_cmdbstatus","type":"Field","group":"TabSearch:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"111","left":"123","right":"287","bottom":"129"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.cmdb_status"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","distinctTable":"ct_statusl","distinctColumn":"status_level","listItems":"Active|Faulty|Impacted|Unavailable|Deactivated|"}}},{"general":{"name":"lb_impact","type":"Field","group":"TabSearch:0"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"128","left":"123","right":"287","bottom":"146"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","distinctTable":"ct_priorityl","distinctColumn":"ck_priority_level"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"145","left":"123","right":"287","bottom":"163"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_urgency_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"162","left":"123","right":"287","bottom":"180"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_sla"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"179","left":"123","right":"287","bottom":"197"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_cost_center"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"43","left":"398","right":"566","bottom":"61"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_userdb"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"60","left":"398","right":"566","bottom":"78"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.owner_name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"77","left":"398","right":"566","bottom":"95"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_site"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"94","left":"398","right":"566","bottom":"112"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_supplier"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"111","left":"398","right":"566","bottom":"129"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.fk_manufacturer"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lb_authorised","type":"Field","group":"TabSearch:0"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"128","left":"398","right":"566","bottom":"146"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.isauthorised"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Yes","content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","listItems":"Yes|No|"}}},{"general":{"name":"lb_action","type":"Field","group":"TabSearch:0"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"162","left":"398","right":"566","bottom":"180"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.import_action"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Yes","content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","listItems":"Create|Update|No Changes|"}}},{"general":{"name":"lb_import_status","type":"Field","group":"TabSearch:0"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"179","left":"398","right":"566","bottom":"197"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.import_status"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Awaiting","content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","listItems":"Awaiting|Processed|Failed|"}}},{"general":{"name":"lb_ntype","type":"Field","group":"TabSearch:0"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"196","left":"398","right":"566","bottom":"214"},"scaling":{"top":"0","left":"70","right":"100","bottom":"0"}},"data":{"binding":"cmdb_stage.import_newtype"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","listItems":"No|Yes|"}}},{"general":{"name":"TabSearch","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"18","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"9","left":"9","right":"579","bottom":"558"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Search Criteria","properties":"56=#f2f2f2|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f2f2f2","inactiveTextColor":"#5f5f5f"}}},{"name":"History","properties":"56=#f2f2f2|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f2f2f2"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"btn_search","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"19","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"261","left":"505","right":"570","bottom":"285"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_clear","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"20","caption":"Reset","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"288","left":"505","right":"570","bottom":"312"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"lb_type","type":"Field","group":"TabSearch:0"},"appearance":{"index":"21","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"291","left":"330","right":"496","bottom":"309"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","listItems":"Any of the above match^0|All of the above match^1|","disabledBackgroundColor":"#eeeeee","defaultValue":"1"}}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"22","caption":"Search Mode :","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"291","left":"246","right":"327","bottom":"309"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"TabRes","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"23","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#eaeaea","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"304","left":"14","right":"573","bottom":"541"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Search Results","properties":"56=#eaeaea|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#eaeaea","inactiveTextColor":"#5f5f5f"}}},{"name":"Result Selection","properties":"56=#eaeaea|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#eaeaea","inactiveTextColor":"#5f5f5f"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"btn_subset","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"24","caption":"Add to Selection","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"233","left":"19","right":"113","bottom":"257"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_process_all","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:0"},"appearance":{"index":"25","caption":"Import This Page","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"402","right":"493","bottom":"532"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_cancel","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:0"},"appearance":{"index":"26","caption":"Close","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"498","right":"563","bottom":"532"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_remsub","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:1"},"appearance":{"index":"27","caption":"Remove Selected","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"21","right":"115","bottom":"532"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_subclear","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:1"},"appearance":{"index":"28","caption":"Remove All","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"120","right":"212","bottom":"532"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"rs1","type":"Rectange","group":"TabSearch:0"},"appearance":{"index":"29","backgroundColor":"#f2f2f2","foregroundColor":"#b2b2b2","font":{"@size":"0"},"borderStyle":"3-D Sunken","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"42","left":"17","right":"289","bottom":"221"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"rs1","type":"Rectange","group":"TabSearch:0"},"appearance":{"index":"30","backgroundColor":"#f2f2f2","foregroundColor":"#f2f2f2","font":{"@size":"0"},"borderStyle":"3-D Sunken","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"42","left":"296","right":"568","bottom":"221"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"31","caption":"Configuration ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"43","left":"18","right":"124","bottom":"61"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.ck_config_item"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"32","caption":"Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"60","left":"18","right":"124","bottom":"78"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.ck_config_type"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"33","caption":"Contact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"43","left":"297","right":"399","bottom":"61"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"config_itemi.fk_userdb"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"34","caption":"Owner Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"60","left":"297","right":"399","bottom":"78"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"config_itemi.owner_name"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Line1","type":"Line","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"35","caption":"Line 1","backgroundColor":"#ffffff","foregroundColor":"#808080","font":{"@size":"0"}},"objectPlacement":{"position":{"top":"223","left":"16","right":"567","bottom":"231"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"36","caption":"Status","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"94","left":"18","right":"124","bottom":"112"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.fk_status_level"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"37","caption":"Urgency","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"145","left":"18","right":"124","bottom":"163"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.fk_urgency_level"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"38","caption":"Impact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"128","left":"18","right":"124","bottom":"146"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.fk_impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"39","caption":"Priority","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"162","left":"18","right":"124","bottom":"180"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.fk_sla"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"40","caption":"Is authorised?","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"128","left":"297","right":"399","bottom":"146"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"config_itemi.isauthorised"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"41","caption":"Import Action","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"162","left":"297","right":"399","bottom":"180"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"cmdb_stage.import_action"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"42","caption":"Category","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"77","left":"18","right":"124","bottom":"95"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.fk_profilecode"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"43","caption":"Site","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"77","left":"297","right":"399","bottom":"95"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"config_itemi.fk_site"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"44","caption":"Supplier","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"94","left":"297","right":"399","bottom":"112"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"config_itemi.fk_supplier"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"45","caption":"Manufacturer","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"111","left":"297","right":"399","bottom":"129"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"config_itemi.fk_manufacturer"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"46","caption":"New type needed?","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"196","left":"297","right":"399","bottom":"214"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"cmdb_stage.import_newtype"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"47","caption":"Import Status","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"179","left":"297","right":"399","bottom":"197"},"scaling":{"top":"0","left":"50","right":"70","bottom":"0"}},"data":{"binding":"cmdb_stage.import_status"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"48","caption":"CMDB Status","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"111","left":"18","right":"124","bottom":"129"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.cmdb_status"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"49","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"179","left":"18","right":"124","bottom":"197"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.fk_cost_center"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"btn_process","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:0"},"appearance":{"index":"50","caption":"Import Selected Items","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"282","right":"397","bottom":"532"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"flg_delete","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"51","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"260","left":"16","right":"272","bottom":"278"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","scale":"#eeeeee","flagItems":"Delete staging records after import to CMDB^1|","defaultValue":"0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_awatingonly","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"52","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"280","left":"16","right":"236","bottom":"298"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","scale":"#eeeeee","flagItems":"Import \"Awaiting\" records only^1|","defaultValue":"1","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"sl_sub","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRes:1"},"appearance":{"index":"53","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"335","left":"23","right":"563","bottom":"501"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"import_action"},"name":"Import Action","width":"89","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"import_status"},"name":"Import Status","width":"108","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"import_newtype"},"name":"New Type Needed?","width":"116","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration Item ID","width":"133","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"165","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"129","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"274","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"156","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_priority_level"},"name":"Priority Level","width":"127","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"156","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Service Level","width":"166","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"186","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"138","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"161","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"130","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"129","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"117","image":"-1","dataColumn":"16"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_group"},"name":"Support Group","width":"113","image":"-1","dataColumn":"17"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_analyst"},"name":"Support Analyst","width":"119","image":"-1","dataColumn":"18"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"cmdb_stage","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"_kv=-1","sqlSource":"swdata","storedQuery":"common.searchtable.resultSelection"}}},{"general":{"name":"btn_delete","type":"EventButton","group":"TabSearch:0"},"appearance":{"index":"54","caption":"Delete \"Completed\" Records","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"261","left":"330","right":"496","bottom":"284"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_determine","type":"EventButton","group":"TabSearch:0"},"appearance":{"index":"55","caption":"Determine Import Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"233","left":"330","right":"494","bottom":"257"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_mng_items","type":"EventButton","group":"TabSearch:0"},"appearance":{"index":"56","caption":"Manage CMDB Items","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"233","left":"116","right":"240","bottom":"257"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"mb_decline","type":"MenuButton","group":"TabRes:0"},"appearance":{"index":"57","caption":"Decline","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"210","right":"276","bottom":"532"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900","commands":"Selected Items^1|All Listed Items^2|"}}},{"general":{"name":"sl_results","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRes:0"},"appearance":{"index":"58","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"335","left":"23","right":"563","bottom":"501"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"import_action"},"name":"Import Action","width":"89","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"import_status"},"name":"Import Status","width":"108","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"import_newtype"},"name":"New Type Needed?","width":"116","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration Item ID","width":"133","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"165","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"129","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"274","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"156","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_priority_level"},"name":"Priority Level","width":"127","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"156","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Service Level","width":"166","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"186","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"138","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"161","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"130","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"129","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"117","image":"-1","dataColumn":"16"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_group"},"name":"Support Group","width":"113","image":"-1","dataColumn":"17"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_analyst"},"name":"Support Analyst","width":"119","image":"-1","dataColumn":"18"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"cmdb_stage","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"empty=1","sqlSource":"swdata","storedQuery":"entity.cis.paged"}}},{"general":{"name":"sl_history","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"TabSearch:1"},"appearance":{"index":"59","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"60","left":"23","right":"563","bottom":"537"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_id"},"name":"Process ID","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"exe_startx"},"name":"Start Date","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"record_proc"},"name":"Records Processed","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"per_complete"},"name":"Progress (%)","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"exe_endx"},"name":"End Date","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"result"},"name":"Result","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"analyst"},"name":"Analyst","width":"120","image":"-1","dataColumn":"7"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"cmdb_stage_audit","storedQuery":"common.load_by_colvalues"}}},{"general":{"name":"Refresh","type":"EventButton","group":"TabSearch:1"},"appearance":{"index":"60","caption":"Refresh List","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"34","left":"503","right":"575","bottom":"55"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"39423"}}},{"general":{"name":"status","type":"Field","group":"TabSearch:1"},"appearance":{"index":"61","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"101","right":"211","bottom":"54"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"complete","type":"Field","group":"TabSearch:1"},"appearance":{"index":"62","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"330","right":"446","bottom":"54"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:1"},"appearance":{"index":"63","caption":"Current Status","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"36","left":"22","right":"96","bottom":"55"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:1"},"appearance":{"index":"64","caption":"Percentage Complete","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"36","left":"220","right":"324","bottom":"55"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_prev","type":"EventButton","group":"TabRes:0"},"appearance":{"index":"65","caption":"Previous","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"70","right":"135","bottom":"532"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_next","type":"EventButton","group":"TabRes:0"},"appearance":{"index":"66","caption":"Next","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"508","left":"140","right":"205","bottom":"532"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}}]},"javascript":{"methods":{"method":[{"name":"btn_search_OnPressed","code":"btn_search_OnPressed()\n{\n\t\/\/-- 19.01.2006 - NWJ\n\t\/\/-- create search criteria\n\t_etab(TabRes, 0);\n\t_een(btn_process, false);\n\t_een(btn_process_all, false);\n\t\n\t_swdoc.strFilter = \"\"; \n\tvar intPageNo = 1;\n\t_swdoc.intPageNo = 1;\n\t\t\n\tapp.g.sqllist_clear(sl_results);\n\n\tvar boolAND = (lb_type.value==1);\n\tvar strFilter = app.g.create_search_params(mainform,\"cmdb_stage\",\"\",boolAND,false);\n\t\n\t_swdoc.strFilter = strFilter;\n\t\n\t\n\t\/\/-- Add Paging\n\tstrFilter += \"&paged=true&start=\"+intPageNo+\"&end=&webclient=\"+_swdoc.webclient+\"\";\n\t\n\t\/\/-- apply filter\n\tapp.g.sl_filter(sl_results,strFilter,null,0)\n\t_swdoc.MF().sl_results.Refresh();\n\t\n\t\/\/Show Next Button\n\tif(sl_results.rowCount() < _swdoc.intCIsPerPage)\n\t{\n\t\t_een(_swdoc.MF().btn_next,false);\t\n\t}else\n\t{\n\t\t_een(_swdoc.MF().btn_next,true);\t\n\t}\n\t_een(_swdoc.MF().btn_prev,false);\n\tsl_results_OnItemSelected(0);\t\n\n}"},{"name":"btn_clear_OnPressed","code":"btn_clear_OnPressed()\n{\n\t\/\/-- clear search fields\n\t\/\/app.g.clear_form_fields(\"config_item\",mainform,\"\",false);lb_active.text=\"1\";\n\t_swdoc.reset_form_fields();\n\t\t\n\t\/\/-- apply filter\n\tapp.g.sl_filter(sl_results,\"empty=1\",null,0)\n\t_swdoc.MF().sl_results.Refresh();\n\t\n\t_een(_swdoc.MF().btn_next,false);\n\t_een(_swdoc.MF().btn_prev,false);\n\t\n}"},{"name":"sl_cis_OnHeaderItemClicked","code":"sl_cis_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_results.Refresh();\n\tsl_results.SetRowSelected(0);\n}"},{"name":"sl_cis_OnItemSelected","code":"sl_cis_OnItemSelected(nRow)\n{\n\t\/\/--\n\t\/\/-- enable the select button\n\t_een(btn_select , (sl_results.rowCount()>0));\n\t_een(btn_subset,(sl_results.rowCount()>0));\t\n\n}"},{"name":"btn_subclear_OnPressed","code":"btn_subclear_OnPressed()\n{\n\tvar strFilter = \"_kv=-1\";\n\tapp.g.sl_filter(sl_sub,strFilter,null,0);\n\tsl_sub_OnItemSelected(0);\n\t\n}"},{"name":"btn_remsub_OnPressed","code":"btn_remsub_OnPressed()\n{\n\tapp.g.sl_clearselected(sl_sub,null,0);\n\n\t\/\/-- reset filter\n\tvar strSubCalls = app.g.sl_get_valuesdel(sl_sub,\"ck_config_item\",\",\",\"\");\n\tif(strSubCalls==\"\")strSubCalls=\"-1\";\n\t\n\tvar strFilter = \"_kv=\" + strSubCalls;\n\tapp.g.sl_filter(sl_sub,strFilter,null,0);\n\tsl_sub_OnItemSelected(0);\t\n\t\n\t\n}"},{"name":"sl_sub_OnHeaderItemClicked","code":"sl_sub_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_sub.Refresh();\n\n\n}"},{"name":"sl_sub_OnItemSelected","code":"sl_sub_OnItemSelected(nRow)\n{\n\t\/\/--\n\t\/\/-- enable the select button\n\t_een(btn_process, (sl_results.rowCount()>0));\n\t_een(btn_process_all, (sl_results.rowCount()>0));\t\n\t_een(btn_remsub, (sl_sub.rowCount()>0));\n\t_een(btn_subclear, (sl_sub.rowCount()>0));\t\n\t_een(mb_decline, (sl_sub.rowCount()>0));\n}"},{"name":"btn_subset_OnPressed","code":"btn_subset_OnPressed()\n{\n\t\/\/-- add selected items to the subset list\n\tvar strSelKeys = app.g.sl_getselected_valuesdel(sl_results\t,\"ck_config_item\",\",\",\"\");\n\tvar strSubKeys = app.g.sl_get_valuesdel(sl_sub,\"ck_config_item\",\",\",\"\");\n\t\n\t\/\/-- if we already have sub items\n\tif(strSubKeys!=\"\")\n\t{\n\t\tstrSelKeys += \",\" + strSubKeys;\n\t}\n\t\n\tvar strFilter = \"_kv=\" + strSelKeys;\n\tapp.g.sl_filter(sl_sub,strFilter,null,0);\n\t\n\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- set field states\n\t_een(btn_process, false);\n\t_een(btn_process_all, false);\t\n\t_een(btn_subset, false);\n\t_een(btn_remsub, false);\n\t_een(btn_subclear, false);\n\t\n\t_swdoc.currentList = sl_results\n\t\n\tmainform.SetTimer(1, 5);\n\t\n\t\/\/--TK Start Process to Check if DIA or Import is Running\n\t_swdoc.history_refresh();\n\n\t\n}"},{"name":"sl_sub_OnItemDoubleClicked","code":"sl_sub_OnItemDoubleClicked(nRow, nCol)\n{\n\n\tvar strAction = sl_sub.GetItemTextRaw(nRow, 'import_action');\n\tif(strAction.indexOf(\"Update\")==0)\n\t{\n\t\tvar strItem = sl_sub.GetItemTextRaw(nRow, 'ck_config_item');\n\t\tvar strArgs = \"config_item=\" + pfu(strItem);\n\t\tapp.OpenForm(\"browse_cmdb_stagefields\", strArgs, true);\n\t}\n\treturn false;\n}"},{"name":"OnTimer","code":"OnTimer(nTimer)\n{\n\tmainform.KillTimer(nTimer);\n\t\n\tif(nTimer==1)_swdoc.reset_form_fields();\n\n\/*\n\tif(nTimer==2)\n\t{\n\t\t\/\/-- TK Refresh History List Every 30 Seconds\n\t\t_swdoc.MF().sl_history.Refresh();\n\t\tmainform.SetTimer(2, 30000);\n\t\t_swdoc.history_refresh();\n\t}\n\t*\/\n\t\n}"},{"name":"TabRes_OnTabSelected","code":"TabRes_OnTabSelected(nTab)\n{\n\tif(nTab==0)\n\t{\n\t\t_swdoc.currentList = sl_results;\t\n\t}\n\telse if (nTab==1)\n\t{\n\t\t_swdoc.currentList = sl_sub;\n\t\tsl_sub.Refresh();\n\t}\n\t\t\n}"},{"name":"lb_profile_OnLeftClick","code":"lb_profile_OnLeftClick()\n{\n\t\/\/--\n\tapp.g.pick_problemprofile(\"\",\"\", function(strCode){\n\t\tif(strCode){\n\t\t\t_ete(lb_profile, strCode);\n\t\t}\n\t});\n\t\n\treturn false;\n}"},{"name":"lb_profile_OnRightClick","code":"lb_profile_OnRightClick()\n{\n\t_ete(lb_profile, \"\");\n}"},{"name":"btn_process_all_sel_OnPressed","code":"btn_process_all_sel_OnPressed()\n{\n\t\/\/-- NWJ - go through list and process items according to action\n\t\n\t_swdoc.CloseForm();\t\n}"},{"name":"btn_delete_OnPressed","code":"btn_delete_OnPressed()\n{\n\n\n\t\/\/-- NWJ : Delete records that have been marked as processed\n\tvar arrParams = new Array();\n\tarrParams[\"import_status\"]=\"Completed\";\n\tvar oRS = app.g.get_tablerecordset_bycol(\"cmdb_stage\",arrParams,false, \"ck_config_item\");\n\tvar strConfigItemIDs = \"\"\n\twhile(oRS.Fetch())\n\t{\n\t\tif(strConfigItemIDs!=\"\")strConfigItemIDs+=\",\";\n\t\tstrConfigItemIDs += app.g.get_field(oRS,\"ck_config_item\");\n\t}\n\t\n\tif(strConfigItemIDs!=\"\")\n\t{\n\t\tvar p = {};\n\t\tp.cis = strConfigItemIDs;\n\t\tapp.g.submitsimplesql(\"cmdb_stage.btn_delete.delete_stage\", p);\n\n\t\tvar p = {};\n\t\tp.cis = strConfigItemIDs;\n\t\tp.sf= \"cmdb_stage.btn_delete.get_exttables\";\n\t\tvar oRS = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_exttables\", p);\n\t\tvar strID = \"\";\n\t\twhile(oRS.Fetch())\n\t\t{\n\t\t\t\n\t\t\tvar strTable = app.g.get_field(oRS, \"strtable\");\n\t\t\t\n\t\t\tif(strTable ==\"\") var strTables = app.g.get_field(oRS, \"strtable\");\n\t\t\tif(strTable !=\"\") strTables += \",\"+app.g.get_field(oRS, \"strtable\");\n\t\t\n\t\t}\n\t\tarrTables = strTables.split(',');\n\t\tfor (var i=0;i<arrTables.length;i++)\n\t\t{\n\t\t\tif(arrTables[i] != \"undefined\" & arrTables[i] != \"\")\n\t\t\t{\n\t\t\t\tvar strTableDel = arrTables[i];\n\t\t\t\tstrTableDel = strTableDel+\"_stage\";\n\t\t\t\tvar strPK = dd.tables[LC(strTableDel)].PrimaryKey;\n\t\t\t\tif(!strPK) strPK = \"ck_config_item\";\n\t\t\t\t\/\/-- TK Delete feilds from Extendted Tables\n\t\t\t\tvar arrParams2 = new Array();\n\t\t\t\tarrParams2[strPK]=strConfigItemIDs;\n\t\n\t\t\t\tvar oRS = app.g.get_tablerecordset_bycol(strTableDel,arrParams2,false);\n\t\t\t\twhile(oRS.Fetch())\n\t\t\t\t{\n\t\t\t\t\tvar p = {};\n\t\t\t\t\tp.cis = strConfigItemIDs;\n\t\t\t\t\tp.tbl = app.g.get_field(oRS,\"strtable\");\n\t\t\t\t\tapp.g.submitsimplesql(\"cmdb_stage.btn_delete.delete_extstage\", p);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\n\t\t\/\/-- delete processed fields\n\t\tvar p = {};\n\t\tp.cis = strConfigItemIDs;\n\t\tapp.g.submitsimplesql(\"cmdb_stage.btn_delete.delete_stagefields\", p);\n\t\t\n\t\t\/\/Refresh the search results\n\t\tmainform.btn_search_OnPressed();\n\t}\n}"},{"name":"btn_determine_OnPressed","code":"btn_determine_OnPressed()\n{\n\t\/\/Storaging the id, endx, status of the las row of the table cmdb_stage\n\tvar oRS = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/get_stage_process\");\n\tvar boolRow = false;\n\twhile(oRS.Fetch())\n\t{\n\t\tboolRow = true;\n\t\tvar strID = app.g.get_field(oRS, \"pk_id\");\n\t\tvar strEnd = app.g.get_field(oRS, \"exe_endx\");\n\t\tvar strStatus = app.g.get_field(oRS, \"status\");\n\t}\n\t\n\t\/\/If the status of the last row is complete we can start a new process\n\tif (strStatus==\"Complete\" || !boolRow){\t\n\t\tvar params = {};\n\t\t\/\/--Set Analayst ID\n\t\tparams.analystid = app.session.analystId;\n\t\t\/\/--Stored Query\n\t\tvar oRS = app.g.get_sqrecordset(\"cmdb\/process\/stagedimport\/create_stage_process\", params);\n\t\tMessageBox(\"Please check in History tab to verify the process has finished.\");\n\t}\n\t\/\/Other case we should wait until finishing\n\telse\n\t\t{\n\t\tMessageBox(\"There is currently a process running.\");\n\t\treturn false;\n\t\t}\n\n}"},{"name":"btn_process_all_OnPressed","code":"btn_process_all_OnPressed()\n{\n\t\/\/--\n\t\/\/-- NWJ - loop through records and process accordingly.\n\t\/\/-- we will either be adding, updating (with baseline) or de-activating\n\n\t_swdoc.process_staging_records(false);\n\n\tbtn_search_OnPressed();\n\n\t\/\/-- add selected items to the subset list\n\tvar strSubKeys = app.g.sl_get_valuesdel(sl_sub,\"ck_config_item\",\",\",\"\");\n\tsl_sub.Refresh();\n\tif(strSubKeys!=\"\")\n\t{\n\t\tvar strFilter = \"_kv=\" + strSubKeys;\t\n\t\tapp.g.sl_filter(sl_sub,strFilter,null,0);\n\t} \n\t\/\/-- Reset after Import\n\t_swdoc.intPageNo = 1;\n\tstrFilter += \"&paged=true&start=\"+_swdoc.intPageNo+\"&end=&webclient=\"+_swdoc.webclient+\"\";\n\t\n\t\/\/-- apply filter\n\tapp.g.sl_filter(sl_results,strFilter,null,0)\n\t_swdoc.MF().sl_results.Refresh();\t\n\t\n\tif(sl_results.rowCount() < _swdoc.intCIsPerPage)\n\t{\n\t\t_een(_swdoc.MF().btn_next,false);\t\n\t}\t\n\t_een(_swdoc.MF().btn_prev,false);\n}"},{"name":"btn_process_OnPressed","code":"btn_process_OnPressed()\n{\n\t_swdoc.process_staging_records(true);\n\tbtn_search_OnPressed();\n\t\n\t\n\t\/\/-- add selected items to the subset list\n\tvar strSubKeys = app.g.sl_get_valuesdel(sl_sub,\"ck_config_item\",\",\",\"\");\n\t\n\tsl_sub.Refresh();\n\tif(strSubKeys!=\"\")\n\t{\n\t\tvar strFilter = \"_kv=\" + strSubKeys;\t\n\t\tapp.g.sl_filter(sl_sub,strFilter,null,0);\n\t}\n\t\/\/-- Reset after Import\n\t_swdoc.intPageNo = 1;\n\tstrFilter += \"&paged=true&start=\"+_swdoc.intPageNo+\"&end=&webclient=\"+_swdoc.webclient+\"\";\n\t\n\t\/\/-- apply filter\n\tapp.g.sl_filter(sl_results,strFilter,null,0)\n\t_swdoc.MF().sl_results.Refresh();\n\t\t\n\tif(sl_results.rowCount() < _swdoc.intCIsPerPage)\n\t{\n\t\t_een(_swdoc.MF().btn_next,false);\t\n\t}\n\t_een(_swdoc.MF().btn_prev,false);\n\t\t\n}"},{"name":"btn_mng_items_OnPressed","code":"btn_mng_items_OnPressed()\n{\n\t\/\/--\n\t_swdoc.CloseForm();\n\tapp.OpenFormForEdit(\"manage_cmdb_items\", \"\", \"\", false, function(){});\n}"},{"name":"mb_decline_OnMenuItem","code":"mb_decline_OnMenuItem(strName, nItemID)\n{\n\tvar boolDeclineAll = (nItemID==2);\n\t_swdoc.decline_records(boolDeclineAll);\n\n}"},{"name":"sl_sub1_OnHeaderItemClicked","code":"sl_sub1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_sub1.Refresh();\n\n\n}"},{"name":"sl_sub1_OnItemSelected","code":"sl_sub1_OnItemSelected(nRow)\n{\n\t\/\/--\n\t\/\/-- enable the select button\n\t_een(btn_process , (sl_results.rowCount()>0));\n\t_een(btn_process_all , (sl_results.rowCount()>0));\t\n\t_een(btn_remsub , (sl_sub1.rowCount()>0));\n\t_een(btn_subclear , (sl_sub1.rowCount()>0));\t\n\n}"},{"name":"sl_sub1_OnItemDoubleClicked","code":"sl_sub1_OnItemDoubleClicked(nRow, nCol)\n{\n\n\tvar strAction = sl_sub1.GetItemTextRaw(nRow, 'import_action');\n\tif(strAction.indexOf(\"Update\")==0)\n\t{\n\t\tvar strItem = sl_sub1.GetItemTextRaw(nRow, 'ck_config_item');\n\t\tvar strArgs = \"config_item=\" + pfu(strItem);\n\t\tapp.OpenForm(\"browse_cmdb_stagefields\", strArgs, true);\n\t}\n\treturn false;\n}"},{"name":"sl_results_OnHeaderItemClicked","code":"sl_results_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.sl_refresh(sl_results,null,0);\n\n}"},{"name":"sl_results_OnItemDoubleClicked","code":"sl_results_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strAction = sl_results.GetItemTextRaw(nRow, 'import_action');\n\tif(strAction.indexOf(\"Update\")==0 || strAction.indexOf(\"Create\")==0)\n\t{\n\t\tvar strItem = sl_results.GetItemTextRaw(nRow, 'ck_config_item');\n\t\tvar strArgs = \"config_item=\" + pfu(strItem);\n\t\tapp.OpenForm(\"browse_cmdb_stagefields\", strArgs, true);\n\t}\n\treturn false;\n\n}"},{"name":"sl_results_OnItemSelected","code":"sl_results_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_een(btn_process, (sl_results.rowCount()>0));\n\t_een(btn_process_all, (sl_results.rowCount()>0));\t\n\t_een(btn_subset, (sl_results.rowCount()>0));\n\t_een(mb_decline, (sl_results.rowCount()>0));\n}"},{"name":"sl_history_OnItemDoubleClicked","code":"sl_history_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\treturn false;\n\n}"},{"name":"Refresh_OnPressed","code":"Refresh_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.MF().sl_history.Refresh();\n\t_swdoc.boolFromRefreshBtn = true;\n\t_swdoc.history_refresh();\n\n}"},{"name":"TabSearch_OnTabSelected","code":"TabSearch_OnTabSelected(nTab)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(nTab==1)\n\t{\n\t\t_swdoc.MF().sl_history.Refresh();\n\t}\n\n}"},{"name":"btn_prev_OnPressed","code":"btn_prev_OnPressed()\n{\n\t_swdoc.intPageNo--;\n\t\n\t\/\/-- Add Paging\n\tvar strFilter = _swdoc.strFilter;\n\tstrFilter += \"&paged=true&start=\"+_swdoc.intPageNo+\"&end=&webclient=\"+_swdoc.webclient+\"\";\n\t\n\t\/\/-- apply filter\n\tapp.g.sl_filter(sl_results,strFilter,null,0)\n\t_swdoc.MF().sl_results.Refresh();\n\t\n\tif (_swdoc.intPageNo == 1) \n\t{\n\t\t_een(_swdoc.MF().btn_prev,false);\n\t}\n\t_een(_swdoc.MF().btn_next,true);\n}"},{"name":"btn_next_OnPressed","code":"btn_next_OnPressed()\n{\n\t_swdoc.intPageNo++;\n\t\n\t\/\/-- Add Paging\n\tvar strFilter = _swdoc.strFilter;\n\tstrFilter += \"&paged=true&start=\"+_swdoc.intPageNo+\"&end=&webclient=\"+_swdoc.webclient+\"\";\n\t\n\t\/\/-- apply filter\n\tapp.g.sl_filter(sl_results,strFilter,null,0)\n\t_swdoc.MF().sl_results.Refresh();\n\n\tif(sl_results.rowCount() < _swdoc.intCIsPerPage)\n\t{\n\t\t_een(_swdoc.MF().btn_next,false);\t\n\t}\n\t_een(_swdoc.MF().btn_prev,true);\n}"},{"name":"Field1_OnValueChanged","code":"Field1_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_types_OnValueChanged","code":"lb_types_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\t\n}"},{"name":"lb_profile_OnValueChanged","code":"lb_profile_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_status_OnValueChanged","code":"lb_status_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_cmdbstatus_OnValueChanged","code":"lb_cmdbstatus_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_impact_OnValueChanged","code":"lb_impact_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_type_OnValueChanged","code":"lb_type_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_authorised_OnValueChanged","code":"lb_authorised_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_action_OnValueChanged","code":"lb_action_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_import_status_OnValueChanged","code":"lb_import_status_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"},{"name":"lb_ntype_OnValueChanged","code":"lb_ntype_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.reset_page();\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}