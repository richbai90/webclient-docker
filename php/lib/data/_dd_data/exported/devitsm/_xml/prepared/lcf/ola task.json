{"espForm":{"configuration":{"settings":{"name":"OLA Task","title":"Log New Operational Task","callClass":"OLA Task","options":{"showExtendedDetails":"false","showWorkflow":"false","showFileAttachments":"true","showAffectedCustomers":"false","showAffectedContacts":"true","showCustomHtmlTab":"false","showPartsUsedTab":"false","allowLog":"true","allowLogAssign":"false","allowLogAccept":"false","allowLogClose":"false","allowLogAcceptTake":"false","showMassageBar":"false","showCloseDetails":"false","useEmailDateToLogCall":"false","hideToolbar":"false","hideMenubar":"false","hideFromMenu":"true","extendedDetailsTable":{"title":"Associated Information"}}},"tables":{"table":[{"name":"opencall","type":"Main Details Table","recordPicklist":"Customer","addRecordForm":"Form.tfCustomer","editRecordForm":"Form.tfCustomer","flags":"0"},{"name":"updatedb","type":"Diary Updates Table","flags":"0"}]},"showMeItems":{"action":[{"name":"Change Customer","id":"9","attrib1":"Customer","displayName":"Change Customer"},{"name":"Customer Properties","id":"2","attrib1":"Form.TfCustomer","attrib2":"&[userdb.keysearch]","displayName":"Customer Properties"}]},"javascript":{"methods":{"method":[{"name":"OnCallLoggedOK","code":"OnCallLoggedOK(nCallRef,\n                        dateRespondBy,\n                        dateFixBy,\n                        strCustName,\n                        strSla)\n{\n\n    \/\/-- nwj \n    \/\/-- 15.03.2004\n    var httpserver = app.session.server + \":\" + app.session.httpPort;\n    var intCallRef = app.g.callref_unpad(nCallRef);  \n\n\tvar pDoc = app.g.get_me_document(\"INCIDENT\",opencall.bpm_parentcallref);\n    if(pDoc)\n    {\n    \tvar intCurSel = pDoc.mainform.sl_ots1.curSel;\n    \tpDoc.mainform.sl_ots1.Refresh();\n    \tpDoc.mainform.sl_ots1.SetRowSelected(intCurSel,true);\n    }\n\n\t\n}"},{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\n\nvar oRecIncident = null;\nvar boolOLAImpactsParent = false;\nvar strCIs = \"\";\n\nvar boolChangeProfile = false;\n\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction EF()\n{\n\treturn extform;\n}\n\nfunction OC()\n{\n\treturn _swdoc.opencall;\n}\n\nfunction load_details()\n{\n\tvar strParams = \"fksla=\"+_swdoc.oRecIncident.itsm_sladef;\n\tif(_swdoc.strCIs!=\"\" && _swdoc.strCIs!=undefined)\n\t\tstrParams += \"&cikeys=\"+_swdoc.strCIs;\n\n\t_slf(_swdoc.MF().lb_oc_olad, strParams);\n\t_swdoc.OC().priority = \"\";\n\t_swdoc.OC().itsm_sladef = \"\";\n\t_ete(_swdoc.MF().flg_pauseparent, \"0\");\n}\n\nfunction handle_set_assignment(strSupportGroup)\n{\n\n}\n\nfunction handle_set_oladef(strNewOLD)\n{\n\tvar oRecOLD = app.g.get_record(\"itsmsp_slad_ola\", strNewOLD);\n\tif(oRecOLD)\n\t{\t\n\t\t_swdoc.OC().priority = oRecOLD.fk_sla;\t\n\t\t_een(_swdoc.MF().lb_oc_sla, true);\t\n\t\t_een(_swdoc.MF().oc_impact,true);\n\t\t_een(_swdoc.MF().oc_urgency, true);\n\t\t_ete(_swdoc.MF().fld_desc, oRecOLD.descriptive);\n\t\t\n\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/OLA\/UseMatrixPriority\")==1)\n\t\t{\n\t\t\tvar strSLA = app.itsm.get_sla_from_slad_matrix(strNewOLD, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level, 0);\n\t\t\tif(strSLA!=\"\")\n\t\t\t\t_swdoc.OC().priority = strSLA;\t\n\t\t}\n\t\t\n\n\t\tif(_swdoc.OC().suppgroup != oRecOLD.fk_suppgroup)\n\t\t{\n\t\t\tif(_swdoc.OC().suppgroup!=\"\" && oRecOLD.fk_suppgroup != '[All Support Groups]')\n\t\t\t{\n\t\t\t\tMessageBox(\"The assignment group has been changed to the group defined against the OLD.\");\n\t\t\t}\n\t\t\t\n\t\t\tif(oRecOLD.fk_suppgroup == '[All Support Groups]')\n\t\t\t{\n\t\t\t\tMessageBox(\"Please select the support group to assign this task to.\");\n\t\t\t\t_swdoc.OC().suppgroup = \"\";\n\t\t\t\t_swdoc.OC().owner = \"\";\n\t\t\t\t_een(_swdoc.MF().tb_suppgroup, true);\n\t\t\t\t_een(_swdoc.MF().tb_suppowner, true);\n\t\t\t\t_ete(_swdoc.MF().tb_suppowner, \"\");\n\t\t\t}else\n\t\t\t{\n\t\t\t\t_swdoc.OC().suppgroup = oRecOLD.fk_suppgroup;\n\t\t\t\t_swdoc.OC().owner = oRecOLD.fk_aid;\n\t\t\t\t_ete(_swdoc.MF().tb_suppowner, \"\");\n\t\t\t\t_een(_swdoc.MF().tb_suppgroup, false);\n\t\t\t\t_een(_swdoc.MF().tb_suppowner, false);\n\t\t\t}\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\n\t\t_swdoc.calc_priority();\n\n\t}\n}\n\nfunction calc_priority()\n{\n\tvar utccalllogdate = new Date();\n\tif(_swdoc.OC().priority==\"False\")\n\t\treturn;\n\tvar useSLA = app.g.get_sla_timeinfo(_swdoc.OC().priority,utccalllogdate);\n\n\tvar mcFixDate = new Date();\n\tmcFixDate.setTime(_swdoc.oRecIncident.fixbyx * 1000);\n\t\n\t_ete(_swdoc.MF().tb_ola_respby,useSLA.sla_tz_respbyx);\n\t_ete(_swdoc.MF().tb_ola_fixby, useSLA.sla_tz_fixbyx);\t\t\n\t\n\t\/\/-- if ola fix by is greater than parent sla fix by alert the analyst\n\t_swdoc.boolOLAImpactsParent = (useSLA.sla_tz_fixbyx > app.g.fixepoch(new Number(_swdoc.oRecIncident.fixbyx)));\n\t_eva(_swdoc.MF().lb_impact,(_swdoc.boolOLAImpactsParent)?\"2\":\"1\");\n\t\n\tif (_swdoc.boolOLAImpactsParent)\n\t{\n\t\tMessageBox(\"Warning : The estimated OLA resolution date exceeds the resolution date of the parent SLA.\");\n\t}\n}"},{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strCallclass)\n{\n\t\/\/-- can they raise an this type of call\n\tif(app.itsm.can_create(strCallclass,true)==false) return false;\n\n\n\tif(app.g.LOG_FROM_CALL==null)\n\t{\n\t\tMessageBox(\"A \" + strCallclass + \" can only be raised from an incident detail form.\");\n\t\treturn false;\n\t}\n\telse\n\t{\n\t\t\/\/-- store call object so we can load related info\n\t\t\n\t\t_swdoc.oRecIncident = app.g.LOG_FROM_CALL;\/\/app.g.get_sys_record(\"opencall\", app.g.LOG_FROM_CALL.callref);\n\t\topencall.bpm_parentcallref = _swdoc.oRecIncident.callref;\n\t\tapp.g.LOG_FROM_CALL=null;\n\t}\n\t\n\treturn true;\n}"},{"name":"OnLogCall","code":"OnLogCall()\n{\n\t\n\t_swdoc.OC().suppgroup = _swdoc.MF().tb_suppgroup.text;\n\t_swdoc.OC().owner = _swdoc.MF().tb_suppowner.text;\n\treturn true;\n}"},{"name":"OnRecordValueChanged","code":"OnRecordValueChanged(strTable, strColumn, strValue, strOldValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tif( (strColumn==\"itsm_impact_level\")||(strColumn==\"itsm_urgency_level\") )\n    {\n    \t\/\/-- if use incident assessment over ci\n    \tif(dd.GetGlobalParamAsNumber(\"Application Settings\/OLA\/UseMatrixPriority\")==0)\n    \t{\n    \t\tif(_swdoc.OC().itsm_sladef!=\"\")\n    \t\t{ \t\t\t\n    \t\t\tvar strSLA = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level,0);\n    \t\t\tif(strSLA!=\"\")\n    \t\t\t{\n    \t\t\t\tif(strSLA!=_swdoc.OC().priority)\n    \t\t\t\t{\n    \t\t\t\t\t_swdoc.OC().priority = strSLA;\n    \t\t\t\t\t_swdoc.calc_priority();\n  \t\t\t  \t\t\t_swdoc.UpdateFormFromData();\n    \t\t\t\t}\n    \t\t\t}\n    \t\t}\n    \t}\n    }\n\telse if(strColumn==\"probcode\" && strTable == \"opencall\")\n    {\n\t\t_swdoc.boolChangeProfile = true;\n  \t\tmainform.SetTimer(4, 100);\n\t}\n\telse if(strColumn==\"priority\" && strTable == \"opencall\")\n    {\n    \tif(_swdoc.boolChangeProfile)\n    \t{\n\t\t\t_swdoc.OC().priority = strOldValue;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tMessageBox(\"SLAs and Priorities are dependant on OLA Task, so cannot be set from the request profile.\");\n   \t\t}\n    }\n      \n  \n}"}]}}},"layout":{"appearance":{"width":"616","height":"437","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"tb_title","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"9","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"295","left":"9","right":"612","bottom":"315"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"opencall.itsm_title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#808080"}}},{"general":{"name":"CaptionPanel5","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Task Title and Description","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"267","left":"5","right":"616","bottom":"437"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_document.png"}}},{"general":{"name":"tb_updatetext","type":"Field"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"9","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"318","left":"9","right":"612","bottom":"432"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"updatedb.updatetxt"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#808080"}}},{"general":{"name":"CaptionPanel3","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Options","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"38","left":"3","right":"306","bottom":"263"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_alarm.png"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Priority","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"176","left":"5","right":"85","bottom":"193"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"name":"lb_oc_sla","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"175","left":"89","right":"302","bottom":"193"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Automatically Set]","distinctTable":"itsmsp_slad_priority","distinctColumn":"fk_priority","listFilter":"_swc_fk_slad=&[opencall.itsm_sladef]&_swc_flg_sla=0","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lbl_olaresdue","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","caption":"Respond by","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"197","left":"5","right":"85","bottom":"215"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_olafixdue","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"7","caption":"Fix by","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"219","left":"5","right":"85","bottom":"237"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_olaimpact","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"SLA Impact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"241","left":"5","right":"85","bottom":"259"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"flg_pauseparent","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"182","left":"676","right":"864","bottom":"199"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Place master incident on hold^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_ola_respby","type":"Field"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"197","left":"89","right":"302","bottom":"215"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"boundDateColumn":"respondbyx","disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_ola_fixby","type":"Field"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"219","left":"89","right":"302","bottom":"237"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"boundDateColumn":"respondbyx","disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_impact","type":"Field"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"241","left":"89","right":"302","bottom":"259"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"boundDateColumn":"respondbyx","disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0","listItems":"Within master SLA fix time^1|Breaches master SLA fix time^2|"}}},{"general":{"name":"tb_suppgroup","type":"Field"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"92","left":"89","right":"302","bottom":"110"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.suppgroup"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_suppowner","type":"Field"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"109","left":"89","right":"302","bottom":"127"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.owner"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"syscache","distinctTable":"swanalysts","distinctColumn":"AnalystID","displayColumn":"Name","dropdownButtonType":"1"}}},{"general":{"name":"lbl_assignto","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"15","caption":"Assign To","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"92","left":"5","right":"85","bottom":"110"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_oc_olad","type":"Field"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"70","left":"89","right":"302","bottom":"88"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"itsmsp_slad_ola","distinctColumn":"pk_ola_id","listFilter":"fksla=-1","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","displayColumn":"slad_ola","storedQuery":"requests.filter_ola"}}},{"general":{"name":"lbl_olaid","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"17","caption":"OLA Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"70","left":"5","right":"85","bottom":"88"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_probprofile1","type":"Field"},"appearance":{"index":"18","backgroundColor":"#ffffff","foregroundColor":"#eaeaea","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"270","left":"304","right":"612","bottom":"288"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"opencall.probcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Click here to select a category for this task","activeTextColor":"#eeeeee","disabledBackgroundColor":"#dddddd","borderColor":"#c0c0c0"}}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"19","caption":"Task Category","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"270","left":"211","right":"300","bottom":"288"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Field1","type":"Field"},"appearance":{"index":"20","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"109","left":"90","right":"286","bottom":"111"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#eeeeee","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"fld_hold_until","type":"Field"},"appearance":{"index":"21","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"199","left":"682","right":"895","bottom":"217"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee","dateFormatMode":"0"}}},{"general":{"name":"txt_hold_until","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"22","caption":"Hold Until","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"202","left":"624","right":"678","bottom":"220"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Text5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"23","caption":"Impact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"131","left":"5","right":"85","bottom":"149"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"24","caption":"Urgency","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"153","left":"5","right":"85","bottom":"171"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"oc_impact","type":"Field"},"appearance":{"index":"25","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"131","left":"89","right":"302","bottom":"149"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Critical|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_impact_lvl","distinctColumn":"pk_impact","storedQuery":"generic.select"}}},{"general":{"name":"oc_urgency","type":"Field"},"appearance":{"index":"26","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"153","left":"90","right":"303","bottom":"171"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_urgency_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Extreme|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_urgency_lvl","distinctColumn":"pk_urgency","storedQuery":"generic.select"}}},{"general":{"name":"CaptionPanel4","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"27","caption":"Description","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"38","left":"313","right":"616","bottom":"263"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_alarm.png"}}},{"general":{"name":"fld_desc","type":"Field"},"appearance":{"index":"28","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"65","left":"317","right":"613","bottom":"260"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"CaptionPanel6","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"29","caption":"Log New Operational Task","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"18"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"4","left":"3","right":"616","bottom":"34"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"30","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_alarm.png"}}}]},"javascript":{"methods":{"method":[{"name":"btn_remove_ci_OnPressed","code":"btn_remove_ci_OnPressed()\n{\n\n\n   \n             \n}"},{"name":"btn_assign_OnPressed","code":"btn_assign_OnPressed()\r\n{\r\n    \/\/ TODO: Add your event code here\r\n    _swdoc.opencall.suppgroup = _swdoc.GetVariable(\"prefered_support\");\r\n    MessageBox(_swdoc.opencall.suppgroup)\r\n    _swdoc.LogCall();        \r\n}\r\n\r\n"},{"name":"tb_suppowner_OnRightClick","code":"tb_suppowner_OnRightClick()\n{\n\t_swdoc.OC().suppgroup = \"\";\n\t_swdoc.OC().owner = \"\";\t\t\n\t_ete(tb_suppowner, \"\");\n\t\/\/-- filter olas that are defined for the master incident SLA\n\t_swdoc.handle_set_assignment(\"\");\n\t\n\t_swdoc.UpdateFormFromData();\n\treturn false;\n}"},{"name":"tb_suppowner_OnDropDown","code":"tb_suppowner_OnDropDown()\n{\n\t\/\/-- pick analyst or group\n\tvar oTmp = app.g.pick_analystorgroup(\"Assign To\");\n\tif((oTmp)&&(oTmp.oGroup!=false))\n\t{\n\t\t\/\/-- we have info\n\t\t_swdoc.OC().suppgroup = oTmp.oGroup.id;\n\t\t_swdoc.OC().owner = oTmp.oAnalyst.id;\t\t\n\t\t\n\t\t_swdoc.handle_set_assignment(oTmp.oGroup.id)\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\t\n\treturn false;\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/-- load incident details into form fields..note have to do js for this as we cant bind two records from same table onto a form\n\tapp.g.load_form_fields(_swdoc.oRecIncident, mainform, \"incident\");\n\t_swdoc.OC().itsm_impact_level = _swdoc.oRecIncident.itsm_impact_level;\n\t_swdoc.OC().itsm_urgency_level = _swdoc.oRecIncident.itsm_urgency_level;\n\t_swdoc.opencall.suppgroup = \"\";\n\topencall.owner = \"\";\n\t\n\t_swdoc.strCIs = app.cmdb.get_call_cis(_swdoc.oRecIncident.callref);\n\n\t\/\/-- filter olas that are defined for the master incident SLA\n\t_swdoc.load_details();\n\n}"},{"name":"lb_oc_olad_OnValueChanged","code":"lb_oc_olad_OnValueChanged(strValue)\n{\n\t_swdoc.handle_set_oladef(strValue);\n\t_swdoc.UpdateFormFromData();\n\n}"},{"name":"tb_suppgroup_OnLeftClick","code":"tb_suppgroup_OnLeftClick()\n{\n\/\/-- pick analyst or group\n\tvar oTmp = app.g.pick_analystorgroup(\"Assign To\");\n\tif((oTmp)&&(oTmp.oGroup!=false))\n\t{\n\t\t\/\/-- we have info\n\t\t_swdoc.OC().suppgroup = oTmp.oGroup.id;\n\t\t_swdoc.OC().owner = oTmp.oAnalyst.id;\t\t\n\t\t\n\t\t_swdoc.handle_set_assignment(oTmp.oGroup.id)\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\n\n\treturn false;\n}"},{"name":"flg_pauseparent_OnValueChanged","code":"flg_pauseparent_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tvar\tboolEnable = strValue==1;\t\n\t_een(_swdoc.MF().fld_hold_until,boolEnable);\n\t_een(_swdoc.MF().txt_hold_until, boolEnable);\n\t\n}"},{"name":"lb_oc_sla_OnValueChanged","code":"lb_oc_sla_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.calc_priority();\n\n}"}]}}},"extendedLayout":{"appearance":{"width":"804","height":"600","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}}}