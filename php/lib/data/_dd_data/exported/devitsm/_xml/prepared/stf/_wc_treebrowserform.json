{"espForm":{"configuration":{"settings":{"name":"_wc_treebrowserform","title":"Find","description":"webclient picklist form for lcf","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _selected_treeformkey = \"\";"}}}},"layouts":{"layout":[{"appearance":{"width":"559","height":"429","backgroundColor":"#f8f8f8","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"sl_picklist","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"false","horizontalGridLines":"false","autoLoad":"false","allowMultiSelect":"false"},"group":"TabSearch:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"283","left":"15","right":"544","bottom":"386"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#cae1ee","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#777777","sqlSource":"swdata"}}},{"general":{"name":"btn_prop","type":"EventButton"},"appearance":{"index":"1","caption":"Properties","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"399","left":"15","right":"76","bottom":"426"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_new","type":"EventButton"},"appearance":{"index":"2","caption":"New","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"399","left":"84","right":"145","bottom":"426"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_select","type":"EventButton"},"appearance":{"index":"3","caption":"Ok","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"399","left":"413","right":"474","bottom":"426"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"4","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"399","left":"482","right":"543","bottom":"426"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"TabSearch","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"5","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"10","left":"8","right":"552","bottom":"394"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Search","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Browse","properties":"56=#ffdb75|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"6","caption":"Search Results","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"263","left":"11","right":"97","bottom":"280"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Line1","type":"Line","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"7","caption":"Line 1","backgroundColor":"#ffffff","foregroundColor":"#808080","font":{"@size":"0"}},"objectPlacement":{"position":{"top":"254","left":"15","right":"544","bottom":"262"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Line2","type":"Line","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"8","caption":"Line 1","backgroundColor":"#ffffff","foregroundColor":"#808080","font":{"@size":"0"}},"objectPlacement":{"position":{"top":"187","left":"15","right":"544","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnFind","type":"EventButton","group":"TabSearch:0"},"appearance":{"index":"9","caption":"Find Now","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"196","left":"482","right":"543","bottom":"223"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btnReset","type":"EventButton","group":"TabSearch:0"},"appearance":{"index":"10","caption":"Reset","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"227","left":"482","right":"543","bottom":"254"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"lb_option","type":"Field","group":"TabSearch:0"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"230","left":"296","right":"466","bottom":"250"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","listItems":"All of the above match^1|Any of the above match^0|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"12","caption":"Search Mode :","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"230","left":"214","right":"291","bottom":"250"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_limit","type":"Field","group":"TabSearch:0"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"205","left":"296","right":"378","bottom":"225"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Numeric","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","defaultValue":"100","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"14","caption":"Max Results :","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"205","left":"214","right":"291","bottom":"225"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"srch_fields_one","type":"Rectange","group":"TabSearch:0"},"appearance":{"index":"15","backgroundColor":"#f8f8f8","foregroundColor":"#969696","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"41","left":"16","right":"273","bottom":"183"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"srch_fields_two","type":"Rectange","group":"TabSearch:0"},"appearance":{"index":"16","backgroundColor":"#f8f8f8","foregroundColor":"#969696","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"41","left":"284","right":"541","bottom":"183"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tif(IsObjectDefined(\"app._xmlSearchForms\")==false)return;\n\n\t\/\/-- set search opion to all must match and limit to 100\n\t_eva(tb_limit,100)\n\t_eva(lb_option,1);\n\n\t\/\/-- get picklist details from xml\n\tif(app._xmlSearchForms==null)\n\t{\n\t\tMessageBox(\"The search form definition (\"+ top._primary_key +\") does not exist. Please contact your Administrator\");\n\t\t_swdoc.CloseForm();\n\t\treturn;\n\t}\n\n\tvar xmlForm = null;\n\tvar arrSearchForms = app._xmlSearchForms.getElementsByTagName('sqlTbForm');\n\tfor(var x=0;x < arrSearchForms.length;x++)\n\t{\n\t\tvar strName = app.xmlNodeTextByTag(arrSearchForms[x],\"name\");\n\t\tif(strName==top._primary_key)\n\t\t{\n\t\t\txmlForm = arrSearchForms[x];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t\/\/-- set sqllist (sl_picklist)\n\tif(xmlForm!=null)\n\t{\n\t\t\/\/-- \n\t\t_swdoc.SetTitle(app.xmlNodeTextByTag(xmlForm,\"title\"));\n\n\t\t\/\/-- set sqltable properties\n\t\tsl_picklist.table = app.xmlNodeTextByTag(xmlForm,\"table\");\n\t\t\/\/sl_picklist.editRecordForm = app.xmlNodeTextByTag(xmlPL,\"propertiesForm\");\n\t\t\/\/sl_picklist.addRecordForm = app.xmlNodeTextByTag(xmlPL,\"newRecordForm\");\t\n\t\t\n\t\t\/\/-- get columns and draw out\n\t\tvar arrColumns = new Array();\n\t\tvar arrXmlColumns = xmlForm.getElementsByTagName(\"resultColumn\");\n\t\tfor(var x=0;x<arrXmlColumns.length;x++)\n\t\t{\n\t\t\tarrColumns[arrColumns.length++] = app.xmlText(arrXmlColumns[x]);\n\t\t}\n\t\tsl_picklist._create_bespoke_xmlcols(arrColumns);\t\t\n\n\n\t\t\/\/-- get search areas and add tables to innerhtml\n\t\tvar eDivOne = srch_fields_one.element;\n\t\n\t\t\/\/eDivOne.style.overflow='auto';\n\t\tvar eDivTwo = srch_fields_two.element;\n\t\t\/\/eDivTwo.style.overflow='auto';\n\t\t\n\t\t\/\/-- sf one fields\n\t\tvar strTableHtml = \"<table border='0' cellspacing='0' cellpadding='0' width='100%'>\";\n\t\tvar arrSearchColumns= xmlForm.getElementsByTagName(\"col1SearchField\");\t\n\t\tfor(var x=0;x<arrSearchColumns.length;x++)\n\t\t{\n\t\t\tvar strBinding = sl_picklist.table + \".\" + app.xmlText(arrSearchColumns[x]);\n\n\t\t\tstrTableHtml += \"<tr>\";\t\n\t\t\t\t\n\t\t\t\t\/\/-- label\n\t\t\t\tstrTableHtml += \"<td class='sf-label' width='50%'>\";\t\n\t\t\t\tstrTableHtml += \"<div class='sf-label-div'>\" + app._application_labels[strBinding] + \"<\/div>\";\t\n\t\t\t\tstrTableHtml += \"<\/td>\";\t\n\t\t\t\n\t\t\t\t\/\/-- input\n\t\t\t\tstrTableHtml += \"<td class='sf-input' width='50%'>\";\n\t\t\t\tstrTableHtml += \"<input type='text' class='sf-input-box' binding='\"+strBinding+\"'>\";\n\t\t\t\tstrTableHtml += \"<\/td>\";\t\n\t\t\t\t\n\t\t\tstrTableHtml += \"<\/tr>\";\t\n\t\n\t\t}\n\t\tstrTableHtml += \"<\/table>\";\t\n\t\teDivOne.innerHTML = strTableHtml;\n\n\t\t\/\/-- sf two fields\n\t\tvar strTableHtml = \"<table border='0' cellspacing='0' cellpadding='0' width='100%'>\";\n\t\tvar arrSearchColumns = xmlForm.getElementsByTagName(\"col2SearchField\");\t\n\t\tfor(var x=0;x<arrSearchColumns.length;x++)\n\t\t{\n\t\t\tvar strBinding = sl_picklist.table + \".\" + app.xmlText(arrSearchColumns[x]);\n\n\t\t\tstrTableHtml += \"<tr>\";\t\n\t\t\t\t\n\t\t\t\t\/\/-- label\n\t\t\t\tstrTableHtml += \"<td class='sf-label' width='50%'>\";\t\n\t\t\t\tstrTableHtml += \"<div class='sf-label-div'>\" + app._application_labels[strBinding] + \"<\/div>\";\t\n\t\t\t\tstrTableHtml += \"<\/td>\";\t\n\t\t\t\n\t\t\t\t\/\/-- input\n\t\t\t\tstrTableHtml += \"<td class='sf-input' width='50%'>\";\n\t\t\t\tstrTableHtml += \"<input type='text' class='sf-input-box' binding='\"+strBinding+\"'>\";\n\t\t\t\tstrTableHtml += \"<\/td>\";\t\n\t\t\t\t\n\t\t\tstrTableHtml += \"<\/tr>\";\t\n\t\n\t\t}\n\t\tstrTableHtml += \"<\/table>\";\t\n\t\teDivTwo.innerHTML = strTableHtml;\n\n\t}\n\n}"},{"name":"btn_select_OnPressed","code":"btn_select_OnPressed()\n{\n    var sCol = dd.tables[sl_picklist.table].PrimaryKey;\n\tvar keyValue = sl_picklist.GetItemTextRaw(sl_picklist.curSel, sCol)\n\t\n\tif(keyValue!=\"\")\n\t{\n\t\t_swdoc._selected_treeformkey = keyValue;\n\t\t_swdoc.CloseForm();\n\t}\n}"},{"name":"btn_prop_OnPressed","code":"btn_prop_OnPressed()\n{\n\tsl_picklist.EditRecord(sl_picklist.curSel);\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc._selected_treeformkey = \"\";\n\t_swdoc.CloseForm()\n\t\n\n\n}"},{"name":"sl_picklist_OnItemDoubleClicked","code":"sl_picklist_OnItemDoubleClicked(nRow, nCol)\n{\n\tvar sCol = dd.tables[sl_picklist.table].PrimaryKey;\n\tvar keyValue = sl_picklist.GetItemTextRaw(nRow, sCol)\n\t\n\tif(keyValue!=\"\")\n\t{\n\t\t_swdoc._selected_treeformkey = keyValue;\n\t\t_swdoc.CloseForm();\n\t}\n\t\n\treturn false;\n\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}