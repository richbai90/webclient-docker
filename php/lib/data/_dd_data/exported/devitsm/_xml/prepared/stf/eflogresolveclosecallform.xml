<?xml version="1.0" encoding="utf-8" ?>
<espForm>
	<configuration>
		<settings>
			<name>EfLogResolveCloseCallForm</name>
			<title>Resolve Close Call Form</title>
			<printTemplates>
			</printTemplates>
			<options>
				<allowResize>true</allowResize>
				<showMenubar>true</showMenubar>
				<showToolbar>false</showToolbar>
				<showStatusBar>false</showStatusBar>
			</options>
		</settings>
		<tables>
			<table>
				<name>updatedb</name>
				<type>Main Details Table</type>
				<flags>5</flags>
				<assignments>
				</assignments>
			</table>
			<table>
				<name>opencall</name>
				<type>Extended Details Table</type>
				<mainDetailsColumn>callref</mainDetailsColumn>
				<flags>0</flags>
				<assignments>
				</assignments>
			</table>
		</tables>
		<showMeItems>
		</showMeItems>
		<javascript>
			<methods>
				<method>
					<name>OnAdviseActionCompleted</name>
					<code>
						<![CDATA[OnAdviseActionCompleted(nAction, stActionResultValues)
{
	var res = new String(stActionResultValues);
	var ar = res.split("&");
	if(nAction == LOG_CALL_ACTION)
	{
		var i=0; 
		for( ; i< ar.length; i++)
		{
			var pos = ar[i].indexOf("callref=");
			if(pos != -1)
			{
				var arCallref = ar[i].split("=");
				var strLogCallRef = arCallref[1];
				if(mainform.ResolveClose(strLogCallRef)) 
				{
					//mainform.onformloaded();
					return true;
				}	
				else
				{
					if (confirm("There was a problem resolving the call you just logged. Would you like to view the call details?"))
					{
						app.global.OpenCallDetailsView(strLogCallRef);
						return true;						
					}
				}
			}
		}
	}
	return false;
}]]>
					</code>
				</method>
				<method>
					<name>(User Defined Functions)</name>
					<code>
						<![CDATA[var boolLogMode = false; //-- boolean - is the form being displayed in a logcall forn
var boolClosing = false; //-- boolean - is the call action to close calls/s (if false resolving)
var arrSurveyNameSurvIDs = new Array(); //-- array - holds list of survey ids 
var arrCallStatuss 		 = new Array(); //-- array - holds list of the all the calls status
var arrCallOpenTasks 	 = new Array(); //-- araray - holds list of all the calls tasks
var boolFormFieldChanged = false;	//-- boolean - set to true when formfield is changed. Used when closing form
var boolSourceEmail = false; //-- from opened from email
var boolHaveSubject = false; //-- Is there a subject
var boolHaveSurveys = false; //-- are there surveys available
var nBackdatePeriod = 0;
var arrContractNameIDs = new Array();
var boolConfirmSupportUnits = true;

var boolIsQuickLogCall = false;

//-- reset bound record so we dont get messages when leaving
function resetData()
{
	_swdoc.ResetModiedFlag("updatedb");
	_swdoc.ResetModiedFlag("opencall");
}

//-- validate form data that user has set
function ValidateForm()
{
	if((_swdoc.updatedb.timespent < 1 || _swdoc.updatedb.timespent > 60000) && (mainform.tb_timespent.mandatory))
	{
		MessageBox("You must enter the amount of time you spent on this action", MB_OK);
		return false;	// Make sure that the time spent is within range
	}

	if((_swdoc.updatedb.updatetxt == "") && (mainform.tb_updatetext.text==""))
	{
		MessageBox("You must enter a description in the Action Description tab.", MB_OK | MB_ICONINFORMATION );
		return false;	// Make sure we have some update text
	}

	//-- check other required fields
	if (!_swdoc.check_mandatory_fields("updatedb",mainform))return false;		
	if (!_swdoc.check_mandatory_fields("opencall",mainform))return false;
	
	//-- check profile levels
	if(!mainform.check_profile_levels())return false;
	
	//-- Check for available support units
	var boolShow =dd.GetGlobalParamAsString("Application Settings/SupportExternalCompanies")==1;
	if(boolShow)
	{
		if(_swdoc.boolConfirmSupportUnits)
		{
			if(mainform.tb_avail_units.value!="Unlimited")
			{
				if((mainform.tb_units_assigned.value*1) > (mainform.tb_avail_units.value*1))
				{
					if(MessageBox("The number of support units entered exceeds those available for the selected contract.  Are you sure you want to continue?", MB_OKCANCEL | MB_ICONINFORMATION )==2)
					{
						return false;
					}
					else
					{
						_swdoc.boolConfirmSupportUnits = false;
					}
				}
			}
		}
	}

	return TRUE;
}


//-- 08.02.2007 - NWJ - Check mandatory fields on the form for a given table
//--					alert user if need be and return false						
function check_mandatory_fields(strTable,oForm)
{
    for (var x = 0; x<oForm.elements.length;x++)
    {
        var element = oForm.elements[x];
        if ((element.mandatory) && (element.text ==""))
        {
            var colName = "";
            var fieldName = "(not specified)";
            if(element.dataRef!="")
            {
            	var arrInfo = element.dataRef.split(".");
            	var strTable = arrInfo[0];
            	var colName = arrInfo[1];
            	var fieldName = dd.tables[strTable].columns[colName.toLowerCase()].DisplayName;
            }
            MessageBox("The field '" + fieldName + "' is a mandatory field and must be completed.");
            return false;
        }
    }
    return true;
}


function setup_form_mode()
{
	//-- always make sure fixcode desc is disabled
	_een(mainform.tb_fixcodedescription,false);
				
	var bResolveByDefault = app.session.IsDefaultOption(ANALYST_DEFAULT_RESOLVEBYDEFAULT);			
	//-- if user does not have the right to close calls then only allow resolve
	if(!app.session.HaveRight(ANALYST_RIGHT_A_GROUP,ANALYST_RIGHT_A_CANCLOSECALLS))
	{
		_een(mainform.cb_callaction,false);
		bResolveByDefault = true;
	}

	//-- do they have option to resolve
	if(!app.session.HaveRight(ANALYST_RIGHT_A_GROUP,ANALYST_RIGHT_A_CANRESOLVECALLS))
	{
		_een(mainform.cb_callaction,false);
		bResolveByDefault = false;
	}
	
	//-- set the default selection for the call action pick list based on the DD entry 
	if(bResolveByDefault)
	{
		if(_swdoc.boolIsQuickLogCall==false)
		{
			_ete(mainform.cb_callaction,"Resolve Call");
		}
	}
	else
	{
		_ete(mainform.cb_callaction,"Close Call");
				
		//-- sandra 30-07-2007 -- Bug 58558 set to close if ResolveByDefault is switched off. 
		_swdoc.boolClosing = true;
	}		

	//-- we are in a quicklog
	if(_swdoc.boolIsQuickLogCall!=false)
	{
		//-- quick log states close call
		if(mainform.cb_callaction.text == "Close Call")
		{
			_swdoc.boolClosing = true;
		}
	}
	
	//--
	//-- disable / enable form fields
	_een(mainform.dt_actiontime,(app.session.CanBackdateCallActions())); //-- can backdate ?
	_een(mainform.btnGetProfileText,false);
	_een(mainform.btnBrowseProfile,true);
	
	//-- setup various flags	
	_swdoc.setup_charge_flag(true);
	_swdoc.setup_kbase_flag();	
	_swdoc.setup_email_flag();
	_swdoc.setup_public_flag();
	_swdoc.setup_survey_options();

	//-- if we have a fixcode - see if we need to enable text button
	_een(mainform.btnGetProfileText,false);
	if(_swdoc.opencall.fixcode!="")
	{
		//-- nwj if it has a dec text enable button to copy
		var currentResProfileDesc = app.global.GetResolutionProfileDescription(_swdoc.opencall.fixcode);	
		_een(mainform.btnGetProfileText,(currentResProfileDesc.strDescription!=""));
	}
}


//-- 08.02.2007 - NWJ - One function to handle which standard check boxes should be enabled/disabled
//--					checked or unchecked, as old code fglas were set all over the place
function setup_public_flag()
{
	_een(mainform.flg_updatepublic,true);
	if(_swdoc.boolIsQuickLogCall==false)
	{
		_ete(mainform.flg_updatepublic,(app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSEPRIVATE) ? "1":"0"));
	}
}

function setup_kbase_flag()
{
	//-- does the user have the right to add to the kbase or we are worknig with multiple calls so dont add
	if(!app.session.HaveRight(ANALYST_RIGHT_C_GROUP,ANALYST_RIGHT_C_CANADDTOKNOWLEDGEBASE))
	{
		_ete(mainform.flg_addKBase,"0");
		_een(mainform.flg_addKBase,false);
	}
	else
	{
		if(_swdoc.boolIsQuickLogCall==false)
		{
			_ete(mainform.flg_addKBase,(app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSEKNOWLEDGEBASE) ? "1":"0"));
        }
        _een(mainform.flg_addKBase,true);
	}
}

function setup_charge_flag(boolOnload)
{
	if (_swdoc.boolClosing)
	{
		//-- if not a quicklog call then set default
		_een(mainform.flg_chargeable,true);
		if((_swdoc.boolIsQuickLogCall==false)||(boolOnload==false))
		{
			_ete(mainform.flg_chargeable,(app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSECHARGABLE) ? "1":"0"));
		}
	}
	else
	{
		//-- resolving
		_een(mainform.flg_chargeable,false);
		_ete(mainform.flg_chargeable,0);
	}
}

function setup_email_flag()
{
	//--
	//-- if we have a mailserver and can send mail set flg
	if(app.global.IsConnectedToMailServer() && app.global.CanSendMail())
	{
		//-- if not a quicklog call then set default
		if(_swdoc.boolIsQuickLogCall==false)
		{
			_een(mainform.flg_emailcustomer,true);
			_ete(mainform.flg_emailcustomer,((app.session.IsDefaultOption(ANALYST_DEFAULT_CLOSESENDEMAIL)) ? "1":"0"));
		}
	}
	else
	{
		_een(mainform.flg_emailcustomer,false);
		_ete(mainform.flg_emailcustomer,"0");
	}
}

//--
//-- initialise the surveys options
function setup_survey_options()
{
	//-- if they do not have surveys hide options
	if(!app.global.IsSurveyModuleEnabled())
	{
		_ete(mainform.flg_customersurvey,"0");
		_evi(mainform.flg_customersurvey,false);
		_evi(mainform.cb_surveys,false);
	}
	else
	{
		//-- get survey options
		_swdoc.load_survey_list();	

		//-- if we dont have surveys on the system then hide
		if(!_swdoc.boolHaveSurveys)	
		{
			_ete(mainform.flg_customersurvey,"0");
			_een(mainform.flg_customersurvey,false);
			_evi(mainform.cb_surveys,false);
			return false;
		}
		
		//-- have to set to true because if you set to hidden in code and then dev form it saves the state
		_evi(mainform.flg_customersurvey,true);
		_evi(mainform.cb_surveys,true);
			
		//-- not allowed to change send survey options or there arent any surveys to send
		if(app.session.IsDefaultOption(ANALYST_DEFAULT_DISABLESENDSURVEY)) 
		{
			//--code change DavidJH 09.06.05
			_een(mainform.flg_customersurvey,false);
			_ete(mainform.flg_customersurvey,"0");
			return false;
		}
		else
		{
			_een(mainform.flg_customersurvey,true);
		}
		
		//-- default ticked setting
		//-- if not a quicklog call then set default
		if(_swdoc.boolIsQuickLogCall==false)
		{
			if(app.session.IsDefaultOption(ANALYST_DEFAULT_SETSENDSURVEY))
			{
				_ete(mainform.flg_customersurvey,"1");
				_een(mainform.cb_surveys,true);						
			}
			else
			{
				_ete(mainform.flg_customersurvey,"0");
				_een(mainform.cb_surveys,false);
			}
		}
	}
}

function load_survey_list()
{
	//-- empty the picklist
	mainform.cb_surveys.pickList = "";
	
	//-- select all of the system mailboxes and add all shared mailboxes to an array
	var SqlRecordSetObj	= new SqlQuery;
	
	//-- select all of the surveys and the mailbox they are associated to
	SqlRecordSetObj.Reset();
	SqlRecordSetObj.InvokeStoredQuery("form/resolvecloseform/getsurveys","");
		
	var str = "";
	var selected = "";
	var strTemps = new Array();
	bselecteddefaultsurvey = false;
	
	//-- loop through the surveys and and match those associated to shared mailboxes
	//-- for each survey add it into an array and to the pick list string and when the 
	//-- first survey is found identify it as the default option for the survey picklist
	while(SqlRecordSetObj.Fetch())
	{
		//-- get the recordset value for survey name and id
		var surveyname = SqlRecordSetObj.GetValueAsString("surveyName");
		var surveyid = SqlRecordSetObj.GetValueAsString("surveyid");
		
		//-- add the survey name/id pair into the array
		_swdoc.arrSurveyNameSurvIDs[surveyname] = surveyid;
		
		//-- build the picklist	options string	
		str += surveyname + "|";
		//MessageBox(surveyname)
		_swdoc.boolHaveSurveys=true;
		//-- identify the default survey (currently the first one added)
		for(ID in _swdoc.arrSurveyNameSurvIDs)
		{
			if(_swdoc.arrSurveyNameSurvIDs[ID])
			{
				if(!bselecteddefaultsurvey)
				{
					bselecteddefaultsurvey = true;
					selected = surveyname;
				}
			}
		}
			
	}
	//-- populate the surveys pick list
	mainform.cb_surveys.pickList = str;
	
	//-- set the default selected survey
	_ete(mainform.cb_surveys,selected);
	
}

function setup_support_unit_assignment()
{
		//-- empty the picklist
		mainform.lb_supp_contract.pickList = "";
		
		var SqlRecordSetObj	= new SqlQuery;				
		SqlRecordSetObj.Reset();
		var strParams = "company="+pfu(app.g.strLogAndResolveCompany);
		SqlRecordSetObj.InvokeStoredQuery("form/resolvecloseform/get_contract_support_units", strParams);
			
		var str = "";
		var selected = "";
		var strTemps = new Array();
		
		while(SqlRecordSetObj.Fetch())
		{
			//-- get the recordset value for contract id and title
			var contractname = SqlRecordSetObj.GetValueAsString("title");
			var contractid = SqlRecordSetObj.GetValueAsString("pk_contract_id");
						
			//-- add the name/id pair into the array
			_swdoc.arrContractNameIDs[contractname] = contractid;
			
			//-- build the picklist	options string	
			str += contractname + "|";
			
			//-- identify the default contract (one selected against the call if set)
			for(ID in _swdoc.arrContractNameIDs)
			{
				if(app.g.strLogAndResolveContract!="")
				{
					if(contractid==app.g.strLogAndResolveContract)
					{
						selected = contractname;
					}
				}
			}
		}
		
		//-- populate the surveys pick list
		mainform.lb_supp_contract.pickList = str;
		
		//-- set the default selected survey
		_ete(mainform.lb_supp_contract,selected);
	
		//-- Lookup units available for selected contract
		_swdoc.get_support_units_available(_swdoc.arrContractNameIDs[selected], mainform.tb_avail_units);
		
	
}

function get_support_units_available(strContractID, oEle)
{
	if((strContractID!="")&&(strContractID!=undefined))
	{
		var recContract = new SqlRecord;
		if(recContract.GetRecord("contract", strContractID))
		{
			if(recContract.flg_support_unlimited==1)
			{
				_eva(oEle,"Unlimited");
			}
			else
			{
				_eva(oEle,recContract.support_units_avail);
			}
		}
	}
}]]>
					</code>
				</method>
				<method>
					<name>OnExecuteAction</name>
					<code>
						<![CDATA[OnExecuteAction(nAction)
{
	//-- trigger an action from a menu bar (shortcusts)		
	//-- attaching a call to the action.
	if(nAction == ATTACHFILETOCALL_ACTION)
	{
		mainform.btnAddFile_OnPressed();
		return true;
	}

	return true;
}]]>
					</code>
				</method>
				<method>
					<name>OnValidate</name>
					<code>
						<![CDATA[OnValidate()
{
	//-- validate the form
	if(!_swdoc.ValidateForm())return VALIDATE_FAIL;
		
	return VALIDATE_OK;
}]]>
					</code>
				</method>
				<method>
					<name>(Globals)</name>
					<code>
						<![CDATA[//-- ALL vars and funcs are in the userdefined js area]]>
					</code>
				</method>
				<method>
					<name>OnFormLoading</name>
					<code>
						<![CDATA[OnFormLoading(strFormName, strClass)
{
	//-- set the logmode and is quick call
	if(_swdoc._form["logmode"])_swdoc.boolLogMode = true;
	if(_swdoc._form["preloadtype"]==3)_swdoc.boolIsQuickLogCall = true;

	
								

}]]>
					</code>
				</method>
				<method>
					<name>OnFormClosing</name>
					<code>
						<![CDATA[OnFormClosing()
{
	if(!_swdoc.boolFormFieldChanged)_swdoc.resetData();
	return true;
}]]>
					</code>
				</method>
			</methods>
		</javascript>
	</configuration>
	<layouts>
		<layout>
			<appearance>
				<width>561</width>
				<height>424</height>
				<backgroundColor>#ffffff</backgroundColor>
				<fillColour>#ffffff</fillColour>
				<textColour >#000000</textColour >
				<font  size="8">Arial</font>
			</appearance>
			<controls>
				<control>
					<general>
						<name>tb_updatetext</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>0</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>490</top>
							<left>690</left>
							<right>1215</right>
							<bottom>630</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.updatetxt</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>true</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>true</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>true</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>4</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>this is resolution two</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>CaptionPanel2</name>
						<type>CaptionBar</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>true</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>1</index>
						<caption>Details</caption>
						<backgroundColor>#f1f1f1</backgroundColor>
						<foregroundColor>#003366</foregroundColor>
						<font  size="10" bold="1">Trebuchet (MS)</font>
						<alignment>Left</alignment>
						<fillStyle>Vertical Gradient</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>250</top>
							<left>680</left>
							<right>1071</right>
							<bottom>423</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<backgroundColor2>#d8d8d8</backgroundColor2>
							<imageHSpace>10</imageHSpace>
							<slope>12</slope>
							<borderColor>#d3c9b6</borderColor>
							<headerHeight>23</headerHeight>
							<hasBorder>1</hasBorder>
							<panelBorderColor>#d3c9b6</panelBorderColor>
							<fillStyle>0</fillStyle>
							<panelBackgroundColor>#f2eedd</panelBackgroundColor>
							<panelBackgroundColor2>#000000</panelBackgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>dt_actiontime</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>2</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>300</top>
							<left>680</left>
							<right>887</right>
							<bottom>318</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.updatetimex</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Date/Time Control</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<colorDateIndicator>false</colorDateIndicator>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>1166205163</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<dateFormatMode>0</dateFormatMode>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_timespent</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>3</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>300</top>
							<left>900</left>
							<right>959</right>
							<bottom>318</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.timespent</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Minute Time Period</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>11</displayColumnValue>
						<properties>
							<defaultValue>5</defaultValue>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>cb_actionsource</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>4</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>330</top>
							<left>680</left>
							<right>887</right>
							<bottom>348</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udsource</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>E-mail</displayColumnValue>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<defaultValue>Telephone</defaultValue>
							<distinctTable>swlists</distinctTable>
							<distinctColumn>value</distinctColumn>
							<borderColor>#c0c0c0</borderColor>
							<sqlSource>swdata</sqlSource>
							<displayColumn>display_name</displayColumn>
							<listFilter>lid=CALL-ACTION-SOURCE</listFilter>
							<storedQuery>common.getSwList</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_actiontype</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>5</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>330</top>
							<left>900</left>
							<right>1061</right>
							<bottom>348</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udcode</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>Called Customer</displayColumnValue>
						<properties>
							<defaultValue>General Update</defaultValue>
							<listItems>General Update|Called Customer|E-mailed Customer|</listItems>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
							<sqlSource>swdata</sqlSource>
							<distinctTable>swlists</distinctTable>
							<distinctColumn>value</distinctColumn>
							<displayColumn>display_name</displayColumn>
							<listFilter>lid=CALL-ACTION-TYPE</listFilter>
							<storedQuery>common.getSwList</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnBrowseProfile</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>6</index>
						<caption>...</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>400</top>
							<left>1040</left>
							<right>1066</right>
							<bottom>421</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<commands>-1</commands>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_fixcodedescription</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>7</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>400</top>
							<left>680</left>
							<right>1039</right>
							<bottom>418</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>false</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>Resolution 1 -&gt; Resoltuon 2</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>CaptionPanel3</name>
						<type>CaptionBar</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>true</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>8</index>
						<caption>Options</caption>
						<backgroundColor>#f1f1f1</backgroundColor>
						<foregroundColor>#003366</foregroundColor>
						<font  size="10" bold="1">Trebuchet (MS)</font>
						<alignment>Left</alignment>
						<fillStyle>Vertical Gradient</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>250</top>
							<left>1080</left>
							<right>1234</right>
							<bottom>423</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<backgroundColor2>#d8d8d8</backgroundColor2>
							<imageHSpace>10</imageHSpace>
							<slope>12</slope>
							<borderColor>#d3c9b6</borderColor>
							<headerHeight>23</headerHeight>
							<hasBorder>1</hasBorder>
							<panelBorderColor>#d3c9b6</panelBorderColor>
							<fillStyle>0</fillStyle>
							<panelBackgroundColor>#f2eedd</panelBackgroundColor>
							<panelBackgroundColor2>#000000</panelBackgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_emailcustomer</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>9</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>300</top>
							<left>1080</left>
							<right>1196</right>
							<bottom>319</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>1</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>E-mail customer^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_updatepublic</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>10</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>280</top>
							<left>1080</left>
							<right>1209</right>
							<bottom>298</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>1</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>Update to be public^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_chargeable</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>11</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>320</top>
							<left>1080</left>
							<right>1221</right>
							<bottom>338</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>1</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>Call to be chargeable^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<defaultValue>0</defaultValue>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_addKBase</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>12</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>340</top>
							<left>1080</left>
							<right>1222</right>
							<bottom>359</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>0</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>Add to KnowledgeBase^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_customersurvey</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>13</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>380</top>
							<left>1080</left>
							<right>1238</right>
							<bottom>401</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>0</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>Send customer survey:^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>cb_surveys</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>14</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>400</top>
							<left>1080</left>
							<right>1210</right>
							<bottom>418</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Pick List</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<useDDPickList>false</useDDPickList>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Rect1</name>
						<type>Rectange</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>true</toolbarButtonStyle>
							<cache>true</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>15</index>
						<backgroundColor>#d4d0c8</backgroundColor>
						<foregroundColor>#dddddd</foregroundColor>
						<font  size="0"/>
						<borderStyle>Rectangle</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>220</top>
							<left>670</left>
							<right>1236</right>
							<bottom>245</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>cb_callaction</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>16</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>3-D Sunken</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>230</top>
							<left>740</left>
							<right>887</right>
							<bottom>246</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Pick List</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>true</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<useDDPickList>false</useDDPickList>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>Close Call</displayColumnValue>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<listItems>Close Call|Resolve Call|Close Call|Resolve Call|</listItems>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnGetProfileText</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>17</index>
						<caption>Get Profile Text</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#0000ff</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>430</top>
							<left>1120</left>
							<right>1212</right>
							<bottom>451</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Tab1</name>
						<type>TabControl</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>18</index>
						<caption>Tab1</caption>
						<backgroundColor>#ded7ce</backgroundColor>
						<foregroundColor>#ffffff</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>460</top>
							<left>680</left>
							<right>1226</right>
							<bottom>641</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<tabStyle>Top</tabStyle>
					<tabSize>19</tabSize>
					<items>
						<item>
							<name>Description</name>
							<properties>56=#d1e0ee|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#d1e0ee</tabColor>
								</properties>
							</controlInfo>
						</item>
						<item>
							<name>File Attachment</name>
							<properties>56=#ffcc66|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#ffcc66</tabColor>
								</properties>
							</controlInfo>
						</item>
						<item>
							<name>Support Units</name>
							<properties>56=#bdcd9f|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#bdcd9f</tabColor>
								</properties>
							</controlInfo>
						</item>
					</items>
					<selectedTextFont  size="8">Arial</selectedTextFont>
					<selectedTextColor>#000000</selectedTextColor>
					<deselectedTextColor>#000000</deselectedTextColor>
					<tabSlopeLeft>2</tabSlopeLeft>
					<tabSlopeRight>2</tabSlopeRight>
					<deselectedTabHeightOffset>1</deselectedTabHeightOffset>
					<tabSpacing>0</tabSpacing>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<tabStyle>0</tabStyle>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fl_attachments</name>
						<type>FileListTable</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
							<showHeader>true</showHeader>
							<verticalGridLines>true</verticalGridLines>
							<horizontalGridLines>true</horizontalGridLines>
							<autoLoad>true</autoLoad>
							<allowMultiSelect>true</allowMultiSelect>
						</flags>
						<group>Tab1:1</group>
					</general>
					<appearance>
						<index>19</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>488</top>
							<left>688</left>
							<right>1146</right>
							<bottom>632</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<columns>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>File Name</name>
							<width>160</width>
							<image>-1</image>
							<dataColumn>0</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Size</name>
							<width>80</width>
							<image>-1</image>
							<dataColumn>1</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Last Modified</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>2</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Full Local Path</name>
							<width>100</width>
							<image>-1</image>
							<dataColumn>3</dataColumn>
						</controlInfo>
					</columns>
					<sortColumn>2</sortColumn>
					<sortDescending>false</sortDescending>
					<headerHeight>16</headerHeight>
					<rowHeight>16</rowHeight>
					<selectedColor>#00008b</selectedColor>
					<selectedTextColor>#ffffff</selectedTextColor>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<content>NAME=css-bug-raising.gif;PATH=C:\Documents and Settings\NeilWJ\My Documents\css\css-bug-raising.gif;SIZE=18746;LASTMODIFIED=1091525370</content>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnAddFile</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Tab1:1</group>
					</general>
					<appearance>
						<index>20</index>
						<caption>Add</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>488</top>
							<left>1155</left>
							<right>1219</right>
							<bottom>512</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<commands>74</commands>
							<eventButtonIcon>74</eventButtonIcon>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnRemove</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Tab1:1</group>
					</general>
					<appearance>
						<index>21</index>
						<caption>Remove</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>518</top>
							<left>1155</left>
							<right>1219</right>
							<bottom>542</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>22</index>
						<caption>Action Source</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>320</top>
							<left>680</left>
							<right>753</right>
							<bottom>332</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udsource</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>LabelCode</name>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>23</index>
						<caption>Action Type</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>320</top>
							<left>900</left>
							<right>966</right>
							<bottom>332</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udcode</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Text1</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>24</index>
						<caption>Date/Time of Action</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>280</top>
							<left>680</left>
							<right>792</right>
							<bottom>294</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Label2</name>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>25</index>
						<caption>Time Spent</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>280</top>
							<left>900</left>
							<right>964</right>
							<bottom>294</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.timespent</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>ResolProfile</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>26</index>
						<caption>Resolution Profile</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>380</top>
							<left>680</left>
							<right>880</right>
							<bottom>394</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnAddFile</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>true</toolbarButtonStyle>
							<cache>true</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>27</index>
						<caption>Attach File</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>230</top>
							<left>1120</left>
							<right>1216</right>
							<bottom>253</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<commands>74</commands>
							<eventButtonIcon>74</eventButtonIcon>
							<backgroundColor>#ff9900</backgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>LabelAction</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>28</index>
						<caption>Call Action:</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>230</top>
							<left>680</left>
							<right>742</right>
							<bottom>247</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_fixcode</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>29</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>3-D Sunken</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>290</top>
							<left>1010</left>
							<right>1039</right>
							<bottom>307</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>opencall.fixcode</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>false</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>RSLT-RSLT</displayColumnValue>
						<properties>
							<content>#eeeeee</content>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>cp_summary1</name>
						<type>CaptionBar</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>true</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>30</index>
						<caption>Other information</caption>
						<backgroundColor>#f1f1f1</backgroundColor>
						<foregroundColor>#003366</foregroundColor>
						<font  size="10" bold="1">Trebuchet (MS)</font>
						<alignment>Left</alignment>
						<fillStyle>Vertical Gradient</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>430</top>
							<left>680</left>
							<right>1234</right>
							<bottom>646</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<backgroundColor2>#d8d8d8</backgroundColor2>
							<imageHSpace>10</imageHSpace>
							<slope>12</slope>
							<borderColor>#d3c9b6</borderColor>
							<headerHeight>23</headerHeight>
							<hasBorder>1</hasBorder>
							<panelBorderColor>#d3c9b6</panelBorderColor>
							<fillStyle>0</fillStyle>
							<panelBackgroundColor>#f2eedd</panelBackgroundColor>
							<panelBackgroundColor2>#000000</panelBackgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_ftf</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>31</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>360</top>
							<left>1080</left>
							<right>1222</right>
							<bottom>379</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>opencall.flg_firsttimefix</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>First time fix achieved^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Text3</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Tab1:2</group>
					</general>
					<appearance>
						<index>32</index>
						<caption>Associated Support Contract</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>488</top>
							<left>698</left>
							<right>849</right>
							<bottom>511</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>lb_supp_contract</name>
						<type>Field</type>
						<group>Tab1:2</group>
					</general>
					<appearance>
						<index>33</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>488</top>
							<left>855</left>
							<right>1017</right>
							<bottom>508</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Pick List</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<useDDPickList>false</useDDPickList>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<borderColor>#d3c9b6</borderColor>
							<image>#eeeeee</image>
							<sqlSource>syscache</sqlSource>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Text2</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Tab1:2</group>
					</general>
					<appearance>
						<index>34</index>
						<caption>Available Support Units</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>513</top>
							<left>732</left>
							<right>849</right>
							<bottom>535</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_avail_units</name>
						<type>Field</type>
						<group>Tab1:2</group>
					</general>
					<appearance>
						<index>35</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>513</top>
							<left>855</left>
							<right>1017</right>
							<bottom>533</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>true</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>false</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<borderColor>#d3c9b6</borderColor>
							<image>#eeeeee</image>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Text4</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Tab1:2</group>
					</general>
					<appearance>
						<index>36</index>
						<caption>Units Spent On This Call</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>536</top>
							<left>710</left>
							<right>849</right>
							<bottom>560</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_units_assigned</name>
						<type>Field</type>
						<group>Tab1:2</group>
					</general>
					<appearance>
						<index>37</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>538</top>
							<left>855</left>
							<right>1017</right>
							<bottom>558</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>opencall.support_unit_cost</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<borderColor>#d3c9b6</borderColor>
							<image>#eeeeee</image>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<defaultValue>0</defaultValue>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Text5</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>38</index>
						<caption>The option to &quot;Show Resolve/Close Details tab&quot; is disabled by default within the Data Dictionary.</caption>
						<backgroundColor>#000000</backgroundColor>
						<foregroundColor>#ff0000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>13</top>
							<left>16</left>
							<right>538</right>
							<bottom>44</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor2>#000000</backgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Text6</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>39</index>
						<caption>Please use &quot;Log &amp; Resolve/Close&quot; action through the &quot;Actions&quot; menu or button to achieve this functionality.</caption>
						<backgroundColor>#000000</backgroundColor>
						<foregroundColor>#ff0000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>34</top>
							<left>16</left>
							<right>544</right>
							<bottom>65</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor2>#000000</backgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Rect2</name>
						<type>Rectange</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>40</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="0"/>
						<borderStyle>Rectangle</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>13</top>
							<left>13</left>
							<right>535</right>
							<bottom>66</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
			</controls>
			<formActions>
			</formActions>
			<javascript>
				<methods>
					<method>
						<name>OnFormLoaded</name>
						<code>
							<![CDATA[OnFormLoaded()
{
	
	//-- set up the form mode
	_swdoc.setup_form_mode();
	
	//-- set updatetime	
	_swdoc.updatedb.updatetimex = app.global.GetCurrentEpocTime();			
	_swdoc.UpdateFormFromData();
	
	var boolShow =dd.GetGlobalParamAsString("Application Settings/SupportExternalCompanies")==1;
	mainform.Tab1.ShowTabItem(2,boolShow);
	if(boolShow)
	{
		_swdoc.setup_support_unit_assignment();
	}

		
}]]>
						</code>
					</method>
					<method>
						<name>btnBrowseProfile_OnPressed</name>
						<code>
							<![CDATA[btnBrowseProfile_OnPressed()
{
	//-- get resolution profile filter
	
	//-- NWJ - 29.06.2006 - get close filter or resolve filter depending on call closure option (requested by Dan 47766)
	if (cb_callaction.text == "Resolve Call")
	{
		var Filter = dd.GetGlobalParamAsString("Close Call Form/ResolveProfileFilter");
	}
	else
	{
		var Filter = dd.GetGlobalParamAsString("Close Call Form/ProfileCodeFilter");
	}
	
	var objPC = new ChooseProfileCodeDialog;
	//-- default analyst permission to auto fill the resolution text on resolve/close call is set

    objPC.useDescriptionText =  app.session.IsDefaultOption(ANALYST_DEFAULT_AUTOFILLRESOLUTIONTEXT); 
    objPC.Open(true, true, _swdoc.opencall.fixcode, Filter, function(pc)
    {
     	if(!pc)
     		return;
     		
     	//-- Get the fix code and split it into an array
        var strCodeDesc = pc.codeDescription;
        var strCode = pc.code;
        
        //-- If no codes are found then stop
        if((strCode=="")||(strCode==_swdoc.opencall.fixcode)) return;
        
        //-- Set the text in the resolution profile text box
        //-- 08.02.2007 - NWJ - set the opencall record value instead of the element name 
		_swdoc.opencall.fixcode = strCode;   
		_ete(tb_fixcode,strCode);
		_ete(tb_fixcodedescription,strCodeDesc);
        
        //-- Attempt to add the resolution profile description to the Action Description box if the
        //-- default analyst permission to auto fill the resolution text on resolve/close call is set
        if(pc.useDescriptionText)
        {
        	//-- 08.02.2007 - NWJ - set the opencall record value instead of the element name 
        	var strCurrentUpdateText = _swdoc.updatedb.updatetxt;           	
        	if(pc.description.length)
        	{
        		//if(tb_updatetext.text.length)
        		if(strCurrentUpdateText.length)
				{
					var Message = "You have chosen to transfer the default profile text into the description field of the close call form. However, you have already entered some text into this field. Do you want to append the text you have typed?\n\nTo append the default text to the text you have already typed, click Yes\nTo transfer the default text and overwrite what you have already typed, click No\nTo ignore the default text and leave the text you have typed alone, click Cancel";
					switch(MessageBox(Message, MB_ICONQUESTION | MB_YESNOCANCEL))
					{
					case IDYES:
						if(_swdoc.updatedb.updatetxt.length)
						{
							 //-- add a line feed
							 strCurrentUpdateText += "\r\n";
							 //tempText = _swdoc.updatedb.updatetxt + "\r\n"; 
						}
						strCurrentUpdateText += pc.description;
						break;
					case IDNO:
						strCurrentUpdateText = pc.description;
						break;
					case IDCANCEL:
						break;
					}
				}
				else
				{
					strCurrentUpdateText = pc.description;
				}
        	}
        	
        	//-- add back to update record
        	_swdoc.updatedb.updatetxt = strCurrentUpdateText;
        }
        _swdoc.UpdateFormFromData();
        	
		//-- if we are working with webclient
		if(app.bWebClient)
		{
			_een(btnGetProfileText,false);
		}
		else
		{
		   	//-- enable / disable button if it has text
		   	_een(btnGetProfileText,(pc.description!=""));
        	
		}
    });
}]]>
						</code>
					</method>
					<method>
						<name>btnAddFile_OnPressed</name>
						<code>
							<![CDATA[btnAddFile_OnPressed()
{
	//-- add files
	//fl_attachments.newFile = InvokeCallAttachmentFileDialog();
	fl_attachments.AddFiles();

}]]>
						</code>
					</method>
					<method>
						<name>btnRemove_OnPressed</name>
						<code>
							<![CDATA[btnRemove_OnPressed()
{
	// -- remove selected files
	for(i=fl_attachments.rowCount()-1; i>=0;i--)
    {
    	if(fl_attachments.IsRowSelected(i))
    	{
    		//-- remove
    		fl_attachments.RemoveRow(i);
    	}
    }

}]]>
						</code>
					</method>
					<method>
						<name>btnGetProfileText_OnPressed</name>
						<code>
							<![CDATA[btnGetProfileText_OnPressed()
{
	if(_swdoc.updatedb.updatetxt.length)
	{
		if(MessageBox("If you retrieve the default text description from the profile database you will overwrite the current Action Description text.\n\nDo you wish to continue?", MB_ICONQUESTION | MB_YESNO) != IDYES)
		return;
	}
	
	//-- get resolution profile description	
	var currentResProfileDesc = app.global.GetResolutionProfileDescription(_swdoc.opencall.fixcode);
	_swdoc.updatedb.updatetxt = currentResProfileDesc.strDescription;
	_swdoc.UpdateFormFromData();
}]]>
						</code>
					</method>
					<method>
						<name>checkCustomerSurvey_OnValueChanged</name>
						<code>
							<![CDATA[checkCustomerSurvey_OnValueChanged(strValue)
{
	var bChecked = checkCustomerSurvey.text == "1";
	_een(Surveys , bChecked);
}]]>
						</code>
					</method>
					<method>
						<name>(User Defined Functions)</name>
						<code>
							<![CDATA[
//-- function to check that user has selected correct number of profile codes
function check_profile_levels()
{
	//-- get the number of profile levels the analyst HAS to choose
	var nLevelNeeded = app.session.GetCloseProfileLevelRequired();

	//-- determine the number of Profile levels the user has selected
	//-- NWJ - can we turn this into a app.global.i.e. app.global.returnProfileLevelCount(strProfileCode);
	var strTempProfileCodes = new String(_swdoc.opencall.fixcode);
	var nLevels = 0;
	while(strTempProfileCodes.indexOf('-') != -1)
	{
		nLevels++;
		strTempProfileCodes = strTempProfileCodes.substr((strTempProfileCodes.indexOf('-')+1),strTempProfileCodes.length);
	}
	
	if(strTempProfileCodes.length)nLevels++;
	
	//-- If insufficient profile levels are specified then alert the user
	if(nLevels < nLevelNeeded)
	{
		MessageBox("You must profile this call resolution. Your access control rights require you to choose at least " + nLevelNeeded + " profile level(s)", MB_ICONSTOP);
		return false;
	}
	
	return true;
}

//-- add call to kbase
function add_call_to_knowledgebase(nFirstCallref)
{
	var strProbText = "";
	var strProbCode = "";
	//-- get the problem text and problem code from updatedb/opencall
	
	var aRSInfo = new SqlQuery;
	var strParams = "crf="+pfu(nFirstCallref);
	var aRSInfo = app.g.get_sqrecordset("form/resolvecloseform/get_details_for_kb",strParams);
	if(aRSInfo.Fetch())
	{
		strProbText = aRSInfo.GetValueAsString(0);
		strProbCode = aRSInfo.GetValueAsString(1);		
	}
	aRSInfo.Reset();	
	
	//-- call api
	//MessageBox("Add KB " + _swdoc.updatedb.updatetxt)
   	app.global.AddResolutionToKnowledgeBase(strProbText, strProbCode, _swdoc.updatedb.updatetxt, _swdoc.opencall.fixcode, nFirstCallref);
}

//-- resolve or close the call
function ResolveClose(intLoggedCallref)
{	
	//-- validate the form
	if(!_swdoc.ValidateForm())return false;
	
	//-- check profile levels
	if(!mainform.check_profile_levels())return false;
		
	//-- determine status
	var nStatus = CS_CLOSED;
	if(!_swdoc.boolClosing)
	{
		nStatus = CS_RESOLVED;
	}
	else
	{
		//-- closing and chargeable?
		if(flg_chargeable.text == "1")	nStatus = CS_CLOSEDCHARGABLE;
	}
		
	//-- handle web client - any reason for this ??
	if((app.bWebClient && app.global==undefined)&&(_swdoc.boolClosing))
	{
	 	nStatus = CS_CLOSED;
	 	_ete(flg_chargeable,"0");
	}	

	//-- create a new HD connection and connection
	var hdcon = new HelpdeskSession;
	if(!hdcon.Connect())return false;

	//-- check if we are sending a survey
	var bSendSurveyToCustomer = false;
	var SurveyID = 0;
	var SurveyName = "";
	if(app.global.IsSurveyModuleEnabled() && flg_customersurvey.text == "1" && cb_surveys.text.length)
	{
		//-- get surveyid from the SurveyNameSurvIdMap
		SurveyName = cb_surveys.text;		
		SurveyID = _swdoc.arrSurveyNameSurvIDs[SurveyName]; 
		if(SurveyID!=undefined)bSendSurveyToCustomer = true;
	
		//-- send survey request to the server			
		if (bSendSurveyToCustomer)
		{
			hdcon.SendCustomerSurvey(SurveyID, intLoggedCallref);
		}
	}
		

	//-- NWJ - 08.02.2007 - We might want to update call values before closing i.e. for customisation
	//-- update opencall fields - we need to do this by looping through form elements	
	//-- problem is BeginCallValueUpdates doesnt accept multiple callrefs so have to do a call update per callref
	var arrUpdateCallValues = new Array();
	var boolCallUpdates = false;
	var rec = _swdoc.GetRecord("opencall");			
	if(rec)
	{
		var nColCount = rec.GetCount();
		for(x=0; x<nColCount; x++)
		{
			if(!rec.IsModified(x))continue;
			boolCallUpdates = true;
			arrUpdateCallValues[rec.GetColumnName(x)] = rec.GetValue(x);
		}

		
		//-- if we have opencall values to update
		if(boolCallUpdates)
		{
			//-- start to update this call
			if(hdcon.BeginCallValueUpdates(intLoggedCallref,"On ResolveClose Call"))
			{
				//-- for each opencall field that needs updating send
				for (fieldName in arrUpdateCallValues)
				{
					hdcon.SendValue("opencall." + fieldName, arrUpdateCallValues[fieldName]);
				}
        		hdcon.Commit();					
			}
		}
	}
	
	//-- We start a new transaction to update the specified call (complex req)
	if(hdcon.BeginCloseCall(intLoggedCallref))
	{   
    	var bSendSuccess = true;
    	
       	//-- send update db values
		var rec = _swdoc.GetRecord("updatedb");			
		if(rec)
		{
			var nColCount = rec.GetCount();
			for(x=0; x<nColCount; x++)
			{
				//-- if not modified then continue
				if(!rec.IsModified(x))continue;
				//-- send the false
				if(!hdcon.SendValue("updatedb." + rec.GetColumnName(x), rec.GetValue(x)))
				{
					bSendSuccess = false;
					break;
				}
			}
		}
	
		//-- if send of info worked  			
    	if(bSendSuccess && hdcon.SendNumber("status", nStatus) && 
			hdcon.SendText("updatetxt", tb_updatetext.text) &&    				
			hdcon.SendText("fixcode", tb_fixcode.text) &&    	
	 		hdcon.SendNumber("backdateperiod", _swdoc.nBackdatePeriod) &&
	   		hdcon.SendBoolean("publicupdate", flg_updatepublic.text) &&
	   		hdcon.SendBoolean("delaycacheflush", flg_emailcustomer.text) &&
	   		hdcon.SendNumber("timespent", mainform.tb_timespent.value))
		{
		
			//-- send attachments
			for(i=0; i<fl_attachments.rowCount();i++)
		    {
    			if(!hdcon.SendFile("attach", fl_attachments.GetItemText(i,0), fl_attachments.GetItemText(i,3)))
    				return false;
    		}
    			
    		//-- commit our data send
    		if(hdcon.Commit())
    		{
    			//-- failed HD
    			if(!hdcon.GetResult()) return false;
    					
    			//-- The returned data is in the format "updateref=<callref>.<udindex>"
    			//-- The following regex will put the callref into arrCallInfo[1] and the udindex
    			//-- into arrCallInfo[2]
    			var arrCallInfo = hdcon.GetCallUpdateResultData();	
    			
    			// If we have been invoked to update a call from an e-mail message, this update will 
					// only relate to a single call. We can only handle e-mail audit trail if we are working
					// on a single-call update.
					if(_swdoc._form["messagesource"] && 	// Are we woring from an e-mail message?
						dd.GetGlobalParamAsNumber("Email Audit Trail/StoreEmailAuditTrail")) // Are we configured?
					{
						// The message source string contains the "mailbox name\message id". We need 
						// to split these out for the following function
						var arrMsgInfo = _swdoc._form["messagesource"].split('\\');
						
						// Check config to see if we need to include the file attachments in the message too
						var bIncludeAttachments = dd.GetGlobalParamAsNumber("Email Audit Trail/IncludeAttachmentsInMessage");
						
						// We need to specify the folder to which the message should be moved to based
						// on the options set in the DD. 
						var strMoveMessageToFolder = "";
												
						// Next, see if we have specified a specific folder to move the message to
						strMoveMessageToFolder = dd.GetGlobalParamAsString("Mail Move Folders/CloseCallMailFolder");
						
						if (strMoveMessageToFolder.length == 0)
						{
							// First we see if the config tells us to move the message to the deleted items folder
							if(dd.GetGlobalParamAsNumber("Email Audit Trail/MoveToDeletedItems"))
							{
								strMoveMessageToFolder = "Deleted Items";
							}
						}
						
						
						// As we are going to use the Email Subject in the name of the audit trail file we are saving
						// we need to check it for characters that are invalid in a filename and replace them with "-"
							var strEmailSubject = "";
							if(_swdoc._form["subject"])
							{
								strEmailSubject = replaceIllegalFileCharacters(_swdoc._form["subject"]);
							}
						
						// The following function does a number of things. It tells the server to encode
						// and attach the specified message to the call. It sets the state icon of the 
						// call update to "mail-received" in this instace. If the strMoveMessageToFolder
						// contains a valid folder, it will move the specified mail message to the folder
						if(!app.global.AttachMessageToCall(arrMsgInfo[0], 								// Mailbox name
												arrMsgInfo[1], 								// Message ID
												"Received-" + strEmailSubject + ".swm", 	// File name
												intLoggedCallref, 							// Call reference
												arrCallInfo[intLoggedCallref],				// UdIndex
												"mail-received",							// Indicate that this is a received message
												bIncludeAttachments,						// Include File attachments?
												strMoveMessageToFolder))					// Move the message to this folder
						{
				    		MessageBox("There was an error attaching the originating e-mail to this call.");
						}
						else
						{
							app.global.CloseMailMessageWindow(arrMsgInfo[1]);
						}
				    }

    			
       			//-- add knowledge base	but only if we have one call
    			if(flg_addKBase.text == "1")
    			{
    				add_call_to_knowledgebase(intLoggedCallref);
    			}
    			    			
							
				//-- if we want to send an email to the customer AND there are file attachments, obtain the 
    			//-- attachments to attach to the email as well	
				if(mainform.flg_emailcustomer.value && app.global.IsConnectedToMailServer())
   				{
    				//-- OK, we are going to send the customer(s) an e-mail message to confirm the 
					//-- call closure. If we have uploaded file attachments, we can ask the session
					//-- for a list of the files. If available, the session variables will include
					//-- a _serverpath variable for each file. The returned list, is a list of 
					//-- strings that is suitable for passing to the compose message function	
					app.global.ComposeCallUpdateEmail(arrCallInfo,			//Array: Call Reference-UdIndex
														tb_updatetext.text, 		//Message Text
														hdcon.GetSessionFileInfo(), //File Attachments
														tb_timespent.text,			//Time spent on Last Action
														"CloseCallMailTemplate", 	//Template Name
														TEMPLATE_CLOSECALL );		//Template Type
				}
				    
    			hdcon.Close();	
    			_swdoc.boolFormFieldChanged = false;		
				_swdoc.resetData();    			
    			_swdoc.CloseForm();
    			return true;	
    		}
		    else
		    {
		    	MessageBox(hdcon.GetLastErrorStr());
		    }//-- if(hdcon.Commit())
		}
		else
		{
		    	MessageBox(hdcon.GetLastErrorStr());
		}//-- if send of info worked  			
	}
	
	//-- if we got here we failed
	hdcon.Close();
	return false;
}

function getReadableDatefromEpoch(dt_epochdate)
{
	var strFormattedDate = "";
	var theDate = new Date(dt_epochdate);
	dateString = theDate.toString();
	arrDateStr = dateString.split(" ");
	strFormattedDate = arrDateStr[2] + "/" + getNumericMonth(arrDateStr[1]) + "/" + arrDateStr[3] + " " + arrDateStr[4].substr(0,2) + ":";
	strFormattedDate += arrDateStr[4].substr(3,2) + ":" + arrDateStr[4].substr(6,2);
	return strFormattedDate;
}

function getNumericMonth(strMonth)
{
	var arrMonth = new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");
	for(i=0; i<arrMonth.length; i++)
	{
		if(strMonth == arrMonth[i])
			return i+1;
	}
}

function replaceIllegalFileCharacters(strText)
{
	//-- This function is used to replace characters in the passed in string that 
	//-- are not suitable for use in filenames and return the modified string 
	
	strOutput = strText;
	strReplacement = "-";
	var i = 0;
	
	while(i < strOutput.length)
	{
		strOutput = strOutput.replace('/', strReplacement);
		strOutput = strOutput.replace(':', strReplacement);
		strOutput = strOutput.replace('*', strReplacement);
		strOutput = strOutput.replace('?', strReplacement);
		strOutput = strOutput.replace('"', strReplacement);
		strOutput = strOutput.replace('\'', strReplacement);
		strOutput = strOutput.replace('<', strReplacement);
		strOutput = strOutput.replace('>', strReplacement);
		
		i++;
	}
	
	return strOutput;
}]]>
						</code>
					</method>
					<method>
						<name>cb_callaction_OnValueChanged</name>
						<code>
							<![CDATA[cb_callaction_OnValueChanged(strValue)
{
	//-- set mode and then setup defaults for that mode
	_swdoc.boolClosing = (strValue!="Resolve Call");
	_swdoc.setup_charge_flag(false);

}]]>
						</code>
					</method>
					<method>
						<name>flg_customersurvey_OnValueChanged</name>
						<code>
							<![CDATA[flg_customersurvey_OnValueChanged(strValue)
{
	//-- enable disable
	var bChecked = flg_customersurvey.text == "1";
	_een(cb_surveys,bChecked);

}]]>
						</code>
					</method>
					<method>
						<name>OnFieldValueChanged</name>
						<code>
							<![CDATA[OnFieldValueChanged(strName, strValue)
{
	//-- This value is set when a field value has been changed.
	//-- We check this variable on from closing to see if there are any data changes that need to be saved.
	_swdoc.boolFormFieldChanged = true;


}]]>
						</code>
					</method>
					<method>
						<name>dt_actiontime_OnValueChanged</name>
						<code>
							<![CDATA[dt_actiontime_OnValueChanged(strValue)
{

	//-- NWJ - 09.02.2007 - Back date call
	var nBackdatePeriod = 0;
	
	//--Calculate the BackDate Period
    var currentTime	= app.global.GetCurrentEpocTime() ;
	var updateDateTime = dt_actiontime.text;
	nBackdatePeriod = currentTime - updateDateTime;
			
	//-- If attempted to forward date then deny
	if(nBackdatePeriod < 0)
	{
		MessageBox("You have attempted to forward date this call update which is not allowed.");
		nBackdatePeriod=0;	
	}
	else
	{
	
		//-- If backdate period > the analyst max backdate period then prompt to use current time or cancel
		if(nBackdatePeriod > app.session.GetMaxBackdatePeriodAllowed())
		{
			var dTime	= new Date();
			dTime = (currentTime - app.session.GetMaxBackdatePeriodAllowed()) * 1000;
			var message = "You have attempted to backdate this call update further than you have sufficient privileges to do so.\n\nDo you want to use the oldest date/time that you are allowed: ";
			if(MessageBox(message + mainform.getReadableDatefromEpoch(dTime), MB_ICONQUESTION | MB_YESNO) != IDYES)	
			{
				nBackdatePeriod = 0;
			}
			else
			{
				//-- update field
				nBackdatePeriod = app.session.GetMaxBackdatePeriodAllowed();
				_swdoc.updatedb.updatetimex = app.global.GetCurrentEpocTime() - nBackdatePeriod;				
			}
		}
	}		
	
	//Set the _swdoc level variable for use in the resolve/close and return true
	if(nBackdatePeriod==0)
	{
		_swdoc.updatedb.updatetimex = app.global.GetCurrentEpocTime();	
	}
	
	_swdoc.nBackdatePeriod = nBackdatePeriod;
	_swdoc.UpdateFormFromData();
	
}]]>
						</code>
					</method>
					<method>
						<name>lb_supp_contract_OnValueChanged</name>
						<code>
							<![CDATA[lb_supp_contract_OnValueChanged(strValue)
{
	// TODO: Add your event handler code here
	//-- Lookup units available for selected contract
	if(strValue!="")
	{
		_swdoc.get_support_units_available(_swdoc.arrContractNameIDs[strValue], mainform.tb_avail_units);
	}
	else
	{
		_eva(mainform.tb_avail_units,0);
	}

}]]>
						</code>
					</method>
					<method>
						<name>Tab1_OnTabSelected</name>
						<code>
							<![CDATA[Tab1_OnTabSelected(nTab)
{
	if(nTab==2)
		_swdoc.setup_support_unit_assignment();
}]]>
						</code>
					</method>
					<method>
						<name>OnShowWindow</name>
						<code>
							<![CDATA[OnShowWindow(bShow)
{
	// TODO: Add your event handler code here

	if(bShow)
	{
		if(mainform.Tab1.tab==2)
		{
			Tab1_OnTabSelected(2);
		}
	}
	
}]]>
						</code>
					</method>
					<method>
						<name>tb_units_assigned_OnValueChanged</name>
						<code>
							<![CDATA[tb_units_assigned_OnValueChanged(strValue)
{
	// TODO: Add your event handler code here
	_swdoc.boolConfirmSupportUnits = true;

}]]>
						</code>
					</method>
				</methods>
			</javascript>
		</layout>
		<layout>
			<appearance>
				<width>360</width>
				<height>220</height>
				<backgroundColor>#ffffff</backgroundColor>
				<fillColour>#ffffff</fillColour>
				<textColour >#000000</textColour >
				<font  size="8">Arial</font>
			</appearance>
			<controls>
			</controls>
			<formActions>
			</formActions>
			<javascript>
				<methods>
				</methods>
			</javascript>
		</layout>
	</layouts>
</espForm>
