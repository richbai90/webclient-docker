{"espForm":{"configuration":{"settings":{"name":"EfDepartment","title":"Department","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"department","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var boolInserting = false;\nvar strComanyID = \"\";\nvar strDeptID = \"\";\n\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction oDept()\n{\n\treturn _swdoc.department;\n}\n\nfunction setup_dept_form(bDataReloaded)\n{\n\t_swdoc.strCompanyID = _swdoc.oDept().fk_company_id;\n\t_swdoc.strDeptID = _swdoc.oDept().fk_dept_id;\n\t\n\t\/\/--124775: Only show Subscription actions button if you have writes and you are not inserting\n\t_evi(_swdoc.MF().mb_serv_action, (app.service.can_manage_cost_and_subs(false) && !_swdoc.boolInserting))\n\n}\n\nfunction load_dept_customers(intSelRow)\n{\n\tif(intSelRow==undefined)intSelRow=0;\n\tvar strKeys = app.cfg.get_dept_customers(_swdoc.oDept().pk_dept_code, true, \"\", _swdoc.oDept().fk_cmdb_id);\n\t_slf(_swdoc.MF().sl_contacts ,  \"swc=keysearch&kvs=\" + strKeys);\n\t_swdoc.MF().sl_contacts.SetRowSelected(intSelRow);\t\t\t\t\n\n}"},{"name":"OnDataSaved","code":"OnDataSaved()\n{\n \n\t\/\/ TODO: Add your event handler code here\n   \tif(_swdoc.oDept().fk_company_id!=\"\"){\n       \tvar pDoc = app.g.get_me_document(\"COMPANY\",_swdoc.oDept().fk_company_id);\n    \tif(pDoc)\n    \t{\n    \t\tvar intCurSel = pDoc.MF().sl_depts1.curSel;\n    \t\tpDoc.MF().sl_depts1.Refresh();\n    \t\tpDoc.MF().sl_depts1.SetRowSelected(intCurSel,true);\n    \t}\n\t\n\t\tif(_swdoc.boolInserting)\n\t\t{\n\t\t\t\/\/-- do not delete relationship\n\t\t}\n\t\telse\n\t\t{\n\t\t\t\/\/-- not inserting, and company has changed\n\t\t\tif(_swdoc.strCompanyID!=_swdoc.oDept().fk_company_id)\n\t\t\t{\n\t\t\t\t\/\/-- company has changed\n     \t\t\tapp.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, \"ME->COMPANY\");\n\t\t\t}\t\t\t\n\t\t}\n\t\t\n  \t\t\/\/-- create cmdb relationship\n    \tif(pDoc)\n    \t{\n    \t\t\/\/-- need to reload site record to get fk_cmdb_id\n    \t\t_swdoc.LoadRecordData(\"swdata\", \"Department\", _swdoc.oDept().pk_dept_code);\n    \t\t\n\t\t\t\/\/-- check if have default rel if so form silently ..\n    \t\tvar strRel = \"is department of\";\/\/dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgSiteRelationship\");\n   \t\t\tapp.cmdb.generate_meconfigrelation(pDoc.oCompany().fk_cmdb_id,_swdoc.oDept().fk_cmdb_id,strRel);  \n    \t}\n    \telse\n    \t{\n\t\t\tvar rec = app.g.get_record(\"COMPANY\", _swdoc.oDept().fk_company_id);\n\t\t\tif(rec)\n\t\t\t{\n\t\t\t\tvar fetchKey  = rec.fk_cmdb_id;\n    \t\t\tvar strRel = \"is department of\";\/\/dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgSiteRelationship\");\n  \t\t\t\tapp.cmdb.generate_meconfigrelation(fetchKey,_swdoc.oDept().fk_cmdb_id,strRel);  \n\t\t\t}\n    \t}\n    }\n\telse if(_swdoc.strCompanyID!=_swdoc.oDept().fk_company_id)\n\t{\n\t\t\/\/-- company is now blank, but wasnt previously\n     \tapp.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, \"ME->COMPANY\");\n\t}\n\n  \tif(_swdoc.oDept().fk_dept_id!=\"\"){\n       \tvar pDoc = app.g.get_me_document(\"DEPARTMENT\",_swdoc.oDept().fk_dept_id);\n    \tif(pDoc)\n    \t{\n    \t\t\/\/var intCurSel = pDoc.MF().sl_orgs.curSel;\n    \t\t\/\/pDoc.MF().sl_orgs.Refresh();\n    \t\t\/\/pDoc.MF().sl_orgs.SetRowSelected(intCurSel,true);\n    \t}\n\t\n\t\tif(_swdoc.boolInserting)\n\t\t{\n\t\t\t\/\/-- do not delete relationship\n\t\t}\n\t\telse\n\t\t{\n\t\t\t\/\/-- not inserting, and Dept has changed\n\t\t\tif(_swdoc.strDeptID!=_swdoc.oDept().fk_dept_id)\n\t\t\t{\n\t\t\t\tif(_swdoc.strDeptID!=\"\")\n\t\t\t\t{\n\t\t\t\t\t\/\/-- dept has changed, dept wasnt blank, delete previous relationship\n     \t\t\t\tapp.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, \"ME->DEPARTMENT\");\n     \t\t\t}\n\t\t\t}\t\t\t\n\t\t}\n\n  \t\t\/\/-- create cmdb relationship\n    \tif(pDoc)\n    \t{\n    \t\t\/\/-- need to reload site record to get fk_cmdb_id\n    \t\t_swdoc.LoadRecordData(\"swdata\", \"Department\", _swdoc.oDept().pk_dept_code);\n    \t\t\n \t\t\t\/\/-- check if have default rel if so form silently ..\n    \t\tvar strRel = \"is department of\";\/\/dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgSiteRelationship\");\n   \t\t\tapp.cmdb.generate_meconfigrelation(pDoc.oDept().fk_cmdb_id,_swdoc.oDept().fk_cmdb_id,strRel);  \n    \t}\n    \telse\n    \t{\n\t\t\tvar rec = app.g.get_record(\"DEPARTMENT\", _swdoc.oDept().fk_dept_id);\n\t\t\tif(rec)\n\t\t\t{\n\t\t\t\tvar fetchKey  = rec.fk_cmdb_id;\n    \t\t\tvar strRel = \"is department of\";\/\/dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgSiteRelationship\");\n   \t\t\t\tapp.cmdb.generate_meconfigrelation(fetchKey,_swdoc.oDept().fk_cmdb_id,strRel);  \n\t\t\t}\n    \t\n    \t}\n    \t\t\n\t}\n\telse if(_swdoc.strDeptID!=_swdoc.oDept().fk_dept_id)\n\t{\n     \tapp.cmdb.delete_child_meconfigrelation(_swdoc.oDept().fk_cmdb_id, \"ME->DEPARTMENT\");\n\t}\n\n\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"429","height":"204","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"fld_dept_code","type":"Field","group":"Departments:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"66","left":"139","right":"389","bottom":"84"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.pk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_dept_name","type":"Field","group":"Departments:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"88","left":"139","right":"389","bottom":"106"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.dept_name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_fk_dept_id","type":"Field","group":"Departments:0"},"appearance":{"index":"2","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"110","left":"139","right":"389","bottom":"128"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.fk_dept_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","dropdownButtonType":"1","sqlSource":"swdata","distinctTable":"department","distinctColumn":"pk_dept_code","borderColor":"#c0c0c0","displayColumn":"dept_name","storedQuery":"generic.select"}}},{"general":{"name":"fld_fk_dept_manager","type":"Field","group":"Departments:0"},"appearance":{"index":"3","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"132","left":"139","right":"389","bottom":"150"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.fk_dept_manager"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","dropdownButtonType":"1","sqlSource":"swdata","distinctTable":"userdb","distinctColumn":"keysearch","displayColumn":"fullname","storedQuery":"generic.select"}}},{"general":{"name":"fld_telephone","type":"Field","group":"Departments:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"154","left":"139","right":"389","bottom":"172"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.telephone"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_email","type":"Field","group":"Departments:0"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"176","left":"139","right":"389","bottom":"194"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Departments","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"10","left":"10","right":"425","bottom":"200"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Department Details","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Notes","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}},{"name":"Customers","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}},{"name":"Services","properties":"56=#f09e9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f09e9f"}}},{"name":"Service Level Agreements","properties":"56=#baa6e1|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#baa6e1"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"mb_view1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"7","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"355","right":"418","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"Parent Dependancies^2|Child Dependancies^1|"}}},{"general":{"name":"fld_notes","type":"Field","group":"Departments:1"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"16","right":"418","bottom":"193"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"department.notes"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"sl_contacts","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"Departments:2"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"70","left":"20","right":"410","bottom":"190"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"keysearch"},"name":"Customer ID","width":"104","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"firstname"},"name":"Forename","width":"131","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"surname"},"name":"Surname","width":"125","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"location"},"name":"Location","width":"137","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"email"},"name":"E-Mail","width":"169","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telext"},"name":"Telephone","width":"116","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cmdb_id"},"name":"CMDB ID","width":"120","image":"-1","dataColumn":"6"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"newRecordForm":"Form.TfCustomer","editRecordForm":"Form.TfCustomer","sqlSource":"swdata","table":"userdb","listFilter":"empty=1","storedQuery":"common.load_by_colname"}}},{"general":{"name":"mbtn_contact_view","type":"MenuButton","group":"Departments:2"},"appearance":{"index":"10","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"38","left":"275","right":"340","bottom":"62"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900","commands":"Properties^1|"}}},{"general":{"name":"mbtn_contact_actions","type":"MenuButton","group":"Departments:2"},"appearance":{"index":"11","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"38","left":"345","right":"410","bottom":"62"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"Create New^1|Search && Associate^3|Disassociate^4|Delete^2|Start Remote Support^5|"}}},{"general":{"name":"lb_company1","type":"Field"},"appearance":{"index":"12","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"390","left":"410","right":"660","bottom":"408"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.fk_company_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"company","distinctColumn":"pk_company_id","displayColumn":"companyname","dropdownButtonType":"1","storedQuery":"generic.select"}}},{"general":{"name":"popup_pcompany1","type":"Image"},"appearance":{"index":"13","caption":"&[app.webroot]\/clisupp\/formimages\/itsm\/form.gif","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"ExactSize","borderStyle":"None"},"objectPlacement":{"position":{"top":"390","left":"670","right":"683","bottom":"403"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"popup_pdept","type":"Image","group":"Departments:0"},"appearance":{"index":"14","caption":"&[app.webroot]\/clisupp\/formimages\/itsm\/form.gif","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"ExactSize","borderStyle":"None"},"objectPlacement":{"position":{"top":"110","left":"399","right":"412","bottom":"123"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"popup_pdeptman","type":"Image","group":"Departments:0"},"appearance":{"index":"15","caption":"&[app.webroot]\/clisupp\/formimages\/itsm\/form.gif","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"ExactSize","borderStyle":"None"},"objectPlacement":{"position":{"top":"132","left":"399","right":"412","bottom":"145"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"16","caption":"Fk Company Id","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"390","left":"290","right":"400","bottom":"406"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.fk_company_id"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"CaptionPanel1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"17","caption":"Department Details","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"35","left":"20","right":"419","bottom":"196"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"18","caption":"Department Code","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"66","left":"25","right":"135","bottom":"82"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.pk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"19","caption":"Department Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"88","left":"25","right":"135","bottom":"104"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.dept_name"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"20","caption":"Parent Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"110","left":"25","right":"135","bottom":"126"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.fk_dept_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"21","caption":"Department Manager","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"132","left":"25","right":"135","bottom":"148"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.fk_dept_manager"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"22","caption":"Telephone","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"154","left":"25","right":"135","bottom":"170"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.telephone"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:0"},"appearance":{"index":"23","caption":"Email","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"176","left":"25","right":"135","bottom":"192"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.email"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_services","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"Departments:3"},"appearance":{"index":"24","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"70","left":"20","right":"410","bottom":"190"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"service_name"},"name":"Service Name","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Subscription Type","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Subscription Start Date","width":"140","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cmdb_id"},"name":"fk_cmdb_id","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"New Column","width":"120","image":"-1","dataColumn":"4"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"highlightStyle":"0","borderColor":"#d3c9b6","sqlSource":"swdata","table":"sc_folio","storedQuery":"department.load_services","listFilter":"dept_code=&[department.pk_dept_code]","selectionMode":"1"}}},{"general":{"name":"mb_serv_action","type":"MenuButton","group":"Departments:3"},"appearance":{"index":"25","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"38","left":"345","right":"410","bottom":"62"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"Associate^1|Disassociate^2|View Subscription^3|"}}},{"general":{"name":"sl_defslas","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"Departments:4"},"appearance":{"index":"26","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"62","left":"18","right":"418","bottom":"194"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"callclass"},"name":"Call Class","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_slad_name"},"name":"SLA","width":"114","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_priority"},"name":"Priority","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"pk_auto_id","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_slad"},"name":"fk_slad","width":"120","image":"-1","dataColumn":"4"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#000099","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"itsm_sla_class_matrix","newRecordForm":"Form.tf_rel_sla_class","editRecordForm":"Form.tf_rel_sla_class","storedQuery":"entity.common.class_slas","listFilter":"pk_auto_id = -1"}}},{"general":{"name":"btn_add_class","type":"EventButton","group":"Departments:4"},"appearance":{"index":"27","caption":"Add","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"350","right":"415","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"39423"}}},{"general":{"name":"btn_rem_class","type":"EventButton","group":"Departments:4"},"appearance":{"index":"28","caption":"Remove","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"280","right":"345","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"39423"}}},{"general":{"name":"lbl_sl","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Departments:4"},"appearance":{"index":"29","caption":"Call Class Default SLAs","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"44","left":"21","right":"145","bottom":"58"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n   \/\/-- 26.07.2004\n    \/\/-- NWJ\n    if ((_swdoc.oDept().pk_dept_code == \"\") || (_swdoc.oDept().dept_name == \"\"))\n    {\t\n        \/\/--disable stuff \n        _swdoc.boolInserting=true;\n        _swdoc.oDept().fk_company_id = unescape(_swdoc.GetArg(\"fk_company_id\"));\n        _swdoc.ResetModiedFlag('department');\n        Departments.ShowTabItem(2,false);\n        Departments.ShowTabItem(3, false);\n         Departments.ShowTabItem(4, false);\n        _etab(Departments, 0);\n        _evi(_swdoc.MF().mb_view1, false);\n        \n    }\n    else if (_swdoc.oDept().pk_dept_code != '')\n    {\n  \n    \t\/\/-- load company details\n    \t_swdoc.boolInserting=false;  \t\n    \tDepartments.ShowTabItem(2,true);\n    \t_etab(Departments, 0);\n    }\n   \n\t_swdoc.setup_dept_form(bDataReloaded);\n\n}"},{"name":"lb_company1_OnDropDown","code":"lb_company1_OnDropDown()\n{\n\t\/\/-- DJH - 06.08.07\n\t\/\/-- load company parent browser\n\t\/\/-- Call new style company search form and resolve company if one is selected\n\n\tapp.g.search_for(\"company\",true,\"\",function(oRes)\n\t{\n\t\tif(oRes.selectedkeys==\"\")return;\n\t\n\t\tvar arrKeys = oRes.selectedkeys.split(\",\");\n\t\tvar arrName = oRes.selectedother.split(\",\");\t\n\t\tstrHash = arrKeys[0];\n\t\tstrName = arrName[0];\n\t\tif ((strHash == '') || (strHash == 'none')) return;\n\t\t\t\n\t\t_swdoc.oDept().fk_company_id = strHash;\t\n\t\t_swdoc.oDept().companyname = strName;\t\n\t\t\n\t\t_swdoc.UpdateFormFromData();\t\n\t\treturn false;\n\t});\n}"},{"name":"lb_company1_OnRightClick","code":"lb_company1_OnRightClick()\n{\n\t_swdoc.oDept().fk_company_id = \"\";\t\n\t_swdoc.oDept().companyname = \"\";\t\n\t_ete(lb_company1, \"\");\n\n\treturn false;\n}"},{"name":"popup_pcompany1_OnLeftClick","code":"popup_pcompany1_OnLeftClick()\n{\n\t\/\/-- NWJ\n\t\/\/-- show parent company record\n\tif (_swdoc.oDept().fk_company_id != \"\")\n\t{\n\t\tapp.OpenFormForEdit(\"TfCompany\", _swdoc.oDept().fk_company_id, \"\", true, function(){\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\treturn true;\n\t\t});\n\t}\n\treturn true;\n\t\n}"},{"name":"fld_fk_dept_id_OnDropDown","code":"fld_fk_dept_id_OnDropDown()\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.search_for(\"dept\",true,\"fk_company_id=\"+department.fk_company_id,function(oRes)\n\t{\n\t\tif(oRes.selectedkeys==\"\")return;\n\t\n\t\tvar arrKeys = oRes.selectedkeys.split(\",\");\n\t\tvar arrName = oRes.selectedother.split(\",\");\t\n\t\tstrHash = arrKeys[0];\n\t\tstrName = arrName[0];\n\t\tif ((strHash == '') || (strHash == 'none')) return;\n\t\t\t\n\t\tif(strHash==department.pk_dept_code)\n\t\t{\n\t\t\tMessageBox('Department cannot be parent of itself');\n\t\t\treturn false;\n\t\t}\n\t\t\n\t\t_swdoc.oDept().fk_dept_id = strHash;\t\n\t\t\n\t\t_swdoc.UpdateFormFromData();\t\n\t\treturn false;\n\t});\n}"},{"name":"fld_fk_dept_id_OnRightClick","code":"fld_fk_dept_id_OnRightClick()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.oDept().fk_dept_id = \"\";\t\n\t_ete(fld_fk_dept_id, \"\");\n\n\n\treturn true;\n}"},{"name":"popup_pdept_OnLeftClick","code":"popup_pdept_OnLeftClick()\n{\n\t\/\/-- NWJ\n\t\/\/-- show parent company record\n\tif (_swdoc.oDept().fk_dept_id != \"\")\n\t{\n\t\tapp.OpenFormForEdit(\"EfDepartment\", _swdoc.oDept().fk_dept_id, \"\", true, function(){\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\treturn true;\n\t\t});\n\t}\n\treturn true;\n\t\n}"},{"name":"fld_fk_dept_manager_OnDropDown","code":"fld_fk_dept_manager_OnDropDown()\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strURL = \"canreset=1&fk_company_id=\" + _swdoc.oDept().fk_company_id;\n\tapp.g.search_for(\"customers\",true,strURL,function(oRes)\n\t{\n\t\tif(oRes.selectedkeys==\"\")return;\n\t\t\n\t\tvar arrKeys = oRes.selectedkeys.split(\",\");\n\t\tvar arrName = oRes.selectedother.split(\",\");\t\n\t\tvar arrCMDBIDs = oRes.selectedcmdbids.split(\",\");\n\t\t\t\n\t\t_swdoc.oDept().fk_dept_manager = arrKeys[0];\n\t\t\n\t\t_swdoc.UpdateFormFromData();\t\n\t\treturn false;\n\t});\n}"},{"name":"popup_pdeptman_OnLeftClick","code":"popup_pdeptman_OnLeftClick()\n{\n\t\/\/-- NWJ\n\t\/\/-- show parent company record\n\tif (_swdoc.oDept().fk_dept_manager != \"\")\n\t{\n\t\tapp.OpenFormForEdit(\"tfCustomer\", _swdoc.oDept().fk_dept_manager, \"\", true, function(){\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\treturn true;\n\t\t});\n\t}\n\treturn true;\n\t\n}"},{"name":"sl_contacts1_OnItemSelected","code":"sl_contacts1_OnItemSelected(nRow)\n{\n \t\/\/-- 26.07.2004\n    \/\/-- NWJ\n    \/\/-- Load contact details when selected.\n    var contact_id  = sl_contacts1.GetItemTextRaw(nRow,'keysearch');\n    if (contact_id != \"\")\n    {\n     \n        \/\/-- show the update and delete button\n        _een(mbtn_contact_view1,true);\n    }    \n    else\n    {\n    \n    \tif (sl_contacts1.rowCount() > 0 )\n    \t{\n    \t\tsl_contacts1.SetRowSelected(0);\n    \t\tsl_contacts1_OnItemSelected(0);\n    \t}\n    \telse\n    \t{\n    \t\t_een(mbtn_contact_view1,false);\n        }\n    }\n\n    \n    return;\n\n\n}"},{"name":"sl_contacts1_OnItemDoubleClicked","code":"sl_contacts1_OnItemDoubleClicked(nRow, nCol)\n{\n\t\tsl_contacts1.EditRecord(nRow);\n\t\t_swdoc.load_site_customers(nRow);\n\t\treturn false;\n}"},{"name":"mbtn_contact_view_OnMenuItem","code":"mbtn_contact_view_OnMenuItem(strName, nItemID)\n{\n\tvar iProperties = 1;\n\t\n\tif(nItemID == iProperties)\n\t{\n\t\tsl_contacts.EditRecord(sl_contacts.curSel);\n\t\t_swdoc.load_site_customers(sl_contacts.curSel);\n\t}\n\n\n}"},{"name":"mbtn_contact_actions_OnMenuItem","code":"mbtn_contact_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iNewContact = 1;\n\tvar iDeleteContact = 2;\n\tvar iSearchAdd = 3;\n\tvar iRemove = 4;\n\tvar iSupport = 5;\n\t\n\tif(nItemID == iRemove)\n\t{\n\t\tvar strKey = sl_contacts.GetItemTextRaw(sl_contacts.curSel, 'keysearch');\n\t\tvar intCI = sl_contacts.GetItemTextRaw(sl_contacts.curSel, 'fk_cmdb_id');\n\t\tif(strKey==\"\")return;\n\t\t    \t\t\t\n\t\tif(confirm(\"Are you sure you want to disassociate the selected customer from this site?\"))\n\t\t{\n\t\t\t\/\/-- delete ci relationship (always assume that ME is parent)\n\t\t\tif(_swdoc.oDept().fk_cmdb_id>0)\n\t\t\t{\n\t\t\t\tapp.cmdb.delete_meconfigrelation(_swdoc.oDept().fk_cmdb_id, intCI);\n\t\t\t}   \t\t\n\t\t\t\t\n\t\t\t\/\/-- update userdb where site is this site and is selected customer - using simple sql\n\t\t\tvar p = {};\n\t\t\tp.ks = strKey;\n\t\t\tp.pdc = _swdoc.oDept().pk_dept_code;\n\t\t\tapp.g.submitsimplesql(\"efdepartment.cleardepartment\", p);\n\t\t}\n\t\t\n\t\t_swdoc.load_dept_customers();\n\t\t_swdoc.MF().sl_contacts.Refresh();\n\t}\t\n\telse if(nItemID == iNewContact)\n\t{\n\t\t\/\/-- NWJ\n    \t\/\/-- Open new contact form\n    \t\/\/-- pass in pk_company_auto_id so that we can link the two\n    \tvar strURL = \"fk_company_id=\" + pfu(_swdoc.oDept().fk_company_id) + \"&department=\" + pfu(_swdoc.oDept().pk_dept_code);\n\t\tapp.g.sl_openformforadd(sl_contacts,\"TfCustomer\", strURL, 1,null, function()\n\t\t{\n\t\t\t_swdoc.load_dept_customers();\n\t\t\t_swdoc.MF().sl_contacts.Refresh();\n\t\t});\n\t}\n\telse if(nItemID == iDeleteContact)\n\t{\n\t\t\n\t\t\/\/-- 29.07.2004\n    \t\/\/-- NWJ\n    \t\/\/-- Delete the selected contact\n    \tvar selectedRow     = sl_contacts.curSel;\n    \tvar strConfirm\t\t= \"Are you sure you want to delete this customer from the database ?\";\n    \n\t\tapp.g.sl_deldbrow(sl_contacts,selectedRow,'keysearch',null,strConfirm);\n\t\t_swdoc.load_dept_customers();\n\t\t_swdoc.MF().sl_contacts.Refresh();\n\t}\n\telse if (nItemID == iSearchAdd)\n\t{\n\t\n\t\t\/\/-- show list of company customers, that are not currently linked to this site, that can link to this site\n\t\tvar strURL = \"fk_company_id=\" + pfu(_swdoc.oDept().fk_company_id);\n\t\tapp.g.search_for(\"customers\", true,strURL,function(oData)\n\t\t{\n\t\t\tif (oData.selectedkeys==\"\") return;\n\t\t \t\n\t\t\t\/\/--\n\t\t\t\/\/-- create ci relationship (always assume that customer always uses a CI)\n\t\t\tif(_swdoc.oDept().fk_cmdb_id>0)\n\t\t\t{\n\t\t\t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultDeptCustRelationship\");\n\t\t\t\t\/\/MessageBox(oData.selectedcmdbids +\":\"+_swdoc.oDept().fk_cmdb_id)\n\t\t\t\tapp.cmdb.generate_meconfigrelation(_swdoc.oDept().fk_cmdb_id, oData.selectedcmdbids, strRel);\n\t\t\t}   \t\t\n   \t\t\t\n\t\t\t\n\t\t\tvar p = {};\n\t\t\tp.ks =  oData.selectedpfskeys;\n\t\t\tp.pdc = _swdoc.oDept().pk_dept_code;\n\t\t\tapp.g.submitsimplesql(\"efdepartment.setdepartment\", p);\n\t\t\t\n\t\t\t_swdoc.load_dept_customers();\n\t\t\t_swdoc.MF().sl_contacts.Refresh();\n\t\t\t\t\t\n\t\t\treturn;\n\t\t});\n\t}\n\telse if(nItemID == iSupport)\n\t{\n\n\t\t\/\/-- Remote Support Enabled?\n\t\tif(app.g.remote_support_enabled())\n\t\t{\n\t\t\t\/\/-- Attempt to launch a pinned support session\n\t\t\tvar strEmail = app.g.sl_getrawcolvalue(sl_contacts,-1,\"email\");\n\t\t\tapp.g.start_remote_support(strEmail);\n\t\t}\t\n\t\telse\n\t\t{\n\t\t\tMessageBox(\"Remote Support is not available for this customer\");\n\t\t}\n\t}\n\n\n}"},{"name":"Departments_OnTabSelected","code":"Departments_OnTabSelected(nTab)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(nTab == 2)\n\t{\n\t\t_swdoc.load_dept_customers();\n\t\t_swdoc.MF().sl_contacts.Refresh();\n\t}\n\telse if (nTab == 3)\n\t{\n\t\t_swdoc.MF().sl_services.Refresh();\n\t}\n\telse if (nTab == 4)\n\t{\n\t\t_slf(_swdoc.MF().sl_defslas, \"reltype=DEPT&fk_rel_id=\"+pfu(department.pk_dept_code));\n\t\t_swdoc.MF().sl_defslas.Refresh();\n\t}\n\n}"},{"name":"mb_view1_OnMenuItem","code":"mb_view1_OnMenuItem(strName, nItemID)\n{\n\tif(nItemID==1)\n\t{\n\t\tapp.cmdb.view_vcm(_swdoc.oDept().fk_cmdb_id,false);\n\t}\n\telse if(nItemID==2)\n\t{\n\t\tapp.cmdb.view_vcm(_swdoc.oDept().fk_cmdb_id,true);\n\t}\n\n\n}"},{"name":"sl_contacts_OnItemSelected","code":"sl_contacts_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n    \/\/-- Load contact details when selected.\n    var contact_id  = sl_contacts.GetItemTextRaw(nRow,'keysearch');\n    if (contact_id != \"\")\n    {\n     \n        \/\/-- show the update and delete button\n        _een(mbtn_contact_view, true);\n    }    \n    else\n    {\n    \n    \tif (sl_contacts.rowCount() > 0 )\n    \t{\n    \t\tsl_contacts.SetRowSelected(0);\n    \t\tsl_contacts_OnItemSelected(0);\n    \t}\n    \telse\n    \t{\n    \t\t_een(mbtn_contact_view, false);\n        }\n    }\n\n    \n    return;\n\n\n}"},{"name":"sl_contacts_OnItemDoubleClicked","code":"sl_contacts_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tsl_contacts.EditRecord(nRow);\n\t_swdoc.load_dept_customers(nRow);\n\treturn false;\n}"},{"name":"sl_services_OnItemDoubleClicked","code":"sl_services_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar pk_id  = _swdoc.MF().sl_services.GetItemText(nRow,'fk_cmdb_id');\n\tapp.OpenFormForEdit(\"portfolio\", pk_id,'',false, function(){});\n}"},{"name":"mb_serv_action_OnMenuItem","code":"mb_serv_action_OnMenuItem(strName, nItemID)\n{\n\tapp.itsm.subscription_actions_OnMenuItem(strName, nItemID, \"Department\", _swdoc.MF().sl_services, _swdoc.oDept());\n\t_swdoc.MF().sl_services.Refresh();\n}"},{"name":"OnFieldValueChanged","code":"OnFieldValueChanged(strName, strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\n}"},{"name":"btn_rem_class_OnPressed","code":"btn_rem_class_OnPressed()\n{\n    var selectedRow     = sl_defslas.curSel;\n    var strConfirm\t\t= \"Are you sure you want to remove this associated SLA\/Call Class?\";\n    \n\tif(app.g.sl_deldbrow(sl_defslas,selectedRow,\"pk_auto_id\",null,strConfirm))\n\t{\n\t\t_swdoc.MF().sl_defslas.Refresh();\n\t}\n}"},{"name":"btn_add_class_OnPressed","code":"btn_add_class_OnPressed()\n{\n\tvar strURL = \"reltype=DEPT&fk_rel_id=\" + pfu(department.pk_dept_code);\n    app.OpenFormForAdd(\"tf_rel_sla_class\" ,\"\", strURL, true, function()\n    {\n    \t_swdoc.MF().sl_defslas.Refresh();\n    });  \t\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}