{"espForm":{"configuration":{"settings":{"name":"TfContract","title":"Contract","options":{"allowResize":"true","showMenubar":"true","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"contract","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var boolInserting = false;\n\nfunction oContract()\n{\n\treturn _swdoc.contract;\n}\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\n\nfunction init_form()\n{\n\t\/\/-- 27.10.2004\n\t\/\/-- fix date fields as getrecord does not process them correctly\n\tif (_swdoc.oContract().pk_contract_id !=\"\")\n\t{\t\n\t\t_swdoc.boolInserting=false;\n\t\t_swdoc.MF().TabContract.ShowTabItem(1,true);\t\t\n\t\t_swdoc.check_contract_state(true);\n\t}\n\telse\n\t{\t\n\t\t\/\/-- inserting\n\t\t_swdoc.boolInserting = true;\n\t\t_swdoc.oContract().fk_company_id= _swdoc.GetArg(\"fk_company_id\");\n\t\t_swdoc.MF().TabContract.ShowTabItem(1,false);\t\t\n\t}\t\n\t\n\t_swdoc.ResetModiedFlag('contract');\n}\n\n\n\/\/-- check contract state\nfunction check_contract_state(boolSave)\n{\t\n\n\tif(boolSave==undefined)boolSave=true;\n\t\/\/-- if the contract end date is less than todays date then set flag\n\tif ((app.g.fix_epoch(_swdoc.oContract().end_datex) < app.global.GetCurrentEpocTime()) ||\n\t\t(app.g.fix_epoch(_swdoc.oContract().start_datex) > app.global.GetCurrentEpocTime()) )\t\n\t{\n\t\t\/\/-- if system has not flagged it yet set flag and save\n\t\tif (_swdoc.oContract().flg_valid==\"1\")\n\t\t{\t\n\t\t\t_swdoc.oContract().flg_valid=\"0\";\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tif(boolSave)_swdoc.Save(0);\n\t\t}\n\t}\n\telse\n\t{\n\t\t\/\/-- if system has not flagged it yet set flag and save\n\t\tif (_swdoc.oContract().flg_valid==0)\n\t\t{\t\n\t\t\t_swdoc.oContract().flg_valid=\"1\";\n\t\t\t_swdoc.oContract().flg_ewemail_sent=\"0\";\t\t\t\n\t\t\t_swdoc.oContract().flg_expemail_sent=\"0\";\t\t\t\t\t\t\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tif(boolSave)_swdoc.Save(0);\n\t\t}\n\t}\n}"},{"name":"OnDataSaved","code":"OnDataSaved()\n{\n\n    var pDoc = app.g.get_me_document(\"COMPANY\",_swdoc.oContract().fk_company_id);\n    if(pDoc)\n    {\n    \tvar intCurSel = pDoc.MF().sl_contracts.curSel;\n    \tpDoc.MF().sl_contracts.Refresh();\n    \tpDoc.MF().sl_contracts.SetRowSelected(intCurSel,true);\n    }\n\n    \/\/-- \n    \/\/-- NWJ - show tab - and also update parent _swdoc\n    if(_swdoc.boolInserting)\n    {\t\t\n    \t\/\/-- create cmdb relationship\n    \tif(pDoc)\n    \t{\n    \t\t\/\/-- need to reload site record to get fk_cmdb_id\n    \t\t_swdoc.LoadRecordData(\"swdata\", \"contract\", _swdoc.oContract().pk_contract_id);\n    \t\t\n    \t\tvar strRel = dd.GetGlobalParamAsString(\"Application Settings\/CMDB\/Types\/DefaultOrgContractRelationship\");\n    \t\tapp.cmdb.generate_meconfigrelation(pDoc.oCompany().fk_cmdb_id,_swdoc.oContract().fk_cmdb_id,strRel);  \n    \t}\n\t\t_swdoc.boolInserting=false;\n\t}\n    \n\n\t\/\/-- ensure tab is active after saving\n\t_swdoc.init_form();\n\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"639","height":"329","backgroundColor":"#f2eedd","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"tb_contract_ref","type":"Field","group":"TabContract:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"68","left":"135","right":"345","bottom":"86"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.pk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_contract_ref1","type":"Field","group":"TabContract:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"90","left":"135","right":"345","bottom":"108"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_contract_type","type":"Field","group":"TabContract:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"112","left":"135","right":"345","bottom":"130"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_contract_type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","distinctTable":"swlists","distinctColumn":"value","sqlSource":"swdata","borderColor":"#c0c0c0","displayColumn":"display_name","listFilter":"list_id = 'CONTRACT-TYPE'"}}},{"general":{"name":"lb_priority","type":"Field","group":"TabContract:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"134","left":"135","right":"345","bottom":"152"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","distinctTable":"priority","distinctColumn":"priority","sqlSource":"swdata","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_document_ref","type":"Field","group":"TabContract:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"156","left":"135","right":"345","bottom":"174"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"contract.document_ref"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"flg_always","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"178","left":"130","right":"326","bottom":"196"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.flg_alwayssupport"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","flagItems":"Always provide support regardless^1|"}}},{"general":{"name":"tb_start_date","type":"Field","group":"TabContract:0"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"68","left":"443","right":"620","bottom":"86"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.start_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_end_date","type":"Field","group":"TabContract:0"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"90","left":"443","right":"620","bottom":"108"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.end_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_end_date1","type":"Field","group":"TabContract:0"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"112","left":"443","right":"620","bottom":"130"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.renew_datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","dateFormatMode":"0","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_ew","type":"Field","group":"TabContract:0"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"156","left":"443","right":"620","bottom":"174"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_ewanalyst"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"syscache","distinctTable":"swanalysts","distinctColumn":"AnalystID","displayColumn":"Name","dropdownButtonType":"1"}}},{"general":{"name":"lb_sponsor","type":"Field","group":"TabContract:0"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"178","left":"443","right":"620","bottom":"196"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_manager"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"syscache","distinctTable":"swanalysts","distinctColumn":"AnalystID","displayColumn":"Name","dropdownButtonType":"1"}}},{"general":{"name":"tb_notes","type":"Field","group":"TabContract:0"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"226","left":"135","right":"620","bottom":"312"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"contract.contract_notes"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"12","caption":"Contract Details \/ Notes","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"33","left":"13","right":"625","bottom":"318"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"13","caption":"Support SLA","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"134","left":"26","right":"131","bottom":"152"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.fk_priority"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"14","caption":"Document Ref.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"156","left":"26","right":"131","bottom":"174"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.document_ref"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"flg_valid","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"135","left":"438","right":"565","bottom":"152"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.flg_valid"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","flagItems":"Contract is in force^1|"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"16","caption":"Expires On","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"90","left":"367","right":"439","bottom":"108"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.end_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"17","caption":"Valid From","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"68","left":"367","right":"439","bottom":"86"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.start_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"18","caption":"Contract Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"112","left":"26","right":"131","bottom":"130"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.fk_contract_type"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"TabContract","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"19","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"6","left":"4","right":"633","bottom":"324"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Contract Details \/ Notes","properties":"56=#dddddd|58=#0000ff|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#dddddd","activeTextColor":"#0000ff"}}},{"name":"Assets Supported in Contract","properties":"56=#dddddd|58=#0000ff|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#dddddd","activeTextColor":"#0000ff"}}}]},"selectedTextFont":{"@size":"8","#text":"Trebuchet MS"},"selectedTextColor":"#000000","deselectedTextColor":"#5f5f5f","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"20","caption":"Contract ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"68","left":"26","right":"131","bottom":"86"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.pk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"21","caption":"Summary","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"225","left":"26","right":"131","bottom":"243"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.contract_notes"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"22","caption":"E.W Analyst","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"156","left":"368","right":"439","bottom":"174"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_ewanalyst"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"mbtn_contract_actions","type":"MenuButton","group":"TabContract:1"},"appearance":{"index":"23","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"30","left":"558","right":"623","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"Browse && Associate^1|Disassociate^2|"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"24","caption":"Early Warning On","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"112","left":"353","right":"439","bottom":"130"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.renew_datex"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"25","caption":"Owner","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"178","left":"368","right":"439","bottom":"196"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_manager"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"26","caption":"Title","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Tahoma"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"90","left":"26","right":"131","bottom":"108"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"contract.title"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:0"},"appearance":{"index":"27","caption":"Sponsor","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"200","left":"368","right":"439","bottom":"218"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_userdb"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_cust","type":"Field","group":"TabContract:0"},"appearance":{"index":"28","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"200","left":"443","right":"620","bottom":"218"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"contract.fk_userdb"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"userdb","distinctColumn":"keysearch","displayColumn":"fullname","dropdownButtonType":"0","listFilter":"fk_company_id = '&[contract.fk_company_id]'"}}},{"general":{"name":"mbtn_view_ci","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabContract:1"},"appearance":{"index":"29","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"30","left":"488","right":"553","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|"}}},{"general":{"name":"sl_asset","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"TabContract:1"},"appearance":{"index":"30","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"61","left":"12","right":"624","bottom":"317"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"equipid"},"name":"Asset ID","width":"130","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"asset_title"},"name":"Description","width":"211","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"generic"},"name":"Type","width":"139","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"currstatus"},"name":"Status","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"manufactur"},"name":"Make","width":"130","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"model"},"name":"Model","width":"130","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"owner"},"name":"Owner","width":"130","image":"-1","dataColumn":"6"}]},"sortColumn":"1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"equipmnt","listFilter":"fk_contract_id = '&[contract.pk_contract_id]'","newRecordForm":"Form.TfAsset","editRecordForm":"Form.TfAsset"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- 22.10.2004\n\t\/\/-- NWJ\n\t\/\/-- Get the passed in contract info\n\n\t\/\/-- load fields\n\t_swdoc.init_form();\n\n}"},{"name":"mbtn_contract_actions_OnMenuItem","code":"mbtn_contract_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iAssignCI = 1;\n\tvar iRemoveCI = 2;\t\n\t\n\t\/\/-- get asset id\n \tvar strAssetID = sl_asset.GetItemTextRaw(sl_asset.curSel,\"equipid\");\t\n\t\n\tif(nItemID == iAssignCI)\n\t{\n\t\t\n\t\t\/\/-- browse for company assets and associate\n\t\tvar strEquipidValues = app.g.sl_get_valuesdel(sl_asset,\"equipid\",\",\",\"'\", true);\n\t\tif(strEquipidValues==\"\")strEquipidValues=\"''\";\n\t\tvar strURL = \"in_filter=fk_company_id='\" + app.pfu(app.g.pfs(_swdoc.oContract().fk_company_id)) + \"' and equipid not in (\" + strEquipidValues + \")\";\n\t\t\n\t\tapp.OpenForm(\"browse_assets\", strURL, true,function(oForm)\n\t\t{\n\t\t\tif (oForm.document.strselectedpfskeys==\"\") return;\n\t\n\t\t\t\/\/-- do any of the selected assets belong to another contract?\n\t\t\tif (oForm.document.strselectedother!=\"\")\n\t\t\t{\n\t\t\t\t\/\/-- prompt user\n\t\t\t\tif (!confirm(\"Some of the selected assets belong to other contracts. These assets will be updated to bind to this contract. Do you want to continue ?\")) return;\n\t\t\t}\n\t\t\t\n\t\n\t\t\tvar strUpdate = \"update EQUIPMNT set FK_CONTRACT_ID = '\" + app.g.pfs(_swdoc.oContract().pk_contract_id) + \"' where EQUIPID in (\" + oForm.document.strselectedpfskeys + \")\";\n\t\t\tif(app.g.submitsql(strUpdate,true))\n\t\t\t{\n\t\t\t\tsl_asset.Refresh();\n\t\t\t}\t\t\t\n\t\t});\n    }\n\telse if(nItemID == iRemoveCI)\n\t{\n\t\t\/\/-- remove link between ci and contract\n\t\tif (strAssetID!=\"\")\n    \t{\n    \t\tif (!confirm(\"Are you sure you want to remove the selected asset from this contract ?\")) return;\n\t\t\tvar strUpdate = \"update EQUIPMNT set FK_CONTRACT_ID = '' where EQUIPID = '\" + app.g.pfs(strAssetID) + \"'\";\n\t\t\tif(app.g.submitsql(strUpdate,true))\n\t\t\t{\n\t\t\t\tsl_asset.Refresh();\n\t\t\t}\n\n    \t} \t\t\n\t}\n\t\t\n}"},{"name":"lb_ew_OnLeftClick","code":"lb_ew_OnLeftClick()\n{\n\t\/\/-- 08.03.2005\n\t\/\/-- NWJ\n\t\/\/-- assign analyst to early warning\n\tvar oA = app.g.pick_analyst(\"Send Early Warning To\");\n\tif (oA)\n\t{\n\t\t\t_swdoc.oContract().fk_ewanalyst = oA.id ;\n\t}\n\n\t_swdoc.UpdateFormFromData();\n\treturn false;\n}"},{"name":"lb_ew_OnRightClick","code":"lb_ew_OnRightClick()\n{\n\t\n\t\/\/-- clear lb\n\t_swdoc.oContract().fk_ewanalyst = \"\";\n\tapp._ete(lb_ew,\"\");\n\t_swdoc.UpdateFormFromData();\n\n\n\treturn true;\n}"},{"name":"lb_sponsor_OnRightClick","code":"lb_sponsor_OnRightClick()\n{\n\t\n\t\/\/-- clear lb\n\t_swdoc.oContract().fk_manager = \"\";\n\tapp._ete(lb_sponsor,\"\");\n\t_swdoc.UpdateFormFromData();\n\n\n\treturn true;\n}"},{"name":"lb_sponsor_OnLeftClick","code":"lb_sponsor_OnLeftClick()\n{\n\t\/\/-- 08.03.2005\n\t\/\/-- NWJ\n\t\/\/-- assign analyst to early warning\n\tvar oA = app.g.pick_analyst(\"Send Expiry Notification To\");\n\tif (oA)\n\t{\n\t\t\t_swdoc.oContract().fk_manager = oA.id ;\n\t}\n\n\t_swdoc.UpdateFormFromData();\n\treturn false;\n}"},{"name":"mbtn_view_ci_OnMenuItem","code":"mbtn_view_ci_OnMenuItem(strName, nItemID)\n{\n  \tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\n\t\/\/-- get intCI\n  \tvar strAssetID = app.g.sl_getrawcolvalue(sl_asset,-1,\"equipid\");\n  \tif(strAssetID!=\"\")\n  \t{ \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tsl_asset.EditRecord(sl_asset.curSel);\n\t\t\tsl_asset.Refresh();\n\t\t\treturn;\n    \t}\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.g.view_inventory(strAssetID,strAssetID);\n\t\t}\n\t\n\t}\n}"},{"name":"sl_asset1_OnItemSelected","code":"sl_asset1_OnItemSelected(nRow)\n{\n\tapp._een(mbtn_view_asset , (sl_asset1.rowCount()>0));\n\n\n}"},{"name":"sl_asset_OnItemSelected","code":"sl_asset_OnItemSelected(nRow)\n{\n\tapp._een(mbtn_view_ci , (sl_asset.rowCount()>0));\n\n}"},{"name":"tb_start_date_OnValueChanged","code":"tb_start_date_OnValueChanged(strValue)\n{\n\t_swdoc.check_contract_state(false);\n\n}"},{"name":"tb_end_date_OnValueChanged","code":"tb_end_date_OnValueChanged(strValue)\n{\n\t_swdoc.check_contract_state(false);\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}