{"espForm":{"configuration":{"settings":{"name":"TfDepartment","title":"Department","description":"Organisational departments","options":{"allowResize":"true","showMenubar":"true","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"department","type":"Main Details Table","flags":"0"}},"javascript":{}},"layouts":{"layout":[{"appearance":{"width":"495","height":"271","backgroundColor":"#f2eedd","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Field1","type":"Field","group":"TabDept:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"42","left":"101","right":"472","bottom":"60"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.pk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field2","type":"Field","group":"TabDept:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"64","left":"101","right":"472","bottom":"82"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.dept_name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field3","type":"Field","group":"TabDept:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"86","left":"101","right":"472","bottom":"104"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.telephone"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field4","type":"Field","group":"TabDept:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"108","left":"101","right":"472","bottom":"126"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_manager","type":"Field","group":"TabDept:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"130","left":"101","right":"472","bottom":"148"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.fk_dept_manager"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"userdb","distinctColumn":"keysearch","displayColumn":"fullname","listFilter":"fk_company_id = '&[department.fk_company_id]' and flg_manager=1"}}},{"general":{"name":"lb_parent","type":"Field","group":"TabDept:0"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"152","left":"101","right":"472","bottom":"170"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"department.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"department","distinctColumn":"pk_dept_code","displayColumn":"dept_name","listFilter":"fk_company_id = '&[department.fk_company_id]' and pk_dept_code != '&[department.pk_dept_code]'"}}},{"general":{"name":"Field7","type":"Field","group":"TabDept:0"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"174","left":"101","right":"472","bottom":"252"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"department.notes"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDept:0"},"appearance":{"index":"7","caption":"Code","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"42","left":"18","right":"97","bottom":"60"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.pk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"TabDept","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"9","left":"9","right":"486","bottom":"260"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Department Details","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Customers","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDept:0"},"appearance":{"index":"9","caption":"Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"64","left":"18","right":"97","bottom":"82"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.dept_name"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDept:0"},"appearance":{"index":"10","caption":"Telephone","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"86","left":"18","right":"97","bottom":"104"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.telephone"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDept:0"},"appearance":{"index":"11","caption":"Email","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"108","left":"18","right":"97","bottom":"126"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.email"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label5","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDept:0"},"appearance":{"index":"12","caption":"Manager","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"130","left":"18","right":"97","bottom":"148"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.fk_dept_manager"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label6","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDept:0"},"appearance":{"index":"13","caption":"Parent Dept.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"152","left":"18","right":"97","bottom":"170"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label7","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDept:0"},"appearance":{"index":"14","caption":"Notes","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"174","left":"18","right":"97","bottom":"192"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"department.notes"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"mbtn_contact_view1","type":"MenuButton","group":"TabDept:1"},"appearance":{"index":"15","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"343","right":"408","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900","commands":"Properties^1|"}}},{"general":{"name":"sl_contact1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"TabDept:1"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"64","left":"18","right":"477","bottom":"252"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"keysearch"},"name":"Customer ID","width":"146","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"firstname"},"name":"Firstname","width":"126","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"surname"},"name":"Surname","width":"149","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Main Site","width":"176","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"email"},"name":"E-Mail","width":"178","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telext"},"name":"Telephone","width":"154","image":"-1","dataColumn":"5"}]},"sortColumn":"4","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"userdb","listFilter":"fk_dept_code = '&[department.pk_dept_code]'","newRecordForm":"Form.TfCustomer","editRecordForm":"Form.TfCustomer"}}},{"general":{"name":"mbtn_contact_actions","type":"MenuButton","group":"TabDept:1"},"appearance":{"index":"17","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"413","right":"478","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"Browse && Associate^3|Disassociate^4|Create New^1|Delete^2|"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/-- NWJ\n\t\/\/-- 21.04.2005\n\tif ((department.pk_dept_code == \"\")||(department.dept_name==\"\"))\n\t{\n\t\tapp.g.popuplate_form_fromargs(\"department\", _swdoc, true, true);\n\t\tTabDept.ShowTabItem(1,false);\n\t\tapp._etab(TabDept , 0);\n\t\t_swdoc.boolInserting=true;\n\t\t\n\t\tif(_swdoc.department.fk_company_id==\"\")\n\t\t{\n\t\t\t_swdoc.department.fk_company_id = dd.GetGlobalParamAsString(\"Application Settings\/DefaultCompanyID\");\n\t\t\t_swdoc.ResetModiedFlag(\"department\");\n\t\t}\t\t\n\t}\n\telse\n\t{\n\t\tTabDept.ShowTabItem(1,true);\n\t\t_swdoc.boolInserting=false;\n\t}\n\n\n}"},{"name":"sl_contact1_OnItemSelected","code":"sl_contact1_OnItemSelected(nRow)\n{\n    \/\/-- 26.07.2004\n    \/\/-- NWJ\n    \/\/-- Load contact details when selected.\n    var contact_id = app.g.sl_getrawcolvalue(sl_contact1, sl_contact1.curSel, \"keysearch\");\n    if (contact_id != \"\")\n    {\n     \n        \/\/-- show the update and delete button\n        app._een(mbtn_contact_view1,true);\n    }    \n    else\n    {\n    \n    \tif (sl_contact1.rowCount() > 0 )\n    \t{\n    \t\tsl_contact1.SetRowSelected(0);\n    \t\tsl_contact1_OnItemSelected(0);\n    \t}\n    \telse\n    \t{\n    \t\n\t        \/\/-- 26.07.2004\n        \t\/\/-- NWJ\n        \t\/\/-- hide the update and delete button\n        \tapp._een(mbtn_contact_view1,false);\n        }\n    }\n    return;\n\n}"},{"name":"sl_contact1_OnItemDoubleClicked","code":"sl_contact1_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tsl_contact1.EditRecord(nRow);\n\tsl_contact1.Refresh();\n\tsl_contact1.SetRowSelected(nRow);\n\treturn false;\n}"},{"name":"mbtn_contact_actions_OnMenuItem","code":"mbtn_contact_actions_OnMenuItem(strName, nItemID)\n{\n    var iAddContact = 1;\n\tvar iDeleteContact = 2;\n\tvar iSearchContact = 3;\t\n\tvar iRemoveContact = 4;\t\n\n\tif(nItemID == iRemoveContact)\n\t{\t\t\n\t\tvar strKeysearchValues = app.g.sl_selectedkeys(sl_contact1,\"keysearch\",false,\",\");\n\t\tif(strKeysearchValues==\"\")return;\n\t\n\t\tif(!confirm(\"Are you sure you want to remove the selected customer(s) from this department ?\")) return;\n\t\n\t\t\/\/-- update - userdb\n\t\tvar strSQL = \"update USERDB set FK_DEPT_CODE = '' where KEYSEARCH in (\" + strKeysearchValues + \")\";\n\t\tapp.g.submitsql(strSQL,false);\n\t\tsl_contact1.Refresh();\n\t\tsl_contact1.SetRowSelected(0, true);\n\t\n\t}\t\n\telse if(nItemID == iSearchContact)\n\t{\t\t\n\t\t\/\/-- show list of company customers, that are not currently linked to this site, that can link to this site\n\t\tvar strKeysearchValues = app.g.sl_get_valuesdel(sl_contact1,\"keysearch\",\",\",\"'\", true);\n\t\tif(strKeysearchValues==\"\")strKeysearchValues=\"''\";\n\t\tvar strURL = \"in_filter=fk_company_id='\" + app.pfu(app.g.pfs(_swdoc.department.fk_company_id)) + \"' and keysearch not in (\" + strKeysearchValues + \")\";\n\t\tapp.g.popup(\"browse_customers\", strURL,function(oForm)\n\t\t{\n\t\t\tif (oForm.document.strselectedpfskeys==\"\") return;\n\t\t\t\/\/-- update - userdb\n\t\t\tvar strSQL = \"update USERDB set FK_DEPT_CODE = '\" + app.g.pfs(department.pk_dept_code) + \"' where KEYSEARCH in (\" + oForm.document.strselectedpfskeys + \")\";\n\t\t\tapp.g.submitsql(strSQL,false);\n\t\t\tsl_contact1.Refresh();\n\t\t\tsl_contact1.SetRowSelected(0, true);\n\t\t});\n\t}\n\telse if(nItemID == iAddContact)\n\t{\n\t\t\/\/-- 29.07.2004\n    \t\/\/-- NWJ\n    \t\/\/-- Open new contact form\n    \t\/\/-- pass in pk_company_auto_id so that we can link the two\n    \tvar strURL = \"fk_company_id=\" + app.pfu(_swdoc.department.fk_company_id) + \"&fk_dept_code=\" + app.pfu(department.pk_dept_code);\n    \tapp.OpenFormForAdd(\"TfCustomer\" ,\"\", strURL, true, function()\n    \t{\n    \t\tsl_contact1.Refresh();\n    \t\tsl_contact1.SetRowSelected(0,true);\n    \t});    \t\n\t}\n\telse if(nItemID == iDeleteContact)\n\t{\n\t\t\/\/-- 29.07.2004\n    \t\/\/-- NWJ\n    \t\/\/-- Delete the selected contact\n    \tvar selectedRow     = sl_contact1.curSel;\n    \tvar strConfirm\t\t= \"Are you sure you want to delete this customer from the database ?\";\n    \t\n\t\tif(app.g.sl_deldbrow(sl_contact1,selectedRow,\"keysearch\",null,strConfirm))\n\t\t{\n\t\t\t\/\/-- relations deleted in vpme\n\t\t\tsl_contact1.SetRowSelected(0,true);\n\t\t}\n\t}\n\n}"},{"name":"mbtn_contact_view1_OnMenuItem","code":"mbtn_contact_view1_OnMenuItem(strName, nItemID)\n{\n\tvar iProperties = 1;\t\n  \tif(nItemID == iProperties)\n\t{\n\t\tsl_contact1.EditRecord(sl_contact1.curSel);\n\t\tsl_contact1.SetRowSelected(sl_contact1.curSel,true);\n\t}\n\t\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}