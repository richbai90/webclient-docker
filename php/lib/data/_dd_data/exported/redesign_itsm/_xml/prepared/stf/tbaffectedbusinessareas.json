{"espForm":{"configuration":{"settings":{"name":"TbAffectedBusinessAreas","title":"Affected Business Areas","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\n\n\/\/-- form pointers\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"776","height":"138","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"SqlList1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"}},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"5","left":"5","right":"670","bottom":"133"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_area_id"},"name":"Business Area ID","width":"130","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"known_as"},"name":"Known As","width":"130","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"principle_contact"},"name":"Main Contact","width":"130","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"principle_contact_id"},"name":"Main Contact ID","width":"130","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"group_email_address"},"name":"Group Email Address","width":"130","image":"-1","dataColumn":"4"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"affected_bus_area","newRecordForm":"Form.EfAffectedBusinessArea","editRecordForm":"Form.EfAffectedBusinessArea","storedQuery":"me.browse.table"}}},{"general":{"name":"btnProperties","type":"EventButton"},"appearance":{"index":"1","caption":"Properties","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"5","left":"682","right":"762","bottom":"29"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnNew","type":"EventButton"},"appearance":{"index":"2","caption":"New","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"32","left":"682","right":"762","bottom":"56"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnDelete","type":"EventButton"},"appearance":{"index":"3","caption":"Delete","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"59","left":"682","right":"762","bottom":"83"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnClose","type":"EventButton"},"appearance":{"index":"4","caption":"Close","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"109","left":"682","right":"762","bottom":"133"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"btnProperties_OnPressed","code":"btnProperties_OnPressed()\n{\n    SqlList1.EditRecord(SqlList1.curSel);\n    _swdoc.MF().SqlList1.Refresh();\n    \n}"},{"name":"btnNew_OnPressed","code":"btnNew_OnPressed()\n{\n    app.OpenFormForAdd(\"EfAffectedBusinessArea\", \"\", \"\", true, function(){\n    \tSqlList1.Refresh();\n    });\n}"},{"name":"btnDelete_OnPressed","code":"btnDelete_OnPressed()\n{\n    \/\/-- nwj :- use key col name instead of numbering\n    var sCol = dd.tables[SqlList1.table].PrimaryKey;\n    if(sCol==\"\")\n    {\n            MessageBox(\"No primary key is defined for this table. Please contact your Supportworks Administrator\");\n    }\n    else\n    {\n            if(SqlList1.curSel != -1)\n            {\n                    \/\/--  ask them to confirm\n                    if(!confirm('Are you sure you want to delete the selected record?'))return false;\n                    \/\/-- nwj :- determine if needs quotes\n                    var strKeyValue = SqlList1.GetItemTextRaw(SqlList1.curSel, sCol);\n                    if(strKeyValue != \"\")\n                    {\n                             if(app.g.sqlexecute_delete(SqlList1.table, strKeyValue))\n                            {\n                                    \/\/ This next call removes the row from the list, not the database\n                                    SqlList1.RemoveRow(SqlList1.curSel);\n                            }\n                    }\n            }\n    }\n}"},{"name":"btnClose_OnPressed","code":"btnClose_OnPressed()\r\n{\r\n    _swdoc.CloseForm();\r\n}\r\n"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n\tSqlList1.Refresh();\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}