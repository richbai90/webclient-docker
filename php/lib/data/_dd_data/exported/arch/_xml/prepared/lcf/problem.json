{"espForm":{"configuration":{"settings":{"name":"Problem","title":"Log New Problem","callClass":"Problem","options":{"showExtendedDetails":"true","showWorkflow":"false","showFileAttachments":"true","showAffectedCustomers":"false","showAffectedContacts":"true","showCustomHtmlTab":"false","showPartsUsedTab":"false","allowLog":"true","allowLogAssign":"true","allowLogAccept":"true","allowLogClose":"false","allowLogAcceptTake":"true","showMassageBar":"false","showCloseDetails":"false","useEmailDateToLogCall":"false","hideToolbar":"false","hideMenubar":"false","hideFromMenu":"true","extendedDetailsTable":{"title":"Associated Information"}}},"tables":{"table":[{"name":"opencall","type":"Main Details Table","flags":"0"},{"name":"updatedb","type":"Diary Updates Table","mainDetailsColumn":"callref","recordPicklist":"Customer","addRecordForm":"Form.EfCustomer","editRecordForm":"Form.EfCustomer","flags":"0"},{"name":"itsm_opencall_problem","type":"Extended Details Table","description":"Associated Information","mainDetailsColumn":"callref","recordPicklist":"Customer","addRecordForm":"Form.EfCustomer","editRecordForm":"Form.EfCustomer","flags":"0"},{"name":"userdb","type":"Related Table","description":"Customer Table","mainDetailsColumn":"cust_id","recordPicklist":"Customer","addRecordForm":"Form.EfCustomer","editRecordForm":"Form.EfCustomer","flags":"0","assignments":{"assignment":[{"expression":"keysearch","masterRecordColumn":"opencall.cust_id"},{"expression":"firstname + ' ' + surname","masterRecordColumn":"opencall.cust_name"},{"expression":"fk_manager","masterRecordColumn":"opencall.bpm_managerid"},{"expression":"fk_company_id","masterRecordColumn":"opencall.fk_company_id"},{"expression":"companyname","masterRecordColumn":"opencall.companyname"},{"expression":"site","masterRecordColumn":"opencall.site"}]}},{"name":"company","type":"Related Table","description":"Organisation Table","mainDetailsColumn":"fk_company_id","recordPicklist":"Company","addRecordForm":"Form.TfCompany","editRecordForm":"Form.TfCompany","flags":"0","assignments":{"assignment":[{"expression":"pk_company_id","masterRecordColumn":"opencall.fk_company_id"},{"expression":"companyname","masterRecordColumn":"opencall.companyname"}]}},{"name":"bpm_workflow","type":"Related Table","mainDetailsColumn":"bpm_workflow_id","recordPicklist":"Business Process","flags":"0","assignments":{"assignment":{"expression":"pk_workflow_id","masterRecordColumn":"opencall.bpm_workflow_id"}}}]},"showMeItems":{"action":[{"name":"Customer Properties","id":"2","attrib1":"Form.TfCustomer","attrib2":"&[userdb.keysearch]","displayName":"Customer Properties"},{"name":"Organisation Properties","id":"2","attrib1":"Form.TfCompany","attrib2":"&[company.pk_company_id]","displayName":"Organisation Properties"},{"name":"Causing CI Search","id":"3","attrib1":"search_for_cis();","displayName":"Causing CI Search"},{"name":"Causing Service Search","id":"3","attrib1":"search_for_services();","displayName":"Causing Service Search"},{"name":"Selfservice Wizard Input","id":"3","attrib1":"if(_swdoc.OC().logcall_source=='SELFSERVICE')\r\n{\r\n    var strParams = 'in_callref='+_swdoc.OC().callref;\r\n    var intCount = app.g.get_sqrecordset(\"call\/common\/count_wiz_qs\",strParams);\r\n    if(intCount>0)\r\n    {\r\n \t\tvar strServer = '&[app.webroot]';\r\n\t\tvar strCurrentdd = '&[app.currentdd]';\r\n\r\n\t\tapp.global.OpenHtmlWindow(\"wssm_wiz_input\", \"frame\", strServer + \"\/clisupp\/details\/\"+ strCurrentdd +\"\/wssm_wiz_input.php?sessionid=\"+app.session.sessionId+\"&fk_callref=\"+_swdoc.OC().callref, \"Selfservice Wizard Input\", true, 950, 700);\r\n    }\r\n    else\r\n    {\r\n        MessageBox(\"resolved call count = \" + intCount);\r\n    }\r\n}\r\nelse\r\n{\r\n\tMessageBox('Call was not logged via selfservice.')\r\n}","displayName":"Selfservice Wizard Input"},{"name":"Store Resolution Details","id":"3","attrib1":"strURL= \"company_code=\"+_swdoc.oCompany().pk_company_id;\r\n        \r\nif (_swdoc.OC().custom_i3){\r\n        app.OpenFormForEdit(\"itsmEfQLogResCloseData\", _swdoc.OC().custom_i3,strURL,true, function(aForm){});\r\n}       \r\nelse\r\n{\r\n\tapp.OpenFormForAdd(\"itsmEfQLogResCloseData\", \"\", strURL, true, function(aForm){\r\n\t\tif (aForm)\r\n\t\t{\r\n\t\t\tvar newRecId = aForm.document.record_id;\r\n\t\t\tif (newRecId != \"\"){\r\n\t\t\t\t_swdoc.OC().custom_i3 = newRecId;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tMessageBox(\"No Resolution \/ Closure details were created. If this form is saved as a Quick Log Call, there will be no Resolution \/ Closure details.\");\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}","displayName":"Store Resolution Details"}]},"javascript":{"methods":{"method":[{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strCallclass)\n{\n\t\/\/-- can they raise record of this class\n\tif(app.itsm.can_create(strCallclass,true)==false) return false;\n\n}"},{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\nvar _kbidentifier = app.session.sessionId+app.global.GetCurrentEpocTime();\n\n\/\/-- _swdoc level functions and vars\nvar ARRAY_LINKED_INCIDENT_CIS = new Array();\nvar ARRAY_LINKED_SITES = new Array();\nvar strCurrentCompanyID = \"\";\nvar boolResolvingCust = false;\nvar strSearchFor = \"\";\nvar companyCIIDS = \"\";\nvar boolProblemTitleSetManually=false;\nvar intProfileCodeCI = 0;\nvar intAssessmentCI = 0;\n\nvar strDefaultImpact = \"\";\nvar strDefaultUrgency = \"\";\nvar strCurrentPriority = \"\";\nvar strCurrentSLADef = 0;\nvar strCurrentSLAName = \"\";\nvar boolProblemSLASetManually = false;\nvar boolSLAEnforced = false;\nvar boolChangeProfile = false;\n\nvar arrOrigSettings = new Array();\n\/\/-- F0105032\nvar oOpencall = null;\nvar oExtended = null;\n\/\/-- EOF F0105032\nvar boolCustid_fromCall = false;\n\nvar strSLACallClass = \"Problem\";\n\nfunction search_for_services()\n{\n\t\/\/ It is redefined the mode for the new window\n\tvar strURL = \"searchmode=1&multiselect=1&canreset=1&fk_company_id=\" + app.pfu(_swdoc.oCompany().pk_company_id);\n\t\/\/ It is defined the next window to execute, searching services with better filters\n\tapp.g.popup(\"manage_portfolio\", strURL, function(sResults)\n\t{\n\t\t\/\/ Case there are not any selection go back\n    \tif (!sResults || sResults.document.strSelectedKeys==\"\")\n    \t{\n    \t\treturn; \n    \t}\n \t\t_swdoc.link_cause_service_to_problem(sResults.document.strSelectedKeys);\n \t\t\n \t\t\/\/-- JPG, 22.01.2015 - check ci contract\n\t\tapp.cfg.process_call_contract_check(sResults.document.strSelectedKeys, true,_swdoc);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t});\n}\n\nfunction search_for_cis(funcCallback)\n{\n\tvar strURL = \"canreset=1&fk_company_id=\" + app.pfu(_swdoc.oCompany().pk_company_id);\n\tapp.cmdb.search_ci(true,strURL,function(sResults)\n\t{\n\t\tif (sResults.selectedkeys==\"\")\n\t\t{\n\t\t\tif ((funcCallback != undefined) && (funcCallback != null))\n\t\t\t{\n\t\t\t\tfuncCallback();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar strType = sResults.selectedtypes;\n  \t\t\tif(strType.indexOf(\"Service\")>-1)\n  \t\t\t{\n  \t\t\t\tvar strServiceKeys = \"\";\n  \t\t\t\tvar strKeys = \"\";\n  \t\t\t\tvar arrTypes = strType.split(\",\");\n  \t\t\t\tvar arrKeys = sResults.selectedkeys.split(\",\");\n  \t\t\t\tfor(var x in arrKeys)\n  \t\t\t\t{\n  \t\t\t\t\tvar strThisType = arrTypes[x];\n  \t\t\t\t\tif(strThisType.indexOf(\"Service\")>-1)\n  \t\t\t\t\t{\n  \t\t\t\t\t\tif(strServiceKeys!=\"\")\n  \t\t\t\t\t\t\tstrServiceKeys+=\",\";\n  \t\t\t\t\t\tstrServiceKeys += arrKeys[x];\n  \t\t\t\t\t}else\n  \t\t\t\t\t{\n  \t\t\t\t\t\tif(strKeys!=\"\")\n  \t\t\t\t\t\t\tstrKeys+=\",\";\n  \t\t\t\t\t\tstrKeys += arrKeys[x];\n  \t\t\t\t\t}\n  \t\t\t\t}\n  \t\t\t\tif(strKeys!=\"\")\n \t\t\t\t\t_swdoc.link_cause_cis_to_problem(strKeys);\n  \t\t\t\tif(strServiceKeys!=\"\")\n  \t\t\t\t\t_swdoc.link_cause_service_to_problem(strServiceKeys);\n  \t\t\t\n  \t\t\t}\n  \t\t\telse\n \t\t\t\t_swdoc.link_cause_cis_to_problem(sResults.selectedkeys);\n\t\t\n \t\t\t\n \t\t\t\n \t\t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\t\tapp.cfg.process_call_contract_check(sResults.selectedkeys, true,_swdoc);\n\t\t\n\t\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\t\t\n\t\t\tif ((funcCallback != undefined) && (funcCallback != null))\n\t\t\t{\n\t\t\t\tfuncCallback();\n\t\t\t}\n\t\t}\n\t});\n\t\n}\n\/\/-- record pointers\nfunction OC()\n{\n\treturn _swdoc.opencall;\n}\n\nfunction oCust()\n{\n\treturn _swdoc.userdb;\n}\n\nfunction PRB()\n{\n\treturn _swdoc.itsm_opencall_problem;\n} \n\nfunction UPD()\n{\n\treturn _swdoc.updatedb;\n} \n\n\/\/-- object pointers\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction EF()\n{\n\treturn extform;\n}\n\nfunction oCompany()\n{\n\treturn _swdoc.company;\n}\n\n\/\/-- given an analyst object (from app.global.js) load raised by values\n\/\/-- for the rfc\nfunction set_prb_analyst(oAnalyst)\n{\n\tif(!oAnalyst) \n\t{\n\t\t\/\/-- invalid so clear fields\n\t\toAnalyst = app.g.get_blank_analyst();\n\t}\n\t\n\t_swdoc.PRB().raised_by_analystid = oAnalyst.id;\n\t_swdoc.PRB().raised_by_name = oAnalyst.name;\n\t_swdoc.PRB().raised_by_group = oAnalyst.supportgroup;\n\t_swdoc.PRB().raised_by_telephone =  oAnalyst.telephone;\n\t_swdoc.PRB().raised_by_email = oAnalyst.email;\t\n\t\t\n\t_swdoc.UpdateFormFromData();\n}\n\n\/\/-- nwj - 15.08.2008 - filter the customers company sites - remember those that have been checked\nfunction filter_company_sites()\n{\n\tapp._slf(_swdoc.MF().sl_sites, \"_swc_fk_company_id=\" + _swdoc.oCompany().pk_company_id);\n\t_swdoc.MF().sl_sites.Refresh();\n}\n\n\/\/-- given a ci or list of cis link it to problem cause list\nfunction link_cause_cis_to_problem(strLinkCIs)\n{\n\tvar strFilter = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems,'pk_auto_id',\",\");\n\tif (strFilter != \"\") \n\t{\n\t\tstrFilter += \",\" + strLinkCIs;\n\t}\n\telse\n\t{\n\t\tstrFilter = strLinkCIs;\n\t}\n\t\n\n\tapp._slf(_swdoc.EF().sl_configitems,\"pk_auto_id=\" + strFilter + \"&type=1\");\n\t_swdoc.EF().sl_configitems.Refresh();\n\t_swdoc.EF().sl_configitems.SetRowSelected(0,true,false);\n\n\t\/\/ -- SG, 02\/07\/2012, F0103324\n\t\/\/ Build array of CI's that have the Bespoke Terms field populated\n\t\/\/ End of array building\t\t\t\n\tapp.bespokeTermsProcessing(strFilter);\n\t\t\n\t_swdoc.check_ci_assessment();\n}\n\n\/\/-- given a ci or list of cis link it to problem cause list\nfunction link_cause_service_to_problem(strLinkCIs)\n{\n\tvar strFilter = app.g.sl_get_valuesdel(_swdoc.EF().sl_services,'pk_auto_id',\",\");\n\tif (strFilter != \"\") \n\t{\n\t\tstrFilter += \",\" + strLinkCIs;\n\t}\n\telse\n\t{\n\t\tstrFilter = strLinkCIs;\n\t}\n\t\n\t\n\tapp._slf(_swdoc.EF().sl_services,\"pk_auto_id=\" + strFilter + \"&type=2\");\n\t_swdoc.EF().sl_services.Refresh();\n\t_swdoc.EF().sl_services.SetRowSelected(0,true,false);\n\t\n\t\/\/ -- SG, 02\/07\/2012, F0103324\n\t\/\/ Build array of CI's that have the Bespoke Terms field populated\n\tapp.bespokeTermsProcessing(strFilter, \"Service\");\t\n\t\n\t_swdoc.check_ci_assessment();\n}\n\n\n\n\/\/-- given a ci or list of cis link it to problem affect list\nfunction link_affect_cis_to_problem(strLinkedCIs)\n{\n\tvar strFilter = app.g.sl_get_valuesdel(_swdoc.EF().sl_impactcis,'pk_auto_id',\",\");\n\tif (strFilter != \"\") \n\t{\n\t\tstrFilter += \",\" + strLinkedCIs;\n\t}\n\telse\n\t{\n\t\tstrFilter = strLinkedCIs;\n\t}\n\t\n\t\n\tapp._slf(_swdoc.EF().sl_impactcis, \"_kv=\" + strFilter);\n\t_swdoc.EF().sl_impactcis.Refresh();\n\t_swdoc.EF().sl_impactcis.SetRowSelected(0,true,false);\n\n\t\/\/ -- SG, 02\/07\/2012, F0103324\n\t\/\/ Build array of CI's that have the Bespoke Terms field populated\n\tapp.bespokeTermsProcessing(strFilter);\t\n\t\n}\n\n\/\/-- for removed incidents prompt user to remove attached CIs linked to those incidents\nfunction remove_selected_incident_cis(strSelectedIncs)\n{\n\tvar array_RemoveImpactCIS = new Array();\n\t\n\tif(_swdoc.EF().sl_impactcis.rowCount()<1) return;\n\t\n\t\/\/--\n\t\/\/-- get linked inc cis and see if they are linked to problem\n\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\tif(strLinkedCIs==\"0\")return;\n\n\tvar arrayCIS = strLinkedCIs.split(\",\");\n\tfor(var x=0;x<arrayCIS.length;x++)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(_swdoc.EF().sl_impactcis,arrayCIS[x],0)!=-1)\tarray_RemoveImpactCIS[array_RemoveImpactCIS.length++] = arrayCIS[x];\t\t\t\n\t}\n\t\t\n\t\/\/-- if we have linked impact inc cis then ask if want to remove them\n\tif(array_RemoveImpactCIS.length>0)\n\t{\n\t\tif(confirm(\"There are associated impact configuration items, that are linked to the incidents you are removing. Do you want to remove these items as well?\"))\n\t\t{\n\t\t\tfor(var y=0;y<array_RemoveImpactCIS.length;y++)\n\t\t\t{\n\t\t\t\tapp.g.sl_delrow_byvalue(_swdoc.EF().sl_impactcis,array_RemoveImpactCIS[y],0, null,0);\n\t\t\t}\n\t\t}\n\t}\n}\n\n\nfunction filter_impact_customers(oForm)\n{\n\tvar strFilter = \"\";\n\t\/\/-- get list of customers impacted by these incidents and refresh cust impact list\n\tvar strCustFilter = app.g.sl_get_valuesdel(oForm.sl_incs,'cust_id',\",\",\"\",true);\n\tif(strCustFilter!=\"\")strFilter+=strCustFilter;\n\t\n\t\/\/-- get customers that use affected cis\n\tvar strImpactedCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_impactcis,'pk_auto_id',\",\");\t\n\t\n\tvar strCustIDSFromCIs = app.cmdb.get_ci_customer_ids(strImpactedCIs,true);\n\tif(strCustIDSFromCIs!=\"\")\n\t{\n\t\tstrFilter+=\",\"+strCustIDSFromCIs;\n\t}\n\tif(_swdoc.oCust().keysearch!=\"\")\n\t{\n\t\tstrFilter+=\",\"+_swdoc.oCust().keysearch;\n\t}\n\tapp._slf(oForm.sl_customerimpact, \"_kv=\"+strFilter);\n\toForm.sl_customerimpact.Refresh();\t\t\t\n}\n\nfunction filter_impact_orgs(oForm)\n{\n\tvar strFilter = \"\";\n\t\/\/-- get list of orgs impacted by impacted customer\n\tvar strOrgFilter = app.g.sl_get_valuesdel(oForm.sl_incs,'fk_company_id',\",\",\"\",true);\n\tif(strOrgFilter!=\"\")strFilter+=strOrgFilter=\"''\";\n\t\n\t\/\/-- get orgs that use affected cis\n\tvar strImpactedCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_impactcis,'pk_auto_id',\",\");\t\n\tvar strOrgIDSFromCIs = app.cmdb.get_ci_company_ids(strImpactedCIs,true);\n\tif(strOrgIDSFromCIs==\"\")\n\t{\n\t\tstrFilter+=\",\"+strOrgIDSFromCIs;\n\t}\n\tif(_swdoc.oCompany().pk_company_id!=\"\")\n\t{\n\t\tstrFilter+=\",\"+_swdoc.oCompany().pk_company_id;\n\t}\n\tapp._slf(oForm.sl_orgimpact,\"_kv=\"+strFilter);\n\toForm.sl_orgimpact.Refresh();\t\n}\n\nfunction get_company_cis()\n{\n\tvar strKeyValues = app.cfg.get_company_cikeys(strCompanyID,true,true);\t\n\n\tvar strParams = \"fk_company_id=\"+app.pfu(strCompanyID);\n    var oRS = app.g.get_sqrecordset(\"general\/get_company_sites\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tif(strKeyValues!=\"\")strKeyValues+=\",\";\t\n\t\tvar strSiteName = app.g.get_field(oRS,\"site_name\");\n\t\tstrKeyValues+= app.cmdb.get_site_cis(strSiteName);\n\t}\t\n\t\n\tif(strKeyValues==\"\")\n\t\tstrKeyValues = \"-1\";\n\t\t\n\t_swdoc.companyCIIDS = strKeyValues;\n}\n\nfunction check_cis()\n{\n\t\/\/-- F0100436 - update _swdoc.check_cis function\n\tif(_swdoc.EF().sl_configitems.rowCount() ==\"\")\n\t\treturn;\n\tvar intStartCount = _swdoc.EF().sl_configitems.rowCount();\n\tvar strCIKeys = app.g.sqllist_get_valuesdel(_swdoc.EF().sl_configitems, 'pk_auto_id', \",\", \"\");\n\n\tvar strAssociatedCIKeys = \"-1\";\n\tvar strParams = \"fk_children=\"+(strCIKeys)+\"&fk_parent=\"+app.pfu(_swdoc.oCompany().fk_cmdb_id);\n    var oRS = app.g.get_sqrecordset(\"call\/incident\/cisrelatedtocompany\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tstrAssociatedCIKeys+=\",\";\t\n\t\tstrAssociatedCIKeys += app.g.get_field(oRS,\"FK_CHILD_ID\");\n\t}\t\n\t\n\tvar strParams = \"pk_cis=\"+(strCIKeys)+\"&fk_company_id=\"+app.pfu(_swdoc.oCompany().pk_company_id);\n    var oRS = app.g.get_sqrecordset(\"call\/incident\/cisownedbycompany\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tstrAssociatedCIKeys+=\",\";\t\n\t\tstrAssociatedCIKeys += app.g.get_field(oRS,\"PK_AUTO_ID\");\n\t}\t\n\n\tvar strParams = \"fk_company_id=\"+app.pfu(_swdoc.oCompany().pk_company_id);\n    var oSites = app.g.get_sqrecordset(\"general\/get_company_sites\",strParams);\n\twhile(oSites.Fetch())\n\t{\n\t\tvar strSiteName = app.g.get_field(oSites,\"site_name\");\n\n\t\tvar strParams = \"pk_cis=\"+(strCIKeys)+\"&fk_site=\"+app.pfu(strSiteName);\n\t    var oRS = app.g.get_sqrecordset(\"call\/incident\/cisownedbysites\",strParams);\n\t\twhile(oRS.Fetch())\n\t\t{\n\t\t\tstrAssociatedCIKeys+=\",\";\t\n\t\t\tstrAssociatedCIKeys += app.g.get_field(oRS,\"PK_AUTO_ID\");\n\t\t}\t\n\t}\t\n\n\tapp._slf(_swdoc.EF().sl_configitems, \"pk_auto_id=\"+strAssociatedCIKeys+\"&type=1\");\n\tvar intEndCount = _swdoc.EF().sl_configitems.rowCount();\n\tif(intEndCount<intStartCount)\n\t\tMessageBox(\"CIs were removed from this call, as they were not associated with the currently selected Organisation\");\n\treturn;\n}\n\n\n\n\/\/-- check if there is alternative slad settings based on the customers department\nfunction check_customer_department_slad(strSLADID, strDepartment)\n{\n \tif(strDepartment==\"\")\n\t\treturn;\n\tvar strParams = \"fk_slad_id=\" +app.pfu(strSLADID)+ \"&fk_dept=\" +app.pfu(strDepartment);\n \tvar oRecSLD = app.g.get_sqrecordset(\"call\/incident\/get_dept_sla\",strParams);\n\tif(oRecSLD.Fetch())\n\t{\n\t\t\/\/-- load cost center option\n\t\tvar strNewCC = app.g.get_field(oRecSLD,\"chargeto_cc\");\n\t\tswitch(strNewCC)\n\t\t{\n\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\tbreak;\n\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\tbreak;\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/-- eof cc option\n\t\t\t\n\t\t\/\/-- set oc values\n\t\tif(strNewCC!=\"\") _swdoc.OC().costcenter = strNewCC;\n\t\t_swdoc.OC().priority = app.g.get_field(oRecSLD,\"fk_sla\");\n\t}\n}\n\n\nfunction check_ci_assessment()\n{\n    \/\/-- if use ci assessment levels\n   \tvar intUseCIrow = -1;\n    \n    if(app.itsm.get_ci_assessmnet_level_setting(\"Problem\")==1)\n    {\n    \tvar strUseSLA = \"\";\n\t\t\n\t\t\/\/-- get which SLA we should use based on CI\/s\t\t\t\n \t\tvar slaArray = new Array();\n \n \t\tvar oList = _swdoc.EF().sl_configitems;\n\t\tvar strSLAs = \"\";\n\t\tvar strVal=\"\";\n\t\tvar strSLAVal=\"\";\n\t\tfor (var x=0;x<oList.rowCount();x++)\n\t\t{\n\t\t\tstrVal = oList.GetItemTextRaw(x,\"fk_sla\");\n\t\t\tstrSLAVal = oList.GetItemTextRaw(x,\"fk_sld\");\n\t\t\tif(strVal ==\"[Use SLA Default Priority]\")\n\t\t\t{\n\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", strSLAVal);\n\t\t\t\tif(oRecSLD)\n\t\t\t\t{\t\n\t\t\t\t\tstrVal = oRecSLD.fk_ssla;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstrVal = app.g.pfs(strVal);\n\t\t\tif(strVal!=\"\")\n\t\t\t{\n\t\t\t\tif (strSLAs !=\"\")strSLAs +=\",\";\n\t\t\t\t\/\/strSLAs  += \"'\"+strVal+\"'\";\n\t\t\t\tstrSLAs  += \"\"+strVal+\"\";\n\t\t\t\tslaArray[strVal]=strSLAVal;\n\t\t\t}\n\t\t}\n\n \t\tvar oList = _swdoc.EF().sl_services;\n\t\tvar strVal=\"\";\n\t\tfor (var x=0;x<oList.rowCount();x++)\n\t\t{\n\t\t\tstrVal = oList.GetItemTextRaw(x,\"fk_sla\");\n\t\t\tstrSLAVal = oList.GetItemTextRaw(x,\"fk_sld\");\n\t\t\tif(strVal ==\"[Use SLA Default Priority]\")\n\t\t\t{\n\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", strSLAVal);\n\t\t\t\tif(oRecSLD)\n\t\t\t\t{\t\n\t\t\t\t\tstrVal = oRecSLD.fk_ssla;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstrVal = app.g.pfs(strVal);\n\t\t\tif(strVal!=\"\")\n\t\t\t{\n\t\t\t\tif (strSLAs !=\"\")strSLAs +=\",\";\n\t\t\t\t\/\/strSLAs  += \"'\"+strVal+\"'\";\n\t\t\t\tstrSLAs  += \"\"+strVal+\"\";\n\t\t\t\tslaArray[strVal]=strSLAVal;\n\t\t\t}\n\t\t}\n\n\t\t\/\/var strSLAs = app.g.get_sld_slas(strSLAs);\n  \t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Problem\/UseCILongestSLA\")==1)    \t\t\t\n\t\t{\n\t\t\tstrUseSLA = app.g.get_longest_sla(strSLAs);    \t\t\t\n    \t}\n    \telse\n    \t{\n    \t\tstrUseSLA = app.g.get_shortest_sla(strSLAs);\n    \t}\t\t\t\n\n\t\t\/\/-- if have SLA to use\n\t\tintUseCIRow = 0;\n\t\tvar boolIsService = false;\n\t\tif(strUseSLA!=\"\")\n\t\t{\n\t\t\tvar intSLD = slaArray[strUseSLA]; \t\t\t\t\t\n\t\t\t\/\/-- we have a prefered SLA - get the CI that has this SLA and use its assess levels\n\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems,strUseSLA,\"fk_sla\");\t\n\t\t\tif(intUseCIrow==-1)\n\t\t\t{\n\t\t\t\t\/\/not a ci found with priority\n\t\t\t\tboolIsService = true;\n\t\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_services,strUseSLA,\"fk_sla\");\n\t\t\t\tif(intUseCIrow==-1)\n\t\t\t\t{\n\t\t\t\t\t\/\/not found with priority try with SLA\n\t\t\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems,intSLD,\"fk_sld\");\t\n\t\t\t\t\tif(intUseCIrow==-1)\n\t\t\t\t\t{\n\t\t\t\t\t\tboolIsService = true;\n\t\t\t\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_services,intSLD,\"fk_sld\");\t\n   \t\t\t\t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_impact_level\");\n\t\t\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_urgency_level\"); \n\t\t\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIRow,\"pk_auto_id\");\n\t\t\t\t\t}else\n\t\t\t\t\t{\n    \t\t\t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_impact_level\");\n\t\t\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_urgency_level\");    \n\t\t\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIRow,\"pk_auto_id\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else{\n\t\t\t\t\t\/\/is a app.service found with sla\n   \t\t\t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_impact_level\");\n\t\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_urgency_level\"); \n\t\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIRow,\"pk_auto_id\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else{\n    \t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_impact_level\");\n\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_urgency_level\");    \n\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIRow,\"pk_auto_id\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.EF().sl_configitems.rowCount()==0)\n\t\t\t{\n\t\t\t\tboolIsService = true;\n\t\t\t\t\/\/-- no slas defined for CI\/s so try base it on assessment levels of first item\n    \t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"fk_impact_level\");\n\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"fk_urgency_level\"); \n\t\t\t\tvar intSLD =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"fk_sld\"); \n\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"pk_auto_id\");\n\t\t\t}else\n\t\t\t{\n\t\t\t\t\/\/-- no slas defined for CI\/s so try base it on assessment levels of first item\n    \t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"fk_impact_level\");\n\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"fk_urgency_level\"); \n\t\t\t\tvar intSLD =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"fk_sld\"); \n\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"pk_auto_id\");\n\t\t\t}\t\t\t\t\n\t\t\tif(intSLD>0)\n\t\t\t\tstrUseSLA = app.itsm.get_sla_from_slad_matrix(intSLD, strImpact, strUrgency);\n\t\t\t\n\t\t}\n\t\t_swdoc.intAssessmentCI = ciKey;\n\t\t\n\t\tif(strUrgency==\"\")strUrgency=_swdoc.strDefaultUrgency;\n \t\tif(strImpact==\"\")strImpact=_swdoc.strDefaultImpact;\n \t\t\n \t\t\n\t\tif(intSLD==\"\")\n\t\t{\n\n\t\t}else\n\t\t{\n\t\t\tif(intSLD>0)\n\t\t\t{\n\t\t\t\tvar oRec = app.g.get_record(\"itsmsp_slad\", intSLD);\t\n\t\t\t\tif(oRec)\n\t\t\t\t{\n\t\t\t\t\t\/\/-- F0108327\n\t\t\t\t\t_swdoc.handle_set_sladef(oRec.slad_id);\n\t\t\t\t\t_swdoc.handle_set_contract(intSLD);\t\/\/-- Set Contract Based on Selected SLA\n\t\t\t\t\tvar boolTemp = _swdoc.boolProblemSLASetManually;\n\t\t\t\t\t_swdoc.boolProblemSLASetManually = true;\n\t\t\t\t\t_swdoc.handle_set_priority(strUseSLA);\n\t\t\t\t\t_swdoc.boolProblemSLASetManually = boolTemp;\n\t\t\t\t\t\/\/--END\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t \n\t\tif(_swdoc.OC().itsm_sladef>0)\n\t\t{\n\t\t\tapp._een(_swdoc.MF().label_oc_priority, true);\n\t\t\tapp._een(_swdoc.MF().lb_oc_sla, true);\n\t\t}\t\t\n\n\t\t_swdoc.OC().itsm_urgency_level = strUrgency;\t\t\t\t\n\t\t_swdoc.OC().itsm_impact_level = strImpact;\t\t\t\t\n\t\t\n\t\t\/\/-- get and set profile code if it has'nt been set manually by the user\n\t\tif(boolIsService)\n\t\t{\n\t\t\tvar intCIid = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"pk_auto_id\");\n\t\t\tvar strCode = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_profilecode\");\t\t\n\t\t}else\n\t\t{\n\t\t\tvar intCIid = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"pk_auto_id\");\n\t\t\tvar strCode = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_profilecode\");\n\t\t}\n\t\t\n\t\tif(_swdoc.intProfileCodeCI==-1)\n\t\t{\n\t\t\t\/\/-- was manually set so ask if want to change it - but only if one to use is not blank\n\t\t\t\n\t\t\tif((strCode!=\"\")&&(strCode!=_swdoc.OC().probcode)&&(confirm(\"The recommended profile code to use for this problem differs from that of the one you selected. Do you want to change it?\")) )\n\t\t\t{\n\t\t\t\t_swdoc.OC().probcode = strCode;\n\t\t\t\t_swdoc.intProfileCodeCI = intCIid;\n\t\t\t}\n\t\t}\n\t\telse \n\t\t{\n\t\t\t\/\/MessageBox(\"strCode : \"+strCode);\n\t\t\tif(strCode!=_swdoc.OC().probcode)\n\t\t\t{\n\t\t\t\t\/\/-- only set if not blank\n\t\t\t\tif(strCode!=\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().probcode = strCode;\n\t\t\t\t\tmainform.SetTimer(2, 100)\n\t\t\t\t\t\/\/MF().tb_probcode.text=\"\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/MessageBox(\"intProfileCodeCI : \"+intCIid);\n\t\t\t_swdoc.UpdateFormFromData();\t\t\n \t\t\t_swdoc.intProfileCodeCI = intCIid;\t\t\t\n\t\t}\n   }\n\t_swdoc.UpdateFormFromData();\t\t\n     \n    return ciKey;\n\n}\n\n\/\/-- load sld info and settings\n\/\/-- load sld info and settings\nfunction handle_set_sladef(strNewSLD, boolValidate, boolOnResolve)\n{\n\tif(_swdoc.boolSLAEnforced)\n\t{\n\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t_swdoc.UpdateFormFromData();\n\t\tMessageBox(\"SLA is being enforced from the process.\");\n\t\treturn;\n\t}\n\n\tif(boolValidate==undefined)\n\t\tboolValidate==false;\n\tvar strDisplaySLD = strNewSLD;\n\n\tvar strUseSLD = strNewSLD;\n\tvar boolRelative = false;\n\tvar strRelative = \"\";\n\n\t\/\/-- get actual SLD ID if getting from related record\n\tswitch(strNewSLD)\n\t{\n\t\tcase \"[Use Profile SLA]\":\n\t\t\tif(_swdoc.OC().probcode!=\"\")\n\t\t\t{\n\t\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\t\t\t\tif(oRecSLD)\n\t\t\t\t{\n\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\tboolRelative = true;\n\t\t\t\t\tstrRelative = \"[Use Profile Priority]\";\n\t\t\t\t\t\/\/return false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Profile SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No profile has been set for this request. The Profile SLA cannot be used.\",16);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"[Use Charge Centre SLA]\":\n\t\t\tif(_swdoc.OC().costcenter!=\"\")\n\t\t\t{\n\t\t\t\tvar strCCUse = _swdoc.OC().costcenter;\n\t\t\t\tif(_swdoc.OC().costcenter==\"[Use Customer Charge Centre]\")\n\t\t\t\t{\n\t\t\t\t\tstrCCUse = _swdoc.oCust().costcenter;\n\t\t\t\t}\n\t\t\t\tif(strCCUse==\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Charge Centre SLA]\";\n\t\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tif(boolValidate)\n\t\t\t\t\t\tMessageBox(\"No charge centre has been set for this request. The charge centre SLA cannot be used.\");\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n                    \/\/-- 992268 Add the below line\n\t\t\t\t\t_swdoc.OC().costcenter = strCCUse;\n\t\t\t\t\tvar oRec = app.g.get_record(\"costcent\", strCCUse);\n\t\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\t\t\t\t\tif(oRecSLD)\n\t\t\t\t\t{\n\t\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\t\tboolRelative = true;\n\t\t\t\t\t\tstrRelative = \"[Use Charge Centre Priority]\";\n\t\t\t\t\t\t\/\/return false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Charge Centre SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No charge centre has been set for this request. The charge centre SLA cannot be used.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"[Use Customer SLA]\":\n\t\t\tif(_swdoc.oCust().keysearch==\"\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Customer SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No customer selected, cannot resolve customer SLA. Please select a valid SLA.\",16);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(_swdoc.oCust().sld==\"\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No Default SLA is associated to this Customer. Please select a valid SLA.\",16);\n\t\t\t\telse\n\t\t\t\t\tMessageBox(\"Customer does not have a default SLA.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.oCust().sld);\n\t\t\tif(oRecSLD)\n\t\t\t{\n\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\tboolRelative = true;\n\t\t\t\tstrRelative = \"[Use Customer Priority]\";\n\t\t\t\t\/\/return false;\n\t\t\t}\n\t\tbreak;\t\t\n\t\tcase \"[Use Process SLA]\":\n\t\t\tif(bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t{\n\t\t\t\tif(bpm_workflow.fk_default_sla_new==\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"No SLA has been set for the requests Business Process. The Process SLA cannot be used.\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar strSLA = bpm_workflow.fk_default_sla_name;\n\t\t\t\t\tif(strSLA.indexOf(\"[Use\")>-1 && strSLA.indexOf(\"SLA]\")>-1)\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.handle_set_sladef(bpm_workflow.fk_default_sla_name);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/var oRec = app.g.get_record(\"costcent\", strCCUse);\n\t\t\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", bpm_workflow.fk_default_sla_new);\n\t\t\t\t\t\tif(oRecSLD)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\t\t\tboolRelative = true;\n\t\t\t\t\t\t\tstrRelative = \"[Use Process Priority]\";\n\t\t\t\t\t\t\t\/\/return false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Process SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No process has been set for this request. The Process SLA cannot be used.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\t}\n\tif(strUseSLD!=\"\")\n\t{\n  \t\tvar oRecSLD = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strUseSLD);\n\t\tif(oRecSLD.Fetch())\n\t\t{\n\t\t\t\/\/-- load cost center option\n\t\t\tvar strNewCC = app.g.get_field(oRecSLD,\"chargeto_cc\");\n\t\t\tswitch(strNewCC)\n\t\t\t{\n\t\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\t\tbreak;\t\t\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t\/\/-- eof cc option\n\t\t\t\t\n\t\t\t\/\/-- set oc values\n\t\t\tif(strNewCC!=\"\") _swdoc.OC().costcenter = strNewCC;\n\t\t\t\/\/OC().priority = oRecSLD.fk_ssla;\t\n\t\t\t_swdoc.OC().itsm_sladef = \tapp.g.get_field(oRecSLD,\"pk_slad_id\");\n\t\t\t_swdoc.OC().itsm_slaname = app.g.get_field(oRecSLD,\"slad_id\");\n\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\n\t\t\tvar strFKSsla = app.g.get_field(oRecSLD,\"fk_ssla\");\n\t\t\tif(boolRelative)\n\t\t\t\t_swdoc.handle_set_priority(strRelative);\n\t\t\telse\n\t\t\t\t_swdoc.handle_set_priority(strFKSsla);\n\t\t\t\n\t\t\t\/\/-- check if customer dept has nay alternative settings\n\t\t\t_swdoc.check_customer_department_slad(strNewSLD,_swdoc.oCust().department);\n\t\t\t\n\t\t\tapp._een(_swdoc.MF().label_oc_priority, true);\n\t\t\tapp._een(_swdoc.MF().lb_oc_sla, true);\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t\telse\n\t\t{\n\t\t\tMessageBox(\"Failed to retrieve service level definition record for '\" + strDisplaySLD + \"'. Please contact your Supportworks Administrator\");\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nfunction handle_set_priority(strValue)\n{\n\tif(strValue==\"[Use SLA Default Priority]\")\n\t{\n\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.OC().itsm_sladef);\n\t\tif(oRecSLD)\n\t\t{\t\n\t\t\t_swdoc.OC().priority = oRecSLD.fk_ssla;\n\t\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Customer Priority]\")\n\t{\n\t\tif(_swdoc.oCust().keysearch!=\"\")\n\t\t{\n\t\t\tif(_swdoc.oCust().sld==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\tif(_swdoc.oCust().priority==\"[Use SLA Default Priority]\")\n\t\t\t\t\t_swdoc.handle_set_priority(\"[Use SLA Default Priority]\");\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.oCust().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The customer SLA is not the same as the currently selected SLA. The Customer priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\")\n\t\t\t\t{\n\t\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"No customer selected. The Customer priority cannot be used.\");\n\t\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Profile Priority]\")\n\t{\n\t\tif(_swdoc.OC().probcode!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.sla);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The Profile SLA is not the same as the currently selected SLA. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority=\"[Use Profile Priority]\";\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No profile has been set for this request. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Charge Centre Priority]\")\n\t{\n\t\tif(_swdoc.OC().costcenter!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.priority);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t\t{\n\t\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"The cost center SLA is not the same as the currently selected SLA. The cost center priority cannot be used.\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t{\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No cost center has been set for this request. The cost center priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Process Priority]\")\n\t{\n\t\tif(bpm_workflow.pk_workflow_id!=\"\")\n\t\t{\n\t\t\t\/\/var oRec = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(bpm_workflow.fk_default_sla_new==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(bpm_workflow.fk_default_sla);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The Process SLA is not the same as the currently selected SLA. The Process priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tMessageBox(\"No process has been set for this request. The process priority cannot be used.\");\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse\n\t{\n\t\tif (_swdoc.boolProblemSLASetManually)\n\t\t{\n\t\t\t_swdoc.OC().priority = strValue;\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t_swdoc.UpdateFormFromData();\n\t\treturn false;\n\t}\n}\n\nfunction handle_set_contract(strNewSLD)\n{\n\tvar strDefaultContract = app.g.filter_company_contracts(_swdoc.oCompany().pk_company_id, _swdoc.MF().lb_contract, strNewSLD);\n\tif(strDefaultContract!=\"\")\n\t{\n\t\t_swdoc.OC().fk_contract_id = strDefaultContract;\n\t\tapp.g.strLogAndResolveContract = strDefaultContract;\n\t}\n\t_swdoc.UpdateFormFromData();\n\t\t\n}"},{"name":"OnCallLoggedOK","code":"OnCallLoggedOK(nCallRef, dateRespondBy, dateFixBy, strCustName, strSla)\n{\n\t\/\/-- NWJ - 12-02.2007 - after logging problem link its CIs and Incidents\n    \/\/-- nwj \n    \/\/-- 15.03.2004\n    var intCallRef = app.g.callref_unpad(nCallRef);\n\n\t\/\/--\n\t\/\/-- loop through impacted sites and create link\n\t\n\tvar strText = \"\";\n\tvar strDiaryText=\"\";\n\tvar boolSites = false;\n\tvar strSiteCode\t=\"\";\t\n\tfor (var x=0;x < _swdoc.MF().sl_sites.rowCount();x++)\n\t{\n\t\tif (_swdoc.MF().sl_sites.IsRowChecked(x))\n\t\t{\n\t\t\tvar fk_ci_id = _swdoc.MF().sl_sites.GetItemTextRaw(x,'fk_cmdb_id');\n\t\t\tvar strSite = _swdoc.MF().sl_sites.GetItemTextRaw(x,'site_name');\n\t\t\tif(fk_ci_id>0)\n\t\t\t{\n\t\t\t\tboolSites= true;\n\t\t\t\tstrText += strSite+\".\\n\";\n\t\t\t\tapp.cmdb.relate_ci_to_call(intCallRef,fk_ci_id,'PROBLEM-SITE')\n\t\t\t}\n\t\t}\n\t}\t\n\t\n\tif(boolSites)\n\t{\n\t\tvar strActionSource = \"Problem Management\";\n\t\tvar strCode\t\t\t= \"Site Added\";\t\n\t\tvar strDiaryText = \"The following site (s) have been reported as experiencing this problem.\\n\" + strText;\t\n\t\tapp.g.new_dairyevent(intCallRef,strDiaryText,strActionSource,strCode);    \t\t\n\t}\n\n    \/\/-- loop through causing CI and assign them to this call\n\tvar strDiaryText = \"The following Configuration Items were identified as the cause of this problem.\\n\";\n\tvar boolCIs = false;\n    var olist = _swdoc.EF().sl_configitems;\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolCIs =true;\n        var pk_ci_id = olist.GetItemTextRaw(x,0);\n        var ci_item_key = olist.GetItemTextRaw(x,1);\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'PROBLEM-CAUSE'))\n\t\t{\n\t\t\tstrDiaryText    += \"Configuration Item (\" + ci_item_key + \"). \\n\";\n\t\t}\n    }\n\n    \/\/-- loop through causing Services and assign them to this call\n\tvar strServiceDiaryText = \"The following Services were identified as the cause of this problem.\\n\";\n\tvar boolServices = false;\n    var olist = _swdoc.EF().sl_services;\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolServices =true;\n        var pk_ci_id = olist.GetItemTextRaw(x,0);\n        var ci_item_key = olist.GetItemTextRaw(x,1);\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'PROBLEM-CAUSE'))\n\t\t{\n\t\t\tstrServiceDiaryText    += \"Service (\" + ci_item_key + \"). \\n\";\n\t\t}\n    }\n    \n    \/\/-- loop through causing Releases and assign them to this call\n\tvar strRelDiaryText = \"The following Releases were identified as the cause of this problem.\\n\";\n\tvar boolRel = false;\n    var olist = _swdoc.EF().sl_rels;\n    var strReleases = app.g.sl_get_valuesdel(_swdoc.EF().sl_rels,0,\",\");\n    if (strReleases !=\"\")\n    {\n    \tvar arrReleases = strReleases.split(\",\");\n    \tfor (var x=0; x < olist.rowCount(); x++)\n   \t\t{\n    \t\tboolRel =true;\n        \tvar release_id = olist.GetItemTextRaw(x,0);\n\t\n\t\t\t\/\/-- Relate the release to the call\n\t\t\tif (app.g.relate_calls(release_id,intCallRef,'RELEASE-CPROBLEM'))\n\t\t\t{\n\t\t\t\tstrRelDiaryText    += \"Release (\" + app.g.pad_callref(release_id) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update problem diary\n\t\t\t\tstrRelText = \"The problem (\" + nCallRef + \") has been associated as being caused by this release\";\n\t\t\t\tapp.g.new_diaryevent(arrReleases[x],strRelText,\"Problem Management\",\"Problem Association\");\n\t\t\t}\n    \t}\n    }\n\n\t\/\/-- affected CIs\n    var olist = _swdoc.EF().sl_impactcis;\n    var boolAffCIs = false;\n\tvar strCauseDiaryText = \"\\nThe following Configuration Items were identified as being impacted upon by this problem.\\n\";    \n    for (var x=0; x < olist.rowCount(); x++)\n    {\n    \tboolAffCIs = true;\n        var pk_ci_id = olist.GetItemTextRaw(x,0);\n        var ci_item_key = olist.GetItemTextRaw(x,1);\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'PROBLEM-AFFECT'))\n\t\t{\n\t\t\tstrCauseDiaryText    += \"Configuration Item (\" + ci_item_key + \"). \\n\"\n\t\t}\n    }    \n    \n    \/\/-- if we have CI to add add it\n    if (boolCIs)\n    {\n\t\tvar strActionSource = \"Problem Management\";\n\t\tvar strCode\t\t\t= \"Linking Configuration Items\";\n\t\tif(boolAffCIs) strDiaryText += strCauseDiaryText;\n\t\tapp.g.new_dairyevent(intCallRef,strDiaryText,strActionSource,strCode);    \n    }\n\n    \/\/-- if we have CI to add add it\n    if (boolServices)\n    {\n\t\tvar strActionSource = \"Problem Management\";\n\t\tvar strCode\t\t\t= \"Linking Services\";\n\t\tapp.g.new_dairyevent(intCallRef,strServiceDiaryText,strActionSource,strCode);    \n    }\n    \n    \/\/-- if we have Release to add add it\n    if (boolRel)\n    {\n\t\tvar strActionSource = \"Problem Management\";\n\t\tvar strCode\t\t\t= \"Linking Releases\";\n\t\tapp.g.new_dairyevent(intCallRef,strRelDiaryText,strActionSource,strCode);    \n    }\n    \n    \/\/ -- If we have a CI or Service, then check whether the first Stage requires Authorisations for Service Owner, Technical Owner and CI Owner\n    if(boolCIs || boolServices)\n    {\n\t\tvar xmlmc = new XmlMethodCall();\n\t\txmlmc.SetParam(\"in_callref\", intCallRef);\n\t\txmlmc.Invoke(\"vpme\", \"checkStageAuth\");\n\t}\t\n\n\n    \/\/-- insert a relationship between incident and problem \/ ke\n    var strIncidents = app.g.sl_get_valuesdel(_swdoc.EF().sl_incs,0,\",\");\n    if (strIncidents !=\"\")\n    {\n    \tvar strText = \"This problem has been associated with the following Incidents\\n\\n\";\n    \tvar arrIncidents = strIncidents.split(\",\");\n    \tfor(var x=0; x < arrIncidents.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(intCallRef,arrIncidents[x],'PROBLEM-INCIDENT'))\n\t\t\t{\n\t\t\t\tstrText += \"Incident (\" + app.g.pad_callref(arrIncidents[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrIncText = \"The problem (\" + nCallRef + \") has been associated to this Incident\";\n\t\t\t\tapp.g.new_diaryevent(arrIncidents[x],strIncText,\"Problem Management\",\"Problem Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Problem Management\",\"Incident Association\");\n    }\n\n    \/\/-- insert a relationship between incs and doc\n    if(!app.g.use_sw_knowledgebase())\n\t{\n\t\tif(app.strKnowledgebaseDefaultTool.toLowerCase()==\"rightanswers\")\n\t\t{\n\t\t\tvar strDocs = app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\");\n    \t\tif (strDocs !=\"\")\n    \t\t{\n    \t\t\tvar strText = \"This Problem has been associated with the following Knowledgebase Documents\\n\\n\";\n    \t\t\tvar arrDocs = strDocs.split(\",\");\n    \t\t\tfor(var x=0; x < arrDocs.length; x++)\n    \t\t\t{\n\t\t\t\t\t\/\/-- call app.g method to link problem to problem\n\t\t\t\t\tapp.g.relate_call_to_rakb(arrDocs[x],intCallRef,'Used','Problem',false);\n\t\t\t\t\tstrText += \"Knowledgebase Document (\" + arrDocs[x] + \") associated\\n\";\n\t\t\t\t}\t\t\t\n\t\t\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Problem Management\",\"Knowledgebase Document Association\");\n    \t\t}\n\t\t}\n\t}\n\telse\n\t{\n    \tvar strDocs = app.g.sl_get_valuesdel(_swdoc.EF().sl_kbs1,0,\",\");\n    \tif (strDocs !=\"\")\n    \t{\n    \t\tvar strText = \"This Problem has been associated with the following Knowledgebase Documents\\n\\n\";\n    \t\tvar arrDocs = strDocs.split(\",\");\n    \t\tfor(var x=0; x < arrDocs.length; x++)\n    \t\t{\n\t\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\t\tapp.oKB.relate_call_to_kb(arrDocs[x],intCallRef,'Used');\n\t\t\t\tstrText += \"Knowledgebase Document (\" + arrDocs[x] + \") associated\\n\";\n\t\t\t}\t\t\t\n\t\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Problem Management\",\"Knowledgebase Document Association\");\n    \t}\n   }\n    \n    \/\/--F0086525 & PM00128139\n    var oRec = app.g.get_sys_record(\"opencall\", intCallRef);\n\tif(typeof oRec.logdatex === \"number\")\n\t{\n\t\toRec.logdatex = app.g.fix_epoch(oRec.logdatex);\n\t\titsm_opencall_problem.logdatex = oRec.logdatex; \n\t}\n\telse\n\t{\n\t\titsm_opencall_problem.logdatex = app.global.GetCurrentEpocTime();\n\t}\n\n\t\/\/-- F0105032 - audit trail if incoming call\t\n\tif(_swdoc._form.PreloadType==2)\n\t{\n\t\tif(_swdoc.OC().bpm_workflow_id!=\"\")\n\t\t{\n\t\t\tvar intEpochTime = app.global.GetCurrentEpocTime();\n\t\t\tvar oAnalyst = app.g.get_sys_record(\"swanalysts\",app.session.analystId);\n\t\t\tvar oGroup = app.g.get_sys_record(\"swgroups\",app.session.groupId);\n\t\t\tvar strParams = \"fk_workflow_id=\"+app.pfu(_swdoc.OC().bpm_workflow_id);\n   \t\t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_audit_fields\",strParams);\n\t\t\twhile(oRS.Fetch())\n\t\t\t{\n\t\t\t\tvar strBinding = app.g.get_field(oRS,\"fieldname\");\n\t\t\t\tarrBinding = strBinding.split(\".\");\n\t\t\t\tvar strTable = arrBinding[0];\n\t\t\t\tvar strColName = arrBinding[1];\n\t\t\t\t\n\t\t\t\tvar oldValue = \"\";\n\t\t\t\tif(strTable==\"opencall\")\n\t\t\t\t\tvar oldValue = _swdoc.oOpencall[strColName];\n\t\t\t\telse\n\t\t\t\t\tvar oldValue = _swdoc.oExtended[strColName];\n\t\t\t\t\n\t\t\t\tvar newValue = _swdoc[strTable][strColName];\n\t\t\t\tif(app.g.dd_isnumeric(strTable, strColName))\n\t\t\t\t{\n\t\t\t\t\tif(newValue<0)\n\t\t\t\t\t\tnewValue = app.g.fix_epoch(newValue);\n\t\t\t\t\tif(oldValue<0)\n\t\t\t\t\t\toldValue = app.g.fix_epoch(oldValue);\n\t\t\t\t}\n\t\t\t\tif(oldValue!=newValue)\n\t\t\t\t{\n\t\t\t\t\tvar strFieldDisplay = dd.tables[app.LC(strTable)].columns[strColName].DisplayName;\n\t\t\t\t\tvar strFmtOldValue = app.g.dd_format(strTable, strColName, oldValue);\n\t\t\t\t\tvar strFmtNewValue = app.g.dd_format(strTable, strColName, newValue);\n\t\t\t\t\tvar oInsertTmp = new app.oXmlmcInsert('oc_audit');\n\t\t\t\t\toInsertTmp.setfield('fk_callref',_swdoc.OC().callref);\n\t\t\t\t\toInsertTmp.setfield('updatetimex',intEpochTime);\n\t\t\t\t\toInsertTmp.setfield('updatedby',app.session.analystId);\n\t\t\t\t\toInsertTmp.setfield('updatedbyname',oAnalyst.name);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroup',app.session.groupId);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroupname',oGroup.name);\n\t\t\t\t\toInsertTmp.setfield('databinding',strBinding);\n\t\t\t\t\toInsertTmp.setfield('bindingfield',arrBinding[1]);\n\t\t\t\t\toInsertTmp.setfield('bindingtable',arrBinding[0]);\n\t\t\t\t\toInsertTmp.setfield('fielddisplay',strFieldDisplay);\n\t\t\t\t\toInsertTmp.setfield('oldvalue',oldValue);\n\t\t\t\t\toInsertTmp.setfield('newvalue',newValue);\n\t\t\t\t\toInsertTmp.setfield('fmtoldvalue',strFmtOldValue);\n\t\t\t\t\toInsertTmp.setfield('fmtnewvalue',strFmtNewValue);\n\t\t\t\t\toInsertTmp.execute();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\/\/-- EOF F0105032 \n}"},{"name":"OnRecordValueChanged","code":"OnRecordValueChanged(strTable, strColumn, strValue, strOldValue)\n{\n\t\/\/-- if update db is changed add it to problem_desc\n\tif((strTable == \"updatedb\") && (strColumn==\"updatetxt\"))\n\t{\n\t\t_swdoc.PRB().prb_info = strValue;\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\t\n\t\/\/-- NWJ - check to see if user has changed the itsm_opencall_rfc table field\n\t\/\/-- to search for raised by and monitored by analyst - so it works like resolving a customer.\n\telse if(strTable==\"itsm_opencall_problem\")\n\t{\n\t\tvar oAnalyst = false;\n\t\tif((strColumn.indexOf(\"raised_\") == 0))\n\t\t{\n\t\t\t\/\/-- get db col name based on passed in col name\n\t\t\tvar strDBCol=\"\";\n\t\t\t\/\/MessageBox(strColumn.split(\"_\")[2])\n\t\t\tswitch(strColumn.split(\"_\")[2])\n\t\t\t{\n\t\t\t\tcase \"analystid\":\n\t\t\t\t\tstrDBCol=\"analystid\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"name\":\n\t\t\t\t\tstrDBCol=\"name\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"group\":\t\t\t\t\t\n\t\t\t\t\tstrDBCol=\"supportgroup\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"telephone\":\n\t\t\t\t\tstrDBCol=\"contactb\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"email\":\n\t\t\t\t\tstrDBCol=\"contacte\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tMessageBox(\"The extended problem column (\" + strColumn + \") cannot be matched to swanalysts. Please contact your Supportworks Administrator.\");\n\t\t\t\t\t_swdoc.set_rfc_analyst(false,true);\n\t\t\t\t\treturn;\n\t\t\t\t\tbreak;\t\t\t\t\t\t\t\t\n\t\t\t}\n\t\t}\n\t\tif(strColumn.indexOf(\"raised_\") == 0)\n\t\t{\n\t\t\t\/\/-- auto search raised by\n\t\t\tapp.g.resolve_analyst(strDBCol,strValue,function(oAnalyst)\n\t\t\t{\n\t\t\t\tif(oAnalyst) _swdoc.set_prb_analyst(oAnalyst);\n\t\t\t});\n\t\t}\t\t\n\t}\n\t\n\t\/\/RJC 3.0 - set recognition profile to the same profile as problem profile\n\telse if((strTable == \"opencall\") && (strColumn==\"probcode\"))\n\t{\n\t\t_swdoc.boolChangeProfile = true;\n  \t\tmainform.SetTimer(4, 100);\n\t\titsm_opencall_problem.inc_profilecode = strValue;\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\tmainform.UpdateFormFromData();\n\t}\n\t\n\telse if(strColumn==\"priority\" && strTable == \"opencall\")\n    {\n    \tif(_swdoc.boolChangeProfile)\n    \t{\n\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\tvar oSLA = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\n\t\t\t_swdoc.handle_set_sladef(oSLA.slad_id);\n\t\t\t_swdoc.boolProblemSLASetManually = true;\n\t\t\t_swdoc.handle_set_priority(oRec.sla);\n \t\t\t_swdoc.UpdateFormFromData();\n   \t\t}\n    }\n    else if( (strColumn==\"itsm_impact_level\")||(strColumn==\"itsm_urgency_level\") )\n    {\n    \t_swdoc.boolProblemSLASetManually = true; \/\/--107865\n    \t\n    \tif(_swdoc.OC().itsm_sladef!=\"\")\n    \t{\n    \t\t\/\/-- if use incident assessment over ci\n    \t\t\/\/if(app.itsm.get_ci_assessmnet_level_setting(\"Problem\")!=1)\n    \t\t\/\/{\n    \t\t\tvar strPriority = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level);\n    \t\t\tif(strPriority!=\"\")\n   \t\t\t\t\t_swdoc.handle_set_priority(strPriority);\n    \t\t\t_swdoc.UpdateFormFromData();\n    \t\t\/\/}\n    \t}\n    }\n    else if (strColumn==\"fk_company_id\"||strColumn==\"site\"||strColumn==\"fk_dept_code\"||strColumn==\"costcenter\"||strColumn==\"pk_workflow_id\")\n\t{\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n\n    \n}"},{"name":"OnValidate","code":"OnValidate()\n{\n\t_swdoc.PRB().suppgroup = app.session.groupId;\n\t_swdoc.PRB().prb_callclass = \"Problem\";\n\t\n\t\/\/-- app.itsm 2.4.0 - check if need mandatory ci\n\tif(bpm_workflow.flg_requireci==1)\n\t{\n\t\tif(_swdoc.EF().sl_configitems.rowCount() < 1)\n\t\t{\n\t\t\tif(_swdoc.EF().sl_services.rowCount() < 1)\n\t\t\t{\n\t\t\t\tMessageBox(\"Before logging this Problem request you have to associate at least one causing configuration item or service\");\n\t\t\t\treturn VALIDATE_FAIL;\n\t\t\t}\n\t\t}\n\t}\n\n\t\/\/-- 108840 : Check if we have required number of CIs \n\tvar strCallType = \"Problem\";\n\tvar intCurCINo = _swdoc.EF().sl_configitems.rowCount() + _swdoc.EF().sl_services.rowCount();\n\tif(!app.itsm.mandatory_ci_check(strCallType, intCurCINo))\n\t{\n\t\tvar intReqCINo = app.oSettings.get_setting(\"int\" + strCallType + \"OnLoggingRequiredCINo\");\n\t\tvar strPlural = \"\";\n\t\tif (intReqCINo > 1)\n\t\t{\n\t\t\tstrPlural= \"s\";\n\t\t}\n\t\tMessageBox(\"Before logging this \" + strCallType + \" request you have to associate at least \" + intReqCINo + \" causing configuration item\" + strPlural + \" or service\" + strPlural + \".\");\n\t\treturn VALIDATE_FAIL;\n\t}\n\t\n\t_swdoc.OC().itsm_title = _swdoc.PRB().prb_title;\n\t\n\t\n\t\/\/-- nwj - hide confirmation if we have no customer\n\tif(userdb.keysearch==\"\")\n\t{\n\t\n\t\tapp.g.bPromptToOpenCallDetails = true;\n\t\tapp.g.bDoNotShowLogCallConfirmation = true;\n\t}\n\telse\n\t{\n\t\tapp.g.bDoNotShowLogCallConfirmation = false;\n\t}\t\n\t\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"OnLogAndAssignCall","code":"OnLogAndAssignCall(strGroupID, strAnalystID)\n{\n\t_swdoc.PRB().suppgroup = strGroupID;\n\tvar strDefaultGroup = dd.GetGlobalParamAsString(\"Application Settings\/Problem\/DefaultAssignmentGroup\");\n\tif(strDefaultGroup!=\"\")\n\t{\n\t\tif(strDefaultGroup!=_swdoc.PRB().suppgroup)\n\t\t{\n\t\t\tvar strDefaultAnalyst = dd.GetGlobalParamAsString(\"Application Settings\/Problem\/DefaultAssignmentAnalyst\");\n\t\t\tvar strDisplayAnalyst = \":\"+strDefaultAnalyst;\n\t\t\tif(strDefaultAnalyst==\"\")\n\t\t\t\tstrDisplayAnalyst = \"\";\n\t\t\tvar boolConfirm = confirm('The default assignment for problem records is '+strDefaultGroup+strDisplayAnalyst+'. Do you want to use the default?');\n\t\t\tif(boolConfirm)\n\t\t\t{\n\t\t\t\t_swdoc.OC().suppgroup = strDefaultGroup;\n\t\t\t\t_swdoc.OC().owner = strDefaultAnalyst;\n\t\t\t\tif(_swdoc.OC().owner!=\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().status = 3;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_swdoc.OC().custom_i3=0;\n\treturn true;\n}"},{"name":"OnRecordResolved","code":"OnRecordResolved(strTable)\n{\n\t\/\/-- set sla based on worflow default\n\t\/\/-- 92592\n\tif(IsObjectDefined(\"mainform\") && (strTable==\"bpm_workflow\"))\n\t{\n\t\tvar boolSet = true;\n\t\tvar boolEnable = true;\n\n\t\tif(bpm_workflow.fk_default_sla_new>0)\n\t\t{\n\t\t\tvar boolSLA = bpm_workflow.flg_sla_apply>0;\n\t\t\tif(boolSLA)\n\t\t\t{\n\t\t\t\tvar boolSet = true;\n\t\t\t\tif(_swdoc.boolProblemSLASetManually)\n\t\t\t\t{\n\t\t\t\t\tvar boolOverride = confirm(\"It is recommended to use SLA set against the process.\\n\\n\\Would you like to set the SLA to the process value?\");\n\t\t\t\t\tif(!boolOverride)\n\t\t\t\t\t\tboolSet = false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(boolSet)\n\t\t\t\t{\n\t\t\t\t\tif(bpm_workflow.flg_sla_enforce==1)\n\t\t\t\t\t\tboolEnable = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tboolSet = false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tboolSet = false;\n\t\t}\n\t\t\n\t\tif(boolSet)\n\t\t{\n\t\t\t\/\/--F0107934\n\t\t\t_swdoc.boolSLAEnforced = false;\n\t\t\t_swdoc.handle_set_sladef(bpm_workflow.fk_default_sla_name,false,true);\n\t\t\tvar boolTempSLASetManually = _swdoc.boolProblemSLASetManually;\n\t\t\t_swdoc.boolProblemSLASetManually = true;\n\t\t\t_swdoc.handle_set_priority(bpm_workflow.fk_default_sla);\n\t\t\t_swdoc.boolProblemSLASetManually = boolTempSLASetManually;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\/\/--End\n\t\t\tif(!boolEnable)\n\t\t\t{\n\t\t\t\tapp._een(mainform.lb_oc_slad1,false);\n\t\t\t\tapp._een(mainform.Label5,false);\n\t\t\t\t_swdoc.boolSLAEnforced = true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(boolEnable)\n\t\t{\n\t\t\tapp._een(mainform.lb_oc_slad1,true);\n\t\t\tapp._een(mainform.Label5,true);\n\t\t\t_swdoc.boolSLAEnforced = false;\n\t\t}\n\t\tapp.g.process_bpm_form_attribute_check(_swdoc,bpm_workflow.pk_workflow_id);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n\t\n\t\/\/-- refresh site list of customer co is different\n\tif (IsObjectDefined(\"mainform\") && strTable == \"userdb\")\n\t{\n\t\tif(app.LC(_swdoc.oCust().fk_company_id) != app.LC(_swdoc.strCurrentCompanyID))\n\t\t{\n\t\t\t_swdoc.strCurrentCompanyID = _swdoc.oCust().fk_company_id;\n\t\t}\n\t\t\n\t\t\/\/-- check if customer is in active    \t\n    \tvar strCustStatusMsgValue = dd.GetGlobalParamAsString(\"Application Settings\/CustomerStatusMessages\/\" + _swdoc.oCust().status);\n\t\tif(strCustStatusMsgValue!=\"\")\n\t\t{\n\t\t\tMessageBox(strCustStatusMsgValue);\n\t\t}\n\t\t\/\/-- log from email fix\n\t\tif(app.LC(_swdoc.oCust().fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\t\n\t\t{\n\t\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", _swdoc.oCust().fk_company_id);\n\t\t}\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n\tif(strTable == \"company\")\n \t{\n \t\t\/\/-- Grab Company Record\n \t\tvar oCompanyTemp = app.g.get_record(\"company\",_swdoc.oCompany().pk_company_id,'companyname');\n \t\t\/\/--F0110887 Start\n\t\tvar intExpiryEpoch = app.g.fix_epoch(oCompanyTemp.supportexpiryx);\n\t\tapp.g.checkOrgSupport(_swdoc.oCust().companyname, intExpiryEpoch, true);\n\t\t\/\/--F0110887 End\n \t}\n    if (IsObjectDefined(\"mainform\") && strTable == \"company\")\n    {\n    \tapp.g.strLogAndResolveCompany = _swdoc.oCompany().pk_company_id;\n    \t\n    \t\/\/ -- Display the Org \"Alert Contents\" message\n    \tif(_swdoc.oCompany().recordresolvedmsg!=\"\")MessageBox(_swdoc.oCompany().recordresolvedmsg);\n    \t\n    \tif(app.LC(_swdoc.oCompany().pk_company_id) != app.LC(_swdoc.oCust().fk_company_id))\n    \t{\n    \t\t_swdoc.ResetRecord('userdb');\n\t\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Change\/OnOrganisationResolveCustomer\")==1)\n\t\t\t{\n\t\t\t\t_swdoc.boolResolvingCust = true;\n\t\t\t\tmainform.SetTimer(1, 10);\n\t\t\t}\n\t\t}\n    \t\t\n\t\tif(_swdoc.OC().costcenter!=\"\"){\n\t\t\tvar recCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(app.LC(recCC.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().costcenter = \"\";\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_cc, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(_swdoc.OC().fk_dept_code!=\"\"){\n\t\t\tvar recCC = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(app.LC(recCC.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().fk_dept_code = \"\";\n\t\t\t\t\tapp._ete(_swdoc.MF().fld_oc_dept, \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t_swdoc.check_cis();\n \t\t_swdoc.strCurrentCompanyID = _swdoc.oCompany().pk_company_id;\n \t\t_swdoc.filter_company_sites();\n\t\t\n\t\t\/\/-- Filter Contracts for Company\n\t\tapp.g.filter_company_contracts(_swdoc.oCompany().pk_company_id, _swdoc.MF().lb_contract);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\n\n}"},{"name":"OnResolveRecord","code":"OnResolveRecord(strTable, strColumn, strValue)\n{\n \t\/\/-- resolving the customer record\n \tif(IsObjectDefined(\"mainform\") && strTable == 'userdb' && _swdoc.boolResolvingCust == false && strValue!=\"\")\n \t{\n  \t\tif(strColumn ==\"firstname!surname\")\n  \t\t{\n  \t\t\t\/\/-- if using customer name search on firstname and lastname\n  \t\t\t\/\/-- 2.4.1 bug fix 79046\n   \t\t\tarrNames = strValue.split(\" \");\n   \t\t\tif(arrNames[1]==undefined)\n   \t\t\t{\n      \t\t\tvar strParams = \"_swc_firstname=\"+arrNames[0];\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0];\n    \t\t}\n   \t\t\telse\n   \t\t\t{\n    \t\t\tvar strLastName=\"\";\n    \t\t\tfor(var y=1;y<arrNames.length;y++)\n    \t\t\t{\n     \t\t\t\tif(y>1)strLastName = strLastName+\" \";\n     \t\t\t\tstrLastName = strLastName+arrNames[y];\n    \t\t\t}\n      \t\t\tvar strParams =  \"_swc_firstname=\"+arrNames[0]+\"&_swc_surname=\"+strLastName;\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0]+\"&surname=\"+strLastName;\n   \t\t\t}\n  \t\t}\n  \t\telse\n  \t\t{\n      \t\tvar strParams =  \"_swc_\"+strColumn+\"=\"+strValue;\n      \t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\tvar strSearch = strColumn+\"=\"+strValue;\n   \t\t}\n\t\tif(intCount!=1 && !_swdoc.boolCustid_fromCall)\n\t\t{\n\t\t\t_swdoc.strSearchFor = strSearch;\n  \t\t\tmainform.SetTimer(1, 100);\n  \t\t\t_swdoc.boolResolvingCust = true;\n  \t\t\treturn \"\";\n \t\t}\n \t}\n \t\n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'company' && strValue ==\"\")\n \t{\n  \t\t\/\/2.4 clear down list if user is being unselected\n  \t\t_swdoc.ResetRecord('userdb');\n \t\tapp.g.strLogAndResolveCompany = \"\";\n\t} \n\n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'bpm_workflow' && strValue ==\"\")\n \t{\n\t\tapp._een(mainform.lb_oc_slad1,true);\n\t\tapp._een(mainform.Label5,true);\n\n\t\tapp.g.reset_bpm_form_attribute_check(_swdoc);\n\t} \n \n return strValue;\n}"},{"name":"OnLogCall","code":"OnLogCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strDefaultGroup = dd.GetGlobalParamAsString(\"Application Settings\/Problem\/DefaultAssignmentGroup\");\n\tvar strDefaultAnalyst = dd.GetGlobalParamAsString(\"Application Settings\/Problem\/DefaultAssignmentAnalyst\");\n\tif(strDefaultGroup!=\"\")\n\t{\n\t\t_swdoc.OC().suppgroup = strDefaultGroup;\n\t\t_swdoc.OC().owner = strDefaultAnalyst;\n\t\tif(_swdoc.OC().owner!=\"\")\n\t\t{\n\t\t\t_swdoc.OC().status = 3;\n\t\t}\n\t}\n\t\n\t_swdoc.OC().custom_i3=0;\n\t\n\treturn true;\n}"},{"name":"OnPreValidate","code":"OnPreValidate()\n{\n    \/\/--F0110887 Start\n    var intExpiryEpoch = app.g.fix_epoch(_swdoc.oCompany().supportexpiryx);\n\tvar boolOrgSupported = new Boolean(app.g.checkOrgSupport(_swdoc.oCompany().companyname, intExpiryEpoch, false));\n\tif (boolOrgSupported==false)\n\t{\n\t\t MessageBox(\"You cannot log this call as the '\" + _swdoc.oCompany().companyname + \"' organisation is no longer supported.\");\n\t\t return VALIDATE_FAIL;\n\t}\n    \/\/--F0110887 End\n    \n    var boolResolve = false;\n\tif(\t_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\"||_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Workflow SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\tboolResolve = true;\n\tif(boolResolve)\n\t{\n\t\tvar boolOK = _swdoc.handle_set_sladef(_swdoc.OC().itsm_slaname,true);\n\t\tif(!boolOK)\n\t\t\treturn VALIDATE_FAIL;\n\t}\n\t\n\tif (!app.g.resolve_default_priority(_swdoc.OC().priority,_swdoc,\"Problem\")){\n\treturn VALIDATE_FAIL;\n\t}\n\t\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"OnFormClosing","code":"OnFormClosing()\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.strLogAndResolveContract = \"\";\n\tapp.g.strLogAndResolveCompany = \"\";\n\n\tapp.strRAKbDocFilter=\"\";\n\t\n\treturn true;\n}"},{"name":"OnAcceptCall","code":"OnAcceptCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.OC().custom_i3=0;\n\t\n\treturn true;\n}"},{"name":"OnTakeCall","code":"OnTakeCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.OC().custom_i3=0;\n\t\n\treturn true;\n}"}]}}},"layout":{"appearance":{"width":"867","height":"616","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Field10","type":"Field","group":"TabCust:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"120","left":"98","right":"319","bottom":"138"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.raised_by_analystid"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field10","type":"Field","group":"TabCust:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"142","left":"98","right":"319","bottom":"160"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.raised_by_name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_rbsupp","type":"Field","group":"TabCust:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"164","left":"98","right":"319","bottom":"182"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.raised_by_group"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","displayColumnValue":"General Support","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","sqlSource":"syscache","distinctTable":"swgroups","distinctColumn":"id","displayColumn":"name","borderColor":"#c0c0c0","storedQuery":"common.getSupGroups"}}},{"general":{"name":"Field7","type":"Field","group":"TabCust:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"186","left":"98","right":"319","bottom":"204"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.raised_by_telephone"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field8","type":"Field","group":"TabCust:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"208","left":"98","right":"319","bottom":"226"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.raised_by_email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"btn_pick_rb","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"5","caption":"Pick Analyst","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"230","left":"215","right":"319","bottom":"253"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"tb_probtitle","type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"362","left":"98","right":"859","bottom":"380"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.prb_title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_info","type":"Field","group":"TabDescs:0"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"411","left":"106","right":"852","bottom":"599"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"itsm_opencall_problem.prb_info"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_profile","type":"Field","group":"TabDet:0"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"338","left":"452","right":"859","bottom":"356"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"data":{"binding":"opencall.probcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Click on this field to browse for and select a category for this call","activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"Field2","type":"Field","group":"TabDet:0"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"120","left":"452","right":"607","bottom":"138"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Critical|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_impact_lvl","distinctColumn":"pk_impact","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_cc","type":"Field","group":"TabDet:0"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"182","left":"452","right":"607","bottom":"200"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"The charge centre for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_oc_dept","type":"Field","group":"TabDet:0"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"203","left":"452","right":"607","bottom":"221"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"The department for this call","sqlSource":"swdata","distinctTable":"department","distinctColumn":"pk_dept_code","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","image":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","displayColumn":"dept_name","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_slad1","type":"Field","group":"TabDet:0"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"225","left":"452","right":"607","bottom":"243"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_slaname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsmsp_slad","distinctColumn":"slad_id","extraOptions":"[Use Customer SLA]=&[userdb.sld_name]^[Use Profile SLA]=&[_form.profilesla]^[Use Charge Centre SLA]=&[costcent.sla]^[Use Process SLA]=&[bpm_workflow.fk_default_sla_new]","disabledBackgroundColor":"#eeeeee","listFilter":"_swc_archive=0","storedQuery":"requests.filter_itsm_sla"}}},{"general":{"name":"lb_oc_sla","type":"Field","group":"TabDet:0"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"247","left":"452","right":"607","bottom":"265"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"itsmsp_slad_priority","distinctColumn":"fk_priority","listFilter":"_swc_fk_slad=&[opencall.itsm_sladef]&_swc_flg_sla=1","extraOptions":"[Use SLA Default Priority]=&[itsmsp_slad.fk_priority]^[Use Customer Priority]=&[userdb.priority]^[Use Charge Centre Priority]=&[costcent.priority]^[Use Profile Priority]=&[_form.probcodesla]^[Use Process Priority]=&[bpm_workflow.fk_default_sla]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lb_contract","type":"Field","group":"TabDet:0"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"269","left":"452","right":"607","bottom":"287"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"contract","distinctColumn":"pk_contract_id","displayColumn":"title","disabledBackgroundColor":"#eeeeee","storedQuery":"requests.filter_company_contracts"}}},{"general":{"name":"fld_bpm_workflow","type":"Field","group":"TabDet:0"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"292","left":"452","right":"607","bottom":"310"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"bpm_workflow.pk_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","sqlSource":"swdata","distinctTable":"bpm_workflow","distinctColumn":"pk_workflow_id","disabledBackgroundColor":"#eeeeee","listFilter":"_swc_callclass=Problem&_swc_flg_active=1","borderColor":"#c0c0c0","storedQuery":"requests.filter_bpm_selection"}}},{"general":{"name":"Field3","type":"Field","group":"TabDet:0"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"120","left":"684","right":"839","bottom":"138"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.itsm_urgency_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Immediate|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_urgency_lvl","distinctColumn":"pk_urgency","storedQuery":"generic.select"}}},{"general":{"name":"Field4","type":"Field","group":"TabDet:0"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"182","left":"684","right":"839","bottom":"200"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","sqlSource":"swdata","storedQuery":"common.getSwList","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ORIGIN"}}},{"general":{"name":"fld_environment","type":"Field","group":"TabDet:0"},"appearance":{"index":"18","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"203","left":"684","right":"839","bottom":"221"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.environment"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"TabCust","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"19","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"70","left":"8","right":"335","bottom":"324"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Support Analyst","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Customer","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"TabDescs","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"20","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"383","left":"98","right":"859","bottom":"608"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Problem Description","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Root Cause","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}},{"name":"Preventative Fix","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"mb_cust","type":"MenuButton","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"21","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"40","left":"277","right":"339","bottom":"65"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900","commands":"Selfservice Wizard Input^1|"}}},{"general":{"name":"TabDet","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"22","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"70","left":"353","right":"859","bottom":"324"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"tabStyle":"Top","tabSize":"19","items":{"item":{"name":"Options \/ Assessment","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}}},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"tb_aprprofile","type":"Field"},"appearance":{"index":"23","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"180","left":"910","right":"1146","bottom":"198"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.inc_profilecode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Click here to select incident matching profile","activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"pcdesc","distinctColumn":"code","displayColumn":"info"}}},{"general":{"name":"flg_notify_sw","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"24","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"230","left":"940","right":"1211","bottom":"248"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_swtoday_on"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"Display notification on supportworks today page^1|","disabledBackgroundColor":"#336699"}}},{"general":{"name":"flg_notify_ss","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"25","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"260","left":"970","right":"1195","bottom":"278"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_selfservice_on"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"activeTextColor":"#eeeeee","flagItems":"Display notification on SelfService^1|","disabledBackgroundColor":"#336699"}}},{"general":{"name":"lb_company","type":"Field","group":"TabCust:1"},"appearance":{"index":"26","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"100","left":"98","right":"319","bottom":"118"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"company.companyname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_tel","type":"Field","group":"TabCust:1"},"appearance":{"index":"27","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"166","left":"98","right":"319","bottom":"184"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_email","type":"Field","group":"TabCust:1"},"appearance":{"index":"28","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"188","left":"98","right":"319","bottom":"206"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageList":"Helpdesk Icons","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel2","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"29","caption":"Settings","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"40","left":"347","right":"865","bottom":"330"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_alarm.png"}}},{"general":{"name":"CaptionPanel3","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"30","caption":"Description","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"335","left":"4","right":"865","bottom":"614"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_document.png"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"31","caption":"Category","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"338","left":"395","right":"448","bottom":"356"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.probcode"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Rect1","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"32","backgroundColor":"#ffffff","foregroundColor":"#c0c0c0","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"102","left":"362","right":"850","bottom":"151"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#c0c0c0"}}},{"general":{"name":"Text1","type":"Text","group":"TabDet:0"},"appearance":{"index":"33","caption":"Assessment Levels","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"93","left":"369","right":"473","bottom":"112"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"34","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"182","left":"359","right":"448","bottom":"200"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"label_oc_priority","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"35","caption":"Priority","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"247","left":"359","right":"448","bottom":"265"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"name":"Rect1","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"36","backgroundColor":"#ffffff","foregroundColor":"#c0c0c0","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"168","left":"362","right":"850","bottom":"318"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#c0c0c0"}}},{"general":{"name":"Text1","type":"Text","group":"TabDet:0"},"appearance":{"index":"37","caption":"Options","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"159","left":"369","right":"416","bottom":"178"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"38","caption":"Analyst ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"120","left":"9","right":"94","bottom":"138"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"39","caption":"Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"142","left":"9","right":"94","bottom":"160"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"40","caption":"Support Group","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"164","left":"9","right":"94","bottom":"182"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"41","caption":"Telephone","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"186","left":"9","right":"94","bottom":"204"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:0"},"appearance":{"index":"42","caption":"Email","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"208","left":"9","right":"94","bottom":"226"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"43","caption":"Problem Recognition Profile","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"160","left":"910","right":"1043","bottom":"178"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.inc_profilecode"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"44","caption":"Impact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"120","left":"399","right":"448","bottom":"138"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"45","caption":"Urgency","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"120","left":"631","right":"680","bottom":"138"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"CaptionPanel1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"46","caption":"Reported By","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"40","left":"4","right":"340","bottom":"330"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_group.png"}}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"47","caption":"Summary","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"363","left":"17","right":"94","bottom":"379"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"itsm_opencall_problem.prb_title"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_sites","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"true","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabCust:1"},"appearance":{"index":"48","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"210","left":"98","right":"319","bottom":"319"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site_name"},"name":"Org. Sites (Tick impacted sites)","width":"221","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cmdb_id"},"name":"CMDB ID","width":"120","image":"-1","dataColumn":"1"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#000099","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#d3c9b6","sqlSource":"swdata","table":"site","selectionMode":"2","storedQuery":"request.problem.common.sites_list","listFilter":"_swc_fk_company_id="}}},{"general":{"name":"Text5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"49","caption":"Customer name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"145","left":"9","right":"94","bottom":"163"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"50","caption":"Tel. No.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"166","left":"9","right":"94","bottom":"184"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"51","caption":"E-Mail","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"188","left":"9","right":"94","bottom":"206"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"52","caption":"Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"203","left":"385","right":"448","bottom":"219"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_customerid2","type":"DualSearchField","group":"TabCust:1"},"appearance":{"index":"53","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"144","left":"98","right":"319","bottom":"162"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.firstname!surname"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"name":"Label5","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"54","caption":"SLA","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"225","left":"419","right":"448","bottom":"243"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"CaptionPanel4","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"55","caption":"Log New Problem","backgroundColor":"#ffd24c","foregroundColor":"#003366","font":{"@size":"18"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"5","left":"4","right":"865","bottom":"35"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#f1f1f1","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"30","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"name":"lbl_bpm_workflow","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"56","caption":"Process","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"292","left":"359","right":"448","bottom":"310"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.bpm_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_oc_slad2","type":"Field"},"appearance":{"index":"57","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"100","left":"880","right":"1035","bottom":"118"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsmsp_slad","distinctColumn":"pk_slad_id","displayColumn":"slad_id","extraOptions":"[Use Customer SLA]=&[userdb.sld]","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lbl_contract","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"58","caption":"Contract","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"269","left":"399","right":"448","bottom":"285"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_tel1","type":"Field","group":"TabCust:1"},"appearance":{"index":"59","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"122","left":"98","right":"319","bottom":"140"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"60","caption":"Customer ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"122","left":"9","right":"94","bottom":"140"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"61","caption":"Details","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"385","left":"17","right":"94","bottom":"401"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_root_cause","type":"Field","group":"TabDescs:1"},"appearance":{"index":"62","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"411","left":"106","right":"852","bottom":"599"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"itsm_opencall_problem.root_cause"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_prevent_fix","type":"Field","group":"TabDescs:2"},"appearance":{"index":"63","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"411","left":"106","right":"852","bottom":"599"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"itsm_opencall_problem.prev_fix"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lbl_company","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCust:1"},"appearance":{"index":"64","caption":"Organisation","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"99","left":"28","right":"101","bottom":"117"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label7","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"65","caption":"Origin","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"182","left":"644","right":"680","bottom":"198"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_environment","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabDet:0"},"appearance":{"index":"66","caption":"Environment","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"204","left":"619","right":"680","bottom":"220"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.environment"},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"Button1_OnPressed","code":"Button1_OnPressed()\r\n{\r\n   var pc = new ChooseProfileCodeDialog;\r\n    if(pc.Open(false,false) == IDOK)\r\n    {\r\n        var strInfo;\r\n        strInfo = \"Code: \" + pc.code + \"\\n\"\r\n        strInfo += \"SLA: \" + pc.sla + \"\\n\"\r\n        strInfo += \"CodeDesc: \" + pc.codeDescription + \"\\n\\n\";\r\n        strInfo += pc.description;\r\n        MessageBox(strInfo);\r\n    }\r\n\r\n    var dlg = new PickAnalystDialog;\r\n    if(dlg.Open(\"Pick an Analyst\/Group\") == IDOK)\r\n    {\r\n        MessageBox(\"Group: \" + dlg.groupid + \"  Analyst:\" + dlg.analystid);\r\n    }\r\n}\r\n\r\n"},{"name":"btn_pick_sb_OnPressed","code":"btn_pick_sb_OnPressed()\r\n{\r\n  \/\/-- NWJ 17.03.2004\r\n   \/\/-- open analyst search form in select mode\r\n        var oe = elements;\r\n    \/\/ Create an instance of a PopupForm class\r\n    var form = new PopupForm();\r\n    var strUrl = \"analystid=\" + oe[\"db.rfc_rb_id\"].text + \"&suppgroup=\" + oe[\"db.rfc_rb_sg\"].text + \"&name=\" + oe[\"db.rfc_rb_name\"].text;\r\n    \/\/ Open the form TbSites\r\n    if(form.Open(\"tbAnalysts\",\"\",strUrl))\r\n    {\r\n        \/\/-- Access the forms _swdoc and call the _swdoc.GetVariable() method with the name of the variable\r\n        var stranalystid = form.document.analystid;\r\n        if (stranalystid == \"\") return;\r\n\r\n        \/\/-- assign values\r\n        app._ete(oe[\"db.rfc_rb_id\"] , stranalystid);\r\n        app._ete(oe[\"db.rfc_rb_name\"] , form.document.name);\r\n        app._ete(oe[\"db.rfc_rb_sg\"] , form.document.group);\r\n        app._ete(oe[\"db.rfc_rb_tel\"] ,form.document.phone);\r\n        app._ete(oe[\"db.rfc_rb_email\"] , form.document.email);\r\n        _swdoc.opencall.itsm_rfc_rb_id = stranalystid;\r\n        _swdoc.opencall.itsm_rfc_rb_name = form.document.name;\r\n        _swdoc.opencall.itsm_rfc_rb_group = form.document.group;\r\n        _swdoc.opencall.itsm_rfc_rb_tel = form.document.phone;\r\n        _swdoc.opencall.itsm_rfc_rb_email = form.document.email;\r\n    }\r\n    \r\n}\r\n\r\n"},{"name":"tb_info_OnValueChanged","code":"tb_info_OnValueChanged(strValue)\n{\n\t\/\/-- copy to updatedb\n\t_swdoc.UPD().updatetxt = strValue;\n\n\n}"},{"name":"btn_pick_rb_OnPressed","code":"btn_pick_rb_OnPressed()\n{\n\t\/\/-- select analyst who requested this change\n\tapp.g.pick_analyst(\"Select raised by Analyst\", function(oAnalyst)\n\t{\n\t\tif(oAnalyst)\n\t\t{\n\t\t\t_swdoc.set_prb_analyst(oAnalyst);\n\t\t}\n\t});\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- F0105032\n\tif(_swdoc._form.PreloadType==2)\n\t{\n\t\t_swdoc.oOpencall = app.g.get_sys_record(\"opencall\",_swdoc.OC().callref);\n\t\t_swdoc.oExtended = app.g.get_record(\"itsm_opencall_problem\", _swdoc.OC().callref);\n\t}\n\t\/\/-- EOF F0105032\n\t\/\/-- save class\n\t_swdoc.PRB().prb_callclass = _swdoc.OC().callclass;\n\n\t\/\/-- NWJ - 28.02.2006\n\t\/\/--      get any incoming cis\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems, _swdoc.OC().callref ,\"INCOMING\",\"\")\t\n\t\n\t\n\t\/\/-- load CIs if call has been logged from another problem\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems, _swdoc.OC().callref ,\"PROBLEM-CAUSE\",\"cis_excludeservice\");\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_services, _swdoc.OC().callref ,\"\",\"cis_servicesonly\");\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_impactcis, _swdoc.OC().callref ,\"PROBLEM-AFFECT\",\"cis_excludeservice\");\n\n\tvar oAnalyst = app.g.get_analyst_detail(app.session.analystId);\n\t_swdoc.set_prb_analyst(oAnalyst);\n\n\t\/\/--\n\t\/\/-- check if we are raising this problem from an incident\n\tif(app.g.LOG_FROM_CALL!=null)\n\t{\n\t\t\/\/-- load from call items into this problem\n\t\t\/\/-- ITSM 2.2.0 removed -- app.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems, app.g.LOG_FROM_CALL.callref);\n\t\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_impactcis, app.g.LOG_FROM_CALL.callref);\n\t\tstrCalls = app.cmdb.get_call_cis(app.g.LOG_FROM_CALL.callref ,\" \");\n\t\t_swdoc.link_affect_cis_to_problem(strCalls);  \n\t\t_swdoc.EF().sl_impactcis.Refresh();\n\t\t\/\/-- store incident record\n\t\tapp._slf(_swdoc.EF().sl_incs, \"_kv=\" + app.g.LOG_FROM_CALL.callref);\n\t\t_swdoc.EF().sl_incs.Refresh();\t\n\t\t\/\/-- show customer impacted by the log from call\n\t\tif(app.g.LOG_FROM_CALL.cust_id!=\"\")_swdoc.filter_impact_customers(_swdoc.EF());\n\t\t\/\/-- copy over prob text\n\t\titsm_opencall_problem.prb_info = app.g.CALLINFO[app.g.LOG_FROM_CALL.callref].origupdatetxt\n\n\t\t\t\t\/\/-- copy over prob code into recog prob code\n\t\titsm_opencall_problem.inc_profilecode = app.g.LOG_FROM_CALL.probcode;\n\t\t\/\/-- F0105872 - pull through profile code from incident\n\t\topencall.probcode = app.g.LOG_FROM_CALL.probcode;\n\t\n\t\t\/\/-- copy of cost center\n\t\t_swdoc.OC().costcenter = app.g.LOG_FROM_CALL.costcenter;\n\t\t\n\t\t_swdoc.OC().itsm_title = app.g.LOG_FROM_CALL.itsm_title;\n\t\t\n\t\titsm_opencall_problem.prb_title = _swdoc.OC().itsm_title;\n\t\tif(itsm_opencall_problem.prb_title!=\"\")\n\t\t{\n\t\t\t_swdoc.boolProblemTitleSetManually = true;\n\t\t}\n\n\t\t\n\t\t\n\t\t\/\/-- impact \/ urgency \/ priority level \n\t\t_swdoc.OC().itsm_impact_level \t= app.g.LOG_FROM_CALL.itsm_impact_level;\n\t\t_swdoc.OC().itsm_urgency_level\t= app.g.LOG_FROM_CALL.itsm_urgency_level;\n\t\t\/\/OC().priority\t\t\t= app.g.LOG_FROM_CALL.priority;\n\t\t\n\t\tif(app.g.LOG_FROM_CALL.cust_id!=\"\")\n\t\t{\n\t\t\t_swdoc.boolCustid_fromCall = true;\n\t\t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", app.g.LOG_FROM_CALL.cust_id);\n\t\t}\n\t\t\n\t\t\/\/-- update form\n\t\t_swdoc.UpdateFormFromData();\n\t\t\n\t\t\/\/-- 75900 - prob_text not being set\n\t\t_swdoc.UPD().updatetxt = app.g.CALLINFO[app.g.LOG_FROM_CALL.callref].origupdatetxt;\n\t\t\n\t\t\/\/-- important - null record\t\t\n\t\tapp.g.LOG_FROM_CALL=null;\n\t}\n\telse if(app.g.LOG_CALL_FOR_USER!=\"\")\n\t{\n\t\t\/\/-- if logging ofr a customer\n\t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", app.g.LOG_CALL_FOR_USER);\n\t\tapp.g.LOG_CALL_FOR_USER=\"\";\n\t}\n\telse if(app.g.LOG_FOR_ORGID!=\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", app.g.LOG_FOR_ORGID);\t\n\t\tapp.g.LOG_FOR_ORGID=\"\";\n\t}\n\telse if(app.g.LOG_CALL_FOR_CI!=\"\")\n\t{\n\t\tapp.g.sl_appendfilter(_swdoc.EF().sl_configitems, app.g.LOG_CALL_FOR_CI,'pk_auto_id');\n\t\t_swdoc.EF().sl_configitems.Refresh();\n \t\tapp.g.LOG_CALL_FOR_CI=\"\";\n\t\t_swdoc.check_ci_assessment();\n\t}\n\telse\n\t{\n\t\tif(_swdoc.oCust().keysearch!=\"\")\n\t\t{\n\t\t\tif(_swdoc.oCust().fk_company_id!=_swdoc.strCurrentCompanyID)\n\t\t\t{\n\t\t\t\t_swdoc.filter_company_sites();\n\t\t\t\t_swdoc.strCurrentCompanyID = _swdoc.oCust().fk_company_id;\n\t\t\t}\n\t\t}\n\t}\n\t\n\t\n\t\/\/-- 12.07.2008 \n\t\/\/-- disable or hide company field if internal support only\n\tapp._een(_swdoc.MF().lb_company,((dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1)));\n\tapp._evi(_swdoc.MF().lb_contract,((dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1)));\n\tapp._evi(_swdoc.MF().lbl_contract,((dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1)));\n\t\n\tif(!_swdoc.MF().lb_company.enable)\n\t{\n\t\t\/\/-- check if we should hide\n\t\tapp._evi(_swdoc.MF().lb_company,(dd.GetGlobalParamAsString(\"Application Settings\/HideCompanyField\")!=1));\t\t\n\n\t\t\/\/alter filter if we do not support external\n\t\tapp._slf(_swdoc.MF().lb_oc_cc,\"\");\n\t\tapp._slf(_swdoc.MF().fld_oc_dept,\"\");\n\t}\n\tapp._evi(_swdoc.MF().lbl_company, _swdoc.MF().lb_company.visible);\t\n\t\/\/-- eof hide \/ enable\t\t\n\n\t\/\/-- RJC - F0105434\n\tapp.g.get_default_process(_swdoc,'Problem',_swdoc.MF().fld_bpm_workflow,_swdoc.MF().lbl_bpm_workflow);\n\/\/\tapp.g.apply_appcode_bpm_filter(_swdoc.MF().fld_bpm_workflow, 'BPM');\n\t\/\/-- EOF - F0105434\n\t\t\n\t\/\/OC().priority = \"[Use Customer Priority]\";\n\t_swdoc.UpdateFormFromData();\t\n\n\n\t\/\/-- F0094989\n\tif(_swdoc.OC().itsm_slaname.indexOf(\"[Use \")<0 && _swdoc.OC().itsm_slaname.indexOf(\" SLA]\")<0 )\n\t{\n\t\tif(_swdoc.OC().itsm_slaname!=\"\")\n\t\t{\n\t\t\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+_swdoc.OC().itsm_slaname);\n\t\t\tif(slarec.Fetch())\n\t\t\t{\n\t\t\t\tvar intSLAId = app.g.get_field(slarec,\"slad_id\");\n\t\t\t\tif(intSLAId!=\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t\t\t\t\t_swdoc.handle_set_sladef(intSLAId);\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\n\t_swdoc.strDefaultImpact = (_swdoc.OC().itsm_impact_level);\n\t_swdoc.strDefaultUrgency = (_swdoc.OC().itsm_urgency_level);\n\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\/\/\tapp.g.apply_appcode_sla_filter(_swdoc.MF().lb_oc_slad1, 'SLA-CALL');\n\n\t\/\/-- F0108825 : A newly logged call should not have resolve\/close text\n\t\/\/\t         even when it has been copied from a resloved\/closed call\n\t_swdoc.OC().resolve_text=\"\";\n\t_swdoc.OC().close_text=\"\";\t\n\t\/\/\tPM00143977 : values copied from parent call\n\t_swdoc.OC().lastactdatex=\"\";\t\n\t_swdoc.OC().lastactdate=\"\";\t\n\t_swdoc.OC().lastactby=\"\";\t\n\t_swdoc.OC().assigndatx=\"\";\t\n\t_swdoc.OC().withinresp=\"\";\t\n\t_swdoc.OC().resp_time=\"\";\t\n\t_swdoc.OC().slaresp=\"\";\t\n\t_swdoc.OC().assigndate=\"\";\t\n\t\/\/-- TK Set Summary Based on Email Subject\n\tif((_swdoc._form['emailsubject']) && (app.oSettings.get_setting(\"boolUseSubjectasSummary\")=='True'))\n\t{\n\t\t_swdoc.PRB().prb_title = _swdoc._form['emailsubject'];\n\t\t_swdoc.boolProblemTitleSetManually = true;\n\t} \n\tif(_swdoc.oCompany().pk_company_id)\n\t{\n\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", _swdoc.oCompany().pk_company_id);\n\t}\n\t\/\/ START 105553\n\tif(_swdoc.oCust().keysearch)\n\t{\n\t\tif(_swdoc.oCust().fk_company_id!=_swdoc.oCompany().pk_company_id)\t\n\t\t{\n\t\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", _swdoc.oCust().fk_company_id);\n\t\t}\n\t}\n\t\/\/ END 105553\n\t_swdoc.strDefaultPriority = _swdoc.MF().lb_oc_sla.value;\n}"},{"name":"tb_aprprofile_OnLeftClick","code":"tb_aprprofile_OnLeftClick()\n{\n\tif (!app.itsm.can_edit(_swdoc.OC().callclass))return;\n\t\n\t\/\/--\n\tvar strCode = app.g.pick_problemprofile(\"\",\"\");\n\tif(strCode)\n\t{\n\t\t_swdoc.PRB().inc_profilecode = strCode;\n\t}\n\n\t_swdoc.UpdateFormFromData()\n\treturn false;\n}"},{"name":"tb_aprprofile_OnRightClick","code":"tb_aprprofile_OnRightClick()\n{\n\t_swdoc.PRB().inc_profilecode = \"\";\n\t_swdoc.UpdateFormFromData()\n\n}"},{"name":"sl_sites_OnItemDoubleClicked","code":"sl_sites_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/-- double click check or uncheck\n\tsl_sites.SetRowChecked(nRow, !sl_sites.IsRowChecked(nRow));\n\treturn false;\n\n\n}"},{"name":"OnTimer","code":"OnTimer(nTimer)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(nTimer==1)\n\t{\n\t\tmainform.KillTimer(1);\n\n\t\tvar strURL = \"autorun=1&searchtype=1&canreset=1&fk_company_id=\" + _swdoc.oCompany().pk_company_id+\"&\"+_swdoc.strSearchFor;\n\t\t_swdoc.strSearchFor=\"\";\n\t\tapp.g.search_for(\"customers\",false,strURL,function(sResults)\n\t\t{\n\t\t\tif(sResults.selectedkeys==\"\") \n    \t\t{\n \t\t\t\t_swdoc.boolResolvingCust = false;\n   \t\t\t\treturn;\n    \t\t}\n    \t\tvar arrKey = sResults.selectedkeys.split(\",\");\n    \t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", arrKey[0]);\n\t\n\t\t\t_swdoc.boolResolvingCust = false;\n\t\t});\n\t}\n\t\n\telse if(nTimer==2)\n\t{\n\t\tmainform.KillTimer(2);\n\t\tif(_swdoc.OC().probcode==\"\")\n\t\t{\n\t\t\tapp._ete(_swdoc.MF().tb_profile,\"\");\n\t\t}\n\t}\n\n\telse if(nTimer==4)\n\t{\n\t\tmainform.KillTimer(4);\n\t\t_swdoc.boolChangeProfile = false;\n\t}\n\n}"},{"name":"lb_oc_sla_OnValueChanged","code":"lb_oc_sla_OnValueChanged(strValue)\n{\n\t_swdoc.handle_set_priority(strValue);\n\tapp.g.fix_priority(_swdoc.OC().itsm_slaname, _swdoc.OC().priority, _swdoc);\n\n}"},{"name":"lb_oc_slad1_OnValueChanged","code":"lb_oc_slad1_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.boolProblemSLASetManually = true;\n\t_swdoc.handle_set_sladef(strValue);\n\t\n\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strValue);\n\tif(slarec.Fetch())\n\t{\n\t\tvar intSLAId = app.g.get_field(slarec,\"pk_slad_id\");\n\t\tif(intSLAId!=\"\")\n\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t}\n\n}"},{"name":"tb_probtitle_OnLeftClick","code":"tb_probtitle_OnLeftClick()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.boolProblemTitleSetManually = true;\n\treturn true;\n}"},{"name":"fld_bpm_workflow_OnValueChanged","code":"fld_bpm_workflow_OnValueChanged(strValue)\n{\n\t\/\/-- if title not set - set it to match workflow name\n\tif(!_swdoc.boolProblemTitleSetManually)\n\t{\n\t\t_swdoc.OC().itsm_title=strValue;\n\t\t_swdoc.PRB().prb_title=strValue;\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\n}"},{"name":"lb_oc_slad2_OnValueChanged","code":"lb_oc_slad2_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.handle_set_sladef(strValue);\n\n\n}"},{"name":"lb_contract_OnValueChanged","code":"lb_contract_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tapp.g.strLogAndResolveContract = strValue;\n\n}"},{"name":"TabCust_OnTabSelected","code":"TabCust_OnTabSelected(nTab)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp._evi(mb_cust, (nTab==1));\n\n\n}"},{"name":"fld_environment_OnDropDown","code":"fld_environment_OnDropDown()\n{\n\t \/\/ ES - F0111761 - Ability to specify an environment within call forms\n     var strSimpleListId = \"ENVIRONMENT\";\n     var p = {};\n     p.id = strSimpleListId;\n     var dbValues = app.g.get_sqrecordset(\"GENERAL\/get.simple_list\", p);\n     var arrEnvironments = new Array();\n     var strEnvironments = \"\";\n     var splitResult = \"\";\n     var intCount = 0;\n     \/\/ Store ENVIRONMENT values from swlists in an array\n     while (dbValues.Fetch())\n     {\n          arrEnvironments[intCount] = app.g.get_field(dbValues, \"value\");\n          intCount++;          \n     }\n     var strTemp = \"\";\n     \/\/ Add | at the end of each value to set up the picklist\n     for (var i=0; i<arrEnvironments.length;i++)\n     {\n          strTemp = arrEnvironments[i];\n          splitResult = strTemp.split(\",\");\n          strEnvironments += splitResult[0];\n          strEnvironments += \"|\";\n     }\n     _swdoc.MF().fld_environment.pickList = strEnvironments;\n     \/\/ END - F0111761;\n\n\n\treturn true;\n}"},{"name":"fld_environment_OnValueChanged","code":"fld_environment_OnValueChanged(strValue)\n{\n\t_swdoc.opencall.environment = strValue;\n}"}]}}},"extendedLayout":{"appearance":{"width":"860","height":"209","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"TabRel","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f2eedd","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"13","left":"7","right":"855","bottom":"203"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"CIs Causing Problem","properties":"56=#ffffff|58=#000000|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","activeTextColor":"#000000","inactiveTextColor":"#5f5f5f"}}},{"name":"Services Causing Problem","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Affected Configuration Items","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Associated Incidents","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Knowledgebase Documents","properties":"56=#baa6e1|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#baa6e1"}}},{"name":"<< Impacted Customers","properties":"56=#9abfb4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#9abfb4"}}},{"name":"<< Impacted Organisations","properties":"56=#f7b683|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f7b683"}}},{"name":"Causes of Problem","properties":"56=#d8abc0|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#d8abc0"}}},{"name":"Knowledgebase Documents","properties":"56=#8aa8e4|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#8aa8e4"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"sl_configitems","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration ID","width":"133","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"126","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"240","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sld"},"name":"sld","width":"120","image":"-1","dataColumn":"15"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pids=0&sf=","sqlSource":"swdata","storedQuery":"request.problem.log.ext.ci_lists"}}},{"general":{"name":"mbtn_cci_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"2","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"672","right":"728","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|"}}},{"general":{"name":"mbtn_cci_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"3","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"732","right":"788","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Problem^1|"}}},{"general":{"name":"btn_search_cci","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"4","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"792","right":"848","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_impactcis","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:2"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration ID","width":"133","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"126","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"240","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pk_auto_id=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_ici_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"6","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"672","right":"728","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|"}}},{"general":{"name":"mbtn_ici_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"7","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"732","right":"788","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Problem^1|"}}},{"general":{"name":"btn_search_ici","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"8","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"792","right":"848","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_incs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:3"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"158","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_name"},"name":"Customer","width":"170","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"environment"},"name":"Environment","width":"120","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_id"},"name":"Customer ID","width":"120","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_id"},"name":"Org ID","width":"120","image":"-1","dataColumn":"13"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_inc_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"10","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"672","right":"728","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Incident Details^1|Customer Detail^2|"}}},{"general":{"name":"mbtn_inc_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"11","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"732","right":"788","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Problem^1|Link Incident CIs as Causative^2|Link Incident CIs as Affected^3|"}}},{"general":{"name":"btn_search_inc","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"12","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"792","right":"848","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_customerimpact","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabRel:5"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"41","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"201","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"keysearch"},"name":"Customer ID","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"firstname"},"name":"First  Name","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"surname"},"name":"Last Name","width":"191","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telext"},"name":"Telephone","width":"148","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"email"},"name":"Email","width":"268","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_id"},"name":"Org ID","width":"120","image":"-1","dataColumn":"6"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"userdb","listFilter":"keysearch = ''","editRecordForm":"Form.TfCustomer","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_orgimpact","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:6"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"41","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_company_id"},"name":"Organisation ID","width":"133","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"companyname"},"name":"Organisation","width":"193","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_industry_type"},"name":"Industry Category","width":"161","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_company_type"},"name":"Industry Sector","width":"174","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"telephone"},"name":"Telephone","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"address_1"},"name":"Address 1","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"address_2"},"name":"Address 2","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"town"},"name":"Town","width":"120","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"county"},"name":"County","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"country"},"name":"Country","width":"120","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"postcode"},"name":"Postcode","width":"103","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"company","editRecordForm":"Form.TfCompany","newRecordForm":"Form.entCompany","sqlSource":"swdata","highlightStyle":"0","selectionMode":"1","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_services","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:1"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"4","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Service ID","width":"133","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Service Name","width":"220","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"service_type"},"name":"Service Type","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"catalog_type"},"name":"Service Category","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sld"},"name":"sld","width":"120","image":"-1","dataColumn":"16"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status_portfolio"},"name":"Portfolio Status","width":"120","image":"-1","dataColumn":"17"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status_lifecycle"},"name":"Lifecycle Status","width":"120","image":"-1","dataColumn":"18"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pk_auto_id=-1&type=2","sqlSource":"swdata","storedQuery":"request.problem.log.ext.ci_lists"}}},{"general":{"name":"mbtn_cci_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"16","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"672","right":"728","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|"}}},{"general":{"name":"mbtn_cci_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"17","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"732","right":"788","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Problem^1|"}}},{"general":{"name":"btn_search_cci1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"18","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"792","right":"848","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_kbs1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:4"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docref"},"name":"Document Reference","width":"203","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"title"},"name":"Title","width":"334","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docstatus"},"name":"Status","width":"120","image":"-1","dataColumn":"2"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"swkb_articles","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"_kv=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_inc_views2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"20","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"672","right":"728","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Document Details^1|"}}},{"general":{"name":"mbtn_inc_actions2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"21","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"732","right":"788","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_search_inc2","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"22","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"792","right":"848","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"TabCauses","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:7"},"appearance":{"index":"23","caption":"Tab2","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"35","left":"12","right":"850","bottom":"199"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":{"name":"Releases causing this Problem","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}}},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_rels","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabCauses:0"},"appearance":{"index":"24","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"75","left":"18","right":"846","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_rel_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCauses:0"},"appearance":{"index":"25","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"56","left":"668","right":"724","bottom":"74"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Release Detail^1|"}}},{"general":{"name":"mbtn_rel_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCauses:0"},"appearance":{"index":"26","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"56","left":"728","right":"784","bottom":"74"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Problem^1|"}}},{"general":{"name":"btn_srch_rel","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabCauses:0"},"appearance":{"index":"27","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"56","left":"788","right":"844","bottom":"74"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"mbtn_inc_views3","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"28","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"672","right":"728","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Document Details^1|"}}},{"general":{"name":"mbtn_inc_actions3","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"29","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"732","right":"788","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Problem^1|"}}},{"general":{"name":"btn_search_inc3","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"30","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"36","left":"792","right":"848","bottom":"54"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_rakb","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabRel:8"},"appearance":{"index":"31","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"14","right":"848","bottom":"195"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docref"},"name":"Document Reference","width":"203","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"title"},"name":"Title","width":"567","image":"-1","dataColumn":"1"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"rakb_articles","listFilter":"docref='-1'","storedQuery":"common.extendedform.tabledata"}}}]},"javascript":{"methods":{"method":[{"name":"sl_configitems1_OnHeaderItemClicked","code":"sl_configitems1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_configitems1.Refresh();\n\n\n}"},{"name":"sl_configitems1_OnItemSelected","code":"sl_configitems1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_configitems1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_configitems1);\t\n\tapp._een(mbtn_cci_views1 , (selCount==1));\n\tapp._een(mbtn_cci_actions1 , boolActive);\n\n\n}"},{"name":"mbtn_cci_views_OnMenuItem","code":"mbtn_cci_views_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_configitems,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_configitems,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_cci_actions_OnMenuItem","code":"mbtn_cci_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"-1\";\n\t\tfor (var x=sl_configitems.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tvar value = sl_configitems.GetItemTextRaw(x,\"pk_auto_id\");\n\t\t\tif (!sl_configitems.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter += value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- 29.04.2008 - 2.2.0 if this ci that has been removed was used to set the pref supp group then change it\n\t\t\t\tif(_swdoc.intAssessmentCI == value)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Customer SLA]\";\n\t\t\t\t\t_swdoc.OC().priority = \"[Use Customer Priority]\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\n\t\t\n\t\t\t\t\tapp._eva(_swdoc.MF().lb_oc_slad1, 0);\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_slad1, 0);\n\t\t\t\t\tapp._een(_swdoc.MF().label_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(strFilter!=\"\")\n\t\t\tstrFilter = \"pk_auto_id=\"+strFilter+\"&type=1\";\n       app._slf(sl_configitems,strFilter);  \n       \/\/sl_configitems.Refresh();\n       sl_configitems.SetRowSelected(0);\n       sl_configitems_OnItemSelected(0);\n       _swdoc.EF().sl_configitems.Refresh();\n\t\t\t\n       _swdoc.check_ci_assessment();\n       return;\n\t}\n       \n}"},{"name":"btn_search_cci_OnPressed","code":"btn_search_cci_OnPressed()\n{\n    \/\/-- NWJ 08.03.2004\n    \/\/-- open CI search form in select mode\n    _swdoc.search_for_cis();\n\n      \n}"},{"name":"sl_impactcis1_OnHeaderItemClicked","code":"sl_impactcis1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_impactcis1.Refresh();\n\n}"},{"name":"sl_impactcis1_OnItemSelected","code":"sl_impactcis1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_impactcis1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_impactcis1);\t\n\tapp._een(mbtn_ici_views1 , (selCount==1));\n\tapp._een(mbtn_ici_actions1 , boolActive);\n\n\n}"},{"name":"mbtn_ici_views_OnMenuItem","code":"mbtn_ici_views_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_impactcis,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_impactcis,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_ici_actions_OnMenuItem","code":"mbtn_ici_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"-1\";\n\t\tfor (var x=sl_impactcis.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tif (!sl_impactcis.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tvar value = sl_impactcis.GetItemTextRaw(x,0);\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter += value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(strFilter!=\"\")\n\t\t\tstrFilter = \"_kv=\"+strFilter;\n       app._slf(sl_impactcis, strFilter);  \n       _swdoc.EF().sl_impactcis.Refresh();\n       sl_impactcis.SetRowSelected(0);\n\t   sl_impactcis_OnItemSelected(0);       \n\t  \/\/ _swdoc.filter_impact_customers(_swdoc.EF());\t   \n       return;\n\t}\n\n}"},{"name":"btn_search_ici_OnPressed","code":"btn_search_ici_OnPressed()\n{\n    \/\/-- NWJ 08.03.2004\n    \/\/-- open CI search form in select mode\n\tvar strURL = \"canreset=1&fk_company_id=\" + app.pfu(_swdoc.oCompany().fk_company_id);\n\tapp.cmdb.search_ci(true,strURL,function(sResults)\n\t{\n\t\tif (sResults.selectedkeys==\"\") return;\n   \n\t\t_swdoc.link_affect_cis_to_problem(sResults.selectedkeys);  \n\t\t\/\/_swdoc.filter_impact_customers(_swdoc.EF()); \n\t});\n\t\n   \n}"},{"name":"sl_incs1_OnHeaderItemClicked","code":"sl_incs1_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\/\/-- core product work arround. If autload = false headers dont refresh when clicked.\n\tsl_incs1.Refresh();\n}"},{"name":"sl_incs1_OnItemSelected","code":"sl_incs1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_incs1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_incs1);\t\n\tapp._een(mbtn_inc_views1 , (selCount==1));\n\tapp._een(mbtn_inc_actions1 , boolActive);\n\n\n}"},{"name":"mbtn_inc_actions_OnMenuItem","code":"mbtn_inc_actions_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\tvar iLinkCauseCI = 2;\n\tvar iLinkImpactCI = 3;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\t\tvar strFilter = \"-1\";\n\t\t\tfor (var x=sl_incs.rowCount()-1;x > -1;x--)\n\t\t\t{\n\t\t\t\tif (!sl_incs.IsRowSelected(x))\n\t\t\t\t{\n\t\t\t\t\t\/\/-- add to filter\n\t\t\t\t\tvar value = sl_incs.GetItemTextRaw(x,0);\n\t\t\t\t\tif (value != \"\")\n\t\t\t\t\t{\n    \t\t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\t\tstrFilter += value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(strFilter!=\"\")\n\t\t\t\tstrFilter = \"_kv=\"+strFilter;\n       \t\tapp._slf(sl_incs, strFilter);  \n       \t\t_swdoc.EF().sl_incs.Refresh();\n       \t\tsl_incs.SetRowSelected(0);\n\t   \t\tsl_incs_OnItemSelected(0);  \n\t\t\tbreak;\n\t\tcase iLinkCauseCI:\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs,0,\",\",\"\");\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\t\t\t_swdoc.link_cause_cis_to_problem(strLinkedCIs);\n\t\t\t_swdoc.EF().sl_incs.Refresh();\t\t\n\t\t\tbreak;\n\t\tcase iLinkImpactCI:\n\t\t\tvar strSelectedIncs = app.g.sl_getselected_valuesdel(sl_incs,0,\",\",\"\");\t\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(strSelectedIncs , \"INCIDENT\", \"\");\n\t\t\t_swdoc.link_affect_cis_to_problem(strLinkedCIs);\n\t\t\t_swdoc.EF().sl_incs.Refresh();\t\n\t\t\t\/\/_swdoc.filter_impact_customers(_swdoc.EF());\n\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc_OnPressed","code":"btn_search_inc_OnPressed()\n{\n   \tvar strURL = \"canreset=1\";\n    app.itsm.search_calls(\"INC\",strURL,true,function(oResults)\n    {\n    \tif(oResults.selectedkeys==\"\") return;\n\n\t\tvar strFilter = app.g.sl_get_valuesdel(sl_incs,0,\",\");\n\t\tif (strFilter != \"\") \n\t\t{\n\t\t\tstrFilter += \",\" + oResults.selectedkeys;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstrFilter = oResults.selectedkeys;\n\t\t}\n\t\tapp._slf(sl_incs, \"_kv=\" + strFilter);\n\t\tsl_incs.SetRowSelected(0, true, false);\n\t\n\t\t\/\/-- Now check if we should link new ci items as being affect\n\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Problem\/CopyIncidentCIs\")==1)\n\t\t{\n\t\t\t\/\/-- if dont have info get it otherwise use info we go above\n\t\t\tvar strLinkedCIs = app.cmdb.get_call_cis(oResults.selectedkeys , \"INCIDENT\", \"\");\n\t\t\tif(strLinkedCIs!=\"0\")\n\t\t\t\t_swdoc.link_affect_cis_to_problem(strLinkedCIs);\n\t\t}\n\t\t_swdoc.EF().sl_incs.Refresh();\n\t\t\/\/--\n\t\t\/\/-- get list of customers impacted by these incidents and refresh cust impact list\n\t\t\/\/_swdoc.filter_impact_customers(_swdoc.EF());\n    });\n}"},{"name":"sl_customerimpact1_OnHeaderItemClicked","code":"sl_customerimpact1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_customerimpact1.Refresh();\n}"},{"name":"sl_configitems_OnItemSelected","code":"sl_configitems_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_configitems.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_configitems);\t\n\tapp._een(mbtn_cci_views, (selCount==1));\n\tapp._een(mbtn_cci_actions, boolActive);\n\n\n}"},{"name":"sl_configitems_OnHeaderItemClicked","code":"sl_configitems_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_configitems.Refresh();\n\n\n}"},{"name":"sl_impactcis_OnHeaderItemClicked","code":"sl_impactcis_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_impactcis.Refresh();\n\n\n}"},{"name":"sl_impactcis_OnItemSelected","code":"sl_impactcis_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_impactcis.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_impactcis);\t\n\tapp._een(mbtn_ici_views,(selCount==1));\n\tapp._een(mbtn_ici_actions, boolActive);\n\n\n\n\n}"},{"name":"sl_incs_OnHeaderItemClicked","code":"sl_incs_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_incs.Refresh();\n\n\n}"},{"name":"sl_incs_OnItemSelected","code":"sl_incs_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_incs.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_incs);\t\n\tapp._een(mbtn_inc_views,(selCount==1));\n\tapp._een(mbtn_inc_actions, boolActive);\n\n\n\n\n}"},{"name":"sl_customerimpact_OnHeaderItemClicked","code":"sl_customerimpact_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_customerimpact.Refresh();\n\n\n}"},{"name":"mbtn_inc_views_OnMenuItem","code":"mbtn_inc_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tvar iCust = 2\n\tif(nItemID == iDetails)\n\t{\n\t\tif(sl_incs.curSel > -1)sl_incs.EditRecord(sl_incs.curSel);\n\t}\n\telse if (nItemID==iCust)\n\t{\n\t\tif(sl_incs.curSel > -1)\n\t\t{\n\t\t\tvar strKeySearch = app.g.sl_getcolvalue(sl_incs,-1,\"cust_id\");\n\t\t\tif(strKeySearch!=\"\")app.OpenFormForEdit(\"tfCustomer\", strKeySearch, \"\", true);\n\t\t}\n\t}\n}"},{"name":"TabRel_OnTabSelected","code":"TabRel_OnTabSelected(nTab)\n{\n\tif(nTab==5)\n\t{\n\t\t_swdoc.filter_impact_customers(_swdoc.EF()); \n\t}\n\telse if (nTab==6)\n\t{\n\t\t_swdoc.filter_impact_orgs(_swdoc.EF()); \n\t}\n\telse if (nTab==3)\n\t{\n\t\tsl_incs.Refresh();\n\t}\n\t\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tTabRel.ShowTabItem(4,((dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1)));\n\tapp._etab(TabRel,0);\n\n\t\/\/-- Show appropriate KB Tab\n\tvar tTab = _swdoc.EF().TabRel.tab;\n\tif(!app.g.use_sw_knowledgebase())\n\t{\n\t\tif(app.strKnowledgebaseDefaultTool.toLowerCase()==\"rightanswers\")\n\t\t{\n\t\t\t_swdoc.EF().TabRel.ShowTabItem(8,true);\n\t\t\t_swdoc.EF().TabRel.ShowTabItem(4,false);\n\t\t\tapp._etab(_swdoc.EF().TabRel, tTab);\n\t\t}\n\t}\n\telse\n\t{\n\t\t_swdoc.EF().TabRel.ShowTabItem(8,false);\n\t\t_swdoc.EF().TabRel.ShowTabItem(4,true);\n\t\tapp._etab(_swdoc.EF().TabRel, tTab);\n\t}\n\n}"},{"name":"mbtn_cci_views1_OnMenuItem","code":"mbtn_cci_views1_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_services,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_services,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_cci_actions1_OnMenuItem","code":"mbtn_cci_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"-1\";\n\t\tfor (var x=sl_services.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tvar value = sl_services.GetItemTextRaw(x,\"pk_auto_id\");\n\t\t\tif (!sl_services.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter +=  value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- 29.04.2008 - 2.2.0 if this ci that has been removed was used to set the pref supp group then change it\n\t\t\t\tif(_swdoc.intAssessmentCI == value)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Customer SLA]\";\n\t\t\t\t\t_swdoc.OC().priority = \"[Use Customer Priority]\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\n\t\t\n\t\t\t\t\tapp._eva(_swdoc.MF().lb_oc_slad1, 0);\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_slad1, 0);\n\t\t\t\t\tapp._een(_swdoc.MF().label_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\tif(strFilter!=\"\")\n\t\tstrFilter = \"pk_auto_id=\"+strFilter+\"&type=2\";\n\n\t\t app._slf(sl_services, strFilter);  \n\t\t\/\/sl_configitems1.Refresh();\n\t\tsl_services.SetRowSelected(0);\n\t\tsl_services_OnItemSelected(0);\n\t\t_swdoc.EF().sl_services.Refresh();\n\t\t_swdoc.check_ci_assessment();\n\t\treturn;\n\t}\n       \n}"},{"name":"btn_search_cci1_OnPressed","code":"btn_search_cci1_OnPressed()\n{\n    \/\/-- NWJ 08.03.2004\n    \/\/-- open CI search form in select mode\n\t_swdoc.search_for_services();\n      \n}"},{"name":"sl_services_OnItemSelected","code":"sl_services_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tvar boolActive = (sl_services.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_services);\t\n\tapp._een(mbtn_cci_views1,(selCount==1));\n\tapp._een(mbtn_cci_actions1, boolActive);\n\n}"},{"name":"sl_kbs1_OnItemSelected","code":"sl_kbs1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_kbs1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_kbs1);\t\n\tapp._een(mbtn_inc_views2,(selCount==1));\n\tapp._een(mbtn_inc_actions2, boolActive);\n\n\n\n}"},{"name":"sl_kbs1_OnItemDoubleClicked","code":"sl_kbs1_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_kbs1, nRow, \"fk_kbdoc\");\n\tapp.OpenFormForEdit(\"kb_docadd\", \"\", \"docref=\"+strKeyValue, false);\n\n\n}"},{"name":"mbtn_inc_views2_OnMenuItem","code":"mbtn_inc_views2_OnMenuItem(strName, nItemID)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_kbs1, sl_kbs1.curSel, \"fk_kbdoc\");\n\tapp.oKB.open_article_form(strKeyValue);\n}"},{"name":"mbtn_inc_actions2_OnMenuItem","code":"mbtn_inc_actions2_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\tvar iLinkCauseCI = 2;\n\tvar iLinkImpactCI = 3;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\t\tvar strFilter = \"-1\";\n\t\t\tfor (var x=sl_kbs1.rowCount()-1;x > -1;x--)\n\t\t\t{\n\t\t\t\tif (!sl_kbs1.IsRowSelected(x))\n\t\t\t\t{\n\t\t\t\t\t\/\/-- add to filter\n\t\t\t\t\tvar value = sl_kbs1.GetItemTextRaw(x,0);\n\t\t\t\t\tif (value != \"\")\n\t\t\t\t\t{\n    \t\t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\t\tstrFilter += value;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(strFilter!=\"\")\n\t\t\t\tstrFilter = \"_kv=\"+strFilter;\n       \t\tapp._slf(sl_kbs1, strFilter);  \n       \t\t_swdoc.EF().sl_kbs1.Refresh();\n       \t\tsl_kbs1.SetRowSelected(0);\n\t   \t\tsl_kbs1_OnItemSelected(0);  \n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc2_OnPressed","code":"btn_search_inc2_OnPressed()\n{\n    app.g.search_for(\"swkb\", true,\"\",function(oRes)\n    {\n    \tvar strKeys = oRes.selectedkeys;\n\t\tif(strKeys==\"\")return;\n\t\tvar arrKeys = strKeys.split(\",\");\n\t\tfor (var x=0; x< arrKeys.length;x++)\n\t\t{\n\t\t\tvar fk_key = arrKeys[x];\n\t\t\tif(app.g.sl_findrow_byvalue(sl_kbs1,fk_key,\"docref\")==-1)\n\t\t\t{\n\t\t\t\tapp.g.sqllist_kv_appendfilter(sl_kbs1, fk_key, \"docref\");\t\t\n\t\t\t}\n\t\t}\n\t\tsl_kbs1.Refresh();\n\t\tsl_kbs1.SetRowSelected(0);\n\t\tsl_kbs1_OnItemSelected(0);\n\t\treturn;\n    });\n}"},{"name":"TabChanges1_OnTabSelected","code":"TabChanges1_OnTabSelected(nTab)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tif(nTab==0)\n\t{\n\t\t\/\/-- only load list once (will keep trying to load records each time you click if there are no linked recs)\n\t\tif (sl_rfccause.rowCount() < 1) \n\t\t{\n\t\t\tapp.g.sl_load_call_masters(sl_rfccause, _swdoc.OC().callref , \"RFC-CPROBLEM\") ;\n\t\t}\n\t}else\n\t{\n\t\tif (sl_rels1.rowCount() < 1) \n\t\t{\n\t\t\tapp.g.sl_load_call_masters(sl_rels1, _swdoc.OC().callref , \"RELEASE-CPROBLEM\") ;\n\t\t}\t\t\n\t}\n\n}"},{"name":"sl_rels1_OnHeaderItemClicked","code":"sl_rels1_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\tsl_rels1.Refresh();\n}"},{"name":"sl_rels1_OnItemSelected","code":"sl_rels1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_rels1.rowCount() > 0);\n\tvar selCount = app.g.sl_getselected_count(sl_rels1);\t\n\tapp._een(mbtn_rel_views1,(selCount==1));\t\n\tapp._een(mbtn_rel_actions1,boolActive);\n\t\n}"},{"name":"mbtn_rel_views_OnMenuItem","code":"mbtn_rel_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\t\n\tif(nItemID == iDetails)\n\t{\n\t\tif(sl_rels.curSel > -1)sl_rels.EditRecord(sl_rels.curSel);\n\t}\n}"},{"name":"mbtn_rel_actions_OnMenuItem","code":"mbtn_rel_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iDisassociate = 1;\n\t\n\t\tif(nItemID == iDisassociate)\n\t\t{\n\t\t\tapp.g.sl_clearselected(sl_rels,null,0);\n\t\t\tsl_rels_OnItemSelected(0);\n\t\t}\n}"},{"name":"btn_srch_rel_OnPressed","code":"btn_srch_rel_OnPressed()\n{\n\tif (!app.itsm.can_edit(_swdoc.OC().callclass,true))return;\n\n  \tvar strURL = \"canreset=1\";  \n\n    app.itsm.search_calls(\"REL\",strURL,true,function(oResults)\n    {\n    \tif(oResults.selectedkeys==\"\") return;\n\n\t\tvar strFilter = app.g.sl_get_valuesdel(sl_rels,0,\",\");\n\t\tif (strFilter != \"\") \n\t\t{\n\t\t\tstrFilter += \",\" + oResults.selectedkeys;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tstrFilter = oResults.selectedkeys;\n\t\t}\n\t\tapp._slf(sl_rels, \"_kv=\" + strFilter);\n\t\tsl_rels.SetRowSelected(0, true, false);\n\t\t_swdoc.EF().sl_rels.Refresh();\n    });\n}"},{"name":"sl_rels_OnItemSelected","code":"sl_rels_OnItemSelected(nRow)\n{\n\tvar boolActive = (sl_rels.rowCount() > 0);\n\tvar selCount = app.g.sl_getselected_count(sl_rels);\t\n\tapp._een(mbtn_rel_views,(selCount==1));\t\n\tapp._een(mbtn_rel_actions,boolActive);\n}"},{"name":"mbtn_inc_views3_OnMenuItem","code":"mbtn_inc_views3_OnMenuItem(strName, nItemID)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_rakb, sl_rakb.curSel, \"docref\");\n\tapp.g.open_article(strKeyValue);\n\t\n}"},{"name":"mbtn_inc_actions3_OnMenuItem","code":"mbtn_inc_actions3_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(sl_rakb,null,0);\t\t\n\t\t\tvar strFilter = app.g.sl_get_valuesdel(sl_rakb,0,\",\",\"'\",\"\");\n\t\t\tif(strFilter==\"\") strFilter=\"''\";\n\t\t\tapp._slf(sl_rakb, \"_kv=\" + strFilter);\t\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc3_OnPressed","code":"btn_search_inc3_OnPressed()\n{\n   if(!app.g.use_sw_knowledgebase())\n\t\t\t{\n\t       \t\tapp.allocatekbdoc(_swdoc._kbidentifier,_swdoc);\n\t\t\t\tapp.g.open_third_party_kb_search(true, \"\",\"\",app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\"), _swdoc._kbidentifier);\n\t}\n   \n   \treturn;\n   \n\n\n\n}"},{"name":"sl_rakb_OnItemDoubleClicked","code":"sl_rakb_OnItemDoubleClicked(nRow, nCol)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_rakb1, nRow, \"docref\");\n\tapp.g.open_article(strKeyValue);\n\n}"},{"name":"sl_rakb_OnItemSelected","code":"sl_rakb_OnItemSelected(nRow)\n{\n\tvar boolActive = (sl_rakb.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rakb);\t\n\tapp._een(mbtn_inc_views3, (selCount==1));\n\tapp._een(mbtn_inc_actions3, boolActive);\n\n\n}"}]}}}}}