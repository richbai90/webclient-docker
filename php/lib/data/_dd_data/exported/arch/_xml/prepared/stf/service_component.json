{"espForm":{"configuration":{"settings":{"name":"service_component","title":"Component Details","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"sc_rels","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":[{"name":"OnSaveData","code":"OnSaveData()\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(!app.service.can_update(true))\n\t\treturn false;\n\t_swdoc.calc_cost();\n\n\tif(sc_rels.flg_isoptional==\"1\" && sc_rels.flg_include==\"1\")\n\t{\n\t\tvar strNewCost = app.service.get_service_costing(sc_rels.fk_service,sc_rels.pk_auto_id,sc_rels.total_cost_for_item,sc_rels.apply_type);\n\n\t\tvar strField = \"request_price\";\n\t\tvar strConfirmText = 'This will make the request cost greater than request price for 1 or more entities. Do you wish to continue?';\n\t\tvar strParams = \"sid=\"+sc_rels.fk_service+ \"&type=SUB\";\n\n\t\tif(sc_rels.apply_type=='Per Subscription')\n\t\t{\n\t\t\tstrField = \"subscription_price\";\n\t\t\tstrParams = \"sid=\"+sc_rels.fk_service+ \"&type=VIEW\";\/\/\" and rel_type='VIEW'\";\n\t\t\tstrConfirmText = 'This will make the subscription cost greater than subscription price for 1 or more entities. Do you wish to continue?';\n\t\t}\n\n\t\tvar oRS  = app.g.get_sqrecordset(\"service\/get_service_subscriptions.select\",strParams);\n\t\twhile (oRS.Fetch())\n\t\t{ \n\t\t\t var strSubPrice = app.g.get_field(oRS,strField);\n\t\t\t if(parseFloat(strSubPrice)<parseFloat(strNewCost) && parseFloat(strSubPrice)>0)\n\t\t\t {\n\t\t\t \tvar boolConfirm = confirm(strConfirmText);\n\t\t\t\treturn boolConfirm;\n\t\t\t }\n\t\t}\n\t}\n\t\n\treturn true;\n}"},{"name":"(Globals)","code":"var boolFigureChanged = false;\nvar strOrigValueCost = \"\";\nvar strOrigValuePrice = \"\";\nvar origCost = \"\";\nvar origPrice = \"\";\n\nfunction oRel()\n{\n\treturn _swdoc.sc_rels;\n}\n\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction calc_cost()\n{\n\tvar strOrigCost = _swdoc.oRel().total_cost_for_item; \n\tvar strWeight = \"\";\n\tif(_swdoc.oRel().cost_weighting==\"\")\n\t{\n\t\tstrWeight = \"0\";\n\t}else\n\t\tstrWeight = _swdoc.oRel().cost_weighting;\n\t\n\t_swdoc.oRel().total_cost_for_item = app.format_float_to_decimal_str(Number(_swdoc.oRel().total_unit_cost)*Number(_swdoc.oRel().units)*( (Number(strWeight)+100)\/100));\n\n\t_swdoc.oRel().customise_diff = app.format_float_to_decimal_str(Number(_swdoc.oRel().customise_diff)+Number(_swdoc.oRel().total_cost_for_item)- Number(strOrigCost));\n\n\t_swdoc.UpdateFormFromData();\t\n}\n\nfunction calc_price()\n{\n\tvar strOrigPrice = _swdoc.oRel().price; \n\n\t_swdoc.oRel().price_diff = app.format_float_to_decimal_str(Number(_swdoc.oRel().price_diff)+Number(_swdoc.oRel().price)- Number(_swdoc.origPrice));\n\n\t_swdoc.UpdateFormFromData();\t\n}\n\nfunction setup_form_fields()\n{\n\t\n\n\n\tif(_swdoc.GetArg(\"customise\")==\"1\")\n\t{\n\t\t_swdoc.MF().Tab1.ShowTabItem(1,false);\n\t}else\n\t{\n\t\t_swdoc.MF().Tab1.ShowTabItem(1,_swdoc.oRel().flg_isoptional==1);\n\t}\n\n\tapp._een(_swdoc.MF().flg_include,(_swdoc.oRel().flg_isoptional==1));\n\t\t\n\tif(_swdoc.oRel().pk_auto_id<1)\n\t{\n\t\tvar strService = _swdoc.GetArg(\"fk_service\");\n\t\t_swdoc.oRel().fk_service = strService;\n\t}\n\t_swdoc.strOrigValueCost = _swdoc.oRel().total_unit_cost;\n\t_swdoc.strOrigValuePrice = _swdoc.oRel().price;\n\t_swdoc.origPrice = _swdoc.oRel().price; \n\t_swdoc.origCost = _swdoc.oRel().total_cost_for_item; \n\t\n\tif(_swdoc.oRel().fk_key>0)\n\t{\n\t\tapp._evi(_swdoc.MF().fld_gl_code,false);\n\t\tapp._evi(_swdoc.MF().lbl_gl_code,false);\n\t}\n\t\n\tif(_swdoc.GetArg(\"selection\")==\"1\")\n\t{\n\t\tapp._een(_swdoc.MF().fld_apply_type,false);\n\t\tapp._een(_swdoc.MF().fld_total_unit_costs,false);\n\t\tapp._een(_swdoc.MF().fld_units,false);\n\t\tapp._een(_swdoc.MF().fld_price,false);\n\t\tapp._een(_swdoc.MF().flg_include,false);\n\t\tapp._een(_swdoc.MF().flg_optional,false);\n\t\n\t}\n\n\n}"},{"name":"OnDataSaved","code":"OnDataSaved()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.boolFigureChanged = true;\n\tif(_swdoc.oRel().flg_cancustomise==\"1\")\n\t{\n\t\tvar newCost = _swdoc.oRel().total_cost_for_item;\n\t\tif(newCost==\"\")\n\t\t\tnewCost = \"0\";\n\t\tif(_swdoc.origCost==\"\")\n\t\t\t_swdoc.origCost=\"0\";\n\t\tvar costChanges = parseFloat(_swdoc.oRel().total_cost_for_item) - parseFloat(_swdoc.origCost); \n\n\t\tvar newPrice = _swdoc.oRel().price;\n\t\tif(newPrice==\"\")\n\t\t\tnewPrice = \"0\";\n\t\tif(_swdoc.origPrice==\"\")\n\t\t\t_swdoc.origPrice=\"0\";\n\t\tvar priceChanges = parseFloat(newPrice) - parseFloat(_swdoc.origPrice); \n\n\t\tvar oRec  = app.g.get_sqrecordset(\"service\/get_service_relations.select\",\"relid=\"+app.pfu(_swdoc.oRel().pk_auto_id));\n\t\twhile (oRec.Fetch())\n\t\t{ \n\t\t\tvar id = app.g.get_field(oRec, \"pk_auto_id\");\n\t\t\tvar cust_diff =  app.g.get_field(oRec,\"customise_diff\");\n\t\t\tif(cust_diff==\"\")\n\t\t\t\tcust_diff=\"0\";\n\t\t\tif(costChanges==\"\")\n\t\t\t\tcostChanges=\"0\";\n\t\t\tvar price_diff =  app.g.get_field(oRec,\"price_diff\");\n\t\t\tif(price_diff==\"\")\n\t\t\t\tprice_diff=\"0\";\n\t\t\tif(priceChanges==\"\")\n\t\t\t\tpriceChanges=\"0\";\n\t\t\tcust_diff = parseFloat(cust_diff) - parseFloat(costChanges);\n\t\t\tprice_diff = parseFloat(price_diff) - parseFloat(priceChanges);\n\n\t\t\tvar strParams = \"cd=\"+app.pfu(cust_diff)+\"&pd=\"+app.pfu(price_diff)+\"&id=\"+app.pfu(id);\n\t\t\tapp.g.submitsqs(\"service\/update_component_diffs.update\", strParams);\n\t\t}\n\t}\n\t\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"476","height":"262","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"fld_description","type":"Field","group":"Tab1:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"36","left":"160","right":"410","bottom":"54"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.description"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_apply_type","type":"Field","group":"Tab1:0"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"58","left":"160","right":"410","bottom":"76"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.apply_type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","listItems":"Per Request|Per Subscription|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_total_unit_costs","type":"Field","group":"Tab1:0"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"81","left":"160","right":"410","bottom":"99"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.total_unit_cost"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_units","type":"Field","group":"Tab1:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"103","left":"160","right":"410","bottom":"121"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.units"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_total_cost","type":"Field","group":"Tab1:0"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"124","left":"160","right":"410","bottom":"142"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.total_cost_for_item"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"fld_price","type":"Field","group":"Tab1:0"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"146","left":"160","right":"410","bottom":"164"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.price"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_include","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"211","left":"154","right":"404","bottom":"227"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.flg_include"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","flagItems":"Include in basic cost calculation^1|"}}},{"general":{"name":"flg_optional","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"191","left":"154","right":"404","bottom":"207"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.flg_isoptional"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","flagItems":"Is a standard component^1|"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Fk Service","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"300","left":"160","right":"270","bottom":"316"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sc_rels.fk_service"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"type":"Field"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"300","left":"280","right":"530","bottom":"316"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.fk_service"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"10","caption":"Unit Cost","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"81","left":"40","right":"150","bottom":"97"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sc_rels.total_unit_cost"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"11","caption":"Units","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"103","left":"40","right":"150","bottom":"119"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sc_rels.units"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"12","caption":"Apply Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"58","left":"87","right":"150","bottom":"74"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sc_rels.apply_type"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Tab1","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"13","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"6","left":"13","right":"461","bottom":"254"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Offering","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Upgrade\/Downgrade Options","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_custom","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"},"group":"Tab1:1"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"64","left":"22","right":"449","bottom":"248"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Name","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"total_unit_cost"},"name":"Unit Cost","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_key"},"name":"key","width":"21","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"pk_auto_id","width":"19","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"units"},"name":"Units","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cost_weighting"},"name":"Mark Up (%)","width":"14","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"total_cost_for_item"},"name":"Total Cost","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"price"},"name":"Price","width":"120","image":"-1","dataColumn":"7"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#d3c9b6","sqlSource":"swdata","table":"sc_rels","listFilter":"swc=fk_service_rels&kvs=&[sc_rels.pk_auto_id]","editRecordForm":"Form.service_component","storedQuery":"common.load_by_colname"}}},{"general":{"name":"btn_remove_customisable","type":"EventButton","group":"Tab1:1"},"appearance":{"index":"15","caption":"Remove","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"318","right":"381","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_view_customisable","type":"EventButton","group":"Tab1:1"},"appearance":{"index":"16","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"251","right":"314","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"txt_label","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"17","caption":"Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"33","left":"55","right":"150","bottom":"58"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"18","caption":"Total Cost For Item","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"124","left":"53","right":"150","bottom":"140"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sc_rels.total_cost_for_item"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"19","caption":"Price","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"146","left":"118","right":"150","bottom":"162"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sc_rels.price"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"mbtn_add_comp","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:1"},"appearance":{"index":"20","caption":"Add","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"385","right":"448","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Service^1|Configuration Type^2|"}}},{"general":{"name":"lbl_gl_code","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:0"},"appearance":{"index":"21","caption":"GL Code","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"168","left":"104","right":"150","bottom":"184"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"sc_rels.gl_code"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_gl_code","type":"Field","group":"Tab1:0"},"appearance":{"index":"22","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"168","left":"160","right":"410","bottom":"186"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"sc_rels.gl_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.setup_form_fields();\n\n}"},{"name":"fld_total_unit_costs_OnValueChanged","code":"fld_total_unit_costs_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(isNaN(strValue))\n\t{\n\t\tsc_rels.total_unit_cost = _swdoc.strOrigValueCost;\n\t}else\n\t{\n\t\tsc_rels.total_unit_cost = app.format_float_to_decimal_str(strValue);\n\t\t_swdoc.strOrigValueCost = sc_rels.total_unit_cost;\n\t}\n\t\/\/MessageBox(service_costs.total_unit_cost);\n\t_swdoc.calc_cost();\n}"},{"name":"btn_remove_customisable_OnPressed","code":"btn_remove_customisable_OnPressed()\n{\n\tif(!app.service.can_update(true))\n\t\treturn false;\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.sqllist_deldbrow(sl_custom, -1, \"\", null, \"Remove the currently selected component?\");\n\t\t\n\tsl_custom.Refresh();\n\tif(sl_custom.rowCount()<1)\n\t{\n\t\tif(sc_rels.flg_cancustomise!=\"0\") \n\t\t{\n\t\t\tsc_rels.flg_cancustomise=\"0\";\n\t\t\t_swdoc.Save(0);\n\t\t}\n\t}\n\tsl_custom_OnItemSelected(-1);\n\t\n\n}"},{"name":"btn_view_customisable_OnPressed","code":"btn_view_customisable_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar varKey = sl_custom.GetItemTextRaw(sl_custom.curSel,'pk_auto_id');\n\n\tapp.OpenFormForEdit('service_component',varKey,\"customise=1\",true, function(){\n\t\t_swdoc.MF().sl_custom.Refresh();\n\t});\n}"},{"name":"fld_units_OnValueChanged","code":"fld_units_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.calc_cost();\n}"},{"name":"sl_custom_OnItemSelected","code":"sl_custom_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp._een(btn_remove_customisable,(nRow>-1));\n\tapp._een(btn_view_customisable,(nRow>-1));\n\t\n\n}"},{"name":"sl_custom_OnItemDoubleClicked","code":"sl_custom_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar strKeyValue = app.g.sl_getprikeyvalue(sl_custom, nRow);\n\tapp.OpenFormForEdit(\"service_component\", strKeyValue, \"customise=1\", true, function(){\n\t\t_swdoc.MF().sl_custom.Refresh();\n\t\treturn false;\n\t});\n}"},{"name":"fld_price_OnValueChanged","code":"fld_price_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(isNaN(strValue))\n\t{\n\t\tsc_rels.price = _swdoc.strOrigValuePrice;\n\t}\n\telse\n\t{\n\t\tsc_rels.price = app.format_float_to_decimal_str(strValue);\n\t\t_swdoc.strOrigValuePrice = sc_rels.price;\n\t}\n\t_swdoc.calc_price();\n\n}"},{"name":"flg_optional_OnValueChanged","code":"flg_optional_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t\t_swdoc.MF().Tab1.ShowTabItem(1,1==strValue);\n\t\tapp._een(flg_include,(1==strValue));\n\t\tif(0==strValue)\n\t\t{\n\t\t\tsc_rels.flg_include=0;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t\t\n\t\t\n\n}"},{"name":"mbtn_add_comp_OnMenuItem","code":"mbtn_add_comp_OnMenuItem(strName, nItemID)\n{\n\tif(!app.service.can_update(true))\n\t\treturn false;\n\tvar iService =1;\t\n\tvar iEntity =2;\t\t\n\n\tif(nItemID == iService)\n\t{\n\t\tapp.cmdb.search_service(true,\"canreset=0&flg_canbundle=1\",function(oRes)\n\t\t{\n\t\t\tif(oRes.selectedkeys==\"\")return;\n\t\n\t\t\t\/\/-- remove duplicates\n\t\t\tvar strKeys = \"\";\n\t\t\tvar arrKeys = oRes.selectedkeys.split(\",\");\n\t\t\tfor(var x=0;x<arrKeys.length;x++)\n\t\t\t{\n\t\t\t\t\/\/-- not in list and not the item we actually have loaded  ok to add\n\t\t\t\tvar foundRowNum = app.g.sqllist_findrow_byvalue(sl_custom,arrKeys[x],'fk_key');\n\t\t\t\tif((foundRowNum==-1)&&(arrKeys[x] != sc_rels.pk_auto_id))\n\t\t\t\t{\n\t\t\t\t\tif(strKeys!=\"\")strKeys +=\",\";\n\t\t\t\t\tstrKeys += arrKeys[x];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(strKeys==\"\")return ;\n\t\t\t\n\t\t\tapp.service.add_component_custom(sc_rels.pk_auto_id,strKeys);\n\t\t\n\t\t\t_swdoc.MF().sl_custom.Refresh();\n\t\t\t\n\t\t\tif(_swdoc.MF().sl_custom.rowCount()>0)\n\t\t\t{\n\t\t\t\tif(sc_rels.flg_cancustomise!=\"1\") \n\t\t\t\t{\n\t\t\t\t\tsc_rels.flg_cancustomise=\"1\";\n\t\t\t\t\t_swdoc.Save(0);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\t\n\t}\n\telse if(nItemID == iEntity)\n\t{\n\t\tapp.OpenForm(\"browse_cmdb_entities\", \"mode=select\", true, function(oRes)\n\t\t{\n\t\t\tif(oRes.strSelectedKey==\"\")return false;\n\t\n\t\t\tvar strKeys = oRes.strSelectedKey;\n\t\t\n\t\t\t\/\/-- remove duplicates\n\t\t\tvar strKeys = \"\";\n\t\t\tvar arrKeys = oRes.strSelectedKey.split(\",\");\n\t\t\tfor(var x=0;x<arrKeys.length;x++)\n\t\t\t{\n\t\t\t\t\/\/-- not in list and not the item we actually have loaded  ok to add\n\t\t\t\tvar foundRowNum = app.g.sqllist_findrow_byvalue(sl_custom,arrKeys[x],'fk_key');\n\t\t\t\tif((foundRowNum==-1)&&(arrKeys[x] != sc_rels.pk_auto_id))\n\t\t\t\t{\n\t\t\t\t\tif(strKeys!=\"\")strKeys +=\",\";\n\t\t\t\t\tstrKeys += arrKeys[x];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(strKeys==\"\")return ;\n\t\t\t\n\t\t\tapp.service.add_cmdb_component_custom(sc_rels.pk_auto_id,strKeys);\n\t\t\n\t\t\t_swdoc.MF().sl_custom.Refresh();\n\t\t\t\n\t\t\tif(_swdoc.MF().sl_custom.rowCount()>0)\n\t\t\t{\n\t\t\t\tif(sc_rels.flg_cancustomise!=\"1\") \n\t\t\t\t{\n\t\t\t\t\tsc_rels.flg_cancustomise=\"1\";\n\t\t\t\t\t_swdoc.Save(0);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}