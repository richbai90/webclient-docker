{"espForm":{"configuration":{"settings":{"name":"browse_olas","title":"Browse OLAs","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\nvar webclient = (IsObjectDefined(\"_bHtmlWebClient\"));\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\n\nvar strSelectedKey=\"\";"}}}},"layouts":{"layout":[{"appearance":{"width":"568","height":"175","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"btnProperties","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Properties","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"5","left":"485","right":"565","bottom":"29"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnNew","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"New","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"32","left":"485","right":"565","bottom":"56"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnDelete","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"Delete","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"59","left":"485","right":"565","bottom":"83"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnClose","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Select","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"144","left":"485","right":"565","bottom":"168"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"SqlList1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"}},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"9","left":"10","right":"481","bottom":"164"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"slad_ola"},"name":"Name","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_aid"},"name":"Analyst","width":"100","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_suppgroup"},"name":"Support Group","width":"129","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Default Priority","width":"118","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"flg_pause_psla"},"name":"P.P SLA","width":"62","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_ola_id"},"name":"PK","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cmdb_id"},"name":"fk_cmdb_id","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"appcode"},"name":"appcode","width":"120","image":"-1","dataColumn":"7"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#000099","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#d3c9b6","sqlSource":"swdata","table":"itsmsp_slad_ola","newRecordForm":"Form.itsmsp_slad_ola","editRecordForm":"Form.itsmsp_slad_ola","storedQuery":"common.load_by_colvalues"}}}]},"javascript":{"methods":{"method":[{"name":"btnProperties_OnPressed","code":"btnProperties_OnPressed()\r\n{\r\n    SqlList1.EditRecord(SqlList1.curSel);\r\n}\r\n"},{"name":"btnNew_OnPressed","code":"btnNew_OnPressed()\n{\n   if(!app.session.HaveAppRight(app.ADMIN_SETTINGS, app.SLM_ADD, app.session.dataDictionary)) \n\t{\n\t\tMessageBox(\"You do not have permission to add items in SLM.\");\n\t\treturn false;\n\t}\n   \/\/ app.OpenFormForAdd(strFormName, strInitialKeyValue, strArgs, bModal);\n   \/\/\tvar strURL = \"fk_company_id=\" + app.pfu(oCompany().pk_company_id);\n    \n    var strURL = \"\";\n    app.OpenFormForAdd(\"itsmsp_slad_ola\", \"\", strURL, true, function(){\n    \tSqlList1.Refresh();\n    });\n}"},{"name":"btnDelete_OnPressed","code":"btnDelete_OnPressed()\n{\n\tif(!app.session.HaveAppRight(app.ADMIN_SETTINGS, app.SLM_DELETE, app.session.dataDictionary)) \n\t{\n\t\tMessageBox(\"You do not have permission to delete items in SLM.\");\n\t\treturn false;\n\t}\n\t\/\/-- NWJ - 14.11.2007 - add confirmation\n\tvar strConfirm = \"Are you sure you want to delete the selected operational level definition record?\";\n\tif(app.g.sl_deldbrow(SqlList1,SqlList1.curSel,'pk_ola_id',null,strConfirm))\n\t{\n\t\tSqlList1.SetRowSelected(0);\n\t}\n\n\n\t\n}"},{"name":"btnClose_OnPressed","code":"btnClose_OnPressed()\n{\n\t\/\/-- if mode is select then set _swdoc.strSelectedKey\n\t_swdoc.strSelectedKey=app.g.sl_getprikeyvalue(SqlList1);\n\t_swdoc.strSelectedText=app.g.sl_getcolvalue(SqlList1,-1,\"slad_ola\");\t\n \t_swdoc.strSelectedCMDBIDs=app.g.sl_getcolvalue(SqlList1, -1, \"fk_cmdb_id\");\n   \t_swdoc.CloseForm();\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- allow user to select a row if in selectmode\n\t_swdoc.strSelectedKey=\"\";\n\tvar strMode = _swdoc.GetArg(\"mode\");\n\tvar boolSelect = (strMode==\"select\");\n\t\t\n\tapp._ete(btnClose,(boolSelect)?\"Select\":\"Close\");\n\n\tvar strFilter = \"_filter=\"+_swdoc.GetArg(\"filter\");\n\t\n\tif(strFilter!=\"\")\n\t{\n\t\tvar strOrigFilter = _swdoc.MF().SqlList1.filter;\n\t\t\n\t\tif(_swdoc.webclient)\n\t\t{\n\t\t\tstrFilter = strOrigFilter;\n\t\t\t_swdoc.MF().SqlList1.Refresh();\n\t\t}\n\t\telse\n\t\t{\t\t\n\t\t\tif(strOrigFilter!=\"\")strFilter = strOrigFilter+\"&\"+strFilter;\n\t\t\t_swdoc.MF().SqlList1.Refresh();\n\t\t}\n\t\t \n\t}\n\n\tif(boolSelect)\t\n\t{\n\t\tif(!app.session.HaveRight(ANALYST_RIGHT_C_GROUP,ANALYST_RIGHT_C_CANMANAGESLAS))\n\t\t{\n\t\t\tapp._evi(btnProperties, false);\n\t\t\tapp._evi(btnNew, false);\n\t\t\tapp._evi(btnDelete, false);\n\t\t}\n\t}\n\telse\n\t{\n\t\/*\tif(!app.session.isAdmin) \n\t\t{\n\t\t\tMessageBox(\"You do not have permission to manage self service request types (System Administrator Required).\");\n\t\t\t_swdoc.CloseForm();\n\t\t}*\/\n\t\t\n\t\tapp._evi(btnProperties,true);\n\t\tapp._evi(btnNew,true);\n\t\tapp._evi(btnDelete,true);\n\t}\n\t    \n    var strTitle = \"Browse OLAs\";\n    _swdoc.SetTitle(strTitle);\n\n \tapp._slf(_swdoc.MF().SqlList1 , strFilter);\n \t_swdoc.MF().SqlList1.Refresh();\n}"},{"name":"SqlList1_OnItemDoubleClicked","code":"SqlList1_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(!app.session.HaveRight(ANALYST_RIGHT_C_GROUP,ANALYST_RIGHT_C_CANMANAGESLAS))\n\t{\n\t\tMessageBox(\"You do not have permission to manage SLAs.\");\n\t\treturn false;\n\t}\n\tSqlList1.EditRecord(nRow);\n\t\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}