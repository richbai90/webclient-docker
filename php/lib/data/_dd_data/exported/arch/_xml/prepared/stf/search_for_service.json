{"espForm":{"configuration":{"settings":{"name":"search_for_service","title":"Search For Services","description":"Search on opencall table","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var strSelectedKeys= \"\";\nvar strSelectedText = \"\";\nvar strSelectedTypes = \"\";\nvar strSelectedDesc = \"\";\nvar currentList = null;\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\n\nfunction reset_form_fields()\n{\n\t\/\/-- clear search fields\n\tapp.g.clear_form_fields(\"config_itemi\",mainform,\"\",false);\n\n\tapp._ete(_swdoc.MF().lb_abln, \"Yes\");\n\tapp._ete(_swdoc.MF().lb_abln1, \"Yes\");\n\tapp._eva(_swdoc.MF().tb_flg_archived, 0);\n\t_swdoc.setup_fixed_criteria();\n}\n\n\/\/-- NWJ - 11.08.2008 - read in url and find any matching bindings - if found set field value and disable\n\/\/-- as means we have passed in fixed search criteria - also returns fixed filter\nfunction setup_fixed_criteria()\n{\n\tvar boolCanChange = (_swdoc.GetArg('canreset')==\"1\");\n\tvar strFilter = \"\";\n\tfor(var x = 0; x < _swdoc.MF().elements.length;x++)\n\t{\n\t\tvar element = _swdoc.MF().elements[x];\n\t\tif((element.dataRef!=\"\") && ((element.type == FE_FIELD)||(element.type == app.FE_SEARCHFIELD)))\n\t\t{\n\t\t\tvar arrInfo = element.dataRef.split(\".\");\n\t\t\tvar strFixedValue = unescape(_swdoc.GetArg(arrInfo[1]));\n\t\t\tif(strFixedValue!=\"\")\n\t\t\t{\n\t\t\t\tapp._ete(element, strFixedValue);\n\t\t\t\tapp._een(element, boolCanChange);\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\n\t\t\t\tif(strFilter!=\"\")strFilter += \"&\";\n\t\t\t\tstrFilter += \"_swc_\"+element.dataRef + \"=\" + strFixedValue;\n\t\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\t\/\/-- F0098488\n\t\t\t\/\/-- If appcode filter is set then apply it to the organisation \n\t\t\tif((arrInfo[1]==\"fk_company_id\") && (dd.GetGlobalParamAsNumber(\"Application Settings\/UseAppCodeFilter\")==1))\n\t\t\t\tapp._slf(element , \"_swc_appcode IN(\"+app.itsm.get_session_param(\"datasetFilterList\")+\")\");\t\n\t\t}\n\t\t\n\t}\n\t\n\treturn strFilter;\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"586","height":"492","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"TabSearch","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f7f3ef","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"9","left":"9","right":"579","bottom":"485"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":{"name":"Search Criteria","properties":"56=#f2f2f2|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f2f2f2","inactiveTextColor":"#5f5f5f"}}}},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"2"}}},{"general":{"name":"btn_search","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"1","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"228","left":"505","right":"570","bottom":"252"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_clear","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"2","caption":"Reset","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"256","left":"505","right":"570","bottom":"280"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"lb_type","type":"Field","group":"TabSearch:0"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"259","left":"330","right":"496","bottom":"277"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","listItems":"Any of the above match^0|All of the above match^1|","disabledBackgroundColor":"#eeeeee","defaultValue":"1"}}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"4","caption":"Search Mode :","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"259","left":"246","right":"327","bottom":"277"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"TabRes","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"5","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#eaeaea","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"282","left":"14","right":"573","bottom":"479"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Search Results","properties":"56=#eaeaea|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#eaeaea","inactiveTextColor":"#5f5f5f"}}},{"name":"Result Selection","properties":"56=#eaeaea|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#eaeaea","inactiveTextColor":"#5f5f5f"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"btn_subset","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:0"},"appearance":{"index":"6","caption":"Add to Selection","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"21","right":"115","bottom":"470"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_select","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:0"},"appearance":{"index":"7","caption":"Select","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"428","right":"493","bottom":"470"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_cancel","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:0"},"appearance":{"index":"8","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"498","right":"563","bottom":"470"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_remsub","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:1"},"appearance":{"index":"9","caption":"Remove Selected","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"21","right":"115","bottom":"470"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_subclear","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:1"},"appearance":{"index":"10","caption":"Remove All","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"120","right":"212","bottom":"470"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_subselect","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:1"},"appearance":{"index":"11","caption":"Select","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"428","right":"493","bottom":"470"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"btn_subcancel","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRes:1"},"appearance":{"index":"12","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"498","right":"563","bottom":"470"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"rs1","type":"Rectange","group":"TabSearch:0"},"appearance":{"index":"13","backgroundColor":"#f2f2f2","foregroundColor":"#b2b2b2","font":{"@size":"0"},"borderStyle":"3-D Sunken","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"42","left":"17","right":"289","bottom":"221"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_add_ci","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"14","caption":"Add New","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"288","right":"353","bottom":"470"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"mbtn_view_ci","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"15","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"446","left":"358","right":"423","bottom":"470"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|VCM (Children)^2|VCM (Parents)^5|"}}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"16","caption":"Configuration ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"43","left":"19","right":"121","bottom":"61"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.ck_config_item"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"tb_service_name1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"43","left":"119","right":"287","bottom":"61"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.ck_config_item"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label6","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"18","caption":"IT Owner","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"100","left":"300","right":"402","bottom":"118"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.owner_it"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"borderColor":"#dddddd"}}},{"general":{"name":"tb_it_owner1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"100","left":"400","right":"568","bottom":"118"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.owner_it"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_bus_owner5","type":"Field","group":"TabSearch:0"},"appearance":{"index":"20","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"160","left":"360","right":"528","bottom":"178"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.ck_config_type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"'ME->Service'","content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lb_abln","type":"Field"},"appearance":{"index":"21","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"128","left":"119","right":"287","bottom":"146"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.isactivebaseline"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","listItems":"No|Yes|"}}},{"general":{"name":"Label9","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"22","caption":"Is active baseline?","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"128","left":"18","right":"120","bottom":"146"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.isactivebaseline"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"23","caption":"Description","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"60","left":"19","right":"121","bottom":"78"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.description"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"tb_service_name2","type":"Field","group":"TabSearch:0"},"appearance":{"index":"24","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"60","left":"119","right":"287","bottom":"78"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.description"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label5","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"25","caption":"Status","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"77","left":"19","right":"121","bottom":"95"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.fk_status_level"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"tb_service_name3","type":"Field","group":"TabSearch:0"},"appearance":{"index":"26","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"77","left":"119","right":"287","bottom":"95"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.fk_status_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"sl_results","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabRes:0"},"appearance":{"index":"27","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"311","left":"23","right":"563","bottom":"439"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration Item","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"ID","width":"17","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"isactivebaseline"},"name":"Is active baseline?","width":"120","image":"-1","dataColumn":"6"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"config_itemi","listFilter":"empty=1","selectionMode":"1","storedQuery":"common.searchtable.searchResults"}}},{"general":{"name":"Label10","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"28","caption":"Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"94","left":"19","right":"121","bottom":"112"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.ck_config_type"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"tb_catalog_type1","type":"Field","group":"TabSearch:0"},"appearance":{"index":"29","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"94","left":"119","right":"287","bottom":"112"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.ck_config_type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","distinctTable":"sc_typei","distinctColumn":"pk_config_type","dropdownButtonType":"1","storedQuery":"generic.select"}}},{"general":{"name":"tb_service_name4","type":"Field"},"appearance":{"index":"30","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"111","left":"119","right":"287","bottom":"129"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.cmdb_status"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label7","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"31","caption":"CMDB Status","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"111","left":"19","right":"121","bottom":"129"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.cmdb_status"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"sl_sub","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabRes:1"},"appearance":{"index":"32","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"311","left":"23","right":"563","bottom":"439"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration Item","width":"120","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"ID","width":"21","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"isactivebaseline"},"name":"Is active baseline?","width":"120","image":"-1","dataColumn":"6"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"config_itemi","listFilter":"empty=1","selectionMode":"1","storedQuery":"common.searchtable.resultSelection"}}},{"general":{"name":"Label11","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabSearch:0"},"appearance":{"index":"33","caption":"Allow Support","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"145","left":"18","right":"120","bottom":"163"},"scaling":{"top":"0","left":"0","right":"20","bottom":"0"}},"data":{"binding":"config_itemi.flg_allow_support"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"name":"tb_flg_thirdparty","type":"Field","group":"TabSearch:0"},"appearance":{"index":"34","backgroundColor":"#f2f2f2","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"167","left":"115","right":"283","bottom":"185"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.flg_thirdparty"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"0","content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","flagItems":"Is a third party^1|"}}},{"general":{"name":"tb_flg_archived","type":"Field","group":"TabSearch:0"},"appearance":{"index":"35","backgroundColor":"#f2f2f2","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"184","left":"115","right":"283","bottom":"202"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.service_archived"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"0","content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","flagItems":"Is an archived Service^1|"}}},{"general":{"name":"lb_abln1","type":"Field"},"appearance":{"index":"36","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"145","left":"119","right":"287","bottom":"163"},"scaling":{"top":"0","left":"20","right":"50","bottom":"0"}},"data":{"binding":"config_itemi.flg_allow_support"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","borderColor":"#dddddd","disabledBackgroundColor":"#eeeeee","listItems":"Yes|No|"}}}]},"javascript":{"methods":{"method":[{"name":"btn_search_OnPressed","code":"btn_search_OnPressed()\n{\n\n\t\/\/-- 19.01.2006 - NWJ\n\t\/\/-- create search criteria\n\tapp._etab(TabRes,0);\n\tapp._een(mbtn_view_ci, false);\n\tapp.g.sqllist_clear(sl_results);\n\t\n\tvar boolAND = (lb_type.value==1);\n\tvar strFilter = app.g.create_search_params(mainform,\"config_itemi\",\"\",boolAND,false);\n\tvar strOrAnd = (boolAND)?\" AND \":\" OR \";\n\n\t\/\/-- nwj 28.11.2012 - commented this out as there is no service_type field on this form ????\n\t\/*\n\t\/\/always make sure they are app.service catalog items being shown\n\tif(strFilter.indexOf(\"service_type like '500%' AND\")>-1)\n\t{\n\t\tstrFilter = strFilter.replace(\"service_type like '500%' AND\", \"\");\n\t}else if(strFilter.indexOf(\"service_type like '500%' OR\")>-1)\n\t{\n\t\tstrFilter = strFilter.replace(\"service_type like '500%' OR\", \"\");\n\t}else if(strFilter.indexOf(\"service_type like '500%'\")>-1)\n\t{\n\t\tstrFilter = strFilter.replace(\"service_type like '500%'\", \"\");\n\t}\n\t*\/\n\t\n\t\/\/always make sure they are app.service catalog items being shown\n\tif(strFilter!=\"\")strFilter += \"&\";\n\tstrFilter += \"sf=cis_servicesonly\"; \/\/-- apply static filter to get services only\n\n\t\/\/-- apply filter\n\tapp.g.sl_filter(sl_results,strFilter,null,0);\n\t_swdoc.MF().sl_results.Refresh();\n}"},{"name":"btn_clear_OnPressed","code":"btn_clear_OnPressed()\n{\n\t\/\/-- clear search fields\n\t\/\/app.g.clear_form_fields(\"config_item\",mainform,\"\",false);lb_active.text=\"1\";\n\t_swdoc.reset_form_fields();\t\n}"},{"name":"sl_cis_OnHeaderItemClicked","code":"sl_cis_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_results.Refresh();\n\tsl_results.SetRowSelected(0);\n}"},{"name":"sl_cis_OnItemSelected","code":"sl_cis_OnItemSelected(nRow)\n{\n\t\/\/--\n\t\/\/-- enable the select button\n\tapp._een(btn_select , (sl_results.rowCount()>0));\n\tapp._een(btn_subset,(sl_results.rowCount()>0));\t\n\n}"},{"name":"btn_subselect_OnPressed","code":"btn_subselect_OnPressed()\n{\n\t\/\/-- get list of selected callrefs\n\t_swdoc.strSelectedKeys= app.g.sl_getselected_valuesdel(sl_sub,\"pk_auto_id\",\",\");\n\t_swdoc.strSelectedText = app.g.sl_getselected_textdel(sl_sub,\"ck_config_item\",\",\");\n\t_swdoc.strSelectedTypes = app.g.sl_getselected_textdel(sl_sub,\"ck_config_type\",\",\");\t\n\t_swdoc.strSelectedDesc = app.g.sl_getselected_textdel(sl_sub,\"description\",\",\");\t\n\t_swdoc.CloseForm();\n}"},{"name":"btn_subclear_OnPressed","code":"btn_subclear_OnPressed()\n{\n\tapp.g.sl_filter(sl_sub,\"empty=1\",null,0);\n\tsl_sub_OnItemSelected(0);\n\t\n}"},{"name":"btn_remsub_OnPressed","code":"btn_remsub_OnPressed()\n{\n\tapp.g.sl_clearselected(sl_sub,null,0);\n\n\t\/\/-- reset filter\n\t\n\tvar strSubCalls = app.g.sl_get_valuesdel(sl_sub,'pk_auto_id',\",\",\"\");\n\tif(strSubCalls==\"\")strSubCalls=\"-1\";\n\tvar strFilter = \"_kv=\" + strSubCalls;\t\n\tapp.g.sl_filter(sl_sub,strFilter,null,0);\n\tsl_sub_OnItemSelected(0);\t\n\t\n\t\n}"},{"name":"btn_subset_OnPressed","code":"btn_subset_OnPressed()\n{\n\t\/\/-- add selected items to the subset list\n\tvar strSelKeys = app.g.sl_getselected_valuesdel(sl_results\t,'pk_auto_id',\",\",\"\");\n\tvar strSubKeys = app.g.sl_get_valuesdel(sl_sub,'pk_auto_id',\",\",\"\");\n\t\n\t\/\/-- if we already have sub calls\n\tif(strSubKeys!=\"\")\n\t{\n\t\tstrSelKeys += \",\" + strSubKeys;\n\t}\n\t\n\tvar strFilter = \"_kv=\" + strSelKeys;\n\tapp.g.sl_filter(sl_sub,strFilter,null,0);\n\n}"},{"name":"btn_subcancel_OnPressed","code":"btn_subcancel_OnPressed()\n{\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"btn_select_OnPressed","code":"btn_select_OnPressed()\n{\n\t\/\/-- get list of selected callrefs\n\t_swdoc.strSelectedKeys= app.g.sl_getselected_valuesdel(sl_results,\"pk_auto_id\",\",\");\n\t_swdoc.strSelectedText = app.g.sl_getselected_textdel(sl_results,\"ck_config_item\",\",\");\n\t_swdoc.strSelectedTypes = app.g.sl_getselected_textdel(sl_results,\"service_type\",\",\");\n\t_swdoc.strSelectedDesc = app.g.sl_getselected_textdel(sl_results,\"description\",\",\");\t\n\t\n\t_swdoc.CloseForm();\t\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- set field states\n\tapp._een(btn_select, false);\n\tapp._een(btn_subset, false);\n\tapp._een(btn_subselect, false);\n\tapp._een(btn_remsub, false);\n\tapp._een(btn_subclear, false);\n\tapp._een(mbtn_view_ci, false);\n\t\n\t_swdoc.currentList = sl_results\n\t\n\tmainform.SetTimer(1, 5);\n}"},{"name":"OnTimer","code":"OnTimer(nTimer)\n{\n\tmainform.KillTimer(nTimer);\n\t\n\tif(nTimer==1)\n\t{\n\t\t_swdoc.reset_form_fields();\n\t}\n\n\n}"},{"name":"btn_add_ci_OnPressed","code":"btn_add_ci_OnPressed()\n{\n\tapp.cmdb.create_configitem(\"\",true);\n}"},{"name":"mbtn_view_ci_OnMenuItem","code":"mbtn_view_ci_OnMenuItem(strName, nItemID)\n{\n  \tvar iProperties = 1;\n\tvar iVCMp = 5;\t\n\tvar iVCMc = 2;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(_swdoc.currentList,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(_swdoc.currentList,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n\t\t}\n\t\telse if(nItemID == iVCMc)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\n\t\telse if(nItemID == iVCMp)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"TabRes_OnTabSelected","code":"TabRes_OnTabSelected(nTab)\n{\n\tif(nTab==0)\n\t{\n\t\tapp._een(mbtn_view_ci, (app.g.sl_getselected_count(sl_results)==1));\n\t\t_swdoc.currentList = sl_results;\t\n\t}\n\telse if (nTab==1)\n\t{\n\t\tapp._een(mbtn_view_ci, (app.g.sl_getselected_count(sl_sub)==1));\n\t\t_swdoc.currentList = sl_sub;\n\t}\n\t\t\n}"},{"name":"sl_sub1_OnHeaderItemClicked","code":"sl_sub1_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\/\/sl_sub1.Refresh();\n}"},{"name":"sl_sub1_OnItemSelected","code":"sl_sub1_OnItemSelected(nRow)\n{\n\t\/\/--\n\t\/\/-- enable the select button\n\tapp._een(btn_del_ci , (sl_sub1.rowCount()>0));\n\tapp._een(btn_common_update , (app.g.sl_getselected_count(sl_sub1)>1));\t\t\n\tapp._een(mbtn_view_ci , (app.g.sl_getselected_count(sl_sub1)==1));\n\tapp._een(btn_remsub , (sl_sub1.rowCount()>0));\n\tapp._een(btn_subclear , (sl_sub1.rowCount()>0));\t\n\n\n}"},{"name":"sl_sub1_OnItemDoubleClicked","code":"sl_sub1_OnItemDoubleClicked(nRow, nCol)\n{\n\tvar intCIKey= sl_sub1.GetItemTextRaw(nRow, 0);\n\tif(intCIKey==\"\")return;\n\tapp.cmdb.popup_configitem(intCIKey,true,\"\",false);\n}"},{"name":"sl_results1_OnItemSelected","code":"sl_results1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp._een(btn_select , (sl_results1.rowCount()>0));\n\tapp._een(btn_clear , (sl_results1.rowCount()>0));\t\n\tapp._een(mbtn_view_ci , (app.g.sl_getselected_count(sl_results1)==1));\n\n\n}"},{"name":"sl_results1_OnItemDoubleClicked","code":"sl_results1_OnItemDoubleClicked(nRow, nCol)\n{\n\tvar intCIKey= sl_results1.GetItemTextRaw(nRow, 'pk_auto_id');\n\t\/\/app.cmdb.popup_configitem(intCIKey,true,\"\",true);\n\tapp.OpenFormForEdit(\"portfolio\", intCIKey, \"\", 0);\n\t\n}"},{"name":"sl_cust_services1_OnItemSelected","code":"sl_cust_services1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_cust_services1.curSel > -1);\n\tapp._een(mbtn_serv_views , boolActive);\n\tapp._een(mbtn_serv_actions , boolActive);\t\n}"},{"name":"sl_cust_services1_OnItemChecked","code":"sl_cust_services1_OnItemChecked(nRow, bChecked)\n{\n\t\/\/-- get selected ci id\n\tvar pk_ci_id = app.g.sl_getrawcolvalue(sl_cust_services1, nRow, \"pk_auto_id\");\t\n\t\n\tif(bChecked)\n\t{\n\t \n\t\tif(app.g.sl_findrow_byvalue(EF().sl_configitems, pk_ci_id, 'pk_auto_id') > -1) return;\n\t\n\t\tapp.g.sl_appendfilter(EF().sl_configitems, pk_ci_id,'pk_auto_id');\n\n\t\t\/\/-- if only 1 CI use it default profile unless blank\n\t\t\/\/if(EF().sl_configitems.rowCount()==1)\n\t\t\/\/{\n\t\t\/\/\tvar strCode = app.g.sl_getrawcolvalue(EF().sl_configitems,0,\"fk_profilecode\");\n\t\t\/\/\tif(strCode!=\"\") \n\t\t\/\/\t{\n\t\t\/\/\t\tOC().probcode = strCode;\n\t\t\/\/\t\t_swdoc.UpdateFormFromData();\t\t\n\t\t\/\/\t}\n\t\t\/\/}\n\t\t\n\t\t\/\/-- NWJ - determine who the preferred support is\n \t\t_swdoc.determine_prefered_support(true);\n \t\t\n \t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\tapp.cfg.process_call_contract_check(pk_ci_id, true,_swdoc);\n \t\t\n\t}\n\telse\n\t{\n\t\tvar intRowPos = app.g.sl_findrow_byvalue(EF().sl_configitems, pk_ci_id, 'pk_auto_id');\n\t\tif(intRowPos>-1)\n\t\t{\n\t\t\tEF().sl_configitems.RemoveRow(intRowPos);\t\t\n\t\t\t\/\/_swdoc.check_ci_assessment();\n\t\t\t\t\/\/-- 29.04.2008 - 2.2.0 if this ci that has been removed was used to set the pref supp group then change it\n\t\t\t\tif(_swdoc.intAssessmentCI == pk_ci_id)\n\t\t\t\t{\n\t\t\t\t\tOC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\tOC().itsm_prefered_text = \"\";\n\t\t\t\t}\t\t\n\t\t\t\tdetermine_prefered_support(true);\n\n\t\t}\n\n\t}\n\n\n\n}"},{"name":"sl_cust_services1_OnItemDoubleClicked","code":"sl_cust_services1_OnItemDoubleClicked(nRow, nCol)\n{\n\tvar pk_ci_id = app.g.sl_getrawcolvalue(sl_cust_services1, nRow, \"pk_auto_id\");\t\n\tapp.cmdb.popup_configitem(pk_ci_id,true,\"\",true);\n\treturn false;\n}"},{"name":"sl_cust_services1_OnHeaderItemClicked","code":"sl_cust_services1_OnHeaderItemClicked(strOrder, nCol)\n{\n\/\/\t_swdoc.load_customer_items();\n\t_swdoc.load_cis();\n\n}"},{"name":"sl_results_OnItemSelected","code":"sl_results_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp._een(btn_select, (sl_results.rowCount()>0));\n\tapp._een(btn_clear, (sl_results.rowCount()>0));\t\n\tapp._een(mbtn_view_ci, (app.g.sl_getselected_count(sl_results)==1));\n\tapp._een(btn_subset, (sl_results.rowCount()>0));\t\n\n\n}"},{"name":"tb_catalog_type1_OnLeftClick","code":"tb_catalog_type1_OnLeftClick()\n{\n\tapp.OpenForm(\"cmdb_configtype_picker\", \"\", true, function(x)\n\t{\n\t\tif(x.document.strConfigType!=\"\")\n\t\t{\n\t\tapp._ete(tb_catalog_type1, x.document.strConfigType);\n\t\t}\n\t});\n\treturn false;\n}"},{"name":"tb_catalog_type1_OnRightClick","code":"tb_catalog_type1_OnRightClick()\n{\n\tapp._ete(tb_catalog_type1, \"\");\n\treturn false;\n}"},{"name":"sl_sub_OnItemSelected","code":"sl_sub_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp._een(btn_subselect, (sl_sub.rowCount()>0));\n\tapp._een(btn_remsub, (sl_sub.rowCount()>0));\n\tapp._een(btn_subclear, (sl_sub.rowCount()>0));\t\n\tapp._een(mbtn_view_ci, (app.g.sl_getselected_count(sl_sub)==1));\n\n\n\n\n}"},{"name":"sl_results_OnItemDoubleClicked","code":"sl_results_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar intCI = app.g.sl_getrawcolvalue(sl_results,nRow,\"pk_auto_id\");\n  \t\n\tif(intCI>0)\n\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false);\n\t\t\t\n    \t\n\n\n}"},{"name":"sl_sub_OnItemDoubleClicked","code":"sl_sub_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar intCI = app.g.sl_getrawcolvalue(sl_sub,nRow,\"pk_auto_id\");\n  \t\n\tif(intCI>0)\n\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false);\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}