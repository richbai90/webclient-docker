{"espForm":{"configuration":{"settings":{"name":"browse_cmdb_types","title":"Categories and Configuration Types","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":[{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strClass)\n{\n\t\/\/-- does user have permission to manage types\n\treturn app.cmdb.can_manage(true);\n\n\t\n}"},{"name":"OnFormClosing","code":"OnFormClosing()\n{\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.remove_me_document(\"CMDB_ENTITY\", 1);\n\n\treturn true;\n}"},{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\n\/\/-- form pointers\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"483","height":"178","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"sl_types","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"true","allowMultiSelect":"false"}},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"5","left":"5","right":"375","bottom":"175"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_config_type"},"name":"Category (Top Level)","width":"165","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"notes"},"name":"Description","width":"425","image":"-1","dataColumn":"2"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"config_typei","listFilter":"sf=citypes_root","newRecordForm":"Form.cmdb_type","editRecordForm":"Form.cmdb_type","storedQuery":"common.load_by_staticfilter"}}},{"general":{"name":"btnProperties","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Properties","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"5","left":"381","right":"479","bottom":"29"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnNew","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"New","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"32","left":"381","right":"479","bottom":"56"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnDelete","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Delete","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"59","left":"381","right":"479","bottom":"83"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_reltypes","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Relationship Types","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"106","left":"381","right":"479","bottom":"130"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btnClose","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"5","caption":"Close","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"151","left":"381","right":"479","bottom":"175"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"btnProperties_OnPressed","code":"btnProperties_OnPressed()\n{\n    sl_types.EditRecord(sl_types.curSel);\n    _swdoc.MF().sl_types.Refresh();\n    \n}"},{"name":"btnNew_OnPressed","code":"btnNew_OnPressed()\n{\n    app.OpenFormForAdd(\"cmdb_type\", \"\", \"\", true,function(){\n    \t\/\/ app.OpenFormForAdd(\"cmdb_configtype_status\", \"\", strURL, true);\n\t\tapp.g.sl_refresh(sl_types,null,0);\n    \t\/\/sl_types.Refresh()\n    });\n}"},{"name":"btnDelete_OnPressed","code":"btnDelete_OnPressed()\n{\n\t\/\/--\n\t\/\/-- Get delete type and make sure it doesnt have any associated items that are activated\n\tvar delTypeID = sl_types.GetItemTextRaw(sl_types.curSel, 'pk_config_type');\n\t\n\tvar arrParams ={};arrParams.ck_config_type=delTypeID;\n\tvar intRowCount = app.g.sqs_rowcountbycol(\"config_itemi\",arrParams);\n\tif(intRowCount>0)\n\t{\n\t\tMessageBox(\"There are configuration items in the CMDB that are still associated to this category.\\nThey need to be re-assigned using the configuration manager before you can delete this category.\")\n\t\treturn false;\n\t}\n\t\n\t\/\/--\n\t\/\/-- if it has sub types cannot delete\n\tvar arrParams ={};arrParams.fk_config_type=delTypeID;\n\tvar intRowCount = app.g.sqs_rowcountbycol(\"config_typei\",arrParams);\n\t\t\n\tif(intRowCount>0)\n\t{\n\t\tMessageBox(\"There are sub categories associated to this category.\\nThey need to be deleted before you can delete this one.\")\n\t\treturn false;\n\t}\t\n\t\n\tvar strConfirm = \"Are you sure you want to delete this CMDB category?\";\n\tif(app.g.sl_deldbrow(sl_types,sl_types.curSel,0,null,strConfirm))\n\t{\n\t\t\/\/-- delete related data\n\t\tapp.g.delete_tablebycol(\"ct_statusl\",\"fk_config_type\",delTypeID);\n\t\tapp.g.delete_tablebycol(\"ct_reltypes\",\"fk_config_type\",delTypeID);\n\t\tapp.g.delete_tablebycol(\"ct_profiles\",\"fk_config_type\",delTypeID);\t\t\n\t}\n\n}"},{"name":"btnClose_OnPressed","code":"btnClose_OnPressed()\r\n{\r\n    _swdoc.CloseForm();\r\n}\r\n"},{"name":"btn_reltypes_OnPressed","code":"btn_reltypes_OnPressed()\n{\n\n\tapp.OpenFormForAdd(\"browse_cmdb_reltypes\", \"\", \"\", false);\n\n}"},{"name":"sl_types_OnItemSelected","code":"sl_types_OnItemSelected(nRow)\n{\n\tapp._een(btnDelete, (sl_types.GetItemTextRaw(nRow, 'pk_config_type')!=\"ME\"));\n\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n   app.g.add_me_document(\"CMDB_ENTITY\", 1, _swdoc);\n\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}