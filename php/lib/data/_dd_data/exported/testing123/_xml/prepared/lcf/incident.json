{"espForm":{"configuration":{"settings":{"name":"Incident","title":"Log New Incident","callClass":"Incident","profileFilter":"code_status not like 'deactivate%'","options":{"showExtendedDetails":"true","showWorkflow":"false","showFileAttachments":"true","showAffectedCustomers":"false","showAffectedContacts":"true","showCustomHtmlTab":"false","showPartsUsedTab":"false","allowLog":"true","allowLogAssign":"true","allowLogAccept":"true","allowLogClose":"true","allowLogAcceptTake":"true","showMassageBar":"true","showCloseDetails":"false","useEmailDateToLogCall":"false","hideToolbar":"false","hideMenubar":"false","hideFromMenu":"false","extendedDetailsTable":{"title":"Associated Information"}}},"tables":{"table":[{"name":"opencall","type":"Main Details Table","flags":"0"},{"name":"updatedb","type":"Diary Updates Table","mainDetailsColumn":"bpm_workflow_id","recordPicklist":"Business Process","flags":"0"},{"name":"userdb","type":"Related Table","description":"Customer Details","mainDetailsColumn":"cust_id","recordPicklist":"Customer","addRecordForm":"Form.tfCustomer","editRecordForm":"Form.tfCustomer","flags":"1","assignments":{"assignment":[{"expression":"keysearch","masterRecordColumn":"opencall.cust_id"},{"expression":"firstname + \" \" + surname","masterRecordColumn":"opencall.cust_name"},{"expression":"postcode","masterRecordColumn":"opencall.postcode"},{"expression":"fk_manager","masterRecordColumn":"opencall.bpm_managerid"}]}},{"name":"company","type":"Related Table","description":"Company Details","mainDetailsColumn":"fk_company_id","recordPicklist":"Company","addRecordForm":"Form.TfCompany","editRecordForm":"Form.TfCompany","flags":"0","assignments":{"assignment":[{"expression":"pk_company_id","masterRecordColumn":"opencall.fk_company_id"},{"expression":"companyname","masterRecordColumn":"opencall.companyname"}]}},{"name":"bpm_workflow","type":"Related Table","description":"Business Process","mainDetailsColumn":"bpm_workflow_id","recordPicklist":"Business Process","addRecordForm":"Form.bpm_workflows","editRecordForm":"Form.bpm_workflows","flags":"0","assignments":{"assignment":{"expression":"pk_workflow_id","masterRecordColumn":"opencall.bpm_workflow_id"}}},{"type":"Extended Details Table","description":"Associated Information","mainDetailsColumn":"callref","recordPicklist":"Business Process","addRecordForm":"Form.bpm_workflows","editRecordForm":"Form.bpm_workflows","flags":"0"}]},"showMeItems":{"action":[{"name":"Change Customer","id":"9","attrib1":"Customer","displayName":"Change Customer"},{"name":"Customer Properties","id":"2","attrib1":"Form.TfCustomer","attrib2":"&[userdb.keysearch]","displayName":"Customer Properties"},{"name":"Organisation Properties","id":"2","attrib1":"Form.TfCompany","attrib2":"&[company.pk_company_id]","displayName":"Organisation Properties"},{"name":"Selfservice Wizard Input","id":"3","attrib1":"if(_swdoc.OC().logcall_source=='SELFSERVICE')\r\n{\r\n    var strParams = 'in_callref='+_swdoc.OC().callref;\r\n    var intCount = app.g.get_sqrecordset(\"call\/common\/count_wiz_qs\",strParams);\r\n    if(intCount>0)\r\n    {\r\n \t\tvar strServer = '&[app.webroot]';\r\n \t\tvar strCurrentdd = '&[app.currentdd]';\r\n\r\n\t\tapp.global.OpenHtmlWindow(\"wssm_wiz_input\", \"frame\", strServer + \"\/clisupp\/details\/\"+ strCurrentdd +\"\/wssm_wiz_input.php?sessionid=\"+app.session.sessionId+\"&fk_callref=\"+_swdoc.OC().callref, \"Selfservice Wizard Input\", true, 950, 700);\r\n    }\r\n    else\r\n    {\r\n     \/\/MessageBox(\"resolved call count = \" + intCount);\r\n    }\r\n}\r\nelse\r\n{\r\n\tMessageBox('Call was not logged via selfservice.')\r\n}","displayName":"Selfservice Wizard Input"},{"name":"Store Resolution Details","id":"3","attrib1":"strURL= \"company_code=\"+_swdoc.oCompany().pk_company_id;\r\n        \r\nif (_swdoc.OC().custom_i3){\r\n        app.OpenFormForEdit(\"itsmEfQLogResCloseData\", _swdoc.OC().custom_i3,strURL,true, function(aForm){});\r\n}       \r\nelse\r\n{\r\n\tapp.OpenFormForAdd(\"itsmEfQLogResCloseData\", \"\", strURL, true, function(aForm){\r\n\t\tif (aForm)\r\n\t\t{\r\n\t\t\tvar newRecId = aForm.document.record_id;\r\n\t\t\tif (newRecId != \"\"){\r\n\t\t\t\t_swdoc.OC().custom_i3 = newRecId;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tMessageBox(\"No Resolution \/ Closure details were created. If this form is saved as a Quick Log Call, there will be no Resolution \/ Closure details.\");\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n}","displayName":"Store Resolution Details"}]},"javascript":{"methods":{"method":[{"name":"OnCallLoggedOK","code":"OnCallLoggedOK(nCallRef,\n                        dateRespondBy,\n                        dateFixBy,\n                        strCustName,\n                        strSla)\n{\n\n\n    \/\/-- nwj \n    \/\/-- 15.03.2004   \n    var httpserver = app.session.server + \":\" + app.session.httpPort;\n    var intCallRef = app.g.callref_unpad(nCallRef);\n\t\n\t_swdoc.boolLogged = true;\n\t_swdoc.loggedCallref = intCallRef;\n\n\tvar strDiaryText = \"\";\n    var olist = _swdoc.EF().sl_configitems;\n    \/\/-- loop through selected CI and assign them to this call\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n        var pk_ci_id = olist.GetItemTextRaw(x,\"pk_auto_id\");\n        var ci_item_key = olist.GetItemTextRaw(x,\"ck_config_item\");\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'INCIDENT'))\n\t\t{\n\t\t\tstrDiaryText    += \"Configuration Item (\" + ci_item_key + \") was added to this Incident.\\n\"\n\t\t}\n    }\n    \/\/-- if we have Ci to add add it\n    if (strDiaryText!=\"\")\n    {\n\t\tvar strActionSource = \"Incident Management\";\n\t\tvar strCode\t\t\t= \"Added Configuration Item\";\n\t\tapp.g.new_dairyevent(intCallRef,strDiaryText,strActionSource,strCode);    \n    }\n\n\n\tvar strDiaryText = \"\";\n    var olist = _swdoc.EF().sl_services;\n    \/\/-- loop through selected CI and assign them to this call\n    for (var x=0; x < olist.rowCount(); x++)\n    {\n        var pk_ci_id = olist.GetItemTextRaw(x,\"pk_auto_id\");\n        var ci_item_key = olist.GetItemTextRaw(x,\"ck_config_item\");\n\n\t\t\/\/-- Relate the CI to the call\n\t\tif (app.cmdb.relate_ci_to_call(intCallRef,pk_ci_id,'INCIDENT'))\n\t\t{\n\t\t\tstrDiaryText    += \"Service (\" + ci_item_key + \") was added to this Incident.\\n\"\n\t\t}\n    }\n    \/\/-- if we have Ci to add add it\n    if (strDiaryText!=\"\")\n    {\n\t\tvar strActionSource = \"Incident Management\";\n\t\tvar strCode\t\t\t= \"Added Service\";\n\t\tapp.g.new_dairyevent(intCallRef,strDiaryText,strActionSource,strCode);    \n    }\n\n    \/\/-- insert a relationship between incident and problem \/ ke\n    var strProblems = app.g.sl_get_valuesdel(_swdoc.EF().sl_problems,0,\",\");\n    if (strProblems !=\"\")\n    {\n    \tvar strText = \"This incident has been associated with the following Problems and Known Errors\\n\\n\";\n    \tvar strClasses = app.g.sl_get_valuesdel(_swdoc.EF().sl_problems,1,\",\");\n    \tvar arrClasses = strClasses.split(\",\");\n    \tvar arrProblems = strProblems.split(\",\");\n    \tfor(var x=0; x < arrProblems.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrProblems[x],intCallRef,'PROBLEM-INCIDENT'))\n\t\t\t{\n\t\t\t\tstrText += arrClasses[x] + \" (\" + app.g.pad_callref(arrProblems[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrPrbText = \"The incident (\" + nCallRef + \") has been associated to this \" + arrClasses[x];\n\t\t\t\tapp.g.new_diaryevent(arrProblems[x],strPrbText,\"Incident Management\",\"Incident Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Problem Association\");\n    }\n\n    \/\/-- insert a relationship between incident and rfcs\n    var strRFCS = app.g.sl_get_valuesdel(_swdoc.EF().sl_rfcs,0,\",\");\n    if (strRFCS !=\"\")\n    {\n    \tvar strText = \"This incident has been associated with the following Change Requests\\n\\n\";\n    \tvar strClasses = app.g.sl_get_valuesdel(_swdoc.EF().sl_rfcs,1,\",\");\n    \tvar arrClasses = strClasses.split(\",\");\n    \tvar arrRFCS = strRFCS.split(\",\");\n    \tfor(var x=0; x < arrRFCS.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrRFCS[x],intCallRef,'RFC-INCIDENT'))\n\t\t\t{\n\t\t\t\tstrText += \"Change Request (\" + app.g.pad_callref(arrRFCS[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrRfcText = \"The incident (\" + nCallRef + \") has been associated to this \" + arrClasses[x];\n\t\t\t\tapp.g.new_diaryevent(arrRFCS[x],strRfcText,\"Incident Management\",\"Incident Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Change Association\");\n    }\n\n\n     \/\/-- insert a relationship between incident and rfcs\n    var strSRs = app.g.sl_get_valuesdel(_swdoc.EF().sl_srs,0,\",\");\n    if (strSRs !=\"\")\n    {\n    \tvar strText = \"This incident has been associated with the following Service Requests\\n\\n\";\n    \tvar arrSRs = strSRs.split(\",\");\n    \tfor(var x=0; x < arrSRs.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrSRs[x],intCallRef,'REQUEST-INCIDENT'))\n\t\t\t{\n\t\t\t\tstrText += \"Service Request (\" + app.g.pad_callref(arrSRs[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrRfcText = \"The incident (\" + nCallRef + \") has been associated to this Service Request\";\n\t\t\t\tapp.g.new_diaryevent(arrSRs[x],strRfcText,\"Incident Management\",\"Incident Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Service Request Association\");\n    }\n\n     \/\/-- insert a relationship between incident and related incidents\n    var strRIncs = app.g.sl_get_valuesdel(_swdoc.EF().sl_relincs,0,\",\");\n    if (strRIncs !=\"\")\n    {\n    \tvar strText = \"This incident has been associated with the following incidents\\n\\n\";\n    \tvar arrRIncs = strRIncs.split(\",\");\n    \tfor(var x=0; x < arrRIncs.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrRIncs[x],intCallRef,'INCIDENT-INCIDENT'))\n\t\t\t{\n\t\t\t\tapp.g.relate_calls(intCallRef,arrRIncs[x],'INCIDENT-INCIDENT');\n\t\t\t\tstrText += \"Incident (\" + app.g.pad_callref(arrRIncs[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrRfcText = \"The incident (\" + nCallRef + \") has been associated to this incident\";\n\t\t\t\tapp.g.new_diaryevent(arrRIncs[x],strRfcText,\"Incident Management\",\"Incident Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Incident Association\");\n    }\n\n     \/\/-- insert a relationship between incident and major incidents\n    var strMIncs = app.g.sl_get_valuesdel(_swdoc.EF().sl_majinc,0,\",\");\n    if (strMIncs !=\"\")\n    {\n    \tvar strText = \"This incident has been associated with the following major incidents\\n\\n\";\n    \tvar arrMIncs = strMIncs.split(\",\");\n    \tfor(var x=0; x < arrMIncs.length; x++)\n    \t{\n\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\tif(app.g.relate_calls(arrMIncs[x],intCallRef,'MINC-INCIDENT'))\n\t\t\t{\n\t\t\t\tstrText += \"Major Incident (\" + app.g.pad_callref(arrMIncs[x]) + \") associated\\n\";\n\t\t\t\t\n\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\tstrRfcText = \"The incident (\" + nCallRef + \") has been associated to this major incident\";\n\t\t\t\tapp.g.new_diaryevent(arrMIncs[x],strRfcText,\"Incident Management\",\"Incident Association\");\n\t\t\t\t\n\t\t\t}\n\t\t}\t\t\t\n\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Major Incident Association\");\n    }\n\n\tif(_swdoc.OC().itsm_majorinc==\"1\")\n\t{\n\t\tapp.g.new_diaryevent(intCallRef ,\"This incident has been logged as a Major Incident\",\"Incident Management\",\"Major Incident Creation\");\n     \t\/\/-- insert a relationship between incident and major incidents\n    \tvar strIncs = app.g.sl_get_valuesdel(_swdoc.EF().sl_assinc,0,\",\");\n    \tif (strIncs !=\"\")\n    \t{\n    \t\tvar strText = \"This major incident has been associated with the following incidents\\n\\n\";\n    \t\tvar arrIncs = strIncs.split(\",\");\n    \t\tfor(var x=0; x < arrIncs.length; x++)\n    \t\t{\n\t\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\t\tif(app.g.relate_calls(intCallRef,arrIncs[x],'MINC-INCIDENT'))\n\t\t\t\t{\n\t\t\t\t\tstrText += \"Incident (\" + app.g.pad_callref(arrIncs[x]) + \") associated\\n\";\n\t\t\t\t\t\n\t\t\t\t\t\/\/-- update ke or problem diary\n\t\t\t\t\tstrRfcText = \"The major incident (\" + nCallRef + \") has been associated to this incident\";\n\t\t\t\t\tapp.g.new_diaryevent(arrIncs[x],strRfcText,\"Incident Management\",\"Incident Association\");\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\t\t\t\n\t\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Major Incident Association\");\n    \t}\n    }\n\n    \/\/-- insert a relationship between incs and doc\n    if(!app.g.use_sw_knowledgebase())\n\t{\n\t\tif(app.strKnowledgebaseDefaultTool.toLowerCase()==\"rightanswers\")\n\t\t{\n\t\t\tvar strDocs = app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\");\n    \t\tif (strDocs !=\"\")\n    \t\t{\n    \t\t\tvar strText = \"This Incident has been associated with the following Knowledgebase Documents\\n\\n\";\n    \t\t\tvar arrDocs = strDocs.split(\",\");\n    \t\t\tfor(var x=0; x < arrDocs.length; x++)\n    \t\t\t{\n\t\t\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\t\t\tapp.g.relate_call_to_rakb(arrDocs[x],intCallRef,'Used','Incident',false);\n\t\t\t\t\tstrText += \"Knowledgebase Document (\" + arrDocs[x] + \") associated\\n\";\n\t\t\t\t}\t\t\t\n\t\t\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Knowledgebase Document Association\");\n    \t\t}\n\t\t}\n\t}\n\telse\n\t{\n    \tvar strDocs = app.g.sl_get_valuesdel(_swdoc.EF().sl_kbs1,0,\",\");\n    \tif (strDocs !=\"\")\n    \t{\n    \t\tvar strText = \"This Incident has been associated with the following Knowledgebase Documents\\n\\n\";\n    \t\tvar arrDocs = strDocs.split(\",\");\n    \t\tfor(var x=0; x < arrDocs.length; x++)\n    \t\t{\n\t\t\t\t\/\/-- call app.g method to link problem to incident\n\t\t\t\tapp.oKB.relate_call_to_kb(arrDocs[x],intCallRef,'Used');\n\t\t\t\tstrText += \"Knowledgebase Document (\" + arrDocs[x] + \") associated\\n\";\n\t\t\t}\t\t\t\n\t\t\tapp.g.new_diaryevent(intCallRef ,strText,\"Incident Management\",\"Knowledgebase Document Association\");\n    \t}\n   \t}\n\n\t\/\/-- F0105032 - audit trail if incoming call\t\n\tif(_swdoc._form.PreloadType==2)\n\t{\n\t\tif(_swdoc.OC().bpm_workflow_id!=\"\")\n\t\t{\n\t\t\tvar intEpochTime = app.global.GetCurrentEpocTime();\n\t\t\tvar oAnalyst = app.g.get_sys_record(\"swanalysts\",app.session.analystId);\n\t\t\tvar oGroup = app.g.get_sys_record(\"swgroups\",app.session.groupId);\n\t\t\tvar strParams = \"fk_workflow_id=\"+app.pfu(_swdoc.OC().bpm_workflow_id);\n   \t\t\tvar oRS = app.g.get_sqrecordset(\"call\/common\/get_audit_fields\",strParams);\n\t\t\twhile(oRS.Fetch())\n\t\t\t{\n\t\t\t\tvar strBinding = app.g.get_field(oRS,\"fieldname\");\n\t\t\t\tarrBinding = strBinding.split(\".\");\n\t\t\t\tvar strTable = arrBinding[0];\n\t\t\t\tvar strColName = arrBinding[1];\n\t\t\t\t\n\t\t\t\tvar oldValue = _swdoc.oOpencall[strColName];\n\t\t\t\t\n\t\t\t\tvar newValue = _swdoc[strTable][strColName];\n\t\t\t\tif(app.g.dd_isnumeric(strTable, strColName))\n\t\t\t\t{\n\t\t\t\t\tif(newValue<0)\n\t\t\t\t\t\tnewValue = app.g.fix_epoch(newValue);\n\t\t\t\t\tif(oldValue<0)\n\t\t\t\t\t\toldValue = app.g.fix_epoch(oldValue);\n\t\t\t\t}\n\t\t\t\tif(oldValue!=newValue)\n\t\t\t\t{\n\t\t\t\t\tvar strFieldDisplay = dd.tables[app.LC(strTable)].columns[strColName].DisplayName;\n\t\t\t\t\tvar strFmtOldValue = app.g.dd_format(strTable, strColName, oldValue);\n\t\t\t\t\tvar strFmtNewValue = app.g.dd_format(strTable, strColName, newValue);\n\t\t\t\t\tvar oInsertTmp = new app.oXmlmcInsert('oc_audit');\n\t\t\t\t\toInsertTmp.setfield('fk_callref',_swdoc.OC().callref);\n\t\t\t\t\toInsertTmp.setfield('updatetimex',intEpochTime);\n\t\t\t\t\toInsertTmp.setfield('updatedby',app.session.analystId);\n\t\t\t\t\toInsertTmp.setfield('updatedbyname',oAnalyst.name);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroup',app.session.groupId);\n\t\t\t\t\toInsertTmp.setfield('updatedbygroupname',oGroup.name);\n\t\t\t\t\toInsertTmp.setfield('databinding',strBinding);\n\t\t\t\t\toInsertTmp.setfield('bindingfield',arrBinding[1]);\n\t\t\t\t\toInsertTmp.setfield('bindingtable',arrBinding[0]);\n\t\t\t\t\toInsertTmp.setfield('fielddisplay',strFieldDisplay);\n\t\t\t\t\toInsertTmp.setfield('oldvalue',oldValue);\n\t\t\t\t\toInsertTmp.setfield('newvalue',newValue);\n\t\t\t\t\toInsertTmp.setfield('fmtoldvalue',strFmtOldValue);\n\t\t\t\t\toInsertTmp.setfield('fmtnewvalue',strFmtNewValue);\n\t\t\t\t\toInsertTmp.execute();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\t\/\/-- EOF F0105032 \n}"},{"name":"OnRecordResolved","code":"OnRecordResolved(strTable)\n{\n\t\/\/MessageBox(\"Resolved : \" + strTable);\n\t\/\/-- set sla based on worflow default\n\tif(IsObjectDefined(\"mainform\") && (strTable==\"bpm_workflow\"))\n\t{\n\t\tvar boolSet = true;\n\t\tvar boolEnable = true;\n\n\t\tif(bpm_workflow.fk_default_sla_new>0)\n\t\t{\n\t\t\tvar boolSLA = bpm_workflow.flg_sla_apply>0;\n\t\t\tif(boolSLA)\n\t\t\t{\n\t\t\t\tvar boolSet = true;\n\t\t\t\tif(_swdoc.boolIncSLASetManually)\n\t\t\t\t{\n\t\t\t\t\tvar boolOverride = confirm(\"It is recommended to use SLA set against the process.\\n\\n\\Would you like to set the SLA to the process value?\");\n\t\t\t\t\tif(!boolOverride)\n\t\t\t\t\t\tboolSet = false;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif(boolSet)\n\t\t\t\t{\n\t\t\t\t\tif(bpm_workflow.flg_sla_enforce==1)\n\t\t\t\t\t\tboolEnable = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tboolSet = false;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tboolSet = false;\n\t\t}\n\t\t\n\t\tif(boolSet)\n\t\t{\n\t\t\t\/\/-- F0107934\n\t\t\t_swdoc.boolSLAEnforced = false;\n\t\t\t_swdoc.handle_set_sladef(bpm_workflow.fk_default_sla_name,false,true);\n\t\t\tvar boolTempSLASetManually = _swdoc.boolIncSLASetManually;\n\t\t\t_swdoc.boolIncSLASetManually = true;\n\t\t\t_swdoc.handle_set_priority(bpm_workflow.fk_default_sla);\n\t\t\t_swdoc.boolIncSLASetManually = boolTempSLASetManually;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\/\/-- END\n\t\t\tif(!boolEnable)\n\t\t\t{\n\t\t\t\tapp._een(mainform.lb_oc_slad1,false);\n\t\t\t\tapp._een(mainform.lbl_oc_sladef,false);\n\t\t\t\t_swdoc.boolSLAEnforced = true;\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(boolEnable)\n\t\t{\n\t\t\tapp._een(mainform.lb_oc_slad1,true);\n\t\t\tapp._een(mainform.lbl_oc_sladef,true);\n\t\t\t_swdoc.boolSLAEnforced = false;\n\t\t}\n\t\t\n\t\tapp.g.process_bpm_form_attribute_check(_swdoc,bpm_workflow.pk_workflow_id);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n\n    \/\/-- When auto resolved user then we will need to refresh some of the sqllists as they dont do so\n    \/\/-- automatically\n    if (IsObjectDefined(\"mainform\") && strTable == \"userdb\")\n    {\n    \t\/\/-- F0099057, reset CI Ids to force re-query\n \t\t_swdoc.companyCIIDS = \"\";\n\t\t_swdoc.contractCIIDS = \"\";\n\t\t_swdoc.siteCIIDS = \"\";\n     \t_swdoc.setup_customer_details()\n\n    \t\/\/-- rjc - 2.4.0 - customer changed and site selected, confirm site part of new customers organisation\n\t\tif(_swdoc.OC().site!=\"[Use Customers Site]\"){\n\t\t\tvar recSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\t\tif(recSite)\n\t\t\t{\n\t\t\t\tif(app.LC(recSite.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().site = \"[Use Customers Site]\";\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_site, \"[Use Customers Site]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tif(_swdoc.OC().costcenter!=\"[Use Customer Charge Centre]\"){\n\t\t\tvar recCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(app.LC(recCC.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().costcenter = \"[Use Customer Charge Centre]\";\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_cc, \"[Use Customer Charge Centre]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(_swdoc.OC().fk_dept_code!=\"[Use Customer Department]\"){\n\t\t\tvar recCC = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(app.LC(recCC.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().fk_dept_code = \"[Use Customer Department]\";\n\t\t\t\t\tapp._ete(_swdoc.MF().fld_oc_dept,\"[Use Customer Department]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/ DTH: display the SLA from the Customer based on the default. Tnis will also set the Priority if there is one for the Customer\n\t\tif(_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\" && _swdoc.oCust().sld_name != \"\")\n\t\t{\n\t\t\t_swdoc.MF().lb_oc_slad1_OnValueChanged(\"[Use Customer SLA]\");\n\t\t}\t\t\n\t\t\t\t\n\t\t\/\/-- check if customer is in active    \t\n    \tvar strCustStatusMsgValue = dd.GetGlobalParamAsString(\"Application Settings\/CustomerStatusMessages\/\" + _swdoc.oCust().status);\n\t\tif(strCustStatusMsgValue!=\"\")\n\t\t{\n\t\t\tMessageBox(strCustStatusMsgValue);\n\t\t}\n\t\t\t\t\n\t\t_swdoc.set_org_filter();\n\t\t\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n    }\n    if(strTable == \"company\")\n \t{\n \t\t\/\/-- Grab Company Record\n \t\tvar oCompanyTemp = app.g.get_record(\"company\",_swdoc.oCompany().pk_company_id,'companyname');\n \t\t\/\/--F0110887 Start\n\t\tvar intExpiryEpoch = app.g.fix_epoch(oCompanyTemp.supportexpiryx);\n\t\tapp.g.checkOrgSupport(_swdoc.oCust().companyname, intExpiryEpoch, true);\n\t\t\/\/--F0110887 End\n \t}\n\n    \n    if (IsObjectDefined(\"mainform\") && strTable == \"company\")\n    {\n    \t\n    \t\/\/###20120716\n    \t_swdoc.multi_c_set_company(_swdoc.oCompany().pk_company_id);\n    \t\n     \t\/\/-- F0099057, reset CI Ids to force re-query\n \t\t_swdoc.companyCIIDS = \"\";\n\t\t_swdoc.contractCIIDS = \"\";\n\t\t_swdoc.siteCIIDS = \"\";\n\t   \tapp.g.strLogAndResolveCompany = _swdoc.OC().fk_company_id;\n\/*###\n    \tif(_swdoc.oCust().fk_company_id!=_swdoc.OC().fk_company_id)\n    \t{\n    \t\t_swdoc.ResetRecord('userdb');\n    \t\t\n\t\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/OnOrganisationResolveCustomer\")==1)\n\t\t\t{\n\t\t\t\t_swdoc.boolResolvingCust = true;\n\t\t\t\t_swdoc.strSearchFor = \"\";\n\t\t\t\tmainform.SetTimer(1, 10);\n\t\t\t\/\/_swdoc.ResolveRecord(\"userdb\", \"keysearch\", _swdoc.resolve_cust_record(\"\"));\n\t\t\t}\n\t\t}\n*\/\t\t\t\t\n\t\tif(_swdoc.oCompany().recordresolvedmsg!=\"\")MessageBox(_swdoc.oCompany().recordresolvedmsg);\n\t\t\n\t\tif(_swdoc.MF().fld_cis.value ==\"by Organisation\")\n    \t\t_swdoc.load_company_cis();\n\t\telse if(_swdoc.MF().fld_cis.value ==\"by Site\")\n\t\t\t_swdoc.load_site_cis();\n \t\telse\n \t\t{\n \t\t\tif(_swdoc.oCust().keysearch==\"\")\n \t\t\t{\n \t\t\t\tapp._slf(_swdoc.MF().sl_cust_cis,\"pk_auto_id=-1\");\n \t\t\t}\n \t\t}\n \t\t_swdoc.check_cis();\n \t\t\n \t\t\/\/-- rjc - 2.4.0 - customer changed and site selected, confirm site part of new customers organisation\n\t\tif(_swdoc.OC().site!=\"[Use Customers Site]\"){\n\t\t\tvar recSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\t\tif(recSite)\n\t\t\t{\n\t\t\t\tif(app.LC(recSite.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().site = \"[Use Customers Site]\";\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_site, \"[Use Customers Site]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n \t\tif(_swdoc.OC().costcenter!=\"[Use Customer Charge Centre]\"){\n\t\t\tvar recCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(app.LC(recCC.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().costcenter = \"[Use Customer Charge Centre]\";\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_cc,  \"[Use Customer Charge Centre]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(_swdoc.OC().fk_dept_code!=\"[Use Customer Department]\"){\n\t\t\tvar recCC = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\t\tif(recCC)\n\t\t\t{\n\t\t\t\tif(app.LC(recCC.fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().fk_dept_code = \"[Use Customer Department]\";\n\t\t\t\t\tapp._ete(_swdoc.MF().fld_oc_dept, \"[Use Customer Department]\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\/\/-- Filter Contracts for Company\n\t\tapp.g.filter_company_contracts(_swdoc.oCompany().pk_company_id, _swdoc.MF().lb_contract);\n\n\t\tif(_swdoc.OC().itsm_slaname!=\"\")\n\t\t{\n\t\t\t\/\/-- Set Contract Based on Selected SLA\n\t\t\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+_swdoc.OC().itsm_slaname);\n\t\t\tif(slarec.Fetch())\n\t\t\t{\n\t\t\t\tvar strSLA = app.g.get_field(slarec,\"pk_slad_id\");\n\t\t\t\tif(strSLA!=\"\")\n\t\t\t\t\t_swdoc.handle_set_contract(strSLA);\n\t\t\t}\n\t\t}\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\t\t\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\t\n}"},{"name":"OnRecordValueChanged","code":"OnRecordValueChanged(strTable,\n                              strColumn,\n                              strValue,\n                              strOldValue)\n{\n    \/\/-- NWJ - 16.04.2004\n    \/\/MessageBox(strTable+\" \"+strValue+\" \"+strColumn);\n    \/\/-- when user changes probcode (profile)\n    \/\/-- launch APR\n    if (strColumn == \"probcode\")\n    {\n\t\t\/\/-- F0093877\n\t\t_swdoc.boolChangeProfile = true;\n    \t_swdoc.intProfileCodeCI = -1; \/\/-- user has manually set the profile code    \t\n        if (strValue != strOldValue)\n\t\t{\n\t\t\t\/\/-- 29.04.2008 - nwj - tidy up by using doc func\n\t\t\t_swdoc.process_profilecode_checks();\n\t\t\t\n\n            \/\/-- 27.05.2004 get attribute 1 of profile\n            \/\/-- which is the preferred support group\n            _swdoc.determine_prefered_support(false,strValue);\n        }\n        app.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n        mainform.SetTimer(4, 100);\n    }   \n    else if( (strColumn==\"itsm_impact_level\")||(strColumn==\"itsm_urgency_level\") )\n    {\n    \t_swdoc.boolIncSLASetManually = true; \/\/--107865\n    \t \n    \tif(_swdoc.OC().itsm_sladef!=\"\")\n    \t{\n    \t\t\/\/-- if use incident assessment over ci\n    \t\t\/*if(app.itsm.get_ci_assessmnet_level_setting(\"Incident\")!=1)\n    \t\t{\n    \t\t\t_swdoc.OC().priority = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level);\n    \t\t\t_swdoc.UpdateFormFromData();\n    \t\t}*\/\n    \t\t\n    \t\tvar strPriority = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level);\n\t\t\tif(strPriority!=\"\") _swdoc.handle_set_priority(strPriority,false);\n\t\t\t_swdoc.UpdateFormFromData();\n    \t}\n    } else if(strColumn==\"priority\" && strTable == \"opencall\")\n    {\n    \tif(_swdoc.boolChangeProfile)\n    \t{\n\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\tvar oSLA = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\n\t\t\t_swdoc.handle_set_sladef(oSLA.slad_id);\n\t\t\t_swdoc.boolIncSLASetManually = true;\n\t\t\t_swdoc.handle_set_priority(oRec.sla);\n \t\t\t_swdoc.UpdateFormFromData();\n   \t\t}\n    }\n    else if (strColumn==\"fk_company_id\"||strColumn==\"site\"||strColumn==\"fk_dept_code\"||strColumn==\"costcenter\"||strColumn==\"pk_workflow_id\")\n\t{\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t}\n\n    \n}"},{"name":"OnLogCall","code":"OnLogCall()\n{\n\t_swdoc.set_preferred_assignment(false);\n    _swdoc.OC().custom_i3=0;\n    return true;\n}"},{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\nvar _kbidentifier = app.session.sessionId+app.global.GetCurrentEpocTime();\n\nvar current_sltabindex=0;\nvar bool_slcustincs_displayed = false;\nvar bool_slpcodeincs_displayed = false;\nvar boolLogged = false;\n\nvar boolSLAEnforced = false;\n\nvar orig_probcode = \"\";\nvar loggedCallref = 0;\nvar boolProblemAlert = false;\nvar intPeriodBreach = 0;\nvar intProblemAlertPeriod = 0;\nvar intFirstProblemIncidentDatex = 0;\nvar incident_profile_count = 0;\n\nvar strSearchFor = \"\";\nvar boolResolvingCust = false;\nvar boolServiceCIBehaviourOnIncident = false;\n\n\/\/###this can be removed\nvar companyCIIDS = \"\";\nvar customerCIIDS = \"\";\nvar contractCIIDS = \"\";\nvar siteCIIDS = \"\";\nvar companyServiceIDS = \"\";\nvar customerServiceIDS = \"\";\nvar contractServiceIDS = \"\";\nvar siteServiceIDS = \"\";\n\/\/###this can be removed\n\n\n\/\/-- store ci id that was used to get assessment info (i.e. suppgroup \/ priority etc)\n\/\/-- if -1 then profile code assessment was used\n\/\/-- if -2 then user has manually set the profile code\nvar intAssessmentCI = 0;\nvar intProfileCodeCI = 0;\nvar boolIncTitleSetManually = false;\nvar boolIncSLASetManually = false;\n\nvar strDefaultImpact = \"\";\nvar strDefaultUrgency = \"\";\nvar strCurrentPriority = \"\";\nvar strCurrentSLADef = 0;\nvar strCurrentSLAName = \"\";\n\n\n\n\/\/###20120619\nvar strOrigSLAFilter = \"\";\n\n\/\/###20120716\nvar call_comp_fk_cmdb_id = 0;\n\/\/ store CI IDs for each company\nvar multi_companyCIIDS = new Array();\n\/\/ store CI IDs for each site\nvar multi_siteCIIDS = new Array();\n\/\/ store CI IDs for each contract - as they are per organisation\nvar multi_contractCIIDS = new Array();\n\/\/ store CI IDs for each customer - to deal with customer changes\nvar multi_customerCIIDS = new Array();\n\/\/ store Service IDs for each customer - to deal with customer changes\nvar multi_customerServiceIDS = new Array();\n\n\nvar strPreSelectedCompany = \"\";\n\n\nvar boolChangeProfile = false;\n\nvar ib = _swdoc.infobar;\nvar arrOrigSettings = new Array();\n \n\/\/-- F0105032\nvar oOpencall = null;\n\/\/-- EOF F0105032\n\nvar strSLACallClass = \"Incident\";\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}\n\nfunction EF()\n{\n\treturn extform;\n}\n\nfunction OC()\n{\n\treturn _swdoc.opencall;\n}\n\nfunction oCust()\n{\n\treturn _swdoc.userdb;\n}\n\nfunction oCompany()\n{\n\treturn _swdoc.company;\n}\n\n\/\/###20120716\nfunction multi_c_set_company(companyId){\n\n\tvar c = app.g.get_record(\"company\", companyId);\n\t_swdoc.OC().fk_company_id = c.pk_company_id;\t\n\t_swdoc.OC().companyname = c.companyname;\n\t\n\t_swdoc.call_comp_fk_cmdb_id = c.fk_cmdb_id;\n\tapp._eva(_swdoc.MF().pl_oc_org , c.pk_company_id);\n\tapp._ete(_swdoc.MF().pl_oc_org , c.pk_company_id);\n\t_swdoc.MF().pl_oc_org.display = c.companyname;\n\t\n\tvar boolCompanySet = (\"\" !== _swdoc.OC().fk_company_id);\n\tapp._ema(_swdoc.MF().x_fld_org, !boolCompanySet);\n\tapp._evi(_swdoc.MF().x_fld_org, !boolCompanySet);\n\tapp._een(_swdoc.MF().x_fld_org, false);\n\t\n\tapp._ema(_swdoc.MF().pl_oc_org, boolCompanySet);\n\tapp._evi(_swdoc.MF().pl_oc_org, boolCompanySet && _swdoc.MF().lb_company.visible);\n\tapp._een(_swdoc.MF().pl_oc_org, boolCompanySet && (1 == dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")) );\n\n    _swdoc.set_org_filter();\n    \n    _swdoc.load_cis();\n}\n\nfunction set_org_filter(){\n\n  \tif (\"\"!=_swdoc.OC().cust_id){\n\t\tvar strKeyValues = \"pk_company_id=\"+app.pfu(_swdoc.OC().fk_company_id) + \"&fk_user_id=\"+app.pfu(_swdoc.OC().cust_id);\n\t\tapp._slf(_swdoc.MF().pl_oc_org , strKeyValues);\n\t} else {\n\t\tapp._slf(_swdoc.MF().pl_oc_org , \"pk_company_id=\");\n\t}\n\tvar strCompFilter = \"_swc_fk_company_id=\" + _swdoc.MF().pl_oc_org.value;\n\tapp._slf(_swdoc.MF().fld_oc_dept , strCompFilter);\n\tapp._slf(_swdoc.MF().lb_oc_site , strCompFilter);\n\tapp._slf(_swdoc.MF().lb_oc_cc , strCompFilter);\n\n\t_swdoc.OC().site = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().site;\n\t_swdoc.OC().fk_dept_code = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().department;\n\t_swdoc.OC().costcenter = (_swdoc.OC().fk_company_id.toLowerCase() != _swdoc.oCust().fk_company_id.toLowerCase())?\"\":_swdoc.oCust().costcenter;\n\t_swdoc.OC().fk_contract_id = \"\";\n\t_swdoc.handle_set_contract(\"\");\t\n\t_swdoc.UpdateFormFromData();\n}\n\n\n\n\nfunction setup_customer_details()\n{   \n\t_swdoc.load_cis();\n\n\tvar oUserdbRating = app.g.get_record(\"userdb_rating\",_swdoc.oCust().keysearch,'fk_keysearch');\n\tif(oUserdbRating!=null)\n\t{\n\t\tapp._ete(_swdoc.MF().lbl_open_request,\": \"+oUserdbRating.active_count);\n\t\tapp._ete(_swdoc.MF().lbl_closed_request,\": \"+oUserdbRating.inactive_count);\n\t}\n\n\t\/\/-- show overall rating\n\tswitch(_swdoc.oCust().flg_ocrating)\n\t{\n\t\tcase 1:\n\t\t\tapp._eim(_swdoc.MF().img_orating,\"&[app.webroot]\" + \"\/clisupp\/formimages\/itsm\/cr_neg16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating,\": Overall satisfaction negative\");\n\t\t\tbreak;\t\t\t\n\t\tcase 2:\n\t\t\tapp._eim(_swdoc.MF().img_orating,\"&[app.webroot]\" + \"\/clisupp\/formimages\/itsm\/cr_neu16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating, \": Overall satisfaction neutral\");\n\t\t\tbreak;\t\t\t\t\t\t\n\t\tcase 3:\n\t\t\n\t\t\tapp._eim(_swdoc.MF().img_orating,\"&[app.webroot]\" + \"\/clisupp\/formimages\/itsm\/cr_pos16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating, \": Overall satisfaction positive\");\n\t\t\tbreak;\t\t\t\t\t\t\n\t\tdefault:\n\t\t\tapp._eim(_swdoc.MF().img_orating,\"&[app.webroot]\" + \"\/clisupp\/formimages\/itsm\/cr_neu16.gif\");\n\t\t\tapp._ete(_swdoc.MF().lbl_orating,\": Overall satisfaction undetermined\");\n\t\t\tbreak;\n\t}\n\t\n\t_swdoc.multi_c_set_company(_swdoc.oCust().fk_company_id);\n\t\/\/-- log from email fix\n\tif(app.LC(_swdoc.oCust().fk_company_id) != app.LC(_swdoc.oCompany().pk_company_id))\t\n\t{\n\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", _swdoc.oCust().fk_company_id);\n\t}\n\t\n}\n\nfunction load_cis()\n{\n\tvar ciFilter = _swdoc.MF().fld_cis.value;\n\t\n\tswitch(ciFilter){\n\t\tcase \"by Organisation\":\n\t\tcase \"by Settings: Organisation\":\n\t\t\tif (\"[Use Customer's Organisation]\" == _swdoc.OC().fk_company_id) _swdoc.OC().fk_company_id = _swdoc.oCust().fk_company_id;\n\t    \t_swdoc.load_company_cis(_swdoc.OC().fk_company_id);\t\t \n\t\t\tbreak;\n\t\tcase \"by Site\":\n\t\tcase \"by Settings: Site\":\n\t\t\tif (\"[Use Customer's Site]\" == _swdoc.OC().site) _swdoc.OC().site = _swdoc.oCust().site;\n\t\t\t_swdoc.load_site_cis(_swdoc.OC().site);\n\t\t\tbreak;\n\t\tcase \"by Customer: Organisation\":\n\t\t\t_swdoc.load_company_cis(_swdoc.oCust().fk_company_id);\t\t \n\t\t\tbreak;\n\t\tcase \"by Customer: Site\":\n\t\t\t_swdoc.load_site_cis(_swdoc.oCust().site);\t\t \n\t\t\tbreak;\n\t\tcase \"by Contract\":\n\t\t\t_swdoc.load_contract_cis();\n\t\t\tbreak\n\t\tdefault: _swdoc.load_customer_items();\n\t}\n    \n}\n\n\/\/###20120607 - filtering out unwanted services\nfunction filter_out_non_display_services(CIIDS){\n\n\tif(CIIDS==\"\")\n\t\tCIIDS = \"-1\";\n\tvar strServiceKeys = \"-1\";\n    var oRS = app.g.get_sqrecordset(\"call\/incident\/services_to_exclude\",\"ci_id=\"+CIIDS);\n    while (oRS.Fetch()){ \n\t\tstrServiceKeys +=\",\";\n\t\tstrServiceKeys += app.g.get_field(oRS,\"fk_cmdb_id\");\n\t}\n\treturn strServiceKeys;\n}\n\nfunction load_customer_items()\n{\n\t\/\/###20120719 - rewrite to cope with change of customer\n\tif(_swdoc.oCust().keysearch==\"\")\n\t{\n\t\tapp._slf(_swdoc.MF().sl_cust_cis,\"pk_auto_id=-1\");\n\t\treturn;\n\t}\n\t\/\/-- load users config items\t\n\tif(typeof _swdoc.multi_customerCIIDS[_swdoc.oCust().keysearch] === \"undefined\")\n\t\t_swdoc.get_customer_cis(_swdoc.oCust().keysearch);\n\t\t\n\t\/\/ DTH: webclient - add the following from load_company_services\n\tvar userCIS = _swdoc.multi_customerCIIDS[_swdoc.oCust().keysearch];\n\t\t\n\tif(typeof _swdoc.multi_customerServiceIDS[_swdoc.oCust().keysearch] === \"undefined\"){\n\t\t_swdoc.multi_customerServiceIDS[_swdoc.oCust().keysearch] = app.service.get_customer_services(_swdoc.oCust().keysearch,true);\n\n\t\t\/\/###20120607 - filtering out unwanted services\n\t\tif(_swdoc.boolServiceCIBehaviourOnIncident) _swdoc.multi_customerServiceIDS[_swdoc.oCust().keysearch] = _swdoc.filter_out_non_display_services(_swdoc.multi_customerServiceIDS[_swdoc.oCust().keysearch]);\n\t\t\n\t}\n\t\t\t\n\t\/\/ DTH: webclient - add the following from load_site_services\n\tvar serviceKeys = _swdoc.multi_customerServiceIDS[_swdoc.oCust().keysearch];\n\n\t\/\/ DTH: webclient - adding the following from Load_customer_services\n\t\/\/var serviceKeys = app.service.get_customer_services(_swdoc.oCust().keysearch,true);\n\tif(userCIS==\"\")\n\t\tuserCIS = \"-1\";\n\tuserCIS = serviceKeys + \",\" + userCIS;\n\t\n\t_swdoc.update_ci_list(userCIS);\n}\n\n\/\/-- uncheck then re check those that exist\nfunction uncheckset_customer_items()\n{\n\tfor(var y=0; y < _swdoc.MF().sl_cust_cis.rowCount();y++)\n\t{\n\t\t_swdoc.MF().sl_cust_cis.SetRowChecked(y, false);\n\t}\n\n\t\/\/-- check those that are linked to this incident\n\tvar strCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems,'pk_auto_id',\",\");\n\tvar arrCIS = strCIs.split(\",\");\n\tfor(var y=0; y < arrCIS.length;y++)\n\t{\n\t\tvar intRowPos = app.g.sl_findrow_byvalue(_swdoc.MF().sl_cust_cis, arrCIS[y], 'pk_auto_id');\t\n\t\tif(intRowPos>-1)\n\t\t{\n\t\t\t_swdoc.MF().sl_cust_cis.SetRowChecked(intRowPos, true);\n\t\t}\n\t}\t\n\n\n\/\/ DTH: webclient - swap references in the following from _swdoc.MF().sl_cust_services to _swdoc.MF().sl_cust_cis\n\t\/\/-- check those that are linked to this incident\n\tvar strCIs = app.g.sl_get_valuesdel(_swdoc.EF().sl_services,'pk_auto_id',\",\");\n\tvar arrCIS = strCIs.split(\",\");\n\tfor(var y=0; y < arrCIS.length;y++)\n\t{\n\t\tvar intServRowPos = app.g.sl_findrow_byvalue(_swdoc.MF().sl_cust_cis, arrCIS[y], 'pk_auto_id');\t\n\t\tif(intServRowPos>-1)\n\t\t{\n\t\t\t_swdoc.MF().sl_cust_cis.SetRowChecked(intServRowPos, true);\n\t\t}\n\t}\t\n}\n\nfunction check_probprofile_against_problems_kes()\n{\n\t\/\/ib.RemoveAllItems();\n    _swdoc.ib.RemoveItemsByGroup(\"problem\");\n           \n    \/\/-- when user selects a problem call profile\n    \/\/-- chec kto see if we have a matching Problem record\n  \/\/if (_swdoc.itsm_settings.prb_auto_apr == 1)\n    if(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AutomaticProfileProblemRecognition\")==1)\n    {    \t\t\t\n        \/\/-- now search for any problem calls that have the same profile code\n        \/\/--\n        if(_swdoc.OC().probcode!=\"\")\n        {\n  \t\t\tvar intCount = 0;\n   \t\t\tvar aRS = app.g.get_sqrecordset(\"call\/incident\/prb_cnt_profcode\",\"probcode=\"+_swdoc.OC().probcode);\n\t\t\tif (aRS.Fetch())\n\t\t\t{\n\t\t\t\tintCount = app.g.get_field(aRS,\"prbcount\");\n\t\t\t}\n\t\n        \tif (intCount > 0 )        \n        \t{\n            \t\/\/-- there are some matching problem calls for this problem profile\n            \t\/\/-- so show in the info bar (as requested by pre-sales - used to be an alert)\n            \t_swdoc.ib.AddItem(\"There are Problems or Known Errors that potentially match this Incident.\", \"5\", \"red\", \"problem\");\n\t\t\t\treturn;\n        \t}\n        }\n    }\n          \n    var strCIIds = \"\";  \n    if(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AutomaticCIProblemRecognition\")==1)\n    {    \t\t\t\n        strCIIds = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems,\"pk_auto_id\",\",\");\n    }\n    \n    if(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AutomaticServiceProblemRecognition\")==1)\n    {    \t\n        if(strCIIds==\"\")\n        {\n         \tstrCIIds = app.g.sl_get_valuesdel(_swdoc.EF().sl_services,\"pk_auto_id\",\",\");\n        }else\n        {\n         \tvar strServiceIDs = app.g.sl_get_valuesdel(_swdoc.EF().sl_services,\"pk_auto_id\",\",\");\n         \tif(strServiceIDs!=\"\")\n        \t\tstrCIIds += \",\" +strServiceIDs;\n        }\n    }\n\n\tif(strCIIds!=\"\")\n\t{\n\t\tvar intCount = 0;\n   \t\tvar oRec = app.g.get_sqrecordset(\"call\/incident\/prb_cnt_related\",\"ci_id=\"+strCIIds);\n\t\tif(oRec.Fetch())\n\t\t{\n\t\t\tintCount = app.g.get_field(oRec,\"cnt\");\n\t\t}\n\n       \tif (intCount > 0 )        \n        {\n           \/\/-- there are some matching problem calls for this problem profile\n            \/\/-- so show in the info bar (as requested by pre-sales - used to be an alert)\n            _swdoc.ib.AddItem(\"There are Problems or Known Errors that potentially match this Incident.\", \"5\", \"red\", \"problem\");\n\t\t}\n\t\t\n\t}\n\t_swdoc.UpdateFormFromData();\n}\n\n\/\/-- 02.03.2006\n\/\/-- check if breached incident count\nfunction check_probprofile_against_incidentcount(strProbCode, intAlertTrigger,pcRecord)\n{\n\t\/\/-- if alert trigger is not specified we need to get counter from probcode table\n\t_swdoc.intProblemAlertPeriod = 0;\n\t_swdoc.intFirstProblemIncidentDatex = 0;\n\t_swdoc.intPeriodBreach = 0;\t\n\t_swdoc.incident_profile_count\t= 0;\n\t\n\tif (intAlertTrigger==-1)\n\t{\n\t\tif(pcRecord)\n\t\t{\n\t\t\tvar pcRecord = app.g.get_record(\"pcinfo\",strProbCode);\t\n\t\t}\n\t\telse\n\t\t{\n\t\t\tvar pcRecord =app.g.get_record(\"pcinfo\",strProbCode);\t\n\t\t}\n\t\t\n\t\tif(pcRecord)\n        {\n        \tintAlertTrigger = new Number(pcRecord.user2);\n        \t_swdoc.intProblemAlertPeriod  = pcRecord.user3;\n\t\t\t_swdoc.intProblemAlertPeriod--;_swdoc.intProblemAlertPeriod++;\n\t\t  \t_swdoc.intFirstProblemIncidentDatex = app.g.fix_epoch(pcRecord.first_incident_datex);    \t\n\t\t\t_swdoc.incident_profile_count = pcRecord.incident_count;\t\n        }\n        else\n        {\n        \tintAlertTrigger = 0;\n        }\n        \n        \/\/-- switched off\n        if(_swdoc.intProblemAlertPeriod ==\"\")_swdoc.intProblemAlertPeriod = 0;\n\t}\n\n\t_swdoc.incident_profile_count++;\n\t_swdoc.boolProblemAlert = false;\n    if (intAlertTrigger > 0)\n    {\t\t\n\t\t\/\/-- if greater than alert analyst of possible problem\n\t\tif (_swdoc.incident_profile_count >= intAlertTrigger)\n\t\t{\n\t\t\t\/\/-- we need ot raise some sort of alert when the call is actually logged\n\t\t\t_swdoc.boolProblemAlert = true;\n\n\t\t\t\/\/-- if this profile uses an alert period (ie number of incidents rasied within an hour or 2 etc\t\t\n\t\t\tif(_swdoc.intProblemAlertPeriod > 0)\t\t\t\n\t\t\t{\n\t\t\t\ttestDatex = app.global.GetCurrentEpocTime() - _swdoc.intFirstProblemIncidentDatex;\n\t\t\t\ttestPeriod = _swdoc.intProblemAlertPeriod * 3600; \/\/-- get period in seconds\n\t\t\t\t\n\t\t\t\t\n\t\t\t\t\/\/-- if number of incidents has exceed limit and within period - then signal alert to pm\n\t\t\t\tif (testDatex < testPeriod)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.intPeriodBreach = 1;\n\t\t\t\t\t\n\t\t\t\t\t\/\/-- 07.11.2006 - NWJ\n\t\t\t\t\t\/\/-- check if we should tell the analyst (some customer will want this others wont) \n\t\t\t\t\t\/\/-- so if you are configuring just switch to 0 in dd\n\t\t\t\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AlertPossibleIncidentProfileBreach\")==1)\n   \t\t\t\t\t{\n\t\t\t\t\t\tMessageBox(\"There may be a potential problem. There are currently \" + _swdoc.incident_profile_count + \" Incidents that have this incident profile.\");\n\t\t\t\t\t}\t\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- profile doesnt use period limit just incident limit\n\t\t\t\t_swdoc.intPeriodBreach = 1;\n\t\t\t\t\n\t\t\t\t\/\/-- 23.11.2009 - RJC\n\t\t\t\t\/\/-- if you reach the threshold without using an alert period\n\t\t\t\t\/\/-- check if we should tell the analyst (some customer will want this others wont) \n\t\t\t\t\/\/-- so if you are configuring just switch to 0 in dd\n\t\t\t\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AlertPossibleIncidentProfileBreach\")==1)\n   \t\t\t\t{\n\t\t\t\t\tMessageBox(\"There may be a potential problem. There are currently \" + _swdoc.incident_profile_count + \" Incidents that have this incident profile.\");\n\t\t\t\t}\t\n\t\t\t}\n\t\t}\t\t\n    }    \n}\n\nfunction determine_prefered_support(boolCI, strKeyValue)\n{\t\t\n    \/\/-- 12.01.2007\n    \/\/-- NWJ\n    \/\/-- do we want to use CI prefered support over profile\n\tvar intPPS = dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/ProfilePSTakesPriorityOverCiPS\", 1);    \n\tvar boolSetByCI=false;    \n    \/\/-- if added or removed a CI\/s\n    if (boolCI)\n    {   \n    \t\/\/-- returns row pos that was used to make assessment - we use this to\n    \t\/\/-- then determine pref support \n    \tvar intUseCIKey = _swdoc.check_ci_assessment();\n    \t\n    \t\/\/-- check if we want to use ci support prefered group \/ analyst\n    \tif ((intPPS==0) || (_swdoc.OC().itsm_prefered_suppgroup==\"\") ||(_swdoc.OC().probcode==\"\"))\n    \t{\n \t\t\t\/\/-- only do if we have one ci or we have an assessment ci pos\n   \t\t\tif((intUseCIKey>-1)||(_swdoc.EF().sl_configitems.rowCount()==1))\n    \t\t{    \t\n   \t\t\t\tif(intUseCIKey==-1)\tintUseCIKey=0;\n    \t\t\t\/\/-- work out which ci support group \/ analyst to use\n    \t\t\t_swdoc.intAssessmentCI = intUseCIKey;\/\/app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIRow,\"pk_auto_id\");\n \t\t\t\tvar intCIRow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems,intUseCIKey,\"pk_auto_id\");\t\n\t\t\t\tif(intCIRow==-1)\n\t\t\t\t{\n \t\t\t\t\tvar intCIRow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_services,intUseCIKey,\"pk_auto_id\");\t\n    \t\t\t\tvar strSupportG = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intCIRow,\"ci_support_group\");\n\t\t\t\t\tvar strSupportA = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intCIRow,\"ci_support_analyst\");  \n\t\t\t\t}else{   \t\t\t\n    \t\t\t\tvar strSupportG = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intCIRow,\"ci_support_group\");\n\t\t\t\t\tvar strSupportA = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intCIRow,\"ci_support_analyst\");  \n\t\t\t\t}  \t\t\n\t\t\t\tif(strSupportA!=\"\")\n\t\t\t\t{\t\t\t\n\t\t\t\t\t\/\/-- have an analyst\n\t\t\t\t\tvar anAnalyst = app.g.get_analyst_detail(strSupportA);\t\t\n\t\t\t\t\tif(anAnalyst)\t\t\t\t\t\t\t\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = strSupportA;\n\t\t\t\t\t\t_swdoc.OC().itsm_prefered_text = anAnalyst.name;\n\t\t\t\t\t\tboolSetByCI=true;\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if(strSupportG != \"\")\n\t\t\t\t{\n\t\t\t\t\t\/\/-- have a supp group\n\t\t\t\t\tvar aGroup = app.g.get_group_detail(strSupportG);    \t\n\t\t\t\t\tif(aGroup)\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = strSupportG;\n\t\t\t\t\t\t_swdoc.OC().itsm_prefered_text = aGroup.name;\n\t\t\t\t\t\tboolSetByCI=true;\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t\/\/-- there is no prefer so reset\n\t\t\t\t\t\/\/-- 29.04.2008 - out of 2.2.0 testing\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\t\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t}\n    \t}\n    \t\n    }\n    else\n    {\n    \t\/\/-- manually added or changed profile\n    \t\/\/-- 2.2.0 29.04.2008 - apply if profile ps is prefered or if there is no pref already\n    \tif( (intPPS!=0)||(_swdoc.OC().itsm_prefered_suppgroup==\"\")) \n    \t{\n    \t\t\n    \t\tif(!boolCI)_swdoc.intAssessmentCI = -1; \/\/-- so we can reset appropriately\n        \tif((strKeyValue==\"\")||(strKeyValue==undefined))strKeyValue = _swdoc.OC().probcode;\n        \tvar oRec = app.g.get_record(\"pcinfo\",strKeyValue);\n        \tif (oRec)\n        \t{\n        \t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\n\t\n        \t\n        \t\tvar anAnalyst = app.g.get_analyst_detail(oRec.user1);\t\t\n        \t\tif(anAnalyst)\n        \t\t{\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = anAnalyst.id;\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = anAnalyst.name;       \t\n        \t\t}\n        \t\telse\n        \t\t{\n        \t\t\tvar aGroup = app.g.get_group_detail(oRec.user1);    \t\n        \t\t\tif(aGroup)\n        \t\t\t{\n\t\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = aGroup.id;\n\t\t\t\t\t\t_swdoc.OC().itsm_prefered_text = aGroup.name;\n\t\t\t\t\t}\n        \t\t}\n        \t}\n            \t\n        \t\/\/-- NWJ - 01.03.2005\n        \t\/\/-- check the alert count for this problem profile\n        \t\/\/-- if it has one find number of incidents in sys cache that match\n        \t_swdoc.check_probprofile_against_incidentcount(strKeyValue, -1,oRec);\n        \t\n    \t}\n\t}\n \n    _swdoc.UpdateFormFromData();\n}\n\n\/\/-- do probcode checking\nfunction process_profilecode_checks()\n{\n\t\/\/-- refresh pcode incident list\n\t\/\/-- have to apply sleep otherwise the sqllist does not filter\n\tif(_swdoc.bool_slpcodeincs_displayed)\n\t{\n\t\t\/\/app.global.Sleep(50);\n\t\t_swdoc.EF().sl_incprofile.Refresh();\t\t\n\t}        \n\n    \/\/-- go see if there is a matching problem\n    _swdoc.check_probprofile_against_problems_kes();\n}\nfunction check_ci_assessment()\n{\n   \t\/\/###20120619 - only show SLAs connected to selected CIs\n    if (app.oSettings.get_setting(\"boolIncidentSLABehaviourOnCI\")){\n\t\t\/\/-- get which SLA we should use based on CI\/s\n\t\tvar strSLAs = app.g.sl_get_valuesdel(_swdoc.EF().sl_configitems,\"fk_sld\",\",\",\"\");\n\t\t\n\t\tif (\"\"!=strSLAs)\n\t\t{\n\t\t\tvar strFilter = _swdoc.strOrigSLAFilter;\n\t\t\tarrSLAs = strSLAs.split(\",\");\n\t\t\tvar strSLAFilter = \"\";\n\t\t\tfor(var i = 0; i<count(arrSLAs);i++)\n\t\t\t{\n\t\t\t\tstrSLAFilter += \"&_swc_pk_slad_id[]=\"+arrSLAs[i];\n\t\t\t}\n\t\t\tstrFilter = strFilter + strSLAFilter;\n        \tapp._slf(_swdoc.MF().lb_oc_slad1 , strFilter);\n        \tif (\"\"!=_swdoc.MF().lb_oc_slad1.value)\n        \t{\n        \t\tvar strParams = strFilter+\"&_swc_slad_id=\"+app.pfu(_swdoc.MF().lb_oc_slad1.value);\n\t        \tvar oRS = app.g.get_sqrecordset(\"call\/incident\/get_slas_match_cis\",strParams);\n               \tif(!oRS.Fetch())\n                {\n\t                _swdoc.OC().itsm_slaname = \"\";\n                }\n        \t}\n\t\t} \n\t\telse \n\t\t{\n\t\t\tapp._slf(_swdoc.MF().lb_oc_slad1 , _swdoc.strOrigSLAFilter);\n        \t_swdoc.OC().itsm_slaname = \"\";\n\t\t}\n\t}\n\n    \/\/-- if use ci assessment levels\n   \tvar intUseCIrow = -1; \n   \t\n    if(app.itsm.get_ci_assessmnet_level_setting(\"Incident\")==1)\n    {\n       \tvar strUseSLA = \"\";\n\t\t\n \t\tvar slaArray = new Array();\n \n \t\tvar oList = _swdoc.EF().sl_configitems;\n\t\tvar strSLAs = \"\";\n\t\tvar strVal=\"\";\n\t\tvar strSLAVal=\"\";\n\t\tfor (var x=0;x<oList.rowCount();x++)\n\t\t{\n\t\t\tstrVal = oList.GetItemTextRaw(x,\"fk_sla\");\n\t\t\tstrSLAVal = oList.GetItemTextRaw(x,\"fk_sld\");\n\t\t\tif(strVal ==\"[Use SLA Default Priority]\")\n\t\t\t{\n\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", strSLAVal);\n\t\t\t\tif(oRecSLD)\n\t\t\t\t{\t\n\t\t\t\t\tstrVal = oRecSLD.fk_ssla;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstrVal = app.g.pfs(strVal);\n\t\t\tif(strVal!=\"\")\n\t\t\t{\n\t\t\t\tif (strSLAs !=\"\")strSLAs +=\",\";\n\t\t\t\tstrSLAs  += strVal;\n\t\t\t\tslaArray[strVal]=strSLAVal;\n\t\t\t}\n\t\t}\n\n \t\tvar oList = _swdoc.EF().sl_services;\n\t\tvar strVal=\"\";\n\t\tfor (var x=0;x<oList.rowCount();x++)\n\t\t{\n\t\t\tstrVal = oList.GetItemTextRaw(x,\"fk_sla\");\n\t\t\tstrSLAVal = oList.GetItemTextRaw(x,\"fk_sld\");\n\t\t\tif(strVal ==\"[Use SLA Default Priority]\")\n\t\t\t{\n\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", strSLAVal);\n\t\t\t\tif(oRecSLD)\n\t\t\t\t{\t\n\t\t\t\t\tstrVal = oRecSLD.fk_ssla;\n\t\t\t\t}\n\t\t\t}\n\t\t\tstrVal = app.g.pfs(strVal);\n\t\t\tif(strVal!=\"\")\n\t\t\t{\n\t\t\t\tif (strSLAs !=\"\")strSLAs +=\",\";\n\t\t\t\tstrSLAs  += strVal;\n\t\t\t\tslaArray[strVal]=strSLAVal;\n\t\t\t}\n\t\t}\n  \t\t\/\/var strSLAs = app.g.get_sld_slas(strSLAs);\n    \tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/UseCILongestSLA\")==1)    \t\t\t\n\t\t{\n\t\t\tstrUseSLA = app.g.get_longest_sla(strSLAs);    \t\t\t\n    \t}\n    \telse\n    \t{\n    \t\tstrUseSLA = app.g.get_shortest_sla(strSLAs);\n    \t}\t\t\t\n\n\t\t\/\/-- if have SLA to use\n\t\tintUseCIRow = 0;\n\t\tvar boolIsService = false;\n\t\tif(strUseSLA!=\"\")\n\t\t{\n\t\t\tvar intSLD = slaArray[strUseSLA]; \t\t\n\t\t\t\/\/-- we have a prefered SLA - get the CI that has this SLA and use its assess levels\n\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems,strUseSLA,\"fk_sla\");\t\n\t\t\tif(intUseCIrow==-1)\n\t\t\t{\n\t\t\t\t\/\/not a ci found with priority\n\t\t\t\tboolIsService = true;\n\t\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_services,strUseSLA,\"fk_sla\");\n\t\t\t\tif(intUseCIrow==-1)\n\t\t\t\t{\n\t\t\t\t\t\/\/not found with priority try with SLA\n\t\t\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_configitems,intSLD,\"fk_sld\");\t\n\t\t\t\t\tif(intUseCIrow==-1)\n\t\t\t\t\t{\n\t\t\t\t\t\tboolIsService = true;\n\t\t\t\t\t\tintUseCIrow = app.g.sl_findrow_byvalue(_swdoc.EF().sl_services,intSLD,\"fk_sld\");\t\n   \t\t\t\t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_impact_level\");\n\t\t\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_urgency_level\"); \n\t\t\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIRow,\"pk_auto_id\");\n\t\t\t\t\t}else\n\t\t\t\t\t{\n    \t\t\t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_impact_level\");\n\t\t\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_urgency_level\");    \n\t\t\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIRow,\"pk_auto_id\");\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t}else{\n\t\t\t\t\t\/\/is a app.service found with sla\n   \t\t\t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_impact_level\");\n\t\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_urgency_level\"); \n\t\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIRow,\"pk_auto_id\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else{\n    \t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_impact_level\");\n\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_urgency_level\");    \n\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIRow,\"pk_auto_id\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.EF().sl_configitems.rowCount()==0)\n\t\t\t{\n\t\t\t\tboolIsService = true;\n\t\t\t\t\/\/-- no slas defined for CI\/s so try base it on assessment levels of first item\n    \t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"fk_impact_level\");\n\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"fk_urgency_level\"); \n\t\t\t\tvar intSLD =app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"fk_sld\"); \n\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,0,\"pk_auto_id\");\n\t\t\t}else\n\t\t\t{\n\t\t\t\t\/\/-- no slas defined for CI\/s so try base it on assessment levels of first item\n    \t\t\tvar strImpact = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"fk_impact_level\");\n\t\t\t\tvar strUrgency =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"fk_urgency_level\"); \n\t\t\t\tvar intSLD =app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"fk_sld\"); \n\t\t\t\tvar ciKey = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,0,\"pk_auto_id\");\n\t\t\t}\t\t\t\t\n\t\t\tif(intSLD>0)\n\t\t\t\tstrUseSLA = app.itsm.get_sla_from_slad_matrix(intSLD, strImpact, strUrgency);\n\t\t}\n\t\t\n\t\tif(strUrgency==\"\")strUrgency=_swdoc.strDefaultUrgency;\n \t\tif(strImpact==\"\")strImpact=_swdoc.strDefaultImpact;\n\n\t\t_swdoc.OC().itsm_urgency_level = strUrgency;\t\t\t\t\n\t\t_swdoc.OC().itsm_impact_level = strImpact;\t\n\t\t\n\t\tif(intSLD!=\"\")\n\t\t{\n\t\t\tif(intSLD>0)\n\t\t\t{\t\n\t\t\t\tvar oRec = app.g.get_record(\"itsmsp_slad\", intSLD);\t\n\t\t\t\tif(oRec)\n\t\t\t\t{\n\t\t\t\t\t\/\/-- F0108327\n\t\t\t\t\t_swdoc.handle_set_sladef(oRec.slad_id);\n\t\t\t\t\t_swdoc.handle_set_contract(intSLD);\t\/\/-- Set Contract Based on Selected SLA\n\t\t\t\t\tvar boolTemp = _swdoc.boolIncSLASetManually;\n\t\t\t\t\t_swdoc.boolIncSLASetManually = true;\n\t\t\t\t\tif(strUseSLA!=\"\") \n\t\t\t\t\t_swdoc.handle_set_priority(strUseSLA);\n\t\t\t\t\t_swdoc.boolIncSLASetManually = boolTemp;\n\t\t\t\t\t\/\/--END\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\t\t\n\t\t\tif(intSLD>0)\n\t\t\t{\t\n\t\t\t\tvar oRec = app.g.get_record(\"itsmsp_slad\", intSLD);\t\n\t\t\t\tif(oRec)\n\t\t\t\t{\n\t\t\t\t\t\/\/-- F0108327\n\t\t\t\t\t_swdoc.handle_set_sladef(oRec.slad_id);\n\t\t\t\t\t_swdoc.handle_set_contract(intSLD);\t\/\/-- Set Contract Based on Selected SLA\n\t\t\t\t\tvar boolTemp = _swdoc.boolIncSLASetManually;\n\t\t\t\t\t_swdoc.boolIncSLASetManually = true;\n\t\t\t\t\tif(strUseSLA!=\"\") \n\t\t\t\t\t_swdoc.handle_set_priority(strUseSLA);\n\t\t\t\t\t_swdoc.boolIncSLASetManually = boolTemp;\n\t\t\t\t\t\/\/--END\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(_swdoc.OC().itsm_sladef>0)\n\t\t{\n\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, true);\n\t\t\tapp._een(_swdoc.MF().lb_oc_sla, true);\n\t\t}\t\t\n\t\t\n\t\t\/\/-- get and set profile code if it has'nt been set manually by the user\n\t\tif(boolIsService)\n\t\t{\n\t\t\tvar intCIid = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"pk_auto_id\");\n\t\t\tvar strCode = app.g.sl_getrawcolvalue(_swdoc.EF().sl_services,intUseCIrow,\"fk_profilecode\");\t\t\n\t\t}else\n\t\t{\n\t\t\tvar intCIid = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"pk_auto_id\");\n\t\t\tvar strCode = app.g.sl_getrawcolvalue(_swdoc.EF().sl_configitems,intUseCIrow,\"fk_profilecode\");\n\t\t}\n\t\t\n\t\tif(_swdoc.intProfileCodeCI==-1)\n\t\t{\n\t\t\t\/\/-- was manually set so ask if want to change it - but only if one to use is not blank\n\t\t\t\n\t\t\tif((strCode!=\"\")&&(strCode!=_swdoc.OC().probcode)&&(confirm(\"The recommended profile code to use for this incident differs from that of the one you selected. Do you want to change it?\")) )\n\t\t\t{\n\t\t\t\t_swdoc.OC().probcode = strCode;\n\t\t\t\t_swdoc.intProfileCodeCI = intCIid;\n\t\t\t}\n\t\t}\n\t\telse \n\t\t{\n\t\t\t\/\/MessageBox(\"strCode : \"+strCode);\n\t\t\tif(strCode!=_swdoc.OC().probcode)\n\t\t\t{\n\t\t\t\t_swdoc.OC().probcode = strCode;\n\t\t\t\tif(strCode==\"\")\n\t\t\t\t{\n\t\t\t\t\tmainform.SetTimer(2, 100)\n\t\t\t\t\t\/\/MF().tb_probcode.text=\"\";\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/MessageBox(\"intProfileCodeCI : \"+intCIid);\n\t\t\t_swdoc.UpdateFormFromData();\t\t\n \t\t\t_swdoc.intProfileCodeCI = intCIid;\t\t\t\n\t\t}\n   }\n   else\n   {\n   \t\tvar ciKey = -1;\n   }\n\t_swdoc.process_profilecode_checks();\n\t_swdoc.UpdateFormFromData();\t\t\n     \n    return ciKey;\n\n}\n\n\n\/\/-- 22.08.2008 - log new problem and \/ or rfc\nfunction onlog_raise_probrfc()\n{\n\treturn true;\n\t_swdoc.OC().callref = _swdoc.loggedCallref;\n\tvar iOption = _swdoc.MF().cb_raise.text\n\tvar iProblem = 1;\n\tvar iRFC = 2;\n\tvar iBoth = 3;\n\n\t\n\tif((iOption==iProblem)||(iOption==iBoth))\n\t{\n\t\t\/\/-- store info in global vars\n\t\tapp.g.LOG_FROM_CALL = _swdoc.opencall;\n\t\tapp.g.CALLINFO[_swdoc.OC().callref] = new Object();\n\t\tapp.g.CALLINFO[_swdoc.OC().callref].lastupdatetxt = updatedb.updatetxt;\n\t\tapp.g.CALLINFO[_swdoc.OC().callref].origupdatetxt = updatedb.updatetxt;\t\t\n\n\t\n\t\t\/\/-- open new problem record\n\t\tapp.global.LogNewCall(\"Problem\");\n    }\n\t\n\tif((iOption==iRFC)||(iOption==iBoth))\n\t{\t\n\t\t\/\/-- store info in global vars again as may have been reset \n\t\tapp.g.LOG_FROM_CALL = _swdoc.opencall;\n\t\tapp.g.CALLINFO[_swdoc.OC().callref] = new Object();\n\t\tapp.g.CALLINFO[_swdoc.OC().callref].lastupdatetxt = updatedb.updatetxt;\n\t\tapp.g.CALLINFO[_swdoc.OC().callref].origupdatetxt = updatedb.updatetxt;\t\t\n\t\n\t\t\/\/-- open new problem record\n\t\tapp.global.LogNewCall(\"Change Request\");\n    }\n}\n\nfunction set_preferred_assignment(boolFromLogAndResolve)\n{\n    \/\/-- 10.06.2004\n    \/\/-- NWJ\n    \/\/-- if just logging a call if we have \n    \/\/-- a support group assign to them\n    if (_swdoc.OC().itsm_prefered_suppgroup != \"\")\n    {\n    \t\/\/-- see if we have a matching analyst (if not try the suppo groups)   \t\n    \tvar anAnalyst = app.g.get_analyst_detail(_swdoc.OC().itsm_prefered_suppgroup);\n    \tif(anAnalyst)\n    \t{\n\t        _swdoc.OC().suppgroup = anAnalyst.supportgroup;\n    \t    _swdoc.OC().owner = anAnalyst.id;\n    \t}\n    \telse\n    \t{\n    \t\t\/\/-- analyst not found so check if we are assigning to a group\n\t\t\tvar aGroup = app.g.get_group_detail(_swdoc.OC().itsm_prefered_suppgroup);    \t\n\t\t\tif (aGroup)\n\t\t\t{\n\t        \t_swdoc.OC().suppgroup = _swdoc.OC().itsm_prefered_suppgroup;\n    \t    }\n\t\t}\n\t\t\n        if ((!boolFromLogAndResolve)&&(_swdoc.OC().owner != \"\"))\n        {\n            \/\/-- set call to unaccepted\n            \/\/-- when assigned to an analyst\n            _swdoc.OC().status = 3;\n        }\n    }\n}\n\nfunction load_company_cis(strCompanyID)\n{\n\t\/\/###20120717 rewrite to cope with multiple organisations\n\tif(\"\"==strCompanyID)\n\t{\n\t\tapp._slf(_swdoc.MF().sl_cust_cis,\"pk_auto_id=-1\");\n\t\treturn;\n\t} \n\tif(typeof _swdoc.multi_companyCIIDS[strCompanyID] === \"undefined\")\n\t\t_swdoc.get_company_cis(strCompanyID);\n\t\t\n\t\/\/ DTH: webclient - add the following from load_company_services\n\tvar userCIS = _swdoc.multi_companyCIIDS[strCompanyID];\n\tvar serviceKeys = app.service.get_organisation_services(strCompanyID,true);\n\t\/\/###20120607 - filtering out unwanted services\n\tif(_swdoc.boolServiceCIBehaviourOnIncident) serviceKeys = _swdoc.filter_out_non_display_services(serviceKeys);\n\n\tif(serviceKeys==\"\")\n\t{\n\t\tuserCIS = userCIS;\n\t}\n\telse\n\t{\n\t\tuserCIS = serviceKeys + \",\" + userCIS;\n\t}\n\t_swdoc.update_ci_list(userCIS);\n}\n\n\n\nfunction get_company_cis(strCompanyID)\n{\n\t\/\/###20120717 - rewrite to accommodate multiple organisations\n\tvar strKeyValues = app.cfg.get_company_cikeys(strCompanyID,true,true);\t\n\tvar strParams = \"fk_company_id=\"+app.pfu(strCompanyID);\n    var oRS = app.g.get_sqrecordset(\"general\/get_company_sites\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tif(strKeyValues!=\"\")strKeyValues+=\",\";\t\n\t\tvar strSiteName = app.g.get_field(oRS,\"site_name\");\n\t    strKeyValues+= app.cmdb.get_site_cis(strSiteName);\n\t}\t\n\t\n\tif(strKeyValues==\"\")\n\t\tstrKeyValues = \"-1\";\n\t_swdoc.multi_companyCIIDS[strCompanyID] = strKeyValues;\n\n}\n\nfunction check_cis()\n{\n\t\/\/-- F0100436 - update _swdoc.check_cis function\n\tif(_swdoc.EF().sl_configitems.rowCount() ==\"\")\n\t\treturn;\n\tvar intStartCount = _swdoc.EF().sl_configitems.rowCount();\n\tvar strCIKeys = app.g.sqllist_get_valuesdel(_swdoc.EF().sl_configitems, 'pk_auto_id', \",\", \"\");\n\n\tvar strAssociatedCIKeys = \"-1\";\n\tvar strParams = \"fk_children=\"+(strCIKeys)+\"&fk_parent=\"+app.pfu(_swdoc.oCompany().fk_cmdb_id);\n    var oRS = app.g.get_sqrecordset(\"call\/incident\/cisrelatedtocompany\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tstrAssociatedCIKeys+=\",\";\t\n\t\tstrAssociatedCIKeys += app.g.get_field(oRS,\"FK_CHILD_ID\");\n\t}\t\n\t\n\tvar strParams = \"pk_cis=\"+(strCIKeys)+\"&fk_company_id=\"+app.pfu(_swdoc.oCompany().pk_company_id);\n    var oRS = app.g.get_sqrecordset(\"call\/incident\/cisownedbycompany\",strParams);\n\twhile(oRS.Fetch())\n\t{\n\t\tstrAssociatedCIKeys+=\",\";\t\n\t\tstrAssociatedCIKeys += app.g.get_field(oRS,\"PK_AUTO_ID\");\n\t}\t\n\n\tvar strParams = \"fk_company_id=\"+app.pfu(_swdoc.oCompany().pk_company_id);\n    var oSites = app.g.get_sqrecordset(\"general\/get_company_sites\",strParams);\n\twhile(oSites.Fetch())\n\t{\n\t\tvar strSiteName = app.g.get_field(oSites,\"site_name\");\n\n\t\tvar strParams = \"pk_cis=\"+(strCIKeys)+\"&fk_site=\"+app.pfu(strSiteName);\n\t    var oRS = app.g.get_sqrecordset(\"call\/incident\/cisownedbysites\",strParams);\n\t\twhile(oRS.Fetch())\n\t\t{\n\t\t\tstrAssociatedCIKeys+=\",\";\t\n\t\t\tstrAssociatedCIKeys += app.g.get_field(oRS,\"PK_AUTO_ID\");\n\t\t}\t\n\t}\t\n\n\tapp._slf(_swdoc.EF().sl_configitems, \"_kv=\"+strAssociatedCIKeys);\n\tvar intEndCount = _swdoc.EF().sl_configitems.rowCount();\n\tif(intEndCount<intStartCount)\n\t\tMessageBox(\"CIs were removed from this call, as they were not associated with the currently selected Organisation\");\n\treturn;\n}\n\nvar boolMI = false;\nfunction hideshow_majorincstab()\n{\n\tvar tTab = _swdoc.EF().TabRel.tab;\n\tvar currMI = (_swdoc.OC().itsm_majorinc==\"1\");\n\t_swdoc.EF().TabRel.ShowTabItem(8,currMI);\n\tapp._etab(_swdoc.EF().TabRel, tTab);\n\t_swdoc.boolMI = currMI;\n}\n\n\/\/ITSM MEROPE\n\n\/\/-- load sld info and settings\nfunction handle_set_sladef(strNewSLD, boolValidate, boolOnResolve)\n{\n\tif(_swdoc.boolSLAEnforced)\n\t{\n\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\/\/\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\/\/\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t_swdoc.UpdateFormFromData();\n\t\tMessageBox(\"SLA is being enforced from the process.\");\n\t\treturn;\n\t}\n\n\tif(boolValidate==undefined)\n\t\tboolValidate==false;\n\tvar strDisplaySLD = strNewSLD;\n\n\tvar strUseSLD = strNewSLD;\n\tvar boolRelative = false;\n\tvar strRelative = \"\";\n\n\t\/\/-- get actual SLD ID if getting from related record\n\tswitch(strNewSLD)\n\t{\n\t\tcase \"[Use Profile SLA]\":\n\t\t\tif(_swdoc.OC().probcode!=\"\")\n\t\t\t{\n\t\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\t\t\t\tif(oRecSLD)\n\t\t\t\t{\n\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\tboolRelative = true;\n\t\t\t\t\tstrRelative = \"[Use Profile Priority]\";\n\t\t\t\t\t\/\/return false;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Profile SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No profile has been set for this request. The Profile SLA cannot be used.\",16);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"[Use Charge Centre SLA]\":\n\t\t\tif(_swdoc.OC().costcenter!=\"\")\n\t\t\t{\n\t\t\t\tvar strCCUse = _swdoc.OC().costcenter;\n\t\t\t\tif(_swdoc.OC().costcenter==\"[Use Customer Charge Centre]\")\n\t\t\t\t{\n\t\t\t\t\tstrCCUse = _swdoc.oCust().costcenter;\n\t\t\t\t}\n\t\t\t\tif(strCCUse==\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Charge Centre SLA]\";\n\t\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tif(boolValidate)\n\t\t\t\t\t\tMessageBox(\"No charge centre has been set for this request. The charge centre SLA cannot be used.\");\n\t\t\t\t\treturn false;\n\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n                    \/\/-- 992268 Add the below line\n\t\t\t\t\t_swdoc.OC().costcenter = strCCUse;\n\t\t\t\t\tvar oRec = app.g.get_record(\"costcent\", strCCUse);\n\t\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", oRec.itsm_sla);\n\t\t\t\t\tif(oRecSLD)\n\t\t\t\t\t{\n\t\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\t\tboolRelative = true;\n\t\t\t\t\t\tstrRelative = \"[Use Charge Centre Priority]\";\n\t\t\t\t\t\t\/\/return false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Charge Centre SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No charge centre has been set for this request. The charge centre SLA cannot be used.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"[Use Customer SLA]\":\n\t\t\tif(_swdoc.oCust().keysearch==\"\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Customer SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No customer selected, cannot resolve customer SLA. Please select a valid SLA.\",16);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif(_swdoc.oCust().sld==\"\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No Default SLA is associated to this Customer. Please select a valid SLA.\",16);\n\t\t\t\telse\n\t\t\t\t\tMessageBox(\"Customer does not have a default SLA.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.oCust().sld);\n\t\t\tif(oRecSLD)\n\t\t\t{\n\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\tboolRelative = true;\n\t\t\t\tstrRelative = \"[Use Customer Priority]\";\n\t\t\t\t\/\/return false;\n\t\t\t}\n\t\tbreak;\t\t\n\t\tcase \"[Use Process SLA]\":\n\t\t\tif(bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t{\n\t\t\t\tif(bpm_workflow.fk_default_sla_new==\"\")\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = _swdoc.strCurrentSLADef;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = _swdoc.strCurrentSLAName;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"No SLA has been set for the requests Business Process. The Process SLA cannot be used.\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tvar strSLA = bpm_workflow.fk_default_sla_name;\n\t\t\t\t\tif(strSLA.indexOf(\"[Use\")>-1 && strSLA.indexOf(\"SLA]\")>-1)\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.handle_set_sladef(bpm_workflow.fk_default_sla_name);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\t\/\/var oRec = app.g.get_record(\"costcent\", strCCUse);\n\t\t\t\t\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", bpm_workflow.fk_default_sla_new);\n\t\t\t\t\t\tif(oRecSLD)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tstrUseSLD =oRecSLD.slad_id;\/\/ _swdoc.handle_set_sladef(oRecSLD.slad_id,false);\n\t\t\t\t\t\t\tboolRelative = true;\n\t\t\t\t\t\t\tstrRelative = \"[Use Process Priority]\";\n\t\t\t\t\t\t\t\/\/return false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Process SLA]\";\n\t\t\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tif(boolValidate)\n\t\t\t\t\tMessageBox(\"No process has been set for this request. The Process SLA cannot be used.\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tbreak;\t\n\t\t}\n\n  \tvar oRecSLD = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strUseSLD);\n\tif(oRecSLD.Fetch())\n\t{\n\t\t\/\/-- load cost center option\n\t\tvar strNewCC = app.g.get_field(oRecSLD,\"chargeto_cc\");\n\t\tswitch(strNewCC)\n\t\t{\n\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\tbreak;\n\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\tbreak;\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/-- eof cc option\n\t\t\t\n\t\t\/\/-- set oc values\n\t\tif(strNewCC!=\"\" && strNewCC!=\"False\") _swdoc.OC().costcenter = strNewCC;\n\t\t_swdoc.OC().itsm_sladef = \tapp.g.get_field(oRecSLD,\"pk_slad_id\");\n\t\t_swdoc.OC().itsm_slaname = app.g.get_field(oRecSLD,\"slad_id\");\n\t\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\t_swdoc.strCurrentSLADef = _swdoc.OC().itsm_sladef;\n\t\t\n\t\tvar strFKssla = app.g.get_field(oRecSLD,\"fk_ssla\");\n\t\tif(boolRelative)\n\t\t\t_swdoc.handle_set_priority(strRelative);\n\t\telse\n\t\t\t_swdoc.handle_set_priority(strFKssla);\n\t\t\n\t\t\/\/-- check if customer dept has nay alternative settings\n\t\t_swdoc.check_customer_department_slad(strNewSLD,_swdoc.oCust().department);\n\t\t\n\t\tapp._een(_swdoc.MF().lbl_oc_priority, true);\n\t\tapp._een(_swdoc.MF().lb_oc_sla, true);\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\telse\n\t{\n\t\tMessageBox(\"Failed to retrieve service level definition record for '\" + strDisplaySLD + \"'. Please contact your Supportworks Administrator\");\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n\/\/-- check if there is alternative slad settings based on the customers department\nfunction check_customer_department_slad(strSLADID, strDepartment)\n{\n\tif(strDepartment==\"\")\n\t\treturn;\n \tvar strParams = \"fk_slad_id=\" +app.pfu(strSLADID)+ \"&fk_dept=\" +app.pfu(strDepartment);\n \tvar oRecSLD = app.g.get_sqrecordset(\"call\/incident\/get_dept_sla\",strParams);\n\tif(oRecSLD.Fetch())\n\t{\n\t\t\/\/-- load cost center option\n\t\tvar strNewCC = app.g.get_field(oRecSLD,\"chargeto_cc\");\n\t\tswitch(strNewCC)\n\t\t{\n\t\t\tcase \"[Use Department Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().department;\n\t\t\t\tbreak;\n\t\t\tcase \"[Use Customer Charge Centre]\":\n\t\t\t\tstrNewCC = _swdoc.oCust().costcenter;\n\t\t\t\tbreak;\t\t\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\t\/\/-- eof cc option\n\t\t\t\n\t\t\/\/-- set oc values\n\t\tif(strNewCC!=\"\") _swdoc.OC().costcenter = strNewCC;\n\t\t_swdoc.OC().priority = app.g.get_field(oRecSLD,\"fk_sla\");\n\t}\n}\n\n\nfunction load_site_cis(strSiteID)\n{\n\t\/\/###20120717 rewrite to cope with multiple sites\n\tif(\"\"==strSiteID)\n\t{\n\t\tapp._slf(_swdoc.MF().sl_cust_cis,\"pk_auto_id=-1\");\n\t\treturn\n\t} \n\n\tif(typeof _swdoc.multi_siteCIIDS[strSiteID] === \"undefined\")\n\t\t_swdoc.get_site_cis(strSiteID);\n\t\t\n\t\/\/ DTH: webclient - add the following from load_site_services\n\tvar userCIS = _swdoc.multi_siteCIIDS[strSiteID];\n\n\tvar serviceKeys = app.service.get_site_services(strSiteID,true);\n\t\/\/###20120607 - filtering out unwanted services\n\tif(_swdoc.boolServiceCIBehaviourOnIncident) serviceKeys = _swdoc.filter_out_non_display_services(serviceKeys);\n\n\tif(serviceKeys==\"\")\n\t\tserviceKeys = \"-1\";\n\tuserCIS = serviceKeys + \",\" + userCIS;\n\t\n\t_swdoc.update_ci_list(userCIS);\n}\n\nfunction get_customer_cis(strCustID)\n{\n\t\/\/###20120719 - rewrite to cope with change of customer\n\tvar strKeyValues = app.cmdb.get_me_cis(strCustID, \"CUSTOMER\",\"\");\n\t\n\tif(strKeyValues==\"\")\n\t\tstrKeyValues = \"-1\";\n\t_swdoc.multi_customerCIIDS[strCustID] = strKeyValues;\n}\n\nfunction get_site_cis(strSiteID)\n{\n\t\/\/###20120717 - rewrite to cope with multiple sites (and organisations)\n\tvar strKeyValues = app.cmdb.get_site_cis(strSiteID);\t\n\t\n\tif(strKeyValues==\"\")\n\t\tstrKeyValues = \"-1\";\n\t_swdoc.multi_siteCIIDS[strSiteID] = strKeyValues;\n\n}\n\nfunction handle_set_priority(strValue)\n{\n\tif(strValue==\"[Use SLA Default Priority]\")\n\t{\n\t\tvar oRecSLD = app.g.get_record(\"itsmsp_slad\", _swdoc.OC().itsm_sladef);\n\t\tif(oRecSLD)\n\t\t{\t\n\t\t\t_swdoc.OC().priority = oRecSLD.fk_ssla;\n\t\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Customer Priority]\")\n\t{\n\t\tif(_swdoc.oCust().keysearch!=\"\")\n\t\t{\n\t\t\tif(_swdoc.oCust().sld==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\tif(_swdoc.oCust().priority==\"[Use SLA Default Priority]\")\n\t\t\t\t\t_swdoc.handle_set_priority(\"[Use SLA Default Priority]\");\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.oCust().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The customer SLA is not the same as the currently selected SLA. The Customer priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\")\n\t\t\t\t{\n\t\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"No customer selected. The Customer priority cannot be used.\");\n\t\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Profile Priority]\")\n\t{\n\t\tif(_swdoc.OC().probcode!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"pcinfo\", _swdoc.OC().probcode);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.sla);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The Profile SLA is not the same as the currently selected SLA. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\")\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority=\"[Use Profile Priority]\";\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No profile has been set for this request. The Profile priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Charge Centre Priority]\")\n\t{\n\t\tif(_swdoc.OC().costcenter!=\"\")\n\t\t{\n\t\t\tvar oRec = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(oRec.itsm_sla==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(oRec.priority);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t\t{\n\t\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\tMessageBox(\"The cost center SLA is not the same as the currently selected SLA. The cost center priority cannot be used.\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(_swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\t\t{\n\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\t\t\t\t_swdoc.OC().priority = strValue;\n\t\t\t\t_swdoc.strCurrentPriority=_swdoc.OC().priority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"No cost center has been set for this request. The cost center priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse if(strValue==\"[Use Process Priority]\")\n\t{\n\t\tif(bpm_workflow.pk_workflow_id!=\"\")\n\t\t{\n\t\t\t\/\/var oRec = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\t\tif(bpm_workflow.fk_default_sla_new==_swdoc.OC().itsm_sladef)\n\t\t\t{\n\t\t\t\t_swdoc.handle_set_priority(bpm_workflow.fk_default_sla);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\tMessageBox(\"The Process SLA is not the same as the currently selected SLA. The Process priority cannot be used.\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\t_swdoc.OC().priority = _swdoc.strCurrentPriority;\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t\tMessageBox(\"No process has been set for this request. The process priority cannot be used.\");\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\treturn false;\n\t}\t\n\telse\n\t{\n\t\tif (_swdoc.boolIncSLASetManually)\n\t\t{\n\t\t\t_swdoc.OC().priority = strValue;\n\t\t}\n\t\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t\t_swdoc.UpdateFormFromData();\n\t\treturn false;\n\t}\n}\n\nfunction handle_set_contract(strNewSLD)\n{\n\/\/###20120726\tvar strDefaultContract = app.g.filter_company_contracts(_swdoc.oCompany().pk_company_id, _swdoc.MF().lb_contract, strNewSLD);\n\n\tvar strDefaultContract = app.g.filter_company_contracts(_swdoc.OC().fk_company_id, _swdoc.MF().lb_contract, strNewSLD);\n\tif((typeof strDefaultContract !== \"undefined\") && strDefaultContract!=\"\")\n\t{\n\t\t_swdoc.OC().fk_contract_id = strDefaultContract;\n\t\tapp.g.strLogAndResolveContract = strDefaultContract;\n\t} else {\n\t\t\/\/###20120727\n\t\tapp._eva(_swdoc.MF().lb_contract , \"\");\n\t\tapp._ete(_swdoc.MF().lb_contract , \"\");\n\t\t_swdoc.OC().fk_contract_id = \"\";\n\t\t\/\/_slf(_swdoc.MF().lb_contract,\"_swc_fk_company_id=\" + _swdoc.OC().fk_company_id);\n\t}\n\t_swdoc.UpdateFormFromData();\n\t\t\n}\n\nfunction get_contract_cis()\n{\n\t\/\/###20120717 - rewrite to allow for multiple organisations\n\tvar strKeyValues = app.g.get_contract_cikeys(_swdoc.OC().fk_contract_id,true,true);\t\n\n\tif(strKeyValues==\"\")\n\t\tstrKeyValues = \"-1\";\n\t_swdoc.multi_contractCIIDS[_swdoc.OC().fk_contract_id] = strKeyValues;\n\n}\n\nfunction load_contract_cis()\n{\n\t\/\/###20120717 rewrite to deal with multiple organisations\n\tif(_swdoc.OC().fk_contract_id==\"\")\n\t{\n\t\tapp._slf(_swdoc.MF().sl_cust_cis,\"pk_auto_id=-1\");\n\t\treturn\n\t} \n\t\n\tif(typeof _swdoc.multi_contractCIIDS[_swdoc.OC().fk_contract_id] === \"undefined\")\n\t\t_swdoc.get_contract_cis();\n\t\t\t\n\t\/\/ DTH: webclient - added the following from load_contract_services\n\tvar userCIS = _swdoc.multi_contractCIIDS[_swdoc.OC().fk_contract_id];\n\tvar serviceKeys = app.cfg.get_contract_cikeys(_swdoc.OC().fk_contract_id,true);\n\t\n\t\/\/###20120607 - filtering out unwanted services\n\tif(_swdoc.boolServiceCIBehaviourOnIncident) serviceKeys = _swdoc.filter_out_non_display_services(serviceKeys);\n\n\tif(serviceKeys==\"\")\n\t\tserviceKeys = \"-1\";\n\tuserCIS = serviceKeys + \",\" + userCIS;\n\t\n\t_swdoc.update_ci_list(userCIS);\n}\n\n\nfunction update_ci_list(strCIIDs)\n{\n\n\tif(typeof strCIIDs === \"undefined\"){\n\t\t\tapp._slf(_swdoc.MF().sl_cust_cis,\"pk_auto_id=-1\");\n\t\t\treturn;\n\t}\n\n\tif (strCIIDs != \"\") \/\/ don't apply any filters if there are no CIs, to prevent a SQL error message\n\t{\n\t\tswitch (_swdoc.MF().fld_ci_filter.value)\n\t\t{\n\t\t\tcase \"Services and Items\":\n\t\t\t\tapp._slf(_swdoc.MF().sl_cust_cis, \"pk_auto_id=\" + strCIIDs + \"&type=1\");\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"Services Only\":\n\t\t\t\tapp._slf(_swdoc.MF().sl_cust_cis, \"pk_auto_id=\" + strCIIDs + \"&type=2\");\n\t\t\t\tbreak;\n\t\t\t\n\t\t\tcase \"Items Only\":\n\t\t\t\tapp._slf(_swdoc.MF().sl_cust_cis, \"pk_auto_id=\" + strCIIDs + \"&type=3\");\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t_swdoc.MF().sl_cust_cis.SetRowSelected(0);\t\t\t\t\n\t_swdoc.MF().sl_cust_cis.Refresh();\n\t_swdoc.uncheckset_customer_items();\n}"},{"name":"OnFormLoading","code":"OnFormLoading(strFormName, strCallclass)\n{\n\t\/\/-- can they raise an this type of call\n\tif(app.itsm.can_create(strCallclass,true)==false) return false;\n\n\treturn true;\n}"},{"name":"OnFormClosing","code":"OnFormClosing()\n{\n\t\/\/-- if logged see if we need to raise anything\n\tif(_swdoc.boolLogged)\n\t{\n\t\t_swdoc.onlog_raise_probrfc();\n\t}\n\n\tapp.g.strLogAndResolveContract = \"\";\n\tapp.g.strLogAndResolveCompany = \"\";\n\t\n\tapp.strRAKbDocFilter=\"\";\n\t\n\treturn true;\n}"},{"name":"OnLogAndResolveCall","code":"OnLogAndResolveCall()\n{\n\t\/\/-- set preferred assignment - if in helpdesk context means gets assigned to prefered group.\n\tif(app.session.currentGroupId==\"\")\n\t{\n\t\t_swdoc.set_preferred_assignment(true);\n\t}\n\t\n\t\/\/-- nwj - hide confirmation\n\tapp.g.bDoNotShowLogCallConfirmation = true;\n\tapp.g.bPromptToOpenCallDetails = false;\n\t\n\treturn true;\n}"},{"name":"OnValidate","code":"OnValidate()\n{\n\t\/\/-- app.itsm 2.4.0 - check if need mandatory ci\n\tif(bpm_workflow.flg_requireci==1)\n\t{\n\t\tif(_swdoc.EF().sl_configitems.rowCount() < 1)\n\t\t{\n\t\t\tif(_swdoc.EF().sl_services.rowCount() < 1)\n\t\t\t{\n\t\t\t\tMessageBox(\"Before logging this Incident request you have to associate at least one affected configuration item or service\");\n\t\t\t\treturn VALIDATE_FAIL;\n\t\t\t}\n\t\t}\n\t}\n\t\/\/-- 108840 : Check if we have required number of CIs \n\tvar strCallType = \"Incident\";\n\tvar intCurCINo = _swdoc.EF().sl_configitems.rowCount() + _swdoc.EF().sl_services.rowCount();\n\tif(!app.itsm.mandatory_ci_check(strCallType, intCurCINo))\n\t{\n\t\tvar intReqCINo = app.oSettings.get_setting(\"int\" + strCallType + \"OnLoggingRequiredCINo\");\n\t\tvar strPlural = \"\";\n\t\tif (intReqCINo > 1)\n\t\t{\n\t\t\tstrPlural= \"s\";\n\t\t}\n\t\tMessageBox(\"Before logging this \" + strCallType + \" request you have to associate at least \" + intReqCINo + \" affected configuration item\" + strPlural + \" or service\" + strPlural + \".\");\n\t\treturn VALIDATE_FAIL;\n\t}\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"OnResolveRecord","code":"OnResolveRecord(strTable, strColumn, strValue)\n{\n \t\/\/-- resolving the customer record\n \tif(IsObjectDefined(\"mainform\") && strTable == 'userdb' && _swdoc.boolResolvingCust == false && strValue!=\"\")\n \t{\n \t\tvar strWhere = \"\";\n\t\tif (\"companyname\" == strColumn && \"\" != strValue){\n\t\t\t_swdoc.ResolveRecord(\"company\",\"companyname\",strValue);\n \t\t\t_swdoc.strPreSelectedCompany = strValue;\n\t\t}\n\n  \t\tif(strColumn ==\"firstname!surname\")\n  \t\t{\n  \t\t\t\/\/-- if using customer name search on firstname and lastname\n  \t\t\t\/\/-- 2.4.1 bug fix 79046\n   \t\t\tarrNames = strValue.split(\" \");\n   \t\t\tif(arrNames[1]==undefined)\n   \t\t\t{\n      \t\t\tvar strParams = \"_swc_firstname=\"+arrNames[0];\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0];\n    \t\t}\n   \t\t\telse\n   \t\t\t{\n    \t\t\tvar strLastName=\"\";\n    \t\t\tfor(var y=1;y<arrNames.length;y++)\n    \t\t\t{\n     \t\t\t\tif(y>1)strLastName = strLastName+\" \";\n     \t\t\t\tstrLastName = strLastName+arrNames[y];\n    \t\t\t}\n      \t\t\tvar strParams =  \"_swc_firstname=\"+arrNames[0]+\"&_swc_surname=\"+strLastName;\n      \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\t\tvar strSearch = \"firstname=\"+arrNames[0]+\"&surname=\"+strLastName;\n   \t\t\t}\n  \t\t}\n  \t\telse\n  \t\t{\n       \t\tvar strParams =  \"_swc_\"+strColumn+\"=\"+strValue;\n   \t\t\tvar intCount = app.g.sqs_rowcount(\"call\/common\/customer_count\",strParams);\n   \t\t\tvar strSearch = strColumn+\"=\"+strValue;\n   \t\t\t\/\/-- START 107620\n   \t\t\tstrSearch = strSearch.replace(\"%\",\"% \");\n\t\t\t\/\/-- END 107620\n   \t\t}\n\t\tif(intCount!=1)\n\t\t{\n\t\t\t_swdoc.strSearchFor = strSearch;\n  \t\t\tmainform.SetTimer(1, 100);\n  \t\t\t_swdoc.boolResolvingCust = true;\n  \t\t\treturn \"\";\n \t\t}\n \t}\n \t\n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'company' && strValue ==\"\")\n \t{\n  \t\t\/\/2.4 clear down list if user is being unselected\n  \t\tapp.g.strLogAndResolveCompany = \"\";\n  \t\t_swdoc.ResetRecord('userdb');\n \t} \n \t\n \tif(IsObjectDefined(\"mainform\") && strValue==\"\" && (strTable==\"userdb\"))\n \t{\n \t\t\/\/MessageBox('Setting Timer');\n  \t\tmainform.SetTimer(3, 100);\n \t}\n\t\/\/-- resolving org record \t\n \tif(IsObjectDefined(\"mainform\") && strTable == 'bpm_workflow' && strValue ==\"\")\n \t{\n \t\tapp._een(mainform.lb_oc_slad1,true);\n\t\tapp._een(mainform.lbl_oc_sladef,true);\n\t\tapp.g.reset_bpm_form_attribute_check(_swdoc);\n\t} \n\n \treturn strValue;\n}"},{"name":"OnPreValidate","code":"OnPreValidate()\n{\n\tvar funcFinalValidation = function()\n\t{\n\t\tif (!app.g.resolve_default_priority(_swdoc.OC().priority,_swdoc,\"Incident\"))\n\t\t{\n\t\t\treturn VALIDATE_FAIL;\n\t\t}\n\t\treturn VALIDATE_DEFAULT;\n\t}\n\t\n\t\/\/--F0110887 Start\n\tvar intExpiryEpoch = app.g.fix_epoch(_swdoc.oCompany().supportexpiryx);\n\tvar boolOrgSupported = new Boolean(app.g.checkOrgSupport(_swdoc.oCust().companyname, intExpiryEpoch, false));\n\tif (boolOrgSupported==false)\n\t{\n\t\t MessageBox(\"You cannot log a call for this customer as the '\" + _swdoc.oCust().companyname + \"' organisation is no longer supported.\");\n\t\t return VALIDATE_FAIL;\n\t}\n\t\/\/--F0110887 End\n\t\n\tvar boolResolve = false;\n\tif(\t_swdoc.OC().itsm_slaname==\"[Use Customer SLA]\"||_swdoc.OC().itsm_slaname==\"[Use Profile SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Workflow SLA]\" || _swdoc.OC().itsm_slaname==\"[Use Charge Centre SLA]\")\n\t\tboolResolve = true;\n\tif(boolResolve)\n\t{\n\t\tvar boolOK = _swdoc.handle_set_sladef(_swdoc.OC().itsm_slaname,true);\n\t\tif(!boolOK)\n\t\t\treturn VALIDATE_FAIL;\n\t}\n\t\n\t\/\/###20120802 check cc, dept, site in org?\n\tvar iCaptureMistakes = 0;\n\tvar intMistakeCounter = 0;\n\tvar tDept; \/\/ needs to remain outside as department name is NOT the fk_dept_code but dept_name\n\tif (\"\" !== _swdoc.OC().site){\n\t\ttSite = app.g.get_record(\"site\", _swdoc.OC().site);\n\t\tif (tSite.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 1;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (\"\" !== _swdoc.OC().costcenter){\n\t\tvar tCC = app.g.get_record(\"costcent\", _swdoc.OC().costcenter);\n\t\tif (tCC.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 2;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (\"\" !== _swdoc.OC().fk_dept_code){\n\t\ttDept = app.g.get_record(\"department\", _swdoc.OC().fk_dept_code);\n\t\tif (tDept.fk_company_id != _swdoc.OC().fk_company_id){\n\t\t\tiCaptureMistakes += 4;\n\t\t\tintMistakeCounter++;\n\t\t}\n\t}\n\tif (iCaptureMistakes > 0)\n\t{\n\t\tvar strDetectedMistakes = \"\";\n\t\tvar intDealtWithMistakes = 0;\n\t\tif ( 1 == (iCaptureMistakes % 2) ) {\n\t\t\tstrDetectedMistakes += \"site (\" + _swdoc.OC().site + \")\";\n\t\t\tintDealtWithMistakes++;\n\t\t}\n\t\tif ( 1 == (Math.floor(iCaptureMistakes \/ 2) % 2) ) {\n\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":((2==intMistakeCounter)?\" and \":\", \")) + \"charge centre (\" + _swdoc.OC().costcenter + \")\";\n\t\t\tintDealtWithMistakes++;\n\t\t}\n\t\tif ( 1 == (Math.floor(iCaptureMistakes \/ 4) % 2) ) {\n\t\t\tif(!tDept.dept_name)\n\t\t\t{\n\t\t\t\t\/\/-- F0108424\n\t\t\t\tvar oCust2 = app.g.get_record(\"userdb\", _swdoc.OC().cust_id);\n\t\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":\" and \") + \"department (\"+oCust2.department+\") does not exist and\";\n\t\t\t}else\n\t\t\t{\n\t\t\t\tstrDetectedMistakes += ((0==intDealtWithMistakes)?\"\":\" and \") + \"department (\" + tDept.dept_name + \")\";\n\t\t\t}\n\t\t\t\/\/-- F0108424\n\n\t\t}\n\t\tMessageBox(\"The \" + strDetectedMistakes + \" \" + ((1==intMistakeCounter)?\"is\":\"are\") + \" NOT part of \" + _swdoc.OC().companyname + \".\\n\\nSelect 'OK' to proceed with the current data.\", MB_OKCANCEL | MB_ICONEXCLAMATION, function(intResponse)\n\t\t{\n\t\t\tif (2==intResponse)\n\t\t\t{\n\t\t\t\treturn VALIDATE_FAIL;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treturn funcFinalValidation();\n\t\t\t}\n\t\t});\n\t\t\n\t}\n\telse\n\t{\n\t\treturn funcFinalValidation();\n\t}\t\t\n}"},{"name":"OnAcceptCall","code":"OnAcceptCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.OC().custom_i3=0;\n\treturn true;\n}"},{"name":"OnLogAndAssignCall","code":"OnLogAndAssignCall(strGroupID, strAnalystID)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.OC().custom_i3=0;\n\treturn true;\n}"},{"name":"OnTakeCall","code":"OnTakeCall()\n{\n\t\/\/ TODO: Add your event handler code here\n\n\t_swdoc.OC().custom_i3=0;\n\treturn true;\n}"}]}}},"layout":{"appearance":{"width":"1039","height":"570","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"lb_company","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"72","left":"103","right":"256","bottom":"90"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.companyname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_customerid","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"94","left":"103","right":"256","bottom":"112"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"SearchField1","type":"DualSearchField"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"116","left":"103","right":"256","bottom":"134"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.firstname!surname"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"name":"fld_userdb_site","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"138","left":"103","right":"256","bottom":"156"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.site"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfSite","editRecordForm":"Form.EfSite","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_userdb_costcenter","type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"160","left":"103","right":"256","bottom":"178"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_userdb_dept","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"181","left":"103","right":"256","bottom":"199"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.department"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"department","distinctColumn":"pk_dept_code","displayColumn":"dept_name","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","disabledBackgroundColor":"#eeeeee","newRecordForm":"Form.EfDepartment","storedQuery":"generic.select"}}},{"general":{"name":"tb_tel","type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"202","left":"103","right":"256","bottom":"220"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"224","left":"103","right":"256","bottom":"242"},"scaling":{"top":"0","left":"0","right":"25","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageList":"Helpdesk Icons","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_title","type":"Field"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"325","left":"95","right":"520","bottom":"343"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_updatetext","type":"Field"},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#333333","font":{"@size":"9","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"347","left":"95","right":"520","bottom":"563"},"scaling":{"top":"0","left":"0","right":"50","bottom":"100"}},"data":{"binding":"updatedb.updatetxt"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"4","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_probcode","type":"Field"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"303","left":"95","right":"520","bottom":"321"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"opencall.probcode"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"hintText":"Click on this field to browse for and select a category for this Incident","activeTextColor":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"pcdesc","distinctColumn":"code","displayColumn":"info"}}},{"general":{"name":"lb_oc_slad1","type":"Field"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"73","left":"602","right":"763","bottom":"91"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_slaname"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"itsmsp_slad","distinctColumn":"slad_id","listFilter":"_swc_archive=0","extraOptions":"[Use Customer SLA]=&[userdb.sld_name]^[Use Profile SLA]=&[_form.probcodesla]^[Use Charge Centre SLA]=&[costcent.itsm_sla]^[Use Process SLA]=&[bpm_workflow.fk_default_sla_new]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"requests.filter_itsm_sla"}}},{"general":{"name":"lb_impact","type":"Field"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"95","left":"602","right":"763","bottom":"113"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_impact_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Critical|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_impact_lvl","distinctColumn":"pk_impact","storedQuery":"generic.select"}}},{"general":{"name":"lb_urgency","type":"Field"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"117","left":"602","right":"763","bottom":"135"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_urgency_level"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"Low","activeTextColor":"#eeeeee","listItems":"None|Low|Medium|High|Extreme|","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"itsm_urgency_lvl","distinctColumn":"pk_urgency","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_sla","type":"Field"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"139","left":"602","right":"763","bottom":"157"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"distinctTable":"itsmsp_slad_priority","distinctColumn":"fk_priority","listFilter":"_swc_fk_slad=&[opencall.itsm_sladef]","extraOptions":"[Use SLA Default Priority]=&[itsmsp_slad.fk_priority]^[Use Customer Priority]=&[userdb.priority]^[Use Charge Centre Priority]=&[costcent.priority]^[Use Profile Priority]=&[_form.probcodesla]^[Use Process Priority]=&[bpm_workflow.fk_default_sla]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"Field1","type":"Field"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"160","left":"602","right":"763","bottom":"178"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.customer_ref"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field2","type":"Field"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"180","left":"602","right":"763","bottom":"198"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","sqlSource":"swdata","storedQuery":"common.getSwList","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee","distinctTable":"swlists","distinctColumn":"value","displayColumn":"display_name","listFilter":"lid=CALL-ORIGIN"}}},{"general":{"name":"lb_contract","type":"Field"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"201","left":"602","right":"763","bottom":"219"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"contract","distinctColumn":"pk_contract_id","displayColumn":"title","disabledBackgroundColor":"#eeeeee","listFilter":"_swc_pk_contract_id=''","storedQuery":"requests.filter_company_contracts"}}},{"general":{"name":"fld_bpm_workflow","type":"Field"},"appearance":{"index":"18","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"222","left":"602","right":"763","bottom":"240"},"scaling":{"top":"0","left":"50","right":"75","bottom":"0"}},"data":{"binding":"bpm_workflow.pk_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","sqlSource":"swdata","distinctTable":"bpm_workflow","distinctColumn":"pk_workflow_id","disabledBackgroundColor":"#eeeeee","listFilter":"_swc_callclass=Incident&_swc_flg_active=1","borderColor":"#c0c0c0","storedQuery":"requests.filter_bpm_selection"}}},{"general":{"name":"pl_oc_org","type":"Field"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"73","left":"848","right":"1031","bottom":"91"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Organisation]=[Use Customer's Organisation]","hintText":"The organisation for this call","image":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"company","distinctColumn":"pk_company_id","displayColumn":"companyname","disabledBackgroundColor":"#eeeeee","listFilter":"1=0","storedQuery":"requests.filter_multi_organisation"}}},{"general":{"name":"lb_oc_site","type":"Field"},"appearance":{"index":"20","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"95","left":"848","right":"1031","bottom":"113"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.site"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Site]","hintText":"The site at which incident occured","distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","extraOptions":"[Use Customer's Site]=&[userdb.site]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"lb_oc_cc","type":"Field"},"appearance":{"index":"21","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"117","left":"848","right":"1031","bottom":"135"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"true","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"true","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge centre for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]","disabledBackgroundColor":"#eeeeee","sqlSource":"swdata","borderColor":"#c0c0c0","storedQuery":"generic.select"}}},{"general":{"name":"fld_oc_dept","type":"Field"},"appearance":{"index":"22","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"139","left":"848","right":"1031","bottom":"157"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"defaultValue":"[Use Customer's Department]","sqlSource":"swdata","distinctTable":"department","distinctColumn":"pk_dept_code","listFilter":"_swc_fk_company_id=&[company.pk_company_id]","extraOptions":"[Use Customer's Department]=&[userdb.department]","image":"#eeeeee","borderColor":"#c0c0c0","displayColumn":"dept_name","disabledBackgroundColor":"#eeeeee","storedQuery":"generic.select"}}},{"general":{"name":"fld_environment","type":"Field"},"appearance":{"index":"23","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"160","left":"848","right":"1031","bottom":"178"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"opencall.environment"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"fld_ci_filter","type":"Field"},"appearance":{"index":"24","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"301","left":"683","right":"803","bottom":"319"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","listItems":"Services and Items|Services Only|Items Only|","defaultValue":"Services and Items","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"fld_cis","type":"Field"},"appearance":{"index":"25","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"301","left":"807","right":"1031","bottom":"319"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","listItems":"by Customer|by Site|by Organisation|","defaultValue":"by Customer","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"mb_cust_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"26","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"39","left":"457","right":"517","bottom":"61"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"commands":"Customer Search^2|Customer Properties^1|Managers Properties^3|Organisation Properties^4|Selfservice Wizard Input^5|","backgroundColor":"#ff9900"}}},{"general":{"name":"mbtn_profile","type":"MenuButton","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"27","caption":"Find Solution","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"272","left":"432","right":"517","bottom":"294"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900","commands":"KnowledgeBase Search (on Category)^1|KnowledgeBase Search (on summary)^4|KnowledgeBase Search (on description)^2|Problem \/ K.E Search^3|"}}},{"general":{"name":"mbtn_cci_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"true","cache":"true","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"28","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"272","left":"969","right":"1028","bottom":"294"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Child Dependencies^5|Parent Dependencies^2|Change Schedule^4|","backgroundColor":"#ff9900"}}},{"general":{"name":"Field3","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"29","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"44","left":"921","right":"1031","bottom":"59"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"data":{"binding":"opencall.itsm_majorinc"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"scale":"#eeeeee","flagItems":"Is a Major Incident^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"x_fld_org","type":"Field"},"appearance":{"index":"30","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"73","left":"848","right":"1031","bottom":"91"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#c0c0c0","image":"#eeeeee","defaultValue":"[Use Customer's Organisation]","disabledBackgroundColor":"#eeeeee"}}},{"general":{"type":"FormulaField"},"appearance":{"index":"31","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"72","left":"350","right":"520","bottom":"90"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":": &[userdb.jobrole]"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0","backgroundColor2":"#eeeeee"}}},{"general":{"name":"sl_cust_cis","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"true","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"}},"appearance":{"index":"32","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"324","left":"534","right":"1031","bottom":"563"},"scaling":{"top":"0","left":"50","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"ID","width":"133","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"54","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"275","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"217","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"131","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"147","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"146","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"132","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"155","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sld"},"name":"SLA ID","width":"120","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"recordresolvedmsg"},"name":"recordresolvedmsg","width":"120","image":"-1","dataColumn":"16"}]},"sortColumn":"0","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pk_auto_id=-1","sqlSource":"swdata","selectionMode":"0","borderColor":"#d3c9b6","storedQuery":"request.incident.service_list"}}},{"general":{"name":"CaptionPanel7","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"33","caption":"Log New Incident","backgroundColor":"#ff7878","foregroundColor":"#003366","font":{"@size":"18"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"5","left":"3","right":"1036","bottom":"35"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#f1f1f1","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"30","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000"}}},{"general":{"type":"FormulaField","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"34","backgroundColor":"#f2eedd","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"201","left":"801","right":"1017","bottom":"219"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"data":{"binding":"&[opencall.itsm_prefered_text]"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#dddddd"}}},{"general":{"type":"FormulaField"},"appearance":{"index":"35","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"94","left":"350","right":"433","bottom":"112"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":": &[userdb.start_datex]"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0","backgroundColor2":"#eeeeee"}}},{"general":{"type":"FormulaField"},"appearance":{"index":"36","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"160","left":"350","right":"433","bottom":"178"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":": &[userdb.sdrating]"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0","backgroundColor2":"#eeeeee"}}},{"general":{"name":"CaptionPanel4","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"37","caption":"Services and Items","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"271","left":"528","right":"1036","bottom":"568"},"scaling":{"top":"0","left":"50","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_pcadd.png"}}},{"general":{"name":"CaptionPanel2","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"38","caption":"Settings","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"39","left":"528","right":"1036","bottom":"268"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_alarm.png"}}},{"general":{"name":"CaptionPanel1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"39","caption":"Customer Details","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"39","left":"3","right":"524","bottom":"268"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_contact.png"}}},{"general":{"name":"CaptionPanel5","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"40","caption":"Description","backgroundColor":"#f1f1f1","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet (MS)"},"alignment":"Left","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"271","left":"3","right":"524","bottom":"568"},"scaling":{"top":"0","left":"0","right":"50","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#d8d8d8","imageHSpace":"10","slope":"12","borderColor":"#d3c9b6","headerHeight":"23","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#f2eedd","panelBackgroundColor2":"#000000","image":"&[app.webroot]\/clisupp\/formimages\/itsm\/itsm_document.png"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"41","caption":"Customer ID","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"94","left":"16","right":"101","bottom":"112"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.keysearch"},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0"}}},{"general":{"type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"42","caption":"Customer Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"116","left":"16","right":"101","bottom":"134"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"43","caption":"Main Site","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"138","left":"16","right":"101","bottom":"156"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.site"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"distinctTable":"site","distinctColumn":"site_name","newRecordForm":"Form.EfSite","editRecordForm":"Form.EfSite","sqlSource":"swdata"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"44","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"160","left":"16","right":"101","bottom":"178"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","sqlSource":"swdata"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"45","caption":"Tel. No.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"202","left":"16","right":"101","bottom":"220"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.telext"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"46","caption":"E-Mail","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"224","left":"16","right":"101","bottom":"242"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.email"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"47","caption":"Impact","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"95","left":"541","right":"597","bottom":"113"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"48","caption":"Urgency","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"117","left":"541","right":"597","bottom":"135"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_oc_priority","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"49","caption":"Priority","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"541","right":"597","bottom":"157"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.priority"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"50","caption":"Charge Centre","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"117","left":"764","right":"843","bottom":"135"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.costcenter"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"51","caption":"Category","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"303","left":"35","right":"91","bottom":"321"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"52","caption":"Job Role","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"72","left":"283","right":"346","bottom":"90"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"userdb.jobrole"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"53","caption":"Start Date","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"94","left":"283","right":"346","bottom":"112"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"userdb.dob"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"img_customer","type":"Image","flags":{"transparent":"false","xpStyle":"false","hasShadow":"true","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"54","caption":"&[app.webroot]\/clisupp\/documents\/userdb\/images\/&[userdb.keysearch].jpg","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"Stretch","borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"94","left":"441","right":"519","bottom":"178"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Hand","properties":{"imageHAlign":"0","imageVAlign":"0","backMode":"0","noImageImage":"&[app.webroot]\/clisupp\/documents\/userdb\/images\/noimage.gif"}}},{"general":{"name":"img_orating","type":"Image"},"appearance":{"index":"55","caption":"&[app.webroot]\/clisupp\/formimages\/itsm\/cr_neu16.gif","backgroundColor":"#f2eedd","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"ExactSize","borderStyle":"None"},"objectPlacement":{"position":{"top":"182","left":"302","right":"318","bottom":"200"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"imageVAlign":"1","backMode":"0"}}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"56","caption":"Assessment","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"160","left":"283","right":"346","bottom":"178"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"userdb.sdrating"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_orating","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"57","caption":": Overall satisfaction undetermined","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"182","left":"319","right":"520","bottom":"200"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Rect3","type":"Rectange","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"58","backgroundColor":"#ffffff","foregroundColor":"#b2b2b2","font":{"@size":"0"},"borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"191","left":"795","right":"1023","bottom":"240"},"scaling":{"top":"0","left":"75","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label1","type":"FieldName"},"appearance":{"index":"59","caption":"Preferred Support Assignment","backgroundColor":"#f2eedd","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"183","left":"802","right":"960","bottom":"201"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.itsm_prefered_text"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"60","caption":"Site Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"95","left":"764","right":"843","bottom":"113"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.site"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer Charge Centre]","hintText":"The charge center for this call","distinctTable":"costcent","distinctColumn":"costcenter","newRecordForm":"Form.EfCharge Centre","editRecordForm":"Form.EfCharge Centre","extraOptions":"[Use Customer Charge Centre]=&[userdb.costcenter]^[Use Asset Charge Centre]=&[equipmnt.costcenter]","sqlSource":"swdata"}}},{"general":{"name":"Text5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"61","caption":"Summary","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"325","left":"35","right":"91","bottom":"343"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label5","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"62","caption":"Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"182","left":"38","right":"101","bottom":"198"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.department"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label6","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"63","caption":"Department","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"764","right":"843","bottom":"157"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.fk_dept_code"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_details","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"64","caption":"Details","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"348","left":"35","right":"91","bottom":"366"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"65","caption":"Active Requests","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"116","left":"263","right":"346","bottom":"136"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"66","caption":"Closed Requests","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"138","left":"262","right":"346","bottom":"158"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_closed_request","type":"Text"},"appearance":{"index":"67","caption":":","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"138","left":"350","right":"433","bottom":"155"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0","backgroundColor2":"#eeeeee"}}},{"general":{"name":"lbl_open_request","type":"Text"},"appearance":{"index":"68","caption":":","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Left","borderStyle":"Rectangle","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"116","left":"350","right":"433","bottom":"133"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"borderColor":"#c0c0c0","backgroundColor2":"#eeeeee"}}},{"general":{"name":"lbl_oc_sladef","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"69","caption":"SLA","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"73","left":"541","right":"597","bottom":"91"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_sladef"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"defaultValue":"[Use Customer SLA]","distinctTable":"priority","distinctColumn":"priority","extraOptions":"[Use Customer SLA]=&[userdb.priority]^[Use Asset SLA]=&[equipmnt.priority]^[Use Charge Centre SLA]=&[costcent.priority]^[Use Profile SLA]=&[_form.probcodesla]","sqlSource":"swdata"}}},{"general":{"name":"lbl_bpm_workflow","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"70","caption":"Process","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"222","left":"541","right":"597","bottom":"240"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.bpm_workflow_id"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"lbl_contract","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"71","caption":"Contract","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"201","left":"541","right":"597","bottom":"217"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.fk_contract_id"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_oc_company","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"72","caption":"Organisation","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"73","left":"764","right":"843","bottom":"91"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.companyname"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text8","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"73","caption":"Filter","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"301","left":"621","right":"680","bottom":"319"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text9","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"74","caption":"There are two Organisation fields here !","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"70","left":"1080","right":"1196","bottom":"113"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"lbl_company","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"75","caption":"Main Organisation","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"72","left":"6","right":"101","bottom":"90"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"userdb.companyname"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"76","caption":"Customer Ref","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"160","left":"526","right":"597","bottom":"176"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.customer_ref"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label7","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"77","caption":"Origin","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"180","left":"561","right":"597","bottom":"196"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"data":{"binding":"opencall.origin"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_environment","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"78","caption":"Environment","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"159","left":"764","right":"843","bottom":"177"},"scaling":{"top":"0","left":"75","right":"75","bottom":"0"}},"data":{"binding":"opencall.environment"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label8","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"79","caption":"Preferred E-Mail","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"222","left":"267","right":"346","bottom":"245"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"opencall.itsm_tempemail"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label9","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"80","caption":"Preferred Tel. No.","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"202","left":"259","right":"346","bottom":"219"},"scaling":{"top":"0","left":"25","right":"25","bottom":"0"}},"data":{"binding":"opencall.itsm_temptel"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_ptelno","type":"Field"},"appearance":{"index":"81","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"202","left":"350","right":"521","bottom":"220"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_temptel"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"tb_tem","type":"Field"},"appearance":{"index":"82","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Trebuchet MS"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"224","left":"350","right":"521","bottom":"242"},"scaling":{"top":"0","left":"25","right":"50","bottom":"0"}},"data":{"binding":"opencall.itsm_tempemail"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}}]},"javascript":{"methods":{"method":[{"name":"btn_remove_ci_OnPressed","code":"btn_remove_ci_OnPressed()\n{\n\n\n   \n             \n}"},{"name":"btn_assign_OnPressed","code":"btn_assign_OnPressed()\r\n{\r\n    \/\/ TODO: Add your event code here\r\n    _swdoc.opencall.suppgroup = _swdoc.GetVariable(\"prefered_support\");\r\n    MessageBox(_swdoc.opencall.suppgroup)\r\n    _swdoc.LogCall();        \r\n}\r\n\r\n"},{"name":"sl_cust_cis_OnHeaderItemClicked","code":"sl_cust_cis_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\/\/sl_cust_cis.Refresh();\n\t_swdoc.load_cis();\n\t\/\/_swdoc.load_customer_items();\n\t\n\n\n}"},{"name":"sl_cust_cis_OnItemSelected","code":"sl_cust_cis_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_cust_cis.rowCount() > 0);\n\tapp._een(mbtn_cci_views, boolActive);\n\/\/_een(mbtn_cci_actions, boolActive);\t\n\t\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- F0105032\n\tif(_swdoc._form.PreloadType==2)\n\t\t_swdoc.oOpencall = app.g.get_sys_record(\"opencall\",_swdoc.OC().callref)\n\t\/\/-- EOF F0105032\n\n\t\/\/--\n\t\/\/-- if logging ofr a customer\n\tif(app.g.LOG_CALL_FOR_USER!=\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", app.g.LOG_CALL_FOR_USER);\n\t\tapp.g.LOG_CALL_FOR_USER=\"\";\n\t}\n\telse if(app.g.LOG_FOR_ORGID!=\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"company\", \"pk_company_id\", app.g.LOG_FOR_ORGID);\t\n\t\tapp.g.LOG_FOR_ORGID=\"\";\n\t}\n\telse if(app.g.LOG_CALL_FOR_CI!=\"\")\n\t{\n\t\tapp.g.sl_appendfilter(_swdoc.EF().sl_configitems, app.g.LOG_CALL_FOR_CI,'pk_auto_id');\n\t\t_swdoc.EF().sl_configitems.Refresh();\n \t\tapp.g.LOG_CALL_FOR_CI=\"\";\n\t\t_swdoc.check_ci_assessment();\n\t}\n\tif(_swdoc.oCust().keysearch !=\"\")\n\t{\n\t\t_swdoc.setup_customer_details();\n\t}\n\t\n\tapp.g.filter_company_contracts(_swdoc.OC().fk_company_id, _swdoc.MF().lb_contract);\n\t\/\/-- 12.07.2008 \n\t\/\/-- disable or hide company field if internal support only\n\t\n\tvar boolExternalCompanies =dd.GetGlobalParamAsString(\"Application Settings\/SupportExternalCompanies\")==1;\n\tapp._een(_swdoc.MF().lb_company, boolExternalCompanies);\n\tapp._evi(_swdoc.MF().lb_contract, boolExternalCompanies);\n\tapp._evi(_swdoc.MF().lbl_contract, boolExternalCompanies);\n\tif(!_swdoc.MF().lb_company.enable)\n\t{\n\t\t\/\/-- check if we should hide\n\t\tvar boolHideCompanyField = (dd.GetGlobalParamAsString(\"Application Settings\/HideCompanyField\")!=1);\n\t\tapp._evi(_swdoc.MF().lb_company, boolHideCompanyField);\t\t\n\t\t\/\/alter filter if we do not support external\n\t\t\n\t\tapp._slf(_swdoc.MF().fld_userdb_site,\"\");\n\t\tapp._slf(_swdoc.MF().fld_userdb_costcenter,\"\");\n\t\tapp._slf(_swdoc.MF().fld_userdb_dept,\"\");\t\n\t\tapp._slf(_swdoc.MF().lb_oc_cc,\"\");\n\t\tapp._slf(_swdoc.MF().lb_oc_site,\"\");\n\t\tapp._slf(_swdoc.MF().fld_oc_dept,\"\");\n\t\t\t\t\n\t}\n\t\n\t\/\/###20120717 ensure correct field for organisation is showing - workaround because distinct picklist with Display is broken\n\t\/\/###20120720 addition of boolHideCompanyField - feeding on the effect of the DD setting.\n\tvar boolCompanyFieldVisible = (_swdoc.MF().lb_company.visible);\n\tapp._evi(_swdoc.MF().lbl_oc_company, boolCompanyFieldVisible);\n\n\tvar boolCompanySet = (\"\" !== _swdoc.OC().fk_company_id);\n\tapp._ema(_swdoc.MF().x_fld_org, !boolCompanySet);\n\tapp._evi(_swdoc.MF().x_fld_org, !boolCompanySet && boolCompanyFieldVisible);\n\tapp._een(_swdoc.MF().x_fld_org, false);\n\t\n\tapp._ema(_swdoc.MF().pl_oc_org, boolCompanySet);\n\tapp._evi(_swdoc.MF().pl_oc_org, boolCompanySet && boolCompanyFieldVisible);\n\tapp._een(_swdoc.MF().pl_oc_org, boolCompanySet && boolExternalCompanies);\n\t\n\tapp._evi(_swdoc.MF().lbl_company, boolCompanyFieldVisible);\t\n\t\/\/-- eof hide \/ enable\t    \t\n\t\n\tvar strFilterPicklist = \"by Customer\";\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AllowSiteFilterCIsAndServices\")==1)\n\t\tstrFilterPicklist += (!boolExternalCompanies)?\"|by Site\":\"|by Customer: Site|by Settings: Site\";\n\tif(dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AllowOrganisationFilterCIsAndServices\")==1)\n\t\tstrFilterPicklist += (!boolExternalCompanies)?\"|by Organisation\":\"|by Customer: Organisation|by Settings: Organisation\";\n\tif(boolExternalCompanies && dd.GetGlobalParamAsNumber(\"Application Settings\/Incident\/AllowContractFilterCIsAndServices\")==1)\n\t\tstrFilterPicklist +=\"|by Contract\";\n\t\t\n\t_swdoc.MF().fld_cis.pickList = strFilterPicklist;\n\n\t\/\/-- RJC - F0105434\n\tapp.g.get_default_process(_swdoc,'Incident',_swdoc.MF().fld_bpm_workflow,_swdoc.MF().lbl_bpm_workflow);\n\t\/\/-- EOF - F0105434\n\t\n\t\/\/-- F0094989\n\tif(_swdoc.OC().itsm_slaname.indexOf(\"[Use \")<0 && _swdoc.OC().itsm_slaname.indexOf(\" SLA]\")<0 )\n\t{\n\t\tif(_swdoc.OC().itsm_slaname!=\"\")\n\t\t{\n\t\t\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+_swdoc.OC().itsm_slaname);\n\t\t\tif(slarec.Fetch())\n\t\t\t{\n\t\t\t\tvar intSLAId = app.g.get_field(slarec,\"slad_id\");\n\t\t\t\tif(intSLAId!=\"\") {\n\t\t\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t\t\t\t\t_swdoc.handle_set_sladef(intSLAId);\t\t\t\t\t\n\t\t\t\t}\t\n\t\t\t}\n\t\t}\n\t}\n\t_swdoc.strDefaultImpact = (_swdoc.OC().itsm_impact_level);\n\t_swdoc.strDefaultUrgency = (_swdoc.OC().itsm_urgency_level);\n\t_swdoc.strCurrentPriority = _swdoc.OC().priority;\n\t_swdoc.strCurrentSLAName = _swdoc.OC().itsm_slaname;\n\t\n\t\/\/###20120619\n\t_swdoc.strOrigSLAFilter = _swdoc.MF().lb_oc_slad1.filter;\n\t\n\t\/\/ES -- START F0107205 : When logging call from email...\n\tif(_swdoc.OC().itsm_slaname == \"[Use Customer SLA]\" && _swdoc.oCust().sld_name != \"\")\n\t{\n\t\t_swdoc.MF().lb_oc_slad1_OnValueChanged(\"[Use Customer SLA]\");\n\t\t\n\t\t\/\/-- If priority not set...\n\t\tif (_swdoc.OC().priority == \"\")\n\t\t{\n\t\t\t\/\/-- ...try to find priority from matrix\n\t\t\t_swdoc.OC().priority = app.itsm.get_sla_from_slad_matrix(_swdoc.OC().itsm_sladef, _swdoc.OC().itsm_impact_level, _swdoc.OC().itsm_urgency_level);\n\t\t\t_swdoc.UpdateFormFromData();\n\t\t}\n\t}\n\t\/\/-- END F0107205\n\t\n\t\/\/ -- Update Main Organisation on the form if only the Organisation is set\n\tif(_swdoc.oCompany().pk_company_id && _swdoc.oCust().keysearch ==\"\")\n\t{\n\t\t_swdoc.ResolveRecord(\"userdb\", \"fk_company_id\", _swdoc.oCompany().pk_company_id);\n\t}\n\t\n\t\/\/-- F0108825 : A newly logged call should not have resolve\/close text\n\t\/\/\t         even when it has been copied from a resloved\/closed call\n\t_swdoc.OC().resolve_text=\"\";\n\t_swdoc.OC().close_text=\"\";\t\n\t\n\t\/\/\tPM00143977 : values copied from parent call\n\t_swdoc.OC().lastactdatex=\"\";\t\n\t_swdoc.OC().lastactdate=\"\";\t\n\t_swdoc.OC().lastactby=\"\";\t\n\t_swdoc.OC().assigndatx=\"\";\t\n\t_swdoc.OC().withinresp=\"\";\t\n\t_swdoc.OC().slaresp=\"\";\t\n\t_swdoc.OC().assigndate=\"\";\t\n\t\n\t\/\/ -- F00109898\n\t_swdoc.OC().resp_time = \"\";\n\t_swdoc.OC().fix_time = \"\";\n\t\/\/-- TK Set Summary Based on Email Subject\n\tif((_swdoc._form['emailsubject']) && (app.oSettings.get_setting(\"boolUseSubjectasSummary\")=='True'))\n\t{\n\t\t_swdoc.OC().itsm_title = _swdoc._form['emailsubject'];\n\t\t_swdoc.boolIncTitleSetManually = true;\n\t} \n\n\t\/\/PM00132039\n\t\/\/Quick Log calls - Category is not displayed on template when a CI is added to the quick log call\n\tif (_swdoc.OC().probcode!=\"\")\n\t{\n\t\/\/ -- indicate that profile was not set by CI\n\t_swdoc.intProfileCodeCI = -1;\n\t}\n\t\n\t_swdoc.strDefaultPriority = _swdoc.MF().lb_oc_sla.value;\n\t\n}"},{"name":"mb_cust_actions_OnMenuItem","code":"mb_cust_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iProperties = 1;\n\tvar iSearch=2;\t\n\tvar iMgr = 3;\n\t\n\tif(nItemID==iSearch)\n\t{\n\t\tvar strURL = \"searchtype=1&canreset=1&fk_company_id=\" + _swdoc.oCompany().pk_company_id;\n\t\tapp.g.search_for(\"customers\",false,strURL,function(sResults)\n\t\t{\n\t\t\tif(sResults.selectedkeys==\"\") return;\n    \n    \t\tvar arrKey = sResults.selectedkeys.split(\",\");\n    \t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", arrKey[0]);\n\t\t});\n    }\n    else if(nItemID==iMgr)\n    {\n    \t\/\/-- popup a form \n\t\tif (_swdoc.userdb.fk_manager != \"\") app.OpenFormForEdit(\"tfCustomer\", _swdoc.userdb.fk_manager, \"\", true);\n\t}\n}"},{"name":"mbtn_cci_views_OnMenuItem","code":"mbtn_cci_views_OnMenuItem(strName, nItemID)\n{\n\tvar iProperties = 1;\n\tvar iVCMParents = 2;\t\n\tvar iVCMChildren = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_cust_cis,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_cust_cis,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMParents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\t\telse if(nItemID == iVCMChildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\t\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"sl_cust_cis_OnItemChecked","code":"sl_cust_cis_OnItemChecked(nRow, bChecked)\n{\n\t _swdoc.boolIncSLASetManually = true; \/\/-- 105734\n\t\n\tvar pk_ci_id = app.g.sl_getrawcolvalue(sl_cust_cis, nRow, \"pk_auto_id\");\t\n\tvar fk_ci_type = app.g.sl_getrawcolvalue(sl_cust_cis, nRow, \"ck_config_type\");\n\n\tvar oList = _swdoc.EF().sl_configitems;\n\t\n\tvar itemType = \"Configuration Item\";\n\n\tif(fk_ci_type.indexOf(\"Service\")>-1)\n\t{\n\t\toList = _swdoc.EF().sl_services;\n\t\tvar itemType = \"Service\";\n\t}\n\n\t\/\/MessageBox(pk_ci_id + \" A:A \" + nRow)\n\tif(bChecked)\n\t{\n\t\tif(app.g.sl_findrow_byvalue(oList, pk_ci_id, 'pk_auto_id') > -1) return;\n\n\t\t\/\/MessageBox(pk_ci_id)\n\t\t\/\/-- TK Replace append Filter with Stored Query\t\n\t\t\/\/app.g.sl_appendfilter(oList, pk_ci_id,'pk_auto_id');\n\t\tif (itemType == \"Configuration Item\")\n\t\t{\n\t\t\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_configitems, pk_ci_id,'pk_auto_id');\n\t\t\t_swdoc.EF().sl_configitems.Refresh();\n\t\t\t\/\/ES - F0111753 - set Process based on value set in Configuration Item and Configuration Type\n\t\t\tvar intCIID = app.g.sl_getrawcolvalue(sl_cust_cis, nRow, \"pk_auto_id\");\n\t\t\tvar dbValue1 = new SqlQuery;\n\t\t\tdbValue1.InvokeStoredQuery(\"cmdb\/get.itemi_fkworkflowid\",\"pk_auto_id=\"+intCIID);\n\t\t\tif(dbValue1.Fetch())\n\t\t\t{\n\t\t\t\tvar strWorkflowId = app.g.get_field(dbValue1,\"fk_workflow_id\");\n\t\t\t\t\/\/Get fk_workflow_id from config_itemi if not blank\n\t\t\t\tif (strWorkflowId!=\"\")\n\t\t\t\t{\n\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id==\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = strWorkflowId;\n\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t}\n\t\t\t\t\telse if (_swdoc.bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id!=strWorkflowId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar msgProcess = MessageBox(\"The default Incident Process for the selected item is [\" + arrWorkflowId[y] + \"]. Would you like to apply this change?\",MB_YESNO|MB_ICONQUESTION);\n \t\t\t\t\t\t\tif (msgProcess==6)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = strWorkflowId;\n\t\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\t\n\t\t\t\t\/\/Get fk_workflow_id from config_typei if blank in config_itemi\t\t\n\t\t\t\telse if (strWorkflowId==\"\")\n\t\t\t\t{\n\t\t\t\t\tvar dbValue2 = new SqlQuery;\n\t\t\t\t\tdbValue2.InvokeStoredQuery(\"cmdb\/get.typei_fkworkflowid\",\"pk_auto_id=\"+intCIID);\n\t\t\t\t\tif (dbValue2.Fetch())\n\t\t\t\t\t{\n\t\t\t\t\t\tvar strTypeWorkflowId = app.g.get_field(dbValue2,\"fk_workflow_id\");\n\t\t\t\t\t\tif (strTypeWorkflowId!=\"\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id==\"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = strTypeWorkflowId;\n\t\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (_swdoc.bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar msgProcessType = MessageBox(\"The default Incident Process for the selected item is [\" + arrWorkflowId[y] + \"]. Would you like to apply this change?\",MB_YESNO|MB_ICONQUESTION);\n \t\t\t\t\t\t\t\tif (msgProcessType==6)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = strTypeWorkflowId;\n\t\t\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} \/\/END - F0111753\n\t\t\t}\t\n\t\t}else if (itemType == \"Service\")\n\t\t{\n  \t\t\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_services, pk_ci_id,'pk_auto_id');\n  \t\t\t_swdoc.EF().sl_services.Refresh();\n  \t\t\t\n  \t\t\t\/\/ES - F0111753 - set Process based on value set in Service\n\t\t\tvar intCIID = app.g.sl_getrawcolvalue(sl_cust_cis, nRow, \"pk_auto_id\");\n\t\t\tvar dbValue3 = new SqlQuery;\n\t\t\tdbValue3.InvokeStoredQuery(\"cmdb\/get.itemi_fkworkflowid\",\"pk_auto_id=\"+intCIID);\n\t\t\tif(dbValue3.Fetch())\n\t\t\t{\n\t\t\t\tvar strServiceWorkflowId = app.g.get_field(dbValue3,\"fk_workflow_id\");\n\t\t\t\t\/\/Get fk_workflow_id from config_itemi for app.service item\n\t\t\t\tif (strServiceWorkflowId!=\"\")\n\t\t\t\t{\n\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id==\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = strServiceWorkflowId;\n\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t}\n\t\t\t\t\telse if (_swdoc.bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id!=strServiceWorkflowId)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tvar msgProcessService = MessageBox(\"The selected item recommends the Process [\" + strServiceWorkflowId + \"] for this Incident. Would you like to apply this change?\",MB_YESNO|MB_ICONQUESTION);\n \t\t\t\t\t\t\tif (msgProcessService==6)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = strServiceWorkflowId;\n\t\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\t\t\t\n\t\t\t} \/\/END - F0111753\n  \t\t}\n\t\t\/\/-- NWJ - determine who the preferred support is\n \t\t_swdoc.determine_prefered_support(true);\t\n\n\t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\tapp.cfg.process_call_contract_check(pk_ci_id, true,_swdoc);\n\t\t\n\t\t\/\/ -- SG, 02\/07\/2012, F0103324\n\t\t\/\/ Create new array to hold CI and Bespoke Terms info\n\t\tapp.bespokeTermsProcessing(pk_ci_id);\n\t\t\/\/ -- END OF BESPOKE PROCESSING\n\t}\n\telse\n\t{\n\t\t\tvar intRowPos = app.g.sl_findrow_byvalue(oList, pk_ci_id, 'pk_auto_id');\n\t\t\tif(intRowPos>-1)\n\t\t\t{\n\t\t\t\toList.RemoveRow(intRowPos);\t\t\n\t\t\n\t\t\t\t\/\/-- 29.04.2008 - 2.2.0 if this ci that has been removed was used to set the pref supp group then change it\n\t\t\t\tif(_swdoc.intAssessmentCI == pk_ci_id)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_sladef = 0;\n\t\t\t\t\t_swdoc.OC().itsm_slaname = \"[Use Customer SLA]\";\n\t\t\t\t\t_swdoc.OC().priority = \"[Use Customer Priority]\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\n\n\t\t\t\t\tapp._eva(_swdoc.MF().lb_oc_slad1, 0);\n\t\t\t\t\tapp._ete(_swdoc.MF().lb_oc_slad1, 0);\n\t\t\t\t\tapp._een(_swdoc.MF().lbl_oc_priority, false);\n\t\t\t\t\tapp._een(_swdoc.MF().lb_oc_sla, false);\n\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t\n\t\t\t\t_swdoc.determine_prefered_support(true);\n\t\t\t\t\/\/_swdoc.check_ci_assessment();\n\t\t\t}\n\t}\n\n\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t\n}"},{"name":"mbtn_profile_OnMenuItem","code":"mbtn_profile_OnMenuItem(strName, nItemID)\n{\n\tvar iDesc = 2;\n\tvar iProfile = 1;\n\tvar iAPR=3;\n\tvar iSumm=4;\n\t\n\tif(nItemID==iDesc)\n\t{\n  \t\tif(_swdoc.updatedb.updatetxt == \"\")\n  \t\t{\n        \tMessageBox(\"Please enter some descriptive text before trying to perform a Knowledge base search.\");\n        }\n    \telse\n    \t{   \t\t\n        \tif(!app.g.use_sw_knowledgebase())\n\t\t\t{\n\t\t\t\tapp.allocatekbdoc(_swdoc._kbidentifier,_swdoc);\n        \t\tapp.g.open_third_party_kb_search(true, _swdoc.updatedb.updatetxt,\"\",app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\"), _swdoc._kbidentifier);\n\t\t\t}\n\t\t\telse\n\t\t\t{ \t\t\n        \t\turl = \"hsl:KbSearch?search=\" + _swdoc.updatedb.updatetxt;\n        \t\tapp.global.OpenEmbeddedURL(url);\n        \t}\n    \t}\n    }\n\tif(nItemID==iSumm)\n\t{\n  \t\tif(_swdoc.opencall.itsm_title == \"\")\n  \t\t{\n        \tMessageBox(\"Please enter a summary before trying to perform a Knowledge base search.\");\n        }\n    \telse\n    \t{   \t\n    \t\tif(!app.g.use_sw_knowledgebase())\n\t\t\t{\n\t\t\t\tapp.allocatekbdoc(_swdoc._kbidentifier,_swdoc);\n        \t\tapp.g.open_third_party_kb_search(true, _swdoc.opencall.itsm_title,\"\",app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\"), _swdoc._kbidentifier);\n        \t\t\n\t\t\t}\n\t\t\telse\n\t\t\t{ \t\t\t\n        \t\turl = \"hsl:KbSearch?search=\" + _swdoc.opencall.itsm_title;\n        \t\tapp.global.OpenEmbeddedURL(url);\n        \t}\n    \t}\n    }\n\telse if(nItemID==iProfile)\n\t{\n\t\tif(_swdoc.OC().probcode == \"\")\n  \t\t{\n        \tMessageBox(\"Please select an incident category before trying to perform a Knowledge base search.\");\n        }\n    \telse\n    \t{\n    \t\tif(!app.g.use_sw_knowledgebase())\n\t\t\t{\n\t\t\t\tMessageBox(\"This option is not available with your Knowledgebase.\");\n\t\t\t}\n\t\t\telse\n\t\t\t{ \t\n        \t\turl = \"hsl:KbSearch?search=\" + _swdoc.OC().probcode;\n        \t\tapp.global.OpenEmbeddedURL(url);\n        \t}\n    \t}\n    \treturn;\n    }\n\telse if(nItemID==iAPR)\n\t{\n\t\t\/\/-- Auto problem search\n\t\tvar strCIKeys = app.g.sqllist_get_valuesdel(_swdoc.EF().sl_configitems, 'pk_auto_id', \",\", \"\");\n\t\tvar strServiceKeys = app.g.sqllist_get_valuesdel(_swdoc.EF().sl_services, 'pk_auto_id', \",\", \"\");\n\t\tif(strServiceKeys!=\"\")\n\t\t{\n\t\t\tif(strCIKeys!=\"\")strCIKeys+=\",\";\n\t\t\tstrCIKeys+=strServiceKeys;\n\t\t}\n  \t\tvar strURL = \"canreset=1&matchingprobcode=\" + _swdoc.OC().probcode;\n  \t\tif(strCIKeys!=\"\")\n  \t\t{\n  \t\t\tstrURL += \"&ci_keys=\"+strCIKeys;\n  \t\t}\n\t\tapp.g.search_for(\"apr\",true,strURL,function(oResult)\n\t\t{\n\t\t\tif(oResult.selectedkeys!=\"\")\n\t\t\t{\t\t\n\t\t\t\tapp.g.sl_appendfilter(_swdoc.EF().sl_problems,oResult.selectedkeys,0);\n\t\t\t\tMessageBox('The associated Problems\/Known Errors can be viewed from the Associated Information tab.');\n\t\t\t}\n\t\t});\n\t}\n}"},{"name":"OnTimer","code":"OnTimer(nTimer)\n{\n\t\/\/ TODO: Add your event handler code here\n\tif(nTimer==1)\n\t{\n\t\tmainform.KillTimer(1);\n\t\t\/\/###20120716\n\t\tif (\"\" != _swdoc.oCompany().pk_company_id){\n\t\t\t_swdoc.strPreSelectedCompany = _swdoc.oCompany().pk_company_id;\n\t\t}\n\t\tvar strURL = \"searchmode=1&multiselect=0&autorun=1&searchtype=1&canreset=1&fk_company_id=\" + _swdoc.strPreSelectedCompany + \"&\"+_swdoc.strSearchFor;\n\t\t_swdoc.strSearchFor=\"\";\n\t\t_swdoc.strPreSelectedCompany = \"\";\n\t\tapp.g.popup(\"search_customers\",strURL,function(aForm)\n\t\t{\n\t\t\tif (aForm)\n\t\t\t{\n\t\t\t\tvar sResults = new Object();\n\t\t\t\tsResults.selectedkeys = aForm.document.strSelectedKeys;\n\t\t\t\tsResults.selectedpfskeys = app.g.pfs_keys(aForm.document.strSelectedKeys);\n\t\t\t\tsResults.selectedtext = aForm.document.strSelectedText;\n\t\t\t\tsResults.selectedother = aForm.document.strSelectedOther;\n\t\t\t\tsResults.selectedcmdbids = aForm.document.strSelectedCMDBIDs;\n\t\t\t\tsResults.selectedcompanyids = aForm.document.strSelectedCompIDs;\n\t\t\t\tsResults.strSearchedCompanyRedux = aForm.document.strSearchedCompanyRedux;\n\t\t\n    \t\t\tif(sResults.selectedkeys==\"\") \n    \t\t\t{\n \t\t\t\t\t_swdoc.boolResolvingCust = false;\n \t\t\t\t\t_swdoc.load_cis();\n   \t\t\t\t\treturn;\n    \t\t\t}\n    \t\t\tvar arrKey = sResults.selectedkeys.split(\",\");\n    \t\t\t_swdoc.ResolveRecord(\"userdb\", \"keysearch\", arrKey[0]);\n\t\t\n\t\t\t\t\/\/###20120601\t\n    \t\t\tif(\"\"!=sResults.strSearchedCompanyRedux){\n\t\t\t\t\t_swdoc.multi_c_set_company(sResults.strSearchedCompanyRedux);\n\t\t\t\t}\n\t\t\t\n\t\t\t\t_swdoc.boolResolvingCust = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t_swdoc.boolResolvingCust = false;\n \t\t\t\t_swdoc.load_cis();\n   \t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t});\t\n\t}\n\t\n\telse if(nTimer==2)\n\t{\n\t\tmainform.KillTimer(2);\n\t\tif(_swdoc.OC().probcode==\"\" && _swdoc.MF().tb_probcode.text ==\"\") \n\t\t{\n\t\t\tapp._ete(_swdoc.MF().tb_probcode,\"\");\n\t\t}\n\t}\n\t\n\telse if(nTimer==3)\n\t{\n\t\tmainform.KillTimer(3);\n\t\t_swdoc.load_cis();\n\t\treturn;\n\n\t}\n\telse if(nTimer==4)\n\t{\n\t\tmainform.KillTimer(4);\n\t\t_swdoc.boolChangeProfile=false;\n\n\t}\n\n}"},{"name":"lb_oc_slad1_OnValueChanged","code":"lb_oc_slad1_OnValueChanged(strValue)\n{\n\t_swdoc.boolIncSLASetManually=true;\n\t_swdoc.handle_set_sladef(strValue);\n\t\n\tif(_swdoc.OC().fk_contract_id==\"\")\n\t{\n\t\tvar slarec = app.g.get_sqrecordset(\"general\/get_itsm_sla\",\"kv=\"+strValue);\n\t\tif(slarec.Fetch())\n\t\t{\n\t\t\tvar intSLAId = app.g.get_field(slarec,\"pk_slad_id\");\n\t\t\tif(intSLAId!=\"\")\n\t\t\t\t_swdoc.handle_set_contract(intSLAId);\n\t\t}\n\t}\n\n}"},{"name":"lb_oc_sla_OnValueChanged","code":"lb_oc_sla_OnValueChanged(strValue)\n{\n\t_swdoc.handle_set_priority(strValue);\n\t\/\/ TODO: Add your event handler code here\n\tapp.g.fix_priority(_swdoc.OC().itsm_slaname, _swdoc.OC().priority, _swdoc);\n\n}"},{"name":"fld_cis_OnValueChanged","code":"fld_cis_OnValueChanged(strValue)\n{\n\n\t_swdoc.load_cis();\n\n}"},{"name":"tb_title_OnLeftClick","code":"tb_title_OnLeftClick()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.boolIncTitleSetManually=true;\n\n\treturn true;\n}"},{"name":"fld_bpm_workflow_OnValueChanged","code":"fld_bpm_workflow_OnValueChanged(strValue)\n{\n\t\/\/-- if title not set - set it to match workflow name\n\tif(!_swdoc.boolIncTitleSetManually)\n\t{\n\t\t_swdoc.OC().itsm_title=strValue;\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\tif(strValue==\"\")\n\t{\n\t\t_swdoc.ResetRecord(\"bpm_workflow\");\n\t\treturn false;\n\t}\n\t\n}"},{"name":"lb_contract_OnValueChanged","code":"lb_contract_OnValueChanged(strValue)\n{\n\n\t_swdoc.load_cis();\n\n\tapp.g.strLogAndResolveContract = strValue;\n\n}"},{"name":"Field3_OnValueChanged","code":"Field3_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tif(strValue==\"1\")\n\t{\n\t\/\/\t_swdoc.SetTitle(\"Log New Major Incident\");\n\t\tapp._ete(mainform.CaptionPanel7 , \"Log New Major Incident\");\n\t}\n\telse\n\t{\n\t\t\/\/_swdoc.SetTitle(\"Log New Incident\");\t\n\t\tapp._ete(mainform.CaptionPanel7 , \"Log New Incident\");\n\t}\n\t\n}"},{"name":"img_customer_OnLeftClick","code":"img_customer_OnLeftClick()\n{\n\t\/\/-- Open Related Customer Form if customer is selected\n\tif(_swdoc.oCust().keysearch!=\"\")\n\t\tapp.OpenFormForEdit(\"tfCustomer\", _swdoc.oCust().keysearch, \"\", false);\n\n\treturn true;\n}"},{"name":"fld_ci_filter_OnValueChanged","code":"fld_ci_filter_OnValueChanged(strValue)\n{\n\t\n\t_swdoc.load_cis();\n\n}"},{"name":"pl_oc_org_OnValueChanged","code":"pl_oc_org_OnValueChanged(strValue)\n{\n\n\t_swdoc.multi_c_set_company(strValue);\n\n}"},{"name":"lb_oc_site_OnValueChanged","code":"lb_oc_site_OnValueChanged(strValue)\n{\n\n\t_swdoc.load_cis();\n\n}"},{"name":"fld_environment_OnDropDown","code":"fld_environment_OnDropDown()\n{\n\t\/\/ ES - F0111761 - Ability to specify an environment within call forms\n     var strSimpleListId = \"ENVIRONMENT\";\n     var p = {};\n     p.id = strSimpleListId;\n     var dbValues = app.g.get_sqrecordset(\"GENERAL\/get.simple_list\", p);\n     var arrEnvironments = new Array();\n     var strEnvironments = \"\";\n     var splitResult = \"\";\n     var intCount = 0;\n     \/\/ Store ENVIRONMENT values from swlists in an array\n     while (dbValues.Fetch())\n     {\n          arrEnvironments[intCount] = app.g.get_field(dbValues, \"value\");\n          intCount++;          \n     }\n     var strTemp = \"\";\n     \/\/ Add | at the end of each value to set up the picklist\n     for (var i=0; i<arrEnvironments.length;i++)\n     {\n          strTemp = arrEnvironments[i];\n          splitResult = strTemp.split(\",\");\n          strEnvironments += splitResult[0];\n          strEnvironments += \"|\";\n     }\n     _swdoc.MF().fld_environment.pickList = strEnvironments;\n     \/\/ END - F0111761;\n\n\treturn true;\n}"},{"name":"fld_environment_OnValueChanged","code":"fld_environment_OnValueChanged(strValue)\n{\n\t_swdoc.opencall.environment = strValue;\n\n}"}]}}},"extendedLayout":{"appearance":{"width":"804","height":"600","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"sl_configitems","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:0"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"57","left":"16","right":"791","bottom":"582"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Configuration ID","width":"133","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"46","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_type"},"name":"Type","width":"126","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Description","width":"227","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"196","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"130","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"137","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"127","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"130","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"134","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_group"},"name":"Support Group","width":"130","image":"-1","dataColumn":"16"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_analyst"},"name":"Support Analyst","width":"120","image":"-1","dataColumn":"17"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sld"},"name":"SLD","width":"120","image":"-1","dataColumn":"17"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pk_auto_id=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"btn_search_ci","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"1","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"735","right":"791","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"mbtn_ici_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"2","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"675","right":"731","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"mbtn_ici_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:0"},"appearance":{"index":"3","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"615","right":"671","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Inventory^3|Child Dependencies^2|Parent Dependencies^5|Change Schedule^4|"}}},{"general":{"name":"sl_problems","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:2"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"57","left":"16","right":"791","bottom":"582"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"callclass"},"name":"Class","width":"92","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"9"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_prb_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"5","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"615","right":"671","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Details^1|"}}},{"general":{"name":"mbtn_prb_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"6","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"675","right":"731","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"mbtn_srch_prb","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:2"},"appearance":{"index":"7","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"735","right":"791","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"commands":"Standard Method^1|Recognition Method^2|Search against Affected Items^3|"}}},{"general":{"name":"sl_rfcs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:3"},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"57","left":"16","right":"791","bottom":"582"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"callref"},"name":"RFC Call Reference","width":"88","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"RFC Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_rfc_type"},"name":"RFC Type","width":"158","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_status"},"name":"RFC Status","width":"143","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"suppgroup"},"name":"Owned By Group","width":"123","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_workx"},"name":"Scheduled Work Date","width":"126","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary of Work","width":"247","image":"-1","dataColumn":"6"}]},"sortColumn":"4","sortDescending":"true","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"sqlSource":"swdata","table":"opencall","editRecordForm":"SystemForms.CallDetails","listFilter":"callref = -1","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_rfc_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"9","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"615","right":"671","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Details^1|"}}},{"general":{"name":"mbtn_rfc_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"10","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"675","right":"731","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_srch_rfc","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:3"},"appearance":{"index":"11","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"735","right":"791","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_incprofile","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"Tab1:3"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"70","left":"29","right":"779","bottom":"577"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"8"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"empty=1","sqlSource":"syscache","storedQuery":"request.incident.common.related_probcode"}}},{"general":{"name":"TabRel","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"13","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#f2eedd","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"12","left":"9","right":"799","bottom":"591"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Affected Configuration Items","properties":"56=#ffffff|58=#000000|59=#5f5f5f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","activeTextColor":"#000000","inactiveTextColor":"#5f5f5f"}}},{"name":"Affected Services","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Problem \/ Known Errors","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Change Requests","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Service Requests","properties":"56=#ffffff|59=#5f5f5f|58=#000000|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffffff","inactiveTextColor":"#5f5f5f","activeTextColor":"#000000"}}},{"name":"Knowledgebase Documents","properties":"56=#9abfb4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#9abfb4"}}},{"name":"Incidents","properties":"56=#f7b683|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f7b683"}}},{"name":"Major Incidents","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Child Incidents","properties":"56=#ffdb75|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#ffdb75"}}},{"name":"Knowledgebase Documents","properties":"56=#ffdb75|_flags=1","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"tabColor":"#ffdb75"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabStyle":"0"}}},{"general":{"name":"sl_site_incidents1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"Tab1:1"},"appearance":{"index":"14","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"70","left":"29","right":"779","bottom":"577"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Site","width":"189","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_name"},"name":"Customer","width":"157","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"probcode"},"name":"Profile","width":"120","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"11"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"empty=1","sqlSource":"swdata","storedQuery":"request.incident.common.related_inc_calls"}}},{"general":{"name":"sl_org_incidents1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"Tab1:2"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"70","left":"29","right":"779","bottom":"577"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Site","width":"189","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cust_name"},"name":"Customer","width":"198","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"141","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"probcode"},"name":"Profile","width":"120","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"11"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"empty=1","sqlSource":"swdata","storedQuery":"request.incident.common.related_inc_calls"}}},{"general":{"name":"Tab1","type":"TabControl","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:6"},"appearance":{"index":"16","caption":"Tab1","backgroundColor":"#ded7ce","foregroundColor":"#ffffff","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"41","left":"18","right":"788","bottom":"586"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"tabStyle":"Top","tabSize":"19","items":{"item":[{"name":"Customer's Incidents","properties":"56=#8aa8e4|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#8aa8e4"}}},{"name":"Site Incidents","properties":"56=#ffdb75|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#ffdb75"}}},{"name":"Organisation Incidents","properties":"56=#bdcd9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#bdcd9f"}}},{"name":"Same Profile","properties":"56=#f09e9f|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#f09e9f"}}},{"name":"Related","properties":"56=#baa6e1|_flags=0","textBorder":"None","textBackgroundColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"tabColor":"#baa6e1"}}}]},"selectedTextFont":{"@size":"8","#text":"Arial"},"selectedTextColor":"#000000","deselectedTextColor":"#000000","tabSlopeLeft":"2","tabSlopeRight":"2","deselectedTabHeightOffset":"1","tabSpacing":"0","controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_cust_incidents1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"Tab1:0"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"70","left":"29","right":"779","bottom":"577"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Site","width":"216","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"probcode"},"name":"Profile","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"empty=1","sqlSource":"swdata","storedQuery":"request.incident.common.related_inc_calls"}}},{"general":{"name":"sl_srs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:4"},"appearance":{"index":"18","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"57","left":"16","right":"791","bottom":"584"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Site","width":"216","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"probcode"},"name":"Profile","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_srs_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"19","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"615","right":"671","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Details^1|"}}},{"general":{"name":"mbtn_srs_actions","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"20","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"675","right":"731","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_srch_service","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:4"},"appearance":{"index":"21","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"735","right":"791","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_services","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:1"},"appearance":{"index":"22","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"57","left":"16","right":"791","bottom":"582"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ck_config_item"},"name":"Service ID","width":"133","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"pk_auto_id"},"name":"Auto ID","width":"46","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"description"},"name":"Service Name","width":"220","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"service_type"},"name":"Service Type","width":"120","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"catalog_type"},"name":"Service Category","width":"120","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_status_level"},"name":"Status","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"cmdb_status"},"name":"CMDB Status","width":"120","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_impact_level"},"name":"Impact Level","width":"108","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_urgency_level"},"name":"Urgency Level","width":"97","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sla"},"name":"Priority (SLA)","width":"144","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_profilecode"},"name":"Profile Code","width":"196","image":"-1","dataColumn":"10"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_userdb"},"name":"Owner ID","width":"130","image":"-1","dataColumn":"11"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_site"},"name":"Site","width":"137","image":"-1","dataColumn":"12"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_supplier"},"name":"Supplier","width":"127","image":"-1","dataColumn":"13"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_manufacturer"},"name":"Manufacturer","width":"130","image":"-1","dataColumn":"14"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_cost_center"},"name":"Charge Centre","width":"134","image":"-1","dataColumn":"15"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_group"},"name":"Support Group","width":"130","image":"-1","dataColumn":"16"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"ci_support_analyst"},"name":"Support Analyst","width":"120","image":"-1","dataColumn":"17"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"fk_sld"},"name":"fk_sld","width":"120","image":"-1","dataColumn":"18"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status_portfolio"},"name":"Portfolio Status","width":"120","image":"-1","dataColumn":"19"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status_lifecycle"},"name":"Lifecycle Status","width":"120","image":"-1","dataColumn":"20"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"config_itemi","editRecordForm":"Form.cmdb_popup_ci","newRecordForm":"Form.cmdb_popup_ci","listFilter":"pk_auto_id=-1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_ici_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"23","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"615","right":"671","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Properties^1|Child Dependencies^2|Parent Dependencies^5|Change Schedule^4|"}}},{"general":{"name":"mbtn_ici_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"24","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"675","right":"731","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_search_ci1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:1"},"appearance":{"index":"25","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"735","right":"791","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_majinc","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:7"},"appearance":{"index":"26","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"57","left":"16","right":"791","bottom":"584"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Site","width":"216","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"probcode"},"name":"Profile","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"sl_assinc","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:8"},"appearance":{"index":"27","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"57","left":"16","right":"791","bottom":"584"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Site","width":"216","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"probcode"},"name":"Profile","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_srs_actions1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:7"},"appearance":{"index":"28","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"675","right":"731","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_srch_service1","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:7"},"appearance":{"index":"29","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"735","right":"791","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"mbtn_srs_actions2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"30","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"675","right":"731","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_srch_service2","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:8"},"appearance":{"index":"31","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"735","right":"791","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_relincs","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"Tab1:4"},"appearance":{"index":"32","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"88","left":"29","right":"779","bottom":"577"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"CALLREF"},"name":"Call Reference","width":"105","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"h_formattedcallref"},"name":"Reference","width":"120","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_title"},"name":"Summary","width":"215","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"site"},"name":"Site","width":"216","image":"-1","dataColumn":"3"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"status"},"name":"Status","width":"90","image":"-1","dataColumn":"4"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"priority"},"name":"Priority (SLA)","width":"88","image":"-1","dataColumn":"5"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_impact_level"},"name":"Impact Level","width":"93","image":"-1","dataColumn":"6"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"false","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"itsm_urgency_level"},"name":"Urgency Level","width":"93","image":"-1","dataColumn":"7"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"probcode"},"name":"Profile","width":"120","image":"-1","dataColumn":"8"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"OWNER"},"name":"Owner","width":"81","image":"-1","dataColumn":"9"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"SUPPGROUP"},"name":"Support Group","width":"107","image":"-1","dataColumn":"10"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"opencall","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"callref = -1","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_srs_actions3","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:4"},"appearance":{"index":"33","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"66","left":"667","right":"723","bottom":"84"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_srch_service3","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:4"},"appearance":{"index":"34","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"66","left":"727","right":"783","bottom":"84"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"sl_kbs1","type":"SqlTable","flags":{"transparent":"false","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"true"},"group":"TabRel:5"},"appearance":{"index":"35","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"59","left":"16","right":"791","bottom":"584"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docref"},"name":"Document Reference","width":"203","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"title"},"name":"Title","width":"334","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docstatus"},"name":"Status","width":"120","image":"-1","dataColumn":"2"}]},"sortColumn":"2","sortDescending":"false","headerHeight":"16","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"table":"swkb_articles","editRecordForm":"SystemForms.CallDetails","newRecordForm":"Form.frmConfigItem","listFilter":"docref=''","sqlSource":"swdata","storedQuery":"common.extendedform.tabledata"}}},{"general":{"name":"mbtn_inc_views2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:5"},"appearance":{"index":"36","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"615","right":"671","bottom":"55"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Document Details^1|"}}},{"general":{"name":"mbtn_inc_actions2","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:5"},"appearance":{"index":"37","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"675","right":"731","bottom":"55"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"btn_search_inc2","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:5"},"appearance":{"index":"38","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"735","right":"791","bottom":"55"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"mbtn_inc_views","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"Tab1:4"},"appearance":{"index":"39","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"66","left":"607","right":"663","bottom":"84"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Details^1|"}}},{"general":{"name":"mbtn_rfc_views1","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:7"},"appearance":{"index":"40","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"35","left":"615","right":"671","bottom":"53"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Details^1|"}}},{"general":{"name":"btn_search_inc3","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:9"},"appearance":{"index":"41","caption":"Search","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"735","right":"791","bottom":"55"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"name":"mbtn_inc_actions3","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:9"},"appearance":{"index":"42","caption":"Actions","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"675","right":"731","bottom":"55"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Remove From Incident^1|"}}},{"general":{"name":"mbtn_inc_views3","type":"MenuButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"},"group":"TabRel:9"},"appearance":{"index":"43","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"615","right":"671","bottom":"55"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"commands":"Document Details^1|"}}},{"general":{"name":"sl_rakb","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"true","horizontalGridLines":"true","autoLoad":"false","allowMultiSelect":"false"},"group":"TabRel:9"},"appearance":{"index":"44","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"59","left":"16","right":"791","bottom":"584"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"docref"},"name":"Document Reference","width":"203","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"column":"title"},"name":"Title","width":"567","image":"-1","dataColumn":"1"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#00008b","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000","sqlSource":"swdata","table":"rakb_articles","listFilter":"docref='-1'","storedQuery":"common.extendedform.tabledata"}}}]},"javascript":{"methods":{"method":[{"name":"btn_srch_rfc_OnPressed","code":"btn_srch_rfc_OnPressed()\n{\n\tvar strURL = \"canreset=1\";\n\tapp.itsm.search_calls(\"RFC\",strURL,true,function(sResults)\n\t{\n    \tif(sResults.selectedkeys==\"\") return;\n    \tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_rfcs, sResults.selectedkeys,\"callref\");\n    \t_swdoc.EF().sl_rfcs.Refresh();\n    });\n}"},{"name":"mbtn_rfc_actions_OnMenuItem","code":"mbtn_rfc_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(_swdoc.EF().sl_rfcs,_swdoc.EF().sl_rfcs_OnItemSelected,0);\n\t\t\tbreak;\n\t}\n\n\n\n}"},{"name":"mbtn_rfc_views_OnMenuItem","code":"mbtn_rfc_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\t_swdoc.EF().sl_rfcs.EditRecord(_swdoc.EF().sl_rfcs.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"btn_search_ci_OnPressed","code":"btn_search_ci_OnPressed()\n{\n    \/\/-- NWJ 08.03.2004\n    \/\/-- open CI search form in select mode\n\n\n\tvar strURL = \"canreset=1&fk_company_id=\" + app.pfu(_swdoc.oCompany().pk_company_id);\n\tapp.cmdb.search_ci(true,strURL,function(sResults)\n\t{\n\t\tif (sResults.selectedkeys==\"\") return;\n  \t\tvar strType = sResults.selectedtypes;\n  \t\tif(strType.indexOf(\"Service\")>-1)\n  \t\t{\n  \t\t\tvar strServiceKeys = \"\";\n  \t\t\tvar strKeys = \"\";\n  \t\t\tvar arrTypes = strType.split(\",\");\n  \t\t\tvar arrKeys = sResults.selectedkeys.split(\",\");\n  \t\t\t\n  \t\t\tfor(var x in arrKeys)\n  \t\t\t{\n  \t\t\t\tvar strThisType = arrTypes[x];\n  \t\t\t\tif(strThisType.indexOf(\"Service\")>-1)\n  \t\t\t\t{\n  \t\t\t\t\tif(strServiceKeys!=\"\")\n  \t\t\t\t\t\tstrServiceKeys+=\",\";\n  \t\t\t\t\tstrServiceKeys += arrKeys[x];\n  \t\t\t\t}else\n  \t\t\t\t{\n  \t\t\t\t\tif(strKeys!=\"\")\n  \t\t\t\t\t\tstrKeys+=\",\";\n  \t\t\t\t\tstrKeys += arrKeys[x];\n  \t\t\t\t}\n  \t\t\t}\n  \t\t\tif(strKeys!=\"\")\n  \t\t\t\tapp.g.sl_kv_appendfilter(sl_configitems, strKeys,'pk_auto_id');\n  \t\t\tif(strServiceKeys!=\"\")\n  \t\t\t\tapp.g.sl_kv_appendfilter(sl_services, strServiceKeys,'pk_auto_id');\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t \t\/\/ -- SG, 21\/08\/2012, F0103324\n    \t\t\/\/ Output Bespoke Terms for selected CI's, where appropriate\n\t\t\tapp.bespokeTermsProcessing(sResults.selectedkeys);\t\n    \t\t\/\/END OF BESPOKE TERMS PROCESSING\n    \t\t\n  \t\t\tapp.g.sl_kv_appendfilter(sl_configitems, sResults.selectedkeys,'pk_auto_id');\n  \t\t\t\n  \t\t\t\/\/ES - F0111753 - set Process based on value set in Configuration Item and Configuration Type\n\t\t\tvar dbValue1 = new SqlQuery;\n\t\t\tvar dbValue2 = new SqlQuery;\n\t\t\tvar arrKeys = sResults.selectedkeys.split(\",\");\n\t\t\tvar arrWorkflowId = new Array();\n\t\t\t\/\/ Grab value of fk_workflow_id for each selected Configuration Item from config_itemi or from config_typi where itemi is blank\n\t\t\tfor(var x in arrKeys)\n  \t\t\t{\n\t\t\t\tdbValue1.InvokeStoredQuery(\"cmdb\/get.itemi_fkworkflowid\",\"pk_auto_id=\"+arrKeys[x]);\n\t\t\t\tif(dbValue1.Fetch())\n\t\t\t\t{\n\t\t\t\t\tif (app.g.get_field(dbValue1,\"fk_workflow_id\")!=\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\tarrWorkflowId[x] = app.g.get_field(dbValue1,\"fk_workflow_id\");\n\t\t\t\t\t}\n\t\t\t\t\telse if (app.g.get_field(dbValue1,\"fk_workflow_id\")==\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\tdbValue2.InvokeStoredQuery(\"cmdb\/get.typei_fkworkflowid\",\"pk_auto_id=\"+arrKeys[x]);\n\t\t\t\t\t\tif (dbValue2.Fetch())\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (app.g.get_field(dbValue2,\"fk_workflow_id\")!=\"\")\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tarrWorkflowId[x] = app.g.get_field(dbValue2,\"fk_workflow_id\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/ Remove blank or undefined elements from the array\n\t\t\tfor (var check in arrWorkflowId)\n\t\t\t{\n\t\t\t\tif (arrWorkflowId[check]==\"undefined\" || arrWorkflowId[check]==\"\")\n\t\t\t\t{\n\t\t\t\t\tvar index = arrWorkflowId.indexOf(check);\n\t\t\t\t\tarrWorkflowId.splice(index,1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar arrayLength = arrWorkflowId.length;\n\t\t\tvar position = 0;\n\t\t\t\/\/ Set Process field based on fk_workflow_id value\n\t\t\tfor (var y in arrWorkflowId)\n\t\t\t{\n\t\t\t\tvar intIncrement = 0;\n\t\t\t\twhile (intIncrement < arrayLength)\n\t\t\t\t{\n\t\t\t\t\tif ((arrWorkflowId[y] == arrWorkflowId[intIncrement] && (intIncrement!=position)) || arrayLength == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id==\"\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = arrWorkflowId[y];\n\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (_swdoc.bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id!=arrWorkflowId[y])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar msgProcess = MessageBox(\"The default Incident Process for the selected item is [\" + arrWorkflowId[y] + \"]. Would you like to apply this change?\",MB_YESNO|MB_ICONQUESTION);\n \t\t\t\t\t\t\t\tif (msgProcess==6)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = arrWorkflowId[y];\n\t\t\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\tintIncrement++;\n\t\t\t\t}\n\t\t\t\tposition++;\n\t\t\t}\/\/END - F0111753\n  \t\t}  \n\t\t\/\/-- if only 1 CI use it default profile unless blank\n\t\tif(sl_configitems.rowCount()==1)\n\t\t{\n\t\t\tvar strCode = app.g.sl_getrawcolvalue(sl_configitems,0,\"fk_profilecode\");\n\t\t\tif(strCode!=\"\") \n\t\t\t{\n\t\t\t\t_swdoc.OC().probcode = strCode;\t\t\t\t\n\t\t\t\t_swdoc.UpdateFormFromData();\t\t\n\t\t\t}\n\t\t}\n\t    \t\n\t\t\/\/-- NWJ - determine who the preferred support is\n \t\t_swdoc.determine_prefered_support(true);\n \t\t\n \t\t\/\/PM00132039\n \t\tsl_configitems.Refresh();\n\t\t_swdoc.MF().sl_cust_cis.Refresh();\n \t\t\/\/END PM00132039\n \t\t\n \t\t\/\/-- nwj - 15.07.2008 - check ci contract\n\t\tapp.cfg.process_call_contract_check( sResults.selectedkeys, true,_swdoc);\n\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n\t});\n}"},{"name":"mbtn_ici_actions_OnMenuItem","code":"mbtn_ici_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"\";\n\t\tfor (var x=_swdoc.EF().sl_configitems.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tvar value = _swdoc.EF().sl_configitems.GetItemTextRaw(x,\"pk_auto_id\");\t\t\n\t\t\tif (!_swdoc.EF().sl_configitems.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter +=value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- 29.04.2008 - 2.2.0 if this ci that has been removed was used to set the pref supp group then change it\n\t\t\t\tif(_swdoc.intAssessmentCI == value)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(strFilter!=\"\")\n\t\t\tstrFilter=\"_kv=\"+strFilter;\n\n       app._slf(_swdoc.EF().sl_configitems, strFilter);  \n       _swdoc.EF().sl_configitems.Refresh();\n       _swdoc.EF().sl_configitems.SetRowSelected(0);\n\t   _swdoc.check_ci_assessment();\n\t   _swdoc.uncheckset_customer_items();\n       return;\n\t}\n       \n}"},{"name":"mbtn_ici_views_OnMenuItem","code":"mbtn_ici_views_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMchildren = 2;\t\n\tvar iVCMparents = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_configitems,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_configitems,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMchildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\n\t\telse if(nItemID == iVCMparents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_srch_prb_OnMenuItem","code":"mbtn_srch_prb_OnMenuItem(strName, nItemID)\n{\n\tvar iNormal = 1;\n\tvar iAPR = 2;\n\tvar iCIs = 3;\n\t\n\tswitch(nItemID)\n\t{\n    \tcase iNormal:\n   \t\t\tvar strURL = \"canreset=1\";    \t\n    \t\tapp.itsm.search_calls(\"PRB\", strURL,true,function(sResults)\n    \t\t{\n    \t\t\tif(sResults.selectedkeys==\"\") return;\t\n\t\t\t\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_problems, sResults.selectedkeys,\"callref\");\n\t\t\t\t_swdoc.EF().sl_problems.Refresh();\n    \t\t});\n\t\t\tbreak;\n    \tcase iAPR:\n   \t\t\tapp.g.search_for(\"apr\",true,\"\",function(sResults)\n   \t\t\t{\n   \t\t\t\tif(sResults.selectedkeys==\"\") return;\t\n\t\t\t\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_problems, sResults.selectedkeys,\"callref\");\n\t\t\t\t_swdoc.EF().sl_problems.Refresh();\n   \t\t\t});\n\t\t\tbreak;\t\t\t\n\t   \tcase iCIs:\t\n\t\t{\t\n\t\t\tvar strCIKeys = app.g.sqllist_get_valuesdel(sl_configitems, 'pk_auto_id', \",\", \"\");\n\t\t\tvar strServiceKeys = app.g.sqllist_get_valuesdel(sl_services, 'pk_auto_id', \",\", \"\");\n\t\t\tif(strServiceKeys!=\"\")\n\t\t\t{\n\t\t\t\tif(strCIKeys!=\"\")strCIKeys+=\",\";\n\t\t\t\tstrCIKeys+=strServiceKeys;\n\t\t\t}\n  \t\t\tvar strURL = \"canreset=1\";\n  \t\t\tif(strCIKeys!=\"\")\n  \t\t\t{\n  \t\t\t\tstrURL += \"&ci_keys=\"+strCIKeys;\n  \t\t\t}\n    \t\tapp.itsm.search_calls(\"PRB\",strURL,true,function(oResults)\n    \t\t{\n    \t\t\tif(oResults.selectedkeys==\"\") return;\t\n\t\t\t\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_problems, oResults.selectedkeys,\"callref\");\n\t\t\t\t_swdoc.EF().sl_problems.Refresh();\t\n    \t\t});\n    \t\tbreak;\t\n\t\t}\t\t\n\t}\n\n}"},{"name":"mbtn_prb_actions_OnMenuItem","code":"mbtn_prb_actions_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(_swdoc.EF().sl_problems,sl_problems_OnItemSelected,0);\n\t\t\tbreak;\n\t}\n\n\n}"},{"name":"mbtn_prb_views_OnMenuItem","code":"mbtn_prb_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\t_swdoc.EF().sl_problems.EditRecord(_swdoc.EF().sl_problems.curSel);\n\t\t\tbreak;\n\t}\n\n\n}"},{"name":"sl_problems_OnItemSelected","code":"sl_problems_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_problems.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_problems);\t\n\tapp._een(mbtn_prb_views, (selCount==1));\n\tapp._een(mbtn_prb_actions, boolActive);\n\n\n}"},{"name":"sl_rfcs_OnItemSelected","code":"sl_rfcs_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_rfcs.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rfcs);\t\n\tapp._een(mbtn_rfc_views, (selCount==1));\n\tapp._een(mbtn_rfc_actions, boolActive);\n\n\n}"},{"name":"sl_configitems_OnItemSelected","code":"sl_configitems_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_configitems.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_configitems);\t\n\tapp._een(mbtn_ici_views,(selCount==1));\n\tapp._een(mbtn_ici_actions, boolActive);\n\n\n}"},{"name":"sl_configitems_OnHeaderItemClicked","code":"sl_configitems_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_configitems.Refresh();\n\n\n}"},{"name":"sl_problems_OnHeaderItemClicked","code":"sl_problems_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_problems.Refresh();\n\n\n}"},{"name":"sl_rfcs_OnHeaderItemClicked","code":"sl_rfcs_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_rfcs.Refresh();\n\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded()\n{\n\t\/\/-- NWJ - 28.02.2006\n\t\/\/--      get any incoming cis\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems, _swdoc.OC().callref ,\"INCOMING\",\"cis_excludeservice\");\t\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_services, _swdoc.OC().callref ,\"INCOMING\",\"cis_servicesonly\");\t\n\t\n\t\/\/-- load CIs if call has been logged from another incident\t\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_configitems, _swdoc.OC().callref ,\"INCIDENT\",\"cis_excludeservice\");\t\n\tapp.cmdb.sl_load_call_cis(_swdoc.EF().sl_services, _swdoc.OC().callref ,\"INCIDENT\",\"cis_servicesonly\");\t\n\t\n\t\n\t\n\t_swdoc.hideshow_majorincstab();\n\t\n\t\/\/-- Show appropriate KB Tab\n\tvar tTab = _swdoc.EF().TabRel.tab;\n\tif(!app.g.use_sw_knowledgebase())\n\t{\n\t\tif(app.strKnowledgebaseDefaultTool.toLowerCase()==\"rightanswers\")\n\t\t{\n\t\t\t_swdoc.EF().TabRel.ShowTabItem(9,true);\n\t\t\t_swdoc.EF().TabRel.ShowTabItem(5,false);\n\t\t\tapp._etab(_swdoc.EF().TabRel, tTab);\n\t\t}\n\t}\n\telse\n\t{\n\t\t_swdoc.EF().TabRel.ShowTabItem(9,false);\n\t\t_swdoc.EF().TabRel.ShowTabItem(5,true);\n\t\tapp._etab(_swdoc.EF().TabRel, tTab);\n\t}\n\t\t\n}"},{"name":"sl_srs1_OnItemSelected","code":"sl_srs1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_srs1.rowCount() > 0);\n\tvar selCount = app.g.sl_getselected_count(sl_srs1);\t\t\n\tapp._een(mbtn_srs_views , (selCount==1));\n\tapp._een(mbtn_srs_actions , boolActive);\n\n}"},{"name":"mbtn_srs_views_OnMenuItem","code":"mbtn_srs_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\t_swdoc.EF().sl_srs.EditRecord(_swdoc.EF().sl_srs.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"mbtn_srs_actions_OnMenuItem","code":"mbtn_srs_actions_OnMenuItem(strName, nItemID)\n{\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(_swdoc.EF().sl_srs,_swdoc.EF().sl_srs_OnItemSelected,0);\n\t\t\tbreak;\n\t}\n\n\n\n}"},{"name":"btn_srch_service_OnPressed","code":"btn_srch_service_OnPressed()\n{\n\tvar strURL = \"canreset=1\";\n    app.itsm.search_calls(\"SR\",strURL,true,function(sResults)\n    {\n    \tif(sResults.selectedkeys==\"\") return;\n    \tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_srs, sResults.selectedkeys,\"callref\");\n    \t_swdoc.EF().sl_srs.Refresh();\n    });\n}"},{"name":"sl_srs_OnItemSelected","code":"sl_srs_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_srs.rowCount() > 0);\n\tvar selCount = app.g.sl_getselected_count(sl_srs);\t\t\n\tapp._een(mbtn_srs_views, (selCount==1));\n\tapp._een(mbtn_srs_actions, boolActive);\n}"},{"name":"sl_configitems1_OnItemSelected","code":"sl_configitems1_OnItemSelected(nRow)\n{\n\t\/\/-- NWJ\n\t\/\/-- 27.11.2006\n\t\/\/-- enable list menus if an item is selected\t\n\tvar boolActive = (sl_configitems1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_configitems1);\t\n\tapp._een(mbtn_ici_views1 , (selCount==1));\n\tapp._een(mbtn_ici_actions1 , boolActive);\n\n\n}"},{"name":"sl_configitems1_OnHeaderItemClicked","code":"sl_configitems1_OnHeaderItemClicked(strOrder, nCol)\n{\n\tsl_configitems1.Refresh();\n\n\n}"},{"name":"mbtn_ici_views1_OnMenuItem","code":"mbtn_ici_views1_OnMenuItem(strName, nItemID)\n{\n  \n\tvar iProperties = 1;\n\tvar iVCMchildren = 2;\t\n\tvar iVCMparents = 5;\t\t\n\tvar iInventory = 3;\n\tvar iChangeSchedule = 4;\n\t\n\t\/\/-- get intCI\n  \tvar intCI = app.g.sl_getrawcolvalue(sl_services,-1,\"pk_auto_id\");\n  \tif(intCI>0)\n  \t{\n  \t\t\/\/-- pass in text identfier as well\n  \t\tvar strItem = app.g.sl_getrawcolvalue(sl_services,-1,\"ck_config_item\");\n  \t\n\t\tif(nItemID == iProperties)\n\t\t{\n\t\t\tapp.cmdb.popup_configitem(intCI,true,\"\",false,function()\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t});\n    \t}\n\t\telse if(nItemID == iVCMchildren)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,false);\n\t\t}\n\t\telse if(nItemID == iVCMparents)\n\t\t{\n\t\t\tapp.cmdb.view_vcm(intCI,true);\n\t\t}\n\n\t\telse if(nItemID == iInventory)\n\t\t{\n\t\t\tapp.cmdb.view_inventory(intCI,strItem);\n\t\t}\n\t\telse if(nItemID == iChangeSchedule)\n\t\t{\n\t\t\tapp.cmdb.view_schedule(intCI,strItem);\n\t\t}\n\t}\n}"},{"name":"mbtn_ici_actions1_OnMenuItem","code":"mbtn_ici_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iRemoveCI = 1;\n\n\t\/\/-- Remove Selected config items\n\tif(nItemID == iRemoveCI)\n\t{\n   \t\n\t\t\/\/-- do this by finding unselected rows and making sure they are part of fitler\n\t\tvar strFilter = \"\";\n\t\tfor (var x=_swdoc.EF().sl_services.rowCount()-1;x > -1;x--)\n\t\t{\n\t\t\tvar value = _swdoc.EF().sl_services.GetItemTextRaw(x,\"pk_auto_id\");\t\t\n\t\t\tif (!_swdoc.EF().sl_services.IsRowSelected(x))\n\t\t\t{\n\t\t\t\t\/\/-- add to filter\n\t\t\t\tif (value != \"\")\n\t\t\t\t{\n    \t\t\t\tif (strFilter != \"\") strFilter +=\",\";\n    \t\t\t\tstrFilter += value;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\t\/\/-- 29.04.2008 - 2.2.0 if this ci that has been removed was used to set the pref supp group then change it\n\t\t\t\tif(_swdoc.intAssessmentCI == value)\n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().itsm_prefered_suppgroup = \"\";\n\t\t\t\t\t_swdoc.OC().itsm_prefered_text = \"\";\n\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(strFilter!=\"\")\n\t\t\tstrFilter=\"_kv=\"+strFilter;\n\n       app._slf(_swdoc.EF().sl_services, strFilter);  \n       _swdoc.EF().sl_services.Refresh();\n       _swdoc.EF().sl_services.SetRowSelected(0);\n\t   _swdoc.check_ci_assessment();\n\t   _swdoc.uncheckset_customer_items();\n       return;\n\t}\n       \n}"},{"name":"btn_search_ci1_OnPressed","code":"btn_search_ci1_OnPressed()\n{\n    \/\/ -- JPG, 22\/01\/2014\n    \/\/ It is redefined the mode for the new window\n    var strURL = \"searchmode=1&multiselect=1&canreset=1&fk_company_id=\" + app.pfu(_swdoc.oCust().fk_company_id);\n    \/\/ It is defined the next window to execute, searching services with better filters\n    app.g.popup(\"manage_portfolio\", strURL, function(sResults)\n    {\n    \tif (sResults)\n    \t{\n    \t\t\/\/ Case there are not any selection go back\n    \t\tif (sResults.document.strSelectedKeys==\"\") return;\n  \t\t\t\n  \t\t\t\n  \t\t\t\/\/ -- JPG, 22\/01\/2015\n    \t\t\/\/ Present Bespoke Terms for selected Services\n    \t\tapp.bespokeTermsProcessing(sResults.document.strSelectedKeys, \"Configuration Item\");\n    \t\t\/\/ END OF BESPOKE TERMS PROCESSING  \t\n   \t           \t\t\t\n   \t\t\tapp.g.sl_kv_appendfilter(sl_services, sResults.document.strSelectedKeys,'pk_auto_id');\n   \t\t\n   \t\t\t\/\/ES - F0111753 - set Process based on value set in Configuration Item and Configuration Type\n\t\t\tvar dbValue = new SqlQuery;\n\t\t\tvar arrKeys = sResults.document.strSelectedKeys.split(\",\");\n\t\t\tvar arrWorkflowId = new Array();\n\t\t\t\/\/ Grab value of fk_workflow_id for each selected Configuration Item\n\t\t\tfor(var x in arrKeys)\n  \t\t\t{\n\t\t\t\tdbValue.InvokeStoredQuery(\"cmdb\/get.itemi_fkworkflowid\",\"pk_auto_id=\"+arrKeys[x]);\n\t\t\t\tif(dbValue.Fetch())\n\t\t\t\t{\n\t\t\t\t\tif (app.g.get_field(dbValue,\"fk_workflow_id\")!=\"\")\n\t\t\t\t\t{\n\t\t\t\t\t\tarrWorkflowId[x] = app.g.get_field(dbValue,\"fk_workflow_id\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t\/\/ Remove blank or undefined elements from the array\n\t\t\tfor (var check in arrWorkflowId)\n\t\t\t{\n\t\t\t\tif (arrWorkflowId[check]==\"undefined\" || arrWorkflowId[check]==\"\")\n\t\t\t\t{\n\t\t\t\t\tvar index = arrWorkflowId.indexOf(check);\n\t\t\t\t\tarrWorkflowId.splice(index,1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar arrayLength = arrWorkflowId.length;\n\t\t\tvar position = 0;\n\t\t\t\/\/ Set Process field based on fk_workflow_id value\n\t\t\tfor (var y in arrWorkflowId)\n\t\t\t{\n\t\t\t\tvar intIncrement = 0;\n\t\t\t\twhile (intIncrement < arrayLength)\n\t\t\t\t{\n\t\t\t\t\tif ((arrWorkflowId[y] == arrWorkflowId[intIncrement] && (intIncrement!=position)) || arrayLength == 1)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id==\"\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = arrWorkflowId[y];\n\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse if (_swdoc.bpm_workflow.pk_workflow_id!=\"\")\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (_swdoc.bpm_workflow.pk_workflow_id!=arrWorkflowId[y])\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tvar msgProcess = MessageBox(\"The default Incident Process for the selected item is [\" + arrWorkflowId[y] + \"]. Would you like to apply this change?\",MB_YESNO|MB_ICONQUESTION);\n \t\t\t\t\t\t\t\tif (msgProcess==6)\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t_swdoc.bpm_workflow.pk_workflow_id = arrWorkflowId[y];\n\t\t\t\t\t\t\t\t\t_swdoc.UpdateFormFromData();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\tintIncrement++;\n\t\t\t\t}\n\t\t\t\tposition++;\n\t\t\t}\n\t\t\t\/\/END - F0111753\n  \t\t\n\t\t\t\/\/-- if only 1 CI use it default profile unless blank\n\t\t\tif(sl_services.rowCount()==1)\n\t\t\t{\n\t\t\t\tvar strCode = app.g.sl_getrawcolvalue(sl_services,0,\"fk_profilecode\");\n\t\t\t\tif(strCode!=\"\") \n\t\t\t\t{\n\t\t\t\t\t_swdoc.OC().probcode = strCode;\t\t\t\t\n\t\t\t\t\t_swdoc.UpdateFormFromData();\t\t\n\t\t\t\t}\n\t\t\t}\n\t    \t\t\n\t\t\t\/\/-- NWJ - determine who the preferred support is\n \t\t\t_swdoc.determine_prefered_support(true);\n \t\t\t\n \t\t\t\n \t\t\t\/\/-- JPG, 22.01.2015 - check ci contract\n\t\t\tapp.cfg.process_call_contract_check( sResults.document.strSelectedKeys, true,_swdoc);\n\t\t\n\t\t\tsl_services.Refresh();\n\t\t\t_swdoc.MF().sl_cust_cis.Refresh();\n\t\t\tapp.g.setSLAFromRules(_swdoc.strSLACallClass, _swdoc);\n    \t}\n    \telse\n    \t{\n    \t\treturn;\n    \t}\n    });\n}"},{"name":"sl_services_OnItemSelected","code":"sl_services_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_services.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_services);\t\n\tapp._een(mbtn_ici_views1, (selCount==1));\n\tapp._een(mbtn_ici_actions1, boolActive);\n\n\n}"},{"name":"OnShowWindow","code":"OnShowWindow(bShow)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.hideshow_majorincstab();\n\n\n}"},{"name":"mbtn_srs_actions1_OnMenuItem","code":"mbtn_srs_actions1_OnMenuItem(strName, nItemID)\n{\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(_swdoc.EF().sl_majinc,_swdoc.EF().sl_majinc_OnItemSelected,0);\n\t\t\tbreak;\n\t}\n\n\n\n}"},{"name":"btn_srch_service1_OnPressed","code":"btn_srch_service1_OnPressed()\n{\n   \tvar strURL = \"canreset=1\";\n    app.itsm.search_calls(\"MAJINC\",strURL,true,function(sResults)\n    {\n    \tif(sResults.selectedkeys==\"\") return;\n\t\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_majinc, sResults.selectedkeys,\"callref\");\n\t\t_swdoc.EF().sl_majinc.Refresh();\n    });\n}"},{"name":"mbtn_srs_actions2_OnMenuItem","code":"mbtn_srs_actions2_OnMenuItem(strName, nItemID)\n{\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(_swdoc.EF().sl_assinc,_swdoc.EF().sl_assinc_OnItemSelected,0);\n\t\t\tbreak;\n\t}\n\n\n\n}"},{"name":"btn_srch_service2_OnPressed","code":"btn_srch_service2_OnPressed()\n{\n   \tvar strURL = \"canreset=1\";\n    app.itsm.search_calls(\"INC\",strURL,true,function(sResults)\n    {\n    \tif(sResults.selectedkeys==\"\") return;\n    \tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_assinc, sResults.selectedkeys,\"callref\");\n   \t\t_swdoc.EF().sl_assinc.Refresh();\n    });\n}"},{"name":"sl_majinc_OnItemSelected","code":"sl_majinc_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_majinc.rowCount() > 0);\n\tapp._een(mbtn_srs_actions1, boolActive);\n\n\tvar selCount = app.g.sl_getselected_count(sl_majinc);\t\n\tapp._een(mbtn_rfc_views1, (selCount==1));\n\n}"},{"name":"sl_assinc_OnItemSelected","code":"sl_assinc_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_assinc.rowCount() > 0);\n\tapp._een(mbtn_srs_actions2, boolActive);\n\n\n}"},{"name":"sl_majinc1_OnItemSelected","code":"sl_majinc1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_majinc1.rowCount() > 0);\n\tapp._een(mbtn_srs_actions3 , boolActive);\n\n\n}"},{"name":"mbtn_srs_actions3_OnMenuItem","code":"mbtn_srs_actions3_OnMenuItem(strName, nItemID)\n{\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(_swdoc.EF().sl_relincs,_swdoc.EF().sl_relincs_OnItemSelected,0);\n\t\t\tbreak;\n\t}\n\n\n\n}"},{"name":"btn_srch_service3_OnPressed","code":"btn_srch_service3_OnPressed()\n{\n\tvar strURL = \"canreset=1\";\n\tapp.itsm.search_calls(\"INC\",strURL,true,function(sResults)\n\t{\n\t\tif(sResults.selectedkeys==\"\") return;\n\t\n\t\tapp.g.sl_kv_appendfilter(_swdoc.EF().sl_relincs, sResults.selectedkeys,\"callref\");\n\t\t_swdoc.EF().sl_relincs.Refresh();\n\t});\n}"},{"name":"sl_relincs_OnItemSelected","code":"sl_relincs_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_relincs.rowCount() > 0);\n\tvar selCount = app.g.sl_getselected_count(sl_relincs);\t\n\tapp._een(mbtn_srs_actions3, boolActive);\n\tapp._een(mbtn_inc_views, (selCount==1));\n\n}"},{"name":"sl_kbs1_OnItemSelected","code":"sl_kbs1_OnItemSelected(nRow)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolActive = (sl_kbs1.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_kbs1);\t\n\tapp._een(mbtn_inc_views2, (selCount==1));\n\tapp._een(mbtn_inc_actions2, boolActive);\n\n\n\n}"},{"name":"sl_kbs1_OnItemDoubleClicked","code":"sl_kbs1_OnItemDoubleClicked(nRow, nCol)\n{\n\t\/\/ TODO: Add your event handler code here\n\t\/\/var strKeyValue = app.g.sl_getcolvalue(sl_kbs1, nRow, \"docref\");\n\t\/\/app.OpenFormForEdit(\"kb_docadd\", \"\", \"docref=\"+strKeyValue, false);\n\t\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_kbs1, sl_kbs1.curSel, \"docref\");\n\tapp.oKB.open_article_form(strKeyValue);\n\n\n}"},{"name":"mbtn_inc_views2_OnMenuItem","code":"mbtn_inc_views2_OnMenuItem(strName, nItemID)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_kbs1, sl_kbs1.curSel, \"docref\");\n\tapp.oKB.open_article_form(strKeyValue);\n}"},{"name":"mbtn_inc_actions2_OnMenuItem","code":"mbtn_inc_actions2_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\tvar iLinkCauseCI = 2;\n\tvar iLinkImpactCI = 3;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\t\/\/-- get select incidents\n\t\t\t\/\/var strSelectedIncs = app.g.sl_getselected_valuesdel(sl_kbs1,0,\",\",\"\");\n\t\t\tapp.g.sl_clearselected(sl_kbs1,null,0);\t\t\t\n\t\t\t\/\/_swdoc.remove_selected_incident_cis(strSelectedIncs);\n\t\t\tbreak;\n\t}\n\n}"},{"name":"btn_search_inc2_OnPressed","code":"btn_search_inc2_OnPressed()\n{\n    app.g.search_for(\"swkb\", true,\"\",function(oRes)\n    {\n    \tvar strKeys = oRes.selectedkeys;\n\t\tif(strKeys==\"\")return;\n\t\tvar arrKeys = strKeys.split(\",\");\n\t\tfor (var x=0; x< arrKeys.length;x++)\n\t\t{\n\t\t\tvar fk_key = arrKeys[x];\n\t\t\tif(app.g.sl_findrow_byvalue(sl_kbs1,fk_key,\"docref\")==-1)\n\t\t\t{\n\t\t\t\tapp.g.sqllist_kv_appendfilter(sl_kbs1, fk_key, \"docref\");\t\t\n\t\t\t}\n\t\t}\n\t\tsl_kbs1.Refresh();\n\t\tsl_kbs1.SetRowSelected(0);\n\t\tsl_kbs1_OnItemSelected(0);\n\t\treturn;\n    });\n}"},{"name":"mbtn_inc_views_OnMenuItem","code":"mbtn_inc_views_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\t_swdoc.EF().sl_relincs.EditRecord(_swdoc.EF().sl_relincs.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"mbtn_rfc_views1_OnMenuItem","code":"mbtn_rfc_views1_OnMenuItem(strName, nItemID)\n{\n\tvar iDetails = 1;\n\tswitch (nItemID)\n\t{\n\t\tcase iDetails:\n\t\t\t_swdoc.EF().sl_majinc.EditRecord(_swdoc.EF().sl_majinc.curSel);\n\t\t\tbreak;\n\t}\n}"},{"name":"btn_search_inc3_OnPressed","code":"btn_search_inc3_OnPressed()\n{\n   if(!app.g.use_sw_knowledgebase())\n\t\t\t{\n\t\t\t\tapp.allocatekbdoc(_swdoc._kbidentifier,_swdoc);\n\t\t\t\tapp.g.open_third_party_kb_search(true, \"\",\"\",app.g.sl_get_valuesdel(_swdoc.EF().sl_rakb,0,\",\"), _swdoc._kbidentifier);\n\t}\n\t_swdoc.EF().sl_rakb.Refresh();\n   \treturn;\n   \n\t\n\n\n}"},{"name":"mbtn_inc_actions3_OnMenuItem","code":"mbtn_inc_actions3_OnMenuItem(strName, nItemID)\n{\n\n\tvar iClear = 1;\n\t\n\tswitch (nItemID)\n\t{\n\t\tcase iClear:\n\t\t\tapp.g.sl_clearselected(sl_rakb,null,0);\t\t\n\t\t\tvar strFilter = app.g.sl_get_valuesdel(sl_rakb,0,\",\",\"'\",\"\");\n\t\t\tif(strFilter!=\"\")\n\t\t\t\tstrFilter=\"_kv=\"+strFilter;\n\t\t\tapp._slf(sl_rakb, strFilter);\t\n\t\t\tbreak;\n\t}\n\n}"},{"name":"mbtn_inc_views3_OnMenuItem","code":"mbtn_inc_views3_OnMenuItem(strName, nItemID)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_rakb, sl_rakb.curSel, \"docref\");\n\tapp.g.open_article(strKeyValue);\n\t\n}"},{"name":"sl_rakb_OnItemDoubleClicked","code":"sl_rakb_OnItemDoubleClicked(nRow, nCol)\n{\n\tvar strKeyValue = app.g.sl_getcolvalue(sl_rakb, nRow, \"docref\");\n\tapp.g.open_article(strKeyValue);\n\n}"},{"name":"sl_rakb_OnItemSelected","code":"sl_rakb_OnItemSelected(nRow)\n{\n\tvar boolActive = (sl_rakb.rowCount()>0);\n\tvar selCount = app.g.sl_getselected_count(sl_rakb);\t\n\tapp._een(mbtn_inc_views3, (selCount==1));\n\tapp._een(mbtn_inc_actions3, boolActive);\n\n\n}"},{"name":"Tab1_OnTabSelected","code":"Tab1_OnTabSelected(nTab)\n{\n\t\/\/ TODO: Add your event handler code here\n\n\tif(nTab == 0)\n\t{\n\t\tapp._slf(sl_cust_incidents1 , \"callref=\"+_swdoc.OC().callref+\"&cust_id=\"+_swdoc.OC().cust_id);\n\t\tsl_cust_incidents1.Refresh();\n\t\t\n\t}\n\telse if(nTab == 1)\n\t{\n\t\tapp._slf(sl_site_incidents1 , \"callref=\"+_swdoc.OC().callref+\"&site=\"+_swdoc.oCust().site+\"&cust_id=\"+_swdoc.oCust().keysearch);\n\t\tsl_site_incidents1.Refresh();\n\t\t\n\t}\n\telse if(nTab == 2)\n\t{\n\t\tapp._slf(sl_org_incidents1 , \"callref=\"+_swdoc.OC().callref+\"&fk_company_id=\"+_swdoc.oCust().fk_company_id+\"&cust_id=\"+_swdoc.oCust().keysearch);\n\t\tsl_org_incidents1.Refresh();\n\t\t\n\t}\n\telse if(nTab == 3)\n\t{\n\t\tapp._slf(sl_incprofile , \"probcode=\"+_swdoc.OC().probcode);\n\t\tsl_incprofile.Refresh();\n\t}\n\telse if(nTab == 4)\n\t{\n\t\tsl_relincs.Refresh();\n\t}\n\n}"},{"name":"TabRel_OnTabSelected","code":"TabRel_OnTabSelected(nTab)\n{\n\t\/\/ TODO: Add your event handler code here\n\ttCMDB = 0;\n\ttServices = 1;\n\ttProblems = 2;\n\ttRFCs = 3;\n\ttSRs = 4;\n\ttKB = 5;\n\ttIncidents = 6;\n\ttMajIncidents = 7;\n\t\n\tif(nTab==tCMDB)\n\t{\n\t\t\/\/-- only load list once (will keep trying to load records each time you click if there are no linked recs)\n\t\tif (sl_configitems.rowCount() < 1) sl_configitems.Refresh();\n\t}\n\tif(nTab==tProblems)\n\t{\n\t\t\/\/-- only load list once (will keep trying to load records each time you click if there are no linked recs)\n\t\tif (sl_problems.rowCount() < 1) sl_problems.Refresh();\n\t}\n\telse if(nTab==tRFCs)\n\t{\n\t\t\t\/\/-- only load list once (will keep trying to load records each time you click if there are no linked recs)\n\t\t\tif (sl_rfcs.rowCount() < 1) sl_rfcs.Refresh();\n\t}\n\telse if(nTab==tSRs)\n\t{\n\t\t\/\/-- only load list once (will keep trying to load records each time you click if there are no linked recs)\n\t\tif (sl_srs.rowCount() < 1) sl_srs.Refresh();\n\t}\n\telse if(nTab==tKB)\n\t{\n\t\tif (sl_kbs1.rowCount() < 1)\n\t\t{\n\t\t\tapp._slf(sl_kbs1,\"cr=\"+_swdoc.OC().callref);\t\n\t\t\tsl_kbs1.Refresh();\n\t\t}\n\t}\t\n\telse if(nTab==tIncidents)\n\t{\n\t\tTab1_OnTabSelected(Tab1.tab);\n\t}\n\telse if(nTab==tMajIncidents)\n\t{\n\t\tif (sl_majinc.rowCount() < 1)sl_majinc.Refresh();\n\t}\t\n\telse if(nTab==tServices)\n\t{\n\t\tif (sl_services.rowCount() < 1)\n\t\t\tsl_services.Refresh();\n\t}\t\n\n\n}"}]}}}}}