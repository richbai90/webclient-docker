{"espForm":{"configuration":{"settings":{"name":"slr_discussion","title":"Discussion","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"slrd_discussion","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":[{"name":"(Globals)","code":"var boolUpdate = false;\n\nfunction MF()\n{\n\treturn mainform;\n}\n\nfunction oDiscussion()\n{\n\treturn slrd_discussion;\n}\n\nfunction insertDiaryEntry(strDiaryText)\n{\n\t\tvar p = {};\n\t\tp.fsi = _swdoc.GetArg(\"fk_slrd_id\");\n\t\tp.ut = strDiaryText;\n\t\tp.uc = \"Detail Update\";\n\t\tp.aid = app.session.analystId;\t\t\t\t\t\t\t\n\t\tp.ux = \tapp.g.todaysdate_epoch();\t\t\t\t\t\t\t\t\t\t\n \t\tapp.g.submitsimplesql(\"itsmsp_slrd_diary.insert\", p);\n}"},{"name":"OnValidate","code":"OnValidate()\n{\n\treturn VALIDATE_DEFAULT;\n}"},{"name":"OnDataSaved","code":"OnDataSaved()\n{\n    var strDiaryText = \"'\" + _swdoc.oDiscussion().name + \"' discussion (ID=\" + _swdoc.oDiscussion().pk_id + \") \";\n   \n    \/\/ if review added...\n\tif (!_swdoc.boolUpdate)\n\t{\n\t\t\/\/ ...insert audit entry for added review\n\t\tstrDiaryText += \"added.\";\n\t\t_swdoc.insertDiaryEntry(strDiaryText);\n \t}\n \telse\n \t{\n\t\tstrDetails = \"\";\n\t\tfor(var intNumberOfInsert=0;intNumberOfInsert<_swdoc.arrDiary.length;intNumberOfInsert++)\n\t\t{\n\t\t\tarrDetails = _swdoc.arrDiary[intNumberOfInsert]\n\t\t\tif(strDetails!=\"\")\n\t\t\t{\n\t\t\t\tstrDetails += \",\"\n\t\t\t}\n\t\t\tstrDetails += arrDetails[0]+\" has been modified from '\"+arrDetails[1]+\"' to '\"+arrDetails[2]+\"'\";\n\t\t}\n\t\t\/\/ if review has been modified..\n\t\tif(strDetails!=\"\")\n\t\t{\n\t\t\t\/\/ ...insert audit entry for modified review\n\t\t\tstrDiaryText += \"modified: \" + strDetails\n\t\t\t_swdoc.insertDiaryEntry(strDiaryText);\n\t\t}\n    }\n    _swdoc.boolUpdate = false;    \n}"},{"name":"OnSaveData","code":"OnSaveData()\n{\n\tif(!app.session.HaveAppRight(app.ADMIN_SETTINGS, app.SLM_EDIT, app.session.dataDictionary))\n\t{\n\t\tapp.global.MessageBox('Insufficient privileges to perform operation.\\n\\nYou have been denied the: [Can edit items in Service Level Management] permission.\\n\\nPlease contact your Supportworks system administrator', 16);\n\t\treturn false;\t\n\t}\n\tvar arrInserts = new Array();\n\t\n\t\/\/-- get current review record\n\tvar oRec = app.g.get_record(\"slrd_discussion\", _swdoc.oDiscussion().pk_id);\n\tvar liveVal=\"\";\n\t\/\/-- for each field check if diff from current\n\tfor (x=0; x < dd.tables['slrd_discussion'].columns.length;x++)\n\t{\n\t\tvar colName = dd.tables['slrd_discussion'].columns[x].Name;\n\t\t\/\/make sure the field exists\n\t\tif(oRec[colName]!=undefined)\n\t\t{\n\t\t\t\/\/-- if values differ and value is not empty put into a field table\n\t\t\tvar FORM_VALUE = slrd_discussion[colName];\n\t\t\t\n\t\t\t\/\/MessageBox(colName + \" : \" + FORM_VALUE + \" : \" + oRec[colName]);\n\t\t\t\n\t\t\t\/\/-- if numeric value and = 0 then ignore\n\t\t\tif((app.g.dd_isnumeric('slrd_discussion',colName))&&(FORM_VALUE==0))continue;\n\t\t\t\n\t\t\tvar\tdispFormVal = FORM_VALUE;\n\t\t\tvar liveVal = oRec[colName];\n\t\t\tvar dispLiveVal = liveVal;\n\t\t\tif(app.g.dd_isnumeric('slrd_discussion',colName))\n\t\t\t{\n\t\t\t\tif(FORM_VALUE<0)\n\t\t\t\t{\n\t\t\t\t\tFORM_VALUE= app.g.fix_epoch(FORM_VALUE);\n\t\t\t\t\tdispFormVal = app.g.convert_epochddmmyyyy(FORM_VALUE);\n\t\t\t\t\tdispLiveVal = app.g.convert_epochddmmyyyy(liveVal);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif((liveVal!=FORM_VALUE))\n\t\t\t{\n\t\t\t\tarrInserts.push(new Array( app.g.dd_fieldlabel('slrd_discussion',colName),app.g.pfs(dispLiveVal) , app.g.pfs(dispFormVal)))\n\t\t\t}\n\t\t}\t\n\t}\n\n\t_swdoc.arrDiary = arrInserts;\n\n\treturn true;\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"387","height":"359","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"fld_name","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"17","left":"84","right":"381","bottom":"35"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"slrd_discussion.name"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee","storedQuery":"generic.select","sqlSource":"swdata","distinctTable":"itsmsp_slad_review","distinctColumn":"review_name","displayColumn":"review_name"}}},{"general":{"name":"fld_date","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"42","left":"84","right":"263","bottom":"60"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"slrd_discussion.datex"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","dateFormatMode":"0"}}},{"general":{"name":"lbl_name","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"17","left":"6","right":"78","bottom":"31"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_date","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Date","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"42","left":"6","right":"78","bottom":"56"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lbl_subject","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Subject","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"162","left":"6","right":"78","bottom":"176"},"scaling":{"top":"25","left":"0","right":"0","bottom":"25"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_subject","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"162","left":"84","right":"381","bottom":"180"},"scaling":{"top":"25","left":"0","right":"100","bottom":"25"}},"data":{"binding":"slrd_discussion.subject"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lbl_notes","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","caption":"Notes","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"187","left":"6","right":"78","bottom":"201"},"scaling":{"top":"25","left":"0","right":"0","bottom":"25"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_notes","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"187","left":"84","right":"381","bottom":"352"},"scaling":{"top":"25","left":"0","right":"100","bottom":"100"}},"data":{"binding":"slrd_discussion.notes"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lbl_organiser","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Organiser","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"67","left":"6","right":"78","bottom":"81"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_organiser","type":"Field"},"appearance":{"index":"9","backgroundColor":"#eeeeee","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"67","left":"84","right":"263","bottom":"85"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"slrd_discussion.organiser"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee","sqlSource":"syscache","storedQuery":"generic.select","distinctTable":"swanalysts","distinctColumn":"AnalystID","displayColumn":"Name","dropdownButtonType":"1","borderColor":"#c0c0c0"}}},{"general":{"name":"fld_participants","type":"Field"},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"90","left":"84","right":"381","bottom":"154"},"scaling":{"top":"0","left":"0","right":"100","bottom":"25"}},"data":{"binding":"slrd_discussion.participants"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lbl_participants","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"11","caption":"Participants","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"90","left":"6","right":"78","bottom":"104"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tvar intSlaId = _swdoc.GetArg(\"fk_slrd_id\");\n\tvar strFilter = \"_swc_fk_id=\" + intSlaId;\n\tapp._slf(_swdoc.MF().fld_name,strFilter);\n\n\t_swdoc.boolUpdate = (_swdoc.oDiscussion().pk_id!=0);\n\tif(_swdoc.boolUpdate)\n\t{\n\t\t\/\/-- updating\n\t}\n\telse\n\t{\n\t\t\/\/-- creating\n\t\t_swdoc.oDiscussion().fk_slrd_id = intSlaId;\n\t}\n}"},{"name":"fld_organiser_OnLeftClick","code":"fld_organiser_OnLeftClick()\n{\n\tapp.g.pick_analyst(\"Select Analyst\",function(oAnalyst)\n\t{\n\t\tif(!oAnalyst)\n\t\t\treturn false;\n\t\tapp._ete(_swdoc.MF().fld_organiser , oAnalyst.name);\n\t\t_swdoc.oDiscussion().organiser = oAnalyst.id;\n\t\t_swdoc.UpdateFormFromData();\t\n\t});\n\treturn false;\n}"},{"name":"fld_organiser_OnRightClick","code":"fld_organiser_OnRightClick()\n{\n\tapp._ete(fld_organiser, \"\");\n\tapp._eva(fld_organiser, \"\");\n\tslad_review_details.organiser = \"\";\n\t_swdoc.UpdateFormFromData();\n\treturn true;\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}