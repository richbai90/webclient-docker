{"espForm":{"configuration":{"settings":{"name":"itsmsp_uri","title":"URI Detail","description":"Form used to managed a planned activity","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"itsmsp_uri","type":"Main Details Table","flags":"0"}},"javascript":{"methods":{"method":[{"name":"OnSaveData","code":"OnSaveData()\n{\n\tif(!app.session.HaveAppRight(app.ADMIN_SETTINGS, app.SLM_EDIT, app.session.dataDictionary))\n\t{\n\t\tapp.global.MessageBox('Insufficient privileges to perform operation.\\n\\nYou have been denied the: [Can edit items in Service Level Management] permission.\\n\\nPlease contact your Supportworks system administrator', 16);\n\t\treturn false;\t\n\t}\n\t\/\/-- NWJ - 18.03.2008\n\t\/\/-- set temp key if there is one - means logged from log call form\n\tif(_swdoc.oURI().pk_caturi_id<1)\n\t{\n\t\t_swdoc.oURI().fk_cat_id = _swdoc.GetArg(\"fk_cat_id\");\t\n\t\t_swdoc.oURI().fk_slad = _swdoc.GetArg(\"fk_slad\");\n\t\t_swdoc.oURI().fk_slrd = _swdoc.GetArg(\"fk_slrd\");\t\t\t\n\t\t_swdoc.oURI().nindex = _swdoc.GetArg(\"nindex\");\t\t\t\n\t\t_swdoc.oURI().relcode = _swdoc.GetArg(\"relcode\");\t\t\t\n\t}\n\t\n\t\tvar arrInserts = new Array();\n\t\n\t\/\/-- get current review record\n\tvar oRec = app.g.get_record(\"itsmsp_uri\", _swdoc.oURI().pk_caturi_id);\n\tvar liveVal=\"\";\n\t\/\/-- for each field check if diff from current\n\tfor (x=0; x < dd.tables['itsmsp_uri'].columns.length;x++)\n\t{\n\t\tvar colName = dd.tables['itsmsp_uri'].columns[x].Name;\n\t\t\/\/make sure the field exists\n\t\tif(oRec[colName]!=undefined)\n\t\t{\n\t\t\t\/\/-- if values differ and value is not empty put into a field table\n\t\t\tvar FORM_VALUE = itsmsp_uri[colName];\n\t\t\t\n\t\t\t\/\/MessageBox(colName + \" : \" + FORM_VALUE + \" : \" + oRec[colName]);\n\t\t\t\n\t\t\t\/\/-- if numeric value and = 0 then ignore\n\t\t\tif((app.g.dd_isnumeric('itsmsp_uri',colName))&&(FORM_VALUE==0))continue;\n\t\t\t\n\t\t\tvar\tdispFormVal = FORM_VALUE;\n\t\t\tvar liveVal = oRec[colName];\n\t\t\tvar dispLiveVal = liveVal;\n\t\t\tif(app.g.dd_isnumeric('itsmsp_uri',colName))\n\t\t\t{\n\t\t\t\tif(FORM_VALUE<0)\n\t\t\t\t{\n\t\t\t\t\tFORM_VALUE= app.g.fix_epoch(FORM_VALUE);\n\t\t\t\t\tdispFormVal = app.g.convert_epochddmmyyyy(FORM_VALUE);\n\t\t\t\t\tdispLiveVal = app.g.convert_epochddmmyyyy(liveVal);\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\tif((liveVal!=FORM_VALUE))\n\t\t\t{\n\t\t\t\tarrInserts.push(new Array( app.g.dd_fieldlabel('itsmsp_uri',colName),app.g.pfs(dispLiveVal) , app.g.pfs(dispFormVal)))\n\t\t\t}\n\t\t}\t\n\t}\n\n\t_swdoc.arrDiary = arrInserts;\n\t\n\t\n\t\n\t\n\treturn true;\n}"},{"name":"(Globals)","code":"var boolShow = false;\nvar relcode = \"\";\nfunction oURI()\n{\n\treturn _swdoc.itsmsp_uri;\n}\n\nfunction insertDiaryEntry(strDiaryText)\n{\n\t\tif(_swdoc.relcode==\"SLRD\")\n\t\t{\n\t\t\tvar p = {};\n\t\t\tp.fsi = _swdoc.oURI().fk_slrd;\n\t\t\tp.ut = strDiaryText;\n\t\t\tp.uc = \"Detail Update\";\n\t\t\tp.aid = app.session.analystId;\t\t\t\t\t\t\t\n\t\t\tp.ux = \tapp.g.todaysdate_epoch();\t\t\t\t\t\t\t\t\t\t\n \t\t\tapp.g.submitsimplesql(\"itsmsp_slrd_diary.insert\", p);\n \t\t}else if(_swdoc.relcode==\"SLAD\")\n \t\t{\n \t\t\tvar p = {};\n\t\t\tp.fsi = _swdoc.oURI().fk_slad;\n\t\t\tp.ut = strDiaryText;\n\t\t\tp.uc = \"Detail Update\";\n\t\t\tp.aid = app.session.analystId;\t\t\t\t\t\t\t\n\t\t\tp.ux = \tapp.g.todaysdate_epoch();\t\t\t\t\t\t\t\t\t\t\n \t\t\tapp.g.submitsimplesql(\"itsmsp_slad_diary.insert\", p);\n\n \t\t}\n}"},{"name":"OnDataSaved","code":"OnDataSaved()\n{\n\t\n\tvar strDiaryText = \"'\" + _swdoc.oURI().title + \"' URI \";\n   \n    \/\/ if review added...\n\tif (!_swdoc.boolShow)\n\t{\n\t\t\/\/ ...insert audit entry for added review\n\t\tstrDiaryText += \"added.\";\n\t\t_swdoc.insertDiaryEntry(strDiaryText);\n \t}\n \telse\n \t{\n\t\tstrDetails = \"\";\n\t\tfor(var intNumberOfInsert=0;intNumberOfInsert<_swdoc.arrDiary.length;intNumberOfInsert++)\n\t\t{\n\t\t\tarrDetails = _swdoc.arrDiary[intNumberOfInsert]\n\t\t\tif(strDetails!=\"\")\n\t\t\t{\n\t\t\t\tstrDetails += \",\"\n\t\t\t}\n\t\t\tstrDetails += arrDetails[0]+\" has been modified from '\"+arrDetails[1]+\"' to '\"+arrDetails[2]+\"'\";\n\t\t}\n\t\t\/\/ if review has been modified..\n\t\tif(strDetails!=\"\")\n\t\t{\n\t\t\t\/\/ ...insert audit entry for modified review\n\t\t\tstrDiaryText += \"modified: \" + strDetails\n\t\t\t_swdoc.insertDiaryEntry(strDiaryText);\n\t\t}\n    }\n    _swdoc.boolShow = false;    \n\n}"}]}}},"layouts":{"layout":[{"appearance":{"width":"489","height":"265","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Field1","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"16","left":"77","right":"426","bottom":"34"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"itsmsp_uri.title"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field3","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"38","left":"77","right":"426","bottom":"56"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"itsmsp_uri.uri"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Field4","type":"Field"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"60","left":"77","right":"426","bottom":"78"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"itsmsp_uri.type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee","listItems":"Document|Forum Site|System Folder|Intranet Site|WWW|Database Record|"}}},{"general":{"name":"Field2","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"84","left":"77","right":"426","bottom":"258"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"itsmsp_uri.note"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"image":"#eeeeee","borderColor":"#c0c0c0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Label1","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Title","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"16","left":"5","right":"73","bottom":"34"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"itsmsp_uri.title"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label2","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"5","caption":"Note","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"84","left":"5","right":"73","bottom":"102"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"itsmsp_uri.note"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label3","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","caption":"URI","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"38","left":"5","right":"73","bottom":"56"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"itsmsp_uri.uri"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Label4","type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"7","caption":"Type","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"60","left":"5","right":"73","bottom":"78"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"itsmsp_uri.type"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_view1","type":"EventButton"},"appearance":{"index":"8","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"37","left":"430","right":"486","bottom":"58"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"true","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}}]},"javascript":{"methods":{"method":[{"name":"btn_view1_OnPressed","code":"btn_view1_OnPressed()\n{\n\t\/\/-- open for edit\n\tvar intURID = itsmsp_uri.uri;\n\tif(intURID!=\"\")\n\t{\n\t\tapp.global.ShellExecute(intURID);\n\t}\n\n}"},{"name":"Field3_OnValueChanged","code":"Field3_OnValueChanged(strValue)\n{\n\t\/\/ TODO: Add your event handler code here\n\tvar boolShow = strValue!=\"\";\n\tapp._een(mainform.btn_view1,boolShow);\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.boolShow = itsmsp_uri.uri!=\"\";\n\tapp._een(mainform.btn_view1,_swdoc.boolShow);\n\t_swdoc.relcode = _swdoc.GetArg(\"relcode\");\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}