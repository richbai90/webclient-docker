{"espForm":{"configuration":{"settings":{"name":"copy_wizard_form","title":"Copy Wizard Form","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\n\nvar strSourceWizardName = \"\";\nvar strNewWizardName = \"\";\n\nfunction MF()\n{\n\treturn _swdoc.mainform;\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"292","height":"103","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"btn_copy_wizard","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Copy","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"80","left":"171","right":"229","bottom":"102"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"btn_cancel","type":"EventButton","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Cancel","backgroundColor":"#000000","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"80","left":"231","right":"289","bottom":"102"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"txt1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"New Wizard Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"35","left":"27","right":"120","bottom":"53"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_newizardname","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"35","left":"124","right":"289","bottom":"55"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#c0c0c0","imageHSpace":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"txt2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Source Wizard Name","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"10","left":"16","right":"121","bottom":"28"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"fld_wizardname","type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"10","left":"124","right":"289","bottom":"30"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#c0c0c0","imageHSpace":"#eeeeee","sqlSource":"swdata","distinctTable":"wssm_wiz","displayColumn":"title","distinctColumn":"pk_name","disabledBackgroundColor":"#eeeeee"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.strSourceWizardName = _swdoc.GetArg(\"strSourceWizardName\");\n\tif(_swdoc.strSourceWizardName!=\"\") app._ete(_swdoc.MF().fld_wizardname , _swdoc.strSourceWizardName);\n\n\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.CloseForm();\n\n}"},{"name":"btn_copy_wizard_OnPressed","code":"btn_copy_wizard_OnPressed()\n{\n\t\/\/ TODO: Add your event handler code here\n\t_swdoc.strNewWizardName = _swdoc.MF().fld_newizardname.text;\n\tif(_swdoc.strNewWizardName!=\"\")\n\t{\n\t\t\/\/ ES -- Check if the Wizard name exists already\n   \t \tvar intCount = app.g.sqs_rowcount(\"form\/copy_wizard_form\/count_wizards_by_name\",\"nwn=\"+app.pfu(_swdoc.strNewWizardName));\n\t\t\n\t\t\/\/ -- If Wizard name exists already, then display an alert\n\t\tif(intCount>0) \n\t\t\tMessageBox(\"There is already a Wizard called [\"+_swdoc.strNewWizardName+\"]. Please enter a new Wizard name.\");\n\t\t\n\t\t\/\/ -- Create copy of the source Wizard\n\t\telse\n\t\t{\n\t\t\t\n\t\t\tvar boolComplete = true;\n\t\t\tvar strParams = \"swn=\"+app.pfu(_swdoc.strSourceWizardName)+\"&nwn=\"+app.pfu(_swdoc.strNewWizardName);\n\t\t\t\n\t\t\t\/\/ -- Insert Wizard into WSSM_WIZ\n\t\t\t\/\/ Extended so that this one stored query does all the copying\n\t\t\tif(!app.g.submitsqs(\"form\/copy_wizard_form\/copy_wssm_wiz_record.insert\",strParams)) boolComplete = false;\n\t\t\t\t\t\t\n\t\t\t\/\/ -- If all inserts are completed successfully, then close the Form.\n\t\t\tif(boolComplete)\n\t\t\t\t_swdoc.CloseForm();\n\t\t\telse\n\t\t\t\tMessageBox(\"Unable to create a copy of the Wizard [\"+ _swdoc.strSourceWizardName +\"]\");\n\t\t}\n\t}\n\telse \n\t{\n\t\tMessageBox(\"Please enter a Wizard name before attempting to create a copy.\");\n\t}\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}