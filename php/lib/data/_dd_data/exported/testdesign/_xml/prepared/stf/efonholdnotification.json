{"espForm":{"configuration":{"settings":{"name":"efOnHoldNotification","title":"On Hold Notification","options":{"allowResize":"true","showMenubar":"false","showToolbar":"true","showStatusBar":"false"}},"tables":{"table":{"name":"onhold_notifiers","type":"Main Details Table","flags":"102"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _swdoc = (IsObjectDefined(\"_bHtmlWebClient\"))?top:_swdoc;\nvar max_days = 0;\n\nfunction OHN(){\n\treturn _swdoc.onhold_notifiers;\n}\n\nfunction MF(){\n\treturn mainform;\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"390","height":"278","backgroundColor":"#f2eedd","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"fld_days","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"29","left":"130","right":"214","bottom":"45"},"scaling":{"top":"0","left":"0","right":"50","bottom":"0"}},"data":{"binding":"onhold_notifiers.days_from"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"48","left":"130","right":"380","bottom":"92"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"onhold_notifiers.diary_entry"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"2","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_mailbox","type":"Field"},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"118","left":"130","right":"380","bottom":"136"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"data":{"binding":"onhold_notifiers.mailbox"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"lb_template","type":"Field"},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"139","left":"130","right":"380","bottom":"157"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"data":{"binding":"onhold_notifiers.template"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"content":"#eeeeee","disabledBackgroundColor":"#eeeeee","sqlSource":"syscache","borderColor":"#c0c0c0"}}},{"general":{"type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"159","left":"130","right":"380","bottom":"175"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"data":{"binding":"onhold_notifiers.recipient"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0","sqlSource":"swdata","distinctTable":"escalation_reference","distinctColumn":"role","storedQuery":"generic.select"}}},{"general":{"type":"Field"},"appearance":{"index":"5","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"208","left":"130","right":"380","bottom":"224"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"data":{"binding":"onhold_notifiers.popup_subject"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"Field"},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"228","left":"130","right":"380","bottom":"272"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"data":{"binding":"onhold_notifiers.popup_message"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"2","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"29","left":"247","right":"380","bottom":"45"},"scaling":{"top":"0","left":"50","right":"100","bottom":"0"}},"data":{"binding":"onhold_notifiers.rem_strike"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","defaultValue":"0","listItems":"Start^0|End^1|","borderColor":"#c0c0c0"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","caption":"Days From","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"29","left":"10","right":"120","bottom":"45"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"onhold_notifiers.days_from"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"9","caption":"Diary Entry","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"48","left":"10","right":"120","bottom":"64"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"onhold_notifiers.diary_entry"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"10","caption":"Id","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"29","left":"10","right":"34","bottom":"45"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"onhold_notifiers.id"},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"true","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"false"}}},{"general":{"type":"Field"},"appearance":{"index":"11","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"29","left":"40","right":"65","bottom":"45"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"onhold_notifiers.id"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"true","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"12","caption":"On Hold Period","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"10","left":"10","right":"120","bottom":"26"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"onhold_notifiers.onhold_period"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"Field"},"appearance":{"index":"13","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"10","left":"130","right":"380","bottom":"26"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"data":{"binding":"onhold_notifiers.onhold_period"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"disabledBackgroundColor":"#eeeeee","borderColor":"#c0c0c0"}}},{"general":{"name":"CaptionPanel1","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"14","caption":"Email","backgroundColor":"#ffffff","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet MS"},"alignment":"Center","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"96","left":"19","right":"382","bottom":"179"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#ffffff","imageHSpace":"10","slope":"0","borderColor":"#d3c9b6","headerHeight":"18","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#ffffff","panelBackgroundColor2":"#000000"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"15","caption":"Recipient","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"159","left":"10","right":"120","bottom":"175"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"data":{"binding":"onhold_notifiers.recipient"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"16","caption":"Template","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"10","right":"120","bottom":"155"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"data":{"binding":"onhold_notifiers.template"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"17","caption":"Mailbox","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"118","left":"10","right":"120","bottom":"134"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"data":{"binding":"onhold_notifiers.mailbox"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"CaptionPanel2","type":"CaptionBar","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"true","hasCheckbox":"false"}},"appearance":{"index":"18","caption":"Messenger Pop-up (to analyst)","backgroundColor":"#ffffff","foregroundColor":"#003366","font":{"@size":"10","@bold":"1","#text":"Trebuchet MS"},"alignment":"Center","fillStyle":"Vertical Gradient"},"objectPlacement":{"position":{"top":"184","left":"20","right":"383","bottom":"275"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor2":"#ffffff","imageHSpace":"10","slope":"0","borderColor":"#d3c9b6","headerHeight":"18","hasBorder":"1","panelBorderColor":"#d3c9b6","fillStyle":"0","panelBackgroundColor":"#ffffff","panelBackgroundColor2":"#000000"}}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"19","caption":"Popup Subject","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"208","left":"10","right":"120","bottom":"224"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"data":{"binding":"onhold_notifiers.popup_subject"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"type":"FieldName","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"20","caption":"Popup Message","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"228","left":"10","right":"120","bottom":"244"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"data":{"binding":"onhold_notifiers.popup_message"},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"21","caption":"from","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Center","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"30","left":"216","right":"243","bottom":"44"},"scaling":{"top":"0","left":"50","right":"50","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"22","caption":"One can use $callref! as a placeholder in the diary and popup messages","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"67","left":"18","right":"127","bottom":"94"},"scaling":{"top":"50","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}}]},"javascript":{"methods":{"method":[{"name":"(User Defined Functions)","code":""},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\n\tvar strPeriodName = _swdoc.GetArg(\"period_name\");\n\tif (\"\" != strPeriodName){\n\t\t_swdoc.OHN().onhold_period = strPeriodName;\n\t}\n\tvar b = app.g.get_record(\"onhold_periods\", _swdoc.OHN().onhold_period);\n\t_swdoc.max_days = b.period_days;\n\n\tvar e_template = _swdoc.OHN().template;\n\tif(\"\"!=_swdoc.OHN().mailbox){\n\t\t_swdoc.MF().lb_mailbox_OnValueChanged(_swdoc.OHN().mailbox);\n\t\t_swdoc.OHN().template = e_template;\n\t}\n\t_swdoc.UpdateFormFromData();\n\t_swdoc.ResetModiedFlag(\"onhold_notifiers\");\n\t\n\n}"},{"name":"lb_mailbox_OnValueChanged","code":"lb_mailbox_OnValueChanged(strValue)\n{\n\n\n\tif(\"\" != strValue){\n\t\tvar strURL = \"php\/itsm\/get_templatelist.php?mailboxname=\" + lb_mailbox.text; \n\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\t_swdoc.MF().lb_template.pickList = strResult;\n\t}\n\t_swdoc.OHN().template = \"\";\n\t_swdoc.UpdateFormFromData();\n\n\n}"},{"name":"lb_mailbox_OnLeftClick","code":"lb_mailbox_OnLeftClick()\n{\n\t\/\/-- get mailbox list\n\t\n\tif(lb_mailbox.pickList==\"\")\n\t{\n\t\t\/\/-- call php to get mailbox list\n\t\tvar strURL = \"php\/itsm\/get_mailboxlist.php\"; \n\t\tvar strResult = app.g.submit_php(strURL,true);\n\t\tlb_mailbox.pickList = strResult;\n\t}\n\n\n\treturn true;\n}"},{"name":"fld_days_OnValueChanged","code":"fld_days_OnValueChanged(strValue)\n{\n\n\tif (strValue < 0 || strValue > _swdoc.max_days){\n\t\tMessageBox(\"You specified more days than available in this period.\");\n\t\t_swdoc.OHN().days_from = _swdoc.max_days;\n\t\t_swdoc.UpdateFormFromData();\n\t}\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}