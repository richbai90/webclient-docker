<?xml version="1.0" encoding="utf-8" ?>
<espForm>
	<configuration>
		<settings>
			<name>EfHoldCallForm_OLT</name>
			<title>Hold Call Form</title>
			<printTemplates>
			</printTemplates>
			<options>
				<allowResize>true</allowResize>
				<showMenubar>true</showMenubar>
				<showToolbar>false</showToolbar>
				<showStatusBar>false</showStatusBar>
			</options>
		</settings>
		<tables>
			<table>
				<name>updatedb</name>
				<type>Main Details Table</type>
				<flags>5</flags>
				<assignments>
				</assignments>
			</table>
			<table>
				<name>opencall</name>
				<type>Extended Details Table</type>
				<mainDetailsColumn>callref</mainDetailsColumn>
				<flags>0</flags>
				<assignments>
				</assignments>
			</table>
		</tables>
		<showMeItems>
		</showMeItems>
		<javascript>
			<methods>
				<method>
					<name>OnFormLoading</name>
					<code>
						<![CDATA[OnFormLoading(strFormName, strClass)
{
	//-- If the analyst does not have permissions to modify the status of call
	//--  then they should not be able to place a call on hold/take off hold
	if (!app.session.HaveRight(ANALYST_RIGHT_A_GROUP,ANALYST_RIGHT_A_CANMODIFYCALLS))
	{
    MessageBox("I am sorry, you do not have sufficient privileges to perform that action.  Please contact your system administrator");
    return false;
	}
	
	//-- Initialise variables
	_swdoc.MessageSource = "";
	_swdoc.bSourceEmail = false;
	_swdoc.UpdateText	= "";
	_swdoc.strActionSource = "";
	//--
	//-- get the form callrefs (those calls refs we are putting on hold)
	//-- store the callrefs "1,2,3" 
	var Callrefs = _swdoc._form["callrefs"];
	
	if(Callrefs=="")
	{
		//-- see if we have passed any in
		Callrefs = _swdoc.GetArg("in_callrefs");
	}
	//-- re-assign callrefs string and also create an array
	_swdoc.CallrefsCommaString = Callrefs;
	_swdoc.Callrefs = Callrefs.split(",");
	
	
	//-- Go lock these calls while we want to put them on hold
	if(!app.global.LockCalls(_swdoc.CallrefsCommaString, "HOLD", true))  //_swdoc.updatedb.callref
	{
		//-- one of the calls may already be locked
		//MessageBox("Call '" + _swdoc.CallrefsCommaString + "' already locked");
		return false;
	}
	
	//-- init form title based on number of calls we are working with
	var strFormTitle = (_swdoc.Callrefs.length > 1) ? "Place Calls On Hold " : "Place Call On Hold ";
	
	//-- now format each of the callrefs to F#### and add to title
	for(var i=0;i<_swdoc.Callrefs.length; i++)
	{
		if( i > 0)strFormTitle += ", ";
		strFormTitle += dd.tables.opencall.columns.callref.FormatValue(_swdoc.Callrefs[i]);
	}
	
	//-- set the title
	_swdoc.SetTitle(strFormTitle);

	//-- check if putting on hold from an email
	if(_swdoc._form["_source_email"])
	{
		_swdoc.bSourceEmail = (_swdoc._form["_source_email"] == "true");
		//MessageBox("_source_email = " + _swdoc.bSourceEmail);
	}
	
	//-- store action source
	_swdoc.strActionSource = (_swdoc.bSourceEmail) ? "E-mail": "Telephone";
	

	//-- if we have passed in update text store it		
	if(_swdoc._form["updatetext"])
	{
		_swdoc.UpdateText = _swdoc._form["updatetext"];
		_swdoc.updatedb.updatetxt = _swdoc._form["updatetext"];
	}
	
	//-- Q? : What is ResetModiedFlag
	_swdoc.ResetModiedFlag("updatedb");

	return true;
}]]>
					</code>
				</method>
				<method>
					<name>OnFormClosing</name>
					<code>
						<![CDATA[OnFormClosing()
{
	if (_swdoc.boolForceClose)
	{
		return true;
	}
	
	var funcUnclockReset = function()
	{
		//-- unlock the calls
		app.global.UnlockCalls(_swdoc.CallrefsCommaString);
	
		//-- clear down data
		_swdoc.ResetData();
	
		return true;
	}
	
	//Check for Changes to any of the data fields
	if(_swdoc.bFormFieldChanged)
	{
		MessageBox("You have unsaved data on this form. Do you still want to close this form?", MB_ICONQUESTION | MB_YESNO, function(intDecision)
		{
			if(intDecision == IDNO)
			{
				return false;
			}
			else
			{
				funcUnclockReset();
				_swdoc.boolForceClose = true;
				_swdoc.CloseForm();
			}
		});
	}
	else
	{
		funcUnclockReset();
	}
}]]>
					</code>
				</method>
				<method>
					<name>(Globals)</name>
					<code>
						<![CDATA[
var _swdoc = (IsObjectDefined("_bHtmlWebClient"))?top:_swdoc;

var bFormFieldChanged = false;	//This var is used to check for changes to data fields and is set to true when any 
								//field data is changed		
var boolForceClose = false;
						
function MF(){
	return mainform;
}]]>
					</code>
				</method>
				<method>
					<name>(User Defined Functions)</name>
					<code>
						<![CDATA[function replaceIllegalFileCharacters(strText)
{
	//-- This function is used to replace characters in the passed in string that 
	//-- are not suitable for use in filenames and return the modified string 
	
	strOutput = strText;
	strReplacement = "-";
	var i = 0;
	
	while(i < strOutput.length)
	{
		strOutput = strOutput.replace('/', strReplacement);
		strOutput = strOutput.replace(':', strReplacement);
		strOutput = strOutput.replace('*', strReplacement);
		strOutput = strOutput.replace('?', strReplacement);
		strOutput = strOutput.replace('"', strReplacement);
		strOutput = strOutput.replace('\'', strReplacement);
		strOutput = strOutput.replace('<', strReplacement);
		strOutput = strOutput.replace('>', strReplacement);
		
		i++;
	}
	
	return strOutput;
}]]>
					</code>
				</method>
				<method>
					<name>OnSaveData</name>
					<code>
						<![CDATA[OnSaveData()
{
	// This should never get called, but if for some reason it does, we only want this form
	// to close if it is cancelled or if the analyst clicks one of the update buttons.
	MessageBox("Please use the [Place Call On Hold] button to process this on hold action.");
	return false;
}]]>
					</code>
				</method>
			</methods>
		</javascript>
	</configuration>
	<layouts>
		<layout>
			<appearance>
				<width>555</width>
				<height>391</height>
				<backgroundColor>#ffffff</backgroundColor>
				<fillColour>#ffffff</fillColour>
				<textColour >#000000</textColour >
				<font  size="8">Arial</font>
			</appearance>
			<controls>
				<control>
					<general>
						<name>CaptionPanel2</name>
						<type>CaptionBar</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>true</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>0</index>
						<caption>Details</caption>
						<backgroundColor>#f1f1f1</backgroundColor>
						<foregroundColor>#003366</foregroundColor>
						<font  size="10" bold="1">Trebuchet (MS)</font>
						<alignment>Left</alignment>
						<fillStyle>Vertical Gradient</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>28</top>
							<left>3</left>
							<right>394</right>
							<bottom>165</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor2>#d8d8d8</backgroundColor2>
							<imageHSpace>10</imageHSpace>
							<slope>12</slope>
							<borderColor>#d3c9b6</borderColor>
							<headerHeight>23</headerHeight>
							<hasBorder>1</hasBorder>
							<panelBorderColor>#d3c9b6</panelBorderColor>
							<fillStyle>0</fillStyle>
							<panelBackgroundColor>#f2eedd</panelBackgroundColor>
							<panelBackgroundColor2>#000000</panelBackgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>CaptionPanel3</name>
						<type>CaptionBar</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>true</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>1</index>
						<caption>Options</caption>
						<backgroundColor>#f1f1f1</backgroundColor>
						<foregroundColor>#003366</foregroundColor>
						<font  size="10" bold="1">Trebuchet (MS)</font>
						<alignment>Left</alignment>
						<fillStyle>Vertical Gradient</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>28</top>
							<left>402</left>
							<right>551</right>
							<bottom>165</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor2>#d8d8d8</backgroundColor2>
							<imageHSpace>10</imageHSpace>
							<slope>12</slope>
							<borderColor>#d3c9b6</borderColor>
							<headerHeight>23</headerHeight>
							<hasBorder>1</hasBorder>
							<panelBorderColor>#d3c9b6</panelBorderColor>
							<fillStyle>0</fillStyle>
							<panelBackgroundColor>#f2eedd</panelBackgroundColor>
							<panelBackgroundColor2>#000000</panelBackgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>CaptionPanel1</name>
						<type>CaptionBar</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>true</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>2</index>
						<caption>Other Information</caption>
						<backgroundColor>#f1f1f1</backgroundColor>
						<foregroundColor>#003366</foregroundColor>
						<font  size="10" bold="1">Trebuchet (MS)</font>
						<alignment>Left</alignment>
						<fillStyle>Vertical Gradient</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>172</top>
							<left>3</left>
							<right>551</right>
							<bottom>388</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
							<backgroundColor2>#d8d8d8</backgroundColor2>
							<imageHSpace>10</imageHSpace>
							<slope>12</slope>
							<borderColor>#d3c9b6</borderColor>
							<headerHeight>23</headerHeight>
							<hasBorder>1</hasBorder>
							<panelBorderColor>#d3c9b6</panelBorderColor>
							<fillStyle>0</fillStyle>
							<panelBackgroundColor>#f2eedd</panelBackgroundColor>
							<panelBackgroundColor2>#000000</panelBackgroundColor2>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_UpdateText</name>
						<type>Field</type>
						<group>Tab1:0</group>
					</general>
					<appearance>
						<index>3</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>232</top>
							<left>20</left>
							<right>533</right>
							<bottom>372</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.updatetxt</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Text Edit</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>true</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>true</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<autoCompleteField>false</autoCompleteField>
							<editUnlimitedText>true</editUnlimitedText>
							<url>false</url>
						</flags>
						<textLineCount>4</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>dt_HoldUntil</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>4</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>78</top>
							<left>11</left>
							<right>218</right>
							<bottom>96</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Date/Time Control</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<colorDateIndicator>false</colorDateIndicator>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<dateFormatMode>0</dateFormatMode>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>tb_TimeSpent</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>5</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>78</top>
							<left>227</left>
							<right>286</right>
							<bottom>96</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Minute Time Period</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<defaultValue>5</defaultValue>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>cb_ActionSource</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>6</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>123</top>
							<left>11</left>
							<right>218</right>
							<bottom>141</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udsource</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>Telephone</displayColumnValue>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<defaultValue>Telephone</defaultValue>
							<listItems>Telephone|E-mail|</listItems>
							<borderColor>#c0c0c0</borderColor>
							<sqlSource>swdata</sqlSource>
							<distinctTable>swlists</distinctTable>
							<distinctColumn>value</distinctColumn>
							<displayColumn>display_name</displayColumn>
							<listFilter>lid=CALL-ACTION-SOURCE,CALL-ACTION-SOURCE-ON-HOLD</listFilter>
							<storedQuery>common.getSwLists</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>cb_ActionType</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>7</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>123</top>
							<left>227</left>
							<right>388</right>
							<bottom>141</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udcode</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<displayColumnValue>General Update</displayColumnValue>
						<properties>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<defaultValue>General Update</defaultValue>
							<listItems>General Update|Called Customer|E-mailed Customer|</listItems>
							<borderColor>#c0c0c0</borderColor>
							<sqlSource>swdata</sqlSource>
							<distinctTable>swlists</distinctTable>
							<distinctColumn>value</distinctColumn>
							<displayColumn>display_name</displayColumn>
							<listFilter>lid=CALL-ACTION-TYPE,CALL-ACTION-TYPE-ON-HOLD</listFilter>
							<storedQuery>common.getSwLists</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_emailcustomer</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>8</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>76</top>
							<left>406</left>
							<right>522</right>
							<bottom>95</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>E-mail customer^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_updatepublic</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>9</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>56</top>
							<left>406</left>
							<right>535</right>
							<bottom>74</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>Update to be public^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Tab1</name>
						<type>TabControl</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>10</index>
						<caption>Tab1</caption>
						<backgroundColor>#ded7ce</backgroundColor>
						<foregroundColor>#ffffff</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>201</top>
							<left>10</left>
							<right>545</right>
							<bottom>382</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<tabStyle>Top</tabStyle>
					<tabSize>19</tabSize>
					<items>
						<item>
							<name>Description</name>
							<properties>56=#d1e0ee|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#d1e0ee</tabColor>
								</properties>
							</controlInfo>
						</item>
						<item>
							<name>File Attachments</name>
							<properties>56=#ffcc66|_flags=0</properties>
							<textBorder>None</textBorder>
							<textBackgroundColor>#ffffff</textBackgroundColor>
							<controlInfo>
								<mouseOverCursor>Window Default</mouseOverCursor>
								<properties>
									<tabColor>#ffcc66</tabColor>
								</properties>
							</controlInfo>
						</item>
					</items>
					<selectedTextFont  size="8">Arial</selectedTextFont>
					<selectedTextColor>#000000</selectedTextColor>
					<deselectedTextColor>#000000</deselectedTextColor>
					<tabSlopeLeft>2</tabSlopeLeft>
					<tabSlopeRight>2</tabSlopeRight>
					<deselectedTabHeightOffset>1</deselectedTabHeightOffset>
					<tabSpacing>0</tabSpacing>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<tabStyle>0</tabStyle>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fl_attachments</name>
						<type>FileListTable</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
							<showHeader>true</showHeader>
							<verticalGridLines>true</verticalGridLines>
							<horizontalGridLines>true</horizontalGridLines>
							<autoLoad>true</autoLoad>
							<allowMultiSelect>true</allowMultiSelect>
						</flags>
						<group>Tab1:1</group>
					</general>
					<appearance>
						<index>11</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>230</top>
							<left>19</left>
							<right>458</right>
							<bottom>373</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>100</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<columns>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>File Name</name>
							<width>160</width>
							<image>-1</image>
							<dataColumn>0</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Size</name>
							<width>80</width>
							<image>-1</image>
							<dataColumn>1</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Last Modified</name>
							<width>120</width>
							<image>-1</image>
							<dataColumn>2</dataColumn>
						</controlInfo>
						<controlInfo>
							<mouseOverCursor>Window Default</mouseOverCursor>
							<type>Text Edit</type>
							<flags>
								<invisible>false</invisible>
								<readOnly>false</readOnly>
								<mandatory>false</mandatory>
								<mandatoryLabelBackground>false</mandatoryLabelBackground>
								<mandatoryLabelText>false</mandatoryLabelText>
								<allowNullValue>false</allowNullValue>
								<skipTabStop>false</skipTabStop>
								<disabled>false</disabled>
								<protected>false</protected>
								<noMacroExpand>false</noMacroExpand>
								<readOnlyInit>false</readOnlyInit>
								<autoCompleteField>false</autoCompleteField>
								<editUnlimitedText>false</editUnlimitedText>
								<url>false</url>
								<hidden>false</hidden>
								<allowResize>true</allowResize>
								<allowSort>true</allowSort>
							</flags>
							<textLineCount>0</textLineCount>
							<textInputFormat>Text</textInputFormat>
							<properties>
							</properties>
							<name>Full Local Path</name>
							<width>100</width>
							<image>-1</image>
							<dataColumn>3</dataColumn>
						</controlInfo>
					</columns>
					<sortColumn>-1</sortColumn>
					<sortDescending>false</sortDescending>
					<headerHeight>16</headerHeight>
					<rowHeight>16</rowHeight>
					<selectedColor>#00008b</selectedColor>
					<selectedTextColor>#ffffff</selectedTextColor>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<content>NAME=DeerSir1.doc;PATH=C:\Documents and Settings\NeilWJ\My Documents\DeerSir1.doc;SIZE=58880;LASTMODIFIED=1114767614</content>
							<borderColor>#c0c0c0</borderColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnAdd</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Tab1:1</group>
					</general>
					<appearance>
						<index>12</index>
						<caption>Add</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>230</top>
							<left>466</left>
							<right>530</right>
							<bottom>254</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<commands>74</commands>
							<eventButtonIcon>74</eventButtonIcon>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnRemove</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
						<group>Tab1:1</group>
					</general>
					<appearance>
						<index>13</index>
						<caption>Remove</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>260</top>
							<left>466</left>
							<right>530</right>
							<bottom>284</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>ActionTypeLabel</name>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>14</index>
						<caption>Action Type</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>101</top>
							<left>225</left>
							<right>287</right>
							<bottom>119</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udcode</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>ActionSourceLabel</name>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>15</index>
						<caption>Action Source</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>101</top>
							<left>9</left>
							<right>82</right>
							<bottom>119</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.udsource</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<type>FieldName</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>16</index>
						<caption>Time Spent</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>56</top>
							<left>225</left>
							<right>282</right>
							<bottom>74</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
						<binding>updatedb.timespent</binding>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Text1</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>17</index>
						<caption>Place on hold until</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<alignment>Left</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>56</top>
							<left>8</left>
							<right>120</right>
							<bottom>74</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnHoldCall</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>true</toolbarButtonStyle>
							<cache>true</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>18</index>
						<caption>Place Call On Hold</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>-1</top>
							<left>8</left>
							<right>127</right>
							<bottom>22</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>0</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<eventButtonIcon>ImageList=Hold Call;IconIndex=5</eventButtonIcon>
							<backgroundColor>#ff9900</backgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>btnAdd</name>
						<type>EventButton</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>true</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>true</toolbarButtonStyle>
							<cache>true</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>19</index>
						<caption>Attach File</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
					</appearance>
					<objectPlacement>
						<position>
							<top>-1</top>
							<left>460</left>
							<right>551</right>
							<bottom>22</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>100</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>false</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
							<commands>74</commands>
							<eventButtonIcon>74</eventButtonIcon>
							<backgroundColor>#ff9900</backgroundColor>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>Rect1</name>
						<type>Rectange</type>
						<flags>
							<transparent>false</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>true</toolbarButtonStyle>
							<cache>true</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>20</index>
						<backgroundColor>#d4d0c8</backgroundColor>
						<foregroundColor>#dddddd</foregroundColor>
						<font  size="0"/>
						<borderStyle>Rectangle</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>-1</top>
							<left>0</left>
							<right>560</right>
							<bottom>24</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>0</left>
							<right>100</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>fld_on_hold_period</name>
						<type>Field</type>
					</general>
					<appearance>
						<index>21</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<borderStyle>Rectangle</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>144</top>
							<left>227</left>
							<right>388</right>
							<bottom>162</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Distinct Pick List</type>
						<flags>
							<invisible>true</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>true</comboNewValues>
							<pickListOrderDesc>false</pickListOrderDesc>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<borderColor>#c0c0c0</borderColor>
							<image>#eeeeee</image>
							<sqlSource>swdata</sqlSource>
							<distinctTable>onhold_periods</distinctTable>
							<distinctColumn>period_name</distinctColumn>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
							<storedQuery>common.filterByTableValues</storedQuery>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>lbl_on_hold_period</name>
						<type>Text</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>22</index>
						<caption>On Hold Period</caption>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Arial</font>
						<alignment>Right</alignment>
						<borderStyle>None</borderStyle>
						<fillStyle>Solid</fillStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>145</top>
							<left>134</left>
							<right>222</right>
							<bottom>159</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>25</left>
							<right>25</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<flags>
							<invisible>true</invisible>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>false</protected>
							<noMacroExpand>false</noMacroExpand>
							<multiLine>false</multiLine>
						</flags>
						<properties>
						</properties>
					</controlInfo>
				</control>
				<control>
					<general>
						<name>flg_addtoparentdiary</name>
						<type>Field</type>
						<flags>
							<transparent>true</transparent>
							<xpStyle>false</xpStyle>
							<hasShadow>false</hasShadow>
							<toolbarButtonStyle>false</toolbarButtonStyle>
							<cache>false</cache>
							<hasBorder>false</hasBorder>
							<hasCheckbox>false</hasCheckbox>
						</flags>
					</general>
					<appearance>
						<index>23</index>
						<backgroundColor>#ffffff</backgroundColor>
						<foregroundColor>#000000</foregroundColor>
						<font  size="8">Trebuchet MS</font>
						<borderStyle>None</borderStyle>
					</appearance>
					<objectPlacement>
						<position>
							<top>95</top>
							<left>406</left>
							<right>542</right>
							<bottom>114</bottom>
						</position>
						<scaling>
							<top>0</top>
							<left>50</left>
							<right>50</right>
							<bottom>0</bottom>
						</scaling>
					</objectPlacement>
					<data>
					</data>
					<controlInfo>
						<mouseOverCursor>Window Default</mouseOverCursor>
						<type>Form Flags</type>
						<flags>
							<invisible>false</invisible>
							<readOnly>false</readOnly>
							<mandatory>false</mandatory>
							<mandatoryLabelBackground>false</mandatoryLabelBackground>
							<mandatoryLabelText>false</mandatoryLabelText>
							<allowNullValue>false</allowNullValue>
							<skipTabStop>false</skipTabStop>
							<disabled>false</disabled>
							<protected>true</protected>
							<noMacroExpand>false</noMacroExpand>
							<readOnlyInit>false</readOnlyInit>
							<comboAutoUpdate>false</comboAutoUpdate>
							<comboNewValues>false</comboNewValues>
						</flags>
						<textLineCount>0</textLineCount>
						<textInputFormat>Text</textInputFormat>
						<properties>
							<activeTextColor>#eeeeee</activeTextColor>
							<flagItems>Add to parent diary^1|</flagItems>
							<disabledBackgroundColor>#eeeeee</disabledBackgroundColor>
						</properties>
					</controlInfo>
				</control>
			</controls>
			<formActions>
			</formActions>
			<javascript>
				<methods>
					<method>
						<name>btnHoldCall_OnPressed</name>
						<code>
							<![CDATA[btnHoldCall_OnPressed()
{
	//-- required for modeless email template dialog
	var funcCloseForm = function()
	{
		// -- Close Form
		_swdoc.bFormFieldChanged = false;			
		_swdoc.CloseForm();
	}
	
	if(!ValidateForm())
	{
		return false;
	}
	
	// -- Check that analyst has sufficient rights to place a call on hold
	if(!app.session.HaveRight(ANALYST_RIGHT_A_GROUP, ANALYST_RIGHT_A_CANPLACECALLONHOL, TRUE))
	{
		MessageBox("You don't have sufficient rights to place a call on hold.");
		return false;
	}
	
	// -- Place the call on hold using XMLMC API(s)
	var xmlmc = new XmlMethodCall;
	// -- API method
	var strMethod = "holdCalls";
	// -- Find modified values in UPDATEDB table
	var arrExtraUpdateDbValues = new Array();
	var strUpdateDbValues = "";
	if(rec = _swdoc.GetRecord("updatedb"))
	{
		var nColCount = rec.GetCount();
		for(x = 0; x < nColCount; x++)
		{
			if(!rec.IsModified(x))
				continue;
			arrExtraUpdateDbValues[rec.GetColumnName(x)] = rec.GetValue(x);
		}
	}
	for (fieldName in arrExtraUpdateDbValues)
	{
		strUpdateDbValues += "<"+fieldName+">"+ app.global.PrepareForXML(arrExtraUpdateDbValues[fieldName])+"</"+fieldName+">";
	}
	
	// -- Workout "holdUntil" value
	var strHoldUntilDate = new Date(mainform.dt_HoldUntil.text);
	
	// ** API params ** //
	var arrCallrefs = _swdoc._form["callrefs"].split(",");
 	for(x in arrCallrefs)
		xmlmc.SetValue("callref", arrCallrefs[x]);
	xmlmc.SetValue("timeSpent", mainform.tb_TimeSpent.value);
	xmlmc.SetValue("description", rec.updatetxt);
	xmlmc.SetValue("holdUntil", strHoldUntilDate);
	var boolPublicUpdate = (flg_updatepublic.text == "1" )? true : false;
	xmlmc.SetValue("publicUpdate", boolPublicUpdate);
	if(rec.udsource!="")
		xmlmc.SetValue("updateSource", rec.udsource);
	if(rec.udcode!="")
		xmlmc.SetValue("updateCode", rec.udcode);
	// -- fileAttachment param
	for(i=0; i<mainform.fl_attachments.rowCount();i++)
	{
 		// -- Check for Server file (These need to use serverFileAttachment)
		var fileName = fl_attachments.GetItemText(i,3);
		var serverFile = fileName.indexOf("MFA:");
		if(serverFile >= 0)
		{
			//-- File was attached to email use serverFileAttachment param
			var strFileName = fl_attachments.GetItemText(i,0);
			var strData = fl_attachments.GetItemText(i,3);
			var strXML = "<fileName>"+strFileName+ "</fileName>";
			if(!app.bWebClient)
				strXML += "<fileSource>"+strData+"</fileSource>";
			xmlmc.SetParamAsComplexType("serverFileAttachment",strXML);
		}else
		{
			//-- File was uploaded to email use fileAttachement param
			var strFileName = fl_attachments.GetItemText(i,0);
			var strData = app.global.LoadFileInBase64(fl_attachments.GetItemText(i,3));
			var strXML = "<fileName>"+strFileName+ "</fileName>";
			if(!app.bWebClient)
				strXML += "<fileData>"+strData+"</fileData>";
			xmlmc.SetParamAsComplexType("fileAttachment",strXML);
		}
    }
	if(strUpdateDbValues!="")
		xmlmc.SetParamAsComplexType("extraUpdateDbValues", strUpdateDbValues);	
	// ** EO API params ** //
	
	// -- Invoke XMLMC API
	if(xmlmc.Invoke("helpdesk",strMethod))
	{
		var strXML = (app.bWebClient)? xmlmc._lastresult:xmlmc.GetReturnXml();
		var objRes = app.XMCResult(strXML);
		if(!objRes.success)
		{
			MessageBox("The " + strMethod + " API method was rejected by the server.");
			return false;
	    }
		else
		{
			// -- Handle XMLMC response
			// -- Call Attachments, Compose Email and "On Hold Notifiers" feature
			
			//###20120704 - set up On Hold Notifiers			
			if(app.boolOnHoldNotification && "" != _swdoc.MF().fld_on_hold_period.value){
				var oh_period_name = _swdoc.MF().fld_on_hold_period.value;
				var onhold_period = app.g.get_record("onhold_periods",oh_period_name);
				var intNow = new Date();
				intNow = Math.round(intNow.getTime() / 1000);
				var intEndTime = _swdoc.MF().dt_HoldUntil.value;
				//### as working days depend on the priority, we grab all the calls' priorities here
				var strParams = "crfs="+ app.pfu(_swdoc.CallrefsCommaString);
				var callrefs_to_notify = app.g.get_sqrecordset("form/EfHoldCallForm/get_priorities_for_calls", strParams);
				while(callrefs_to_notify.Fetch()){
			
					var priority_against = app.g.get_field(callrefs_to_notify, "priority");
					if (""==priority_against){
						MessageBox("No priority was found, periodical on hold notifications will not be sent.");
						break;
					}
					
					if (1 == onhold_period.flg_work_week){
						//### build array of "calendar" days
						var arrLeadTimeExpiry = new Array();
						var intArrayBuildInfo = intNow;
						while (intArrayBuildInfo < intEndTime){
							arrLeadTimeExpiry[arrLeadTimeExpiry.length] = intArrayBuildInfo;
							intArrayBuildInfo += 86400;
						}
						arrLeadTimeExpiry[arrLeadTimeExpiry.length] = intEndTime;
					} else {
						//### get array of "working" days
						var arrLeadTimeExpiry = app.g.get_sla_end_date(intNow, priority_against, onhold_period.period_days + 1, true);
					}

					var strParams = "name="+app.pfu(oh_period_name);
					var onhold_settings = app.g.get_sqrecordset("form/EfHoldCallForm/get_notifiers_for_period", strParams);

					//### setting of Off Hold data
					var oh_end_alert_time = arrLeadTimeExpiry[arrLeadTimeExpiry.length-1] + 14400; //### ensuring this has not been sent at time of Off Hold.
					var oh_end_popup_subject = "";
					var oh_end_popup_message = "";
					var oh_end_mailbox = "";
					var oh_end_template = "";
					var oh_end_diary_entry = "";
					var oh_end_recipient = "";
					
					while(onhold_settings.Fetch()){
						var oh_days_into = app.g.get_field(onhold_settings,"days_from");
						var from_start_or_end = app.g.get_field(onhold_settings,"rem_strike");
						var blnSkip = false;
						
						if (onhold_period.period_days > oh_days_into){
							var oh_alert_time = 0;

							if (1==from_start_or_end){
								//### from end
								if (1 == onhold_period.flg_work_week){
									if(arrLeadTimeExpiry.length - (oh_days_into + 1)>=0)
										oh_alert_time = arrLeadTimeExpiry[arrLeadTimeExpiry.length - (oh_days_into + 1)];
									else
										blnSkip = true; //### in case the amount of days calculated falls out of scope THEN drop this reminder.
								} else {
									var work_days = app.g.get_workdays_till_date(intNow, priority_against, intEndTime,true);
									if(work_days.length - (oh_days_into + 1)>=0)
										oh_alert_time = work_days[work_days.length - (oh_days_into + 1)];
									else
										blnSkip = true; //### in case the amount of days calculated falls out of scope THEN drop this reminder.
								}
							} else {
								//### from start
								oh_alert_time = arrLeadTimeExpiry[oh_days_into];
							}
							
							//### setting of data for this particular reminder
							var oh_popup_subject = (app.g.get_field(onhold_settings, "popup_subject"));
							var oh_popup_message = (app.g.get_field(onhold_settings, "popup_message"));
							var oh_mailbox = app.g.get_field(onhold_settings, "mailbox");
							var oh_template = (app.g.get_field(onhold_settings, "template"));
							var oh_diary_entry = (app.g.get_field(onhold_settings, "diary_entry"));
							var oh_recipient = (app.g.get_field(onhold_settings, "recipient"));
							if (!blnSkip)
							{
								var ap = {}
								ap.oh_mailbox=oh_mailbox;
								ap.oh_template = oh_template;
								ap.oh_diary_entry = oh_diary_entry;
								ap.oh_period_name = oh_period_name;
								ap.oh_recipient = oh_recipient;
								ap.callref =  app.g.get_field(callrefs_to_notify, "callref");
								ap.oh_alert_time = oh_alert_time;
								ap.oh_popup_subject = oh_popup_subject;
								ap.oh_popup_message = oh_popup_message;
								app.g.submitsqs("form/EfHoldCallForm/add_notifier_for_call", ap);
							}
						} 
						else 
						{
							//### IF it reaches here (for some reason there is a days_from which is larger than the amount defined for the period) then capture this info for Off Hold
							oh_end_popup_subject = (app.g.get_field(onhold_settings, "popup_subject"));
							oh_end_popup_message = (app.g.get_field(onhold_settings, "popup_message"));
							oh_end_mailbox = app.g.get_field(onhold_settings, "mailbox");
							oh_end_template = (app.g.get_field(onhold_settings, "template"));
							oh_end_diary_entry = (app.g.get_field(onhold_settings, "diary_entry"));
							oh_end_recipient = (app.g.get_field(onhold_settings, "recipient"));
						}						
					}
					var ap = {}
					ap.oh_mailbox=oh_end_mailbox;
					ap.oh_template = oh_end_template;
					ap.oh_diary_entry = oh_end_diary_entry;
					ap.oh_period_name = oh_period_name;
					ap.oh_recipient = oh_end_recipient;
					ap.callref =  app.g.get_field(callrefs_to_notify, "callref");
					ap.oh_alert_time = oh_end_alert_time;
					ap.oh_popup_subject = oh_end_popup_subject;
					ap.oh_popup_message = oh_end_popup_message;
					app.g.submitsqs("form/EfHoldCallForm/add_notifier_for_call", ap);
				}
			}
			
			var myXmlFile = new XmlFile(); 
			bRet = myXmlFile.loadFromString(strXML); 
			var arrChildCallInfo = null;
			var arrCallInfo = new Array();
			var strDocs = "";
			for (count = 0; count < myXmlFile.methodCallResult.params.length; count ++) 
			{
				if(myXmlFile.methodCallResult.params[count].nodeName=="callActionStatus")
				{  
					var boolSuccess = myXmlFile.methodCallResult.params[count]['success'].nodeValue;
					if(boolSuccess=="false")
					{
						var strMessage =  myXmlFile.methodCallResult.params[count]['message'].nodeValue;
						MessageBox(strMessage);
						return false;
					}
					var strCallref = myXmlFile.methodCallResult.params[count]['callref'].nodeValue;
					var strIndex = myXmlFile.methodCallResult.params[count]['udIndex'].nodeValue;
					arrCallInfo[strCallref] = strIndex;
				}
				else if(myXmlFile.methodCallResult.params[count].nodeName=="callFileAttachment")
				{
					var intCount = arrCallInfo.length;
					if(intCount==1)
					{
						try
						{
							var updateId = myXmlFile.methodCallResult.params[count]['updateId'].nodeValue;
							if(updateId==arrCallInfo[strCallref])
							{
								var pathName = myXmlFile.methodCallResult.params[count]['pathName'].nodeValue;
								var fileName = myXmlFile.methodCallResult.params[count]['fileName'].nodeValue;
								var fileSize = myXmlFile.methodCallResult.params[count]['fileSize'].nodeValue;
								if(strDocs!="") strDocs +="\r\n";
								strDocs +='displayname="'+fileName+'"; path="'+pathName+'"; size="'+fileSize+'";';
							}
						}
						catch(e)
						{
							// --
						}
					}
				}
			}
			
			// If we have been invoked to update a call from an e-mail message, this update will 
			// only relate to a single call. We can only handle e-mail audit trail if we are working
			// on a single-call update. 
			if(arrCallrefs.length == 1 && 			// Are we only dealing with a single call reference?
				_swdoc._form["messagesource"] && 	// Are we working from an e-mail message?
				dd.GetGlobalParamAsNumber("Email Audit Trail/StoreEmailAuditTrail")) // Are we configured?
			{
				app.g.attach_message_to_call(_swdoc._form,arrCallrefs[0],arrCallInfo[arrCallrefs[0]]);
			}
	
    		// if we want to send an email to the customer AND there are file attachments, obtain the 
    		// attachments to attach to the email as well
    		var flSessionFilesInfo = "";
    		if(mainform.flg_emailcustomer.value && app.global.IsConnectedToMailServer())
    		{
				// Now, compose an email to the customer				
				app.global.ComposeCallUpdateEmail(arrCallInfo, 					// Array: Call reference-UdIndex
										_swdoc.updatedb.updatetxt, 	// Message text
										strDocs, 		// File attachments
										_swdoc.updatedb.timespent,
										"HoldCallMailTemplate", 		// Template name
										TEMPLATE_HOLDCALL,				// Template type
										function()
										{
											funcCloseForm();
										});
			}
			else
			{
				funcCloseForm();
			}
		}
	}	
	else
	{
		(app.bWebClient)? MessageBox(xmlmc._lastresult):MessageBox(xmlmc.GetReturnXml());
		funcCloseForm();
	}		
}]]>
						</code>
					</method>
					<method>
						<name>btnAdd_OnPressed</name>
						<code>
							<![CDATA[btnAdd_OnPressed()
{
	//-- add a new file
	//fl_attachments.newFile = PickAnalystDialog();
	fl_attachments.AddFiles();

}]]>
						</code>
					</method>
					<method>
						<name>btnRemove_OnPressed</name>
						<code>
							<![CDATA[btnRemove_OnPressed()
{
	//-- remove selected files
	for(var i=fl_attachments.rowCount()-1; i>=0;i--)
    {
    	//-- if selected remove
    	if(fl_attachments.IsRowSelected(i))	fl_attachments.RemoveRow(i);
    }
}]]>
						</code>
					</method>
					<method>
						<name>OnFormLoaded</name>
						<code>
							<![CDATA[OnFormLoaded()
{
	//-- clear update field
		app._ete(tb_UpdateText,"");
	
	//--
	//-- set public flag depending on the rights of the analyst
		app._ete(flg_updatepublic,(app.session.IsDefaultOption(ANALYST_DEFAULT_HOLDPRIVATE) ? "1":"0"));
						
	//-- check if we have a mail connection and analyst can send mail
		if(app.global.IsConnectedToMailServer() && app.global.CanSendMail())
		{
			//-- set flg to editable and set to defualt setting for this analyst
			app._ero(flg_emailcustomer,false);
			app._ete(flg_emailcustomer,(app.session.IsDefaultOption(ANALYST_DEFAULT_HOLDSENDEMAIL) ? "1":"0"));
		}
		else
		{
			//-- not allowed to send email disable and set to 0
			app._ero(flg_emailcustomer,true);
			app._ete(flg_emailcustomer,"0");
		}
		
	//--
	//-- set update text
		if(_swdoc.UpdateText.length)app._ete(tb_UpdateText,_swdoc.UpdateText);
		
		

	//if this form has been called with attachments, add them to the attachments list
		var index = 0;
		var bAreAttachments = false;
		
 		while(_swdoc._form["attach"+index]) 
 		{
 			bAreAttachments = true;
    		fl_attachments.AddAttachment(_swdoc._form["attach" + index]);
			index++;
 		} 
 	
 	//if the analyst does not have permissions to add files to calls, make the file attachments box invisible
 	//UNLESS there are file attachments being included from the email which called this form, in which case
 	//show the file attachments, but make the Add and Remove buttons invisible
 	
 		if(!app.session.HaveRight(ANALYST_RIGHT_A_GROUP,ANALYST_RIGHT_A_CANATTACHFILESTOCALLS, false))
 		{
 			if(!bAreAttachments)
 			{
 				Tab1.ShowTabItem(1,false);
 			}
 			else
 			{
 				app._evi(btnAdd,false);
 				app._evi(btnRemove,false);
 			}
 		}
		
	//-- set the hold until date to now
		app._eva(dt_HoldUntil, app.global.GetCurrentEpocTime());
		
	//-- set action source
		app._ete(cb_ActionSource,_swdoc.strActionSource);
	
	//###20120704 - display the onhold period (or not)
	app._evi(_swdoc.MF().fld_on_hold_period , app.boolOnHoldNotification); 
	app._evi(_swdoc.MF().lbl_on_hold_period , app.boolOnHoldNotification); 
		
	//-- Set the Default Value for the Time Spent field
	//SetDefaultTimeSpent();
}]]>
						</code>
					</method>
					<method>
						<name>(User Defined Functions)</name>
						<code>
							<![CDATA[//-- Validate the form data to make sure it is ok
function ValidateForm()
{

	if((tb_TimeSpent.text < 1 || tb_TimeSpent.text > 60000) &&(tb_TimeSpent.mandatory))
	{
		MessageBox("You must enter the amount of time you spent on this action", MB_OK);
		return false;;	// Make sure that the time spent is within range
	}
	
	if(tb_UpdateText.text == "")
	{
		MessageBox("You must enter an update description to place this call on hold", MB_OK);
		return false;	// Make sure we have some update text
	}

	var nowTime = new Number(app.global.GetCurrentEpocTime());
	if(app.global.EpocTimeFromString(dt_HoldUntil.text) <= nowTime)
	{
		MessageBox("You must set a time in the future.", MB_OK | MB_ICONSTOP);
		return false;
	}

	if(cb_ActionSource.mandatory == true && cb_ActionSource.text.length == 0)
	{
		var Message = "The field'" + ActionSourceLabel.text + "' must be completed before you can apply this action"
		MessageBox(Message);
		return false;
	}

	if(cb_ActionType.mandatory == true  && cb_ActionType.text.length == 0)
	{
		var Message = "The field '" + ActionTypeLable.text + "' must be completed before you can apply this action";
		MessageBox(Message);
		return false;
	}
	
	if(!check_mandatory_fields("opencall",mainform)) return false;
	if(!check_mandatory_fields("updatedb",mainform)) return false;

	return true;
}

//-- 08.02.2007 - NWJ - Check mandatory fields on the form for a given table
//--					alert user if need be and return false						
function check_mandatory_fields(strTable,oForm)
{
    for (var x = 0; x<oForm.elements.length;x++)
    {
        var element = oForm.elements[x];
        if ((element.mandatory) && (element.text ==""))
        {
            var colName = "";
            var fieldName = "(not specified)";
            if(element.dataRef!="")
            {
            	var arrInfo = element.dataRef.split(".");
            	var strTable = arrInfo[0];
            	var colName = arrInfo[1];
            	var fieldName = dd.tables[strTable].columns[colName.toLowerCase()].DisplayName;
            }
            MessageBox("The field '" + fieldName + "' is a mandatory field and must be completed.");
            return false;
        }
    }
    return true;
}


function SetDefaultTimeSpent()
{

	
}]]>
						</code>
					</method>
					<method>
						<name>OnFieldValueChanged</name>
						<code>
							<![CDATA[OnFieldValueChanged(strName, strValue)
{
	//-- This value is set when a field value has been changed.
	//-- We check this variable on from closing to see if there are any data changes that need to be saved.
	_swdoc.bFormFieldChanged = true;


}]]>
						</code>
					</method>
					<method>
						<name>fld_on_hold_period_OnValueChanged</name>
						<code>
							<![CDATA[fld_on_hold_period_OnValueChanged(strValue)
{

	if (""!=strValue){
		var a = app.g.get_record("onhold_periods", strValue);
		//var intRequestedDate = app.g.fix_epoch(OC().requested_start_datex);
		var intNow = new Date();
		intNow = Math.round(intNow.getTime() / 1000);
		var calls = _swdoc.CallrefsCommaString.split(",");
		var c = app.g.get_sys_record("opencall", calls[0]);
		var intLeadTimeExpiry = 0;
		if (1 == a.flg_work_week){
			intLeadTimeExpiry = intNow + (a.period_days*86400)
		} else {
			intLeadTimeExpiry = app.g.get_sla_end_date(intNow, c.priority, a.period_days + 1);
		}
		app._eva(_swdoc.MF().dt_HoldUntil , Number(intLeadTimeExpiry));
		app._een(_swdoc.MF().dt_HoldUntil, (1==a.flg_override) );
	} else 	app._een(_swdoc.MF().dt_HoldUntil, true);

}]]>
						</code>
					</method>
					<method>
						<name>cb_ActionType_OnValueChanged</name>
						<code>
							<![CDATA[cb_ActionType_OnValueChanged(strValue)
{
	if (app.boolOnHoldNotification && ""!=strValue)
	{
		var strParams = "atype="+app.pfu(strValue);
		var oRS  = app.g.get_sqrecordset("form/EfHoldCallForm/get_notifier_periods_for_action",strParams);
		if (oRS.Fetch())
		{
			var strType = app.g.get_field(oRS, "action_type");
			if (""!=strType)
			{
				var strName = app.g.get_field(oRS, "period_name");
				app._eva(_swdoc.MF().fld_on_hold_period ,strName);
				_swdoc.MF().fld_on_hold_period_OnValueChanged(strName);
			}
		}
	}
	

}]]>
						</code>
					</method>
				</methods>
			</javascript>
		</layout>
		<layout>
			<appearance>
				<width>360</width>
				<height>220</height>
				<backgroundColor>#ffffff</backgroundColor>
				<fillColour>#ffffff</fillColour>
				<textColour >#000000</textColour >
				<font  size="8">Arial</font>
			</appearance>
			<controls>
			</controls>
			<formActions>
			</formActions>
			<javascript>
				<methods>
				</methods>
			</javascript>
		</layout>
	</layouts>
</espForm>
