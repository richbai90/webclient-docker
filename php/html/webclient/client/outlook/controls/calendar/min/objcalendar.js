var undefined;var arr_months=new Array("January","February","March","April","May","June","July","August","September","October","November","December");function objCalendar(varname,oDivholder,number_of_months,strFormat){this.type="calendar";this.name=varname;this.oHolder=oDivholder;this.format=strFormat;var tmpDate=new Date();var start_month=tmpDate.getMonth();var start_year=tmpDate.getFullYear();var day=tmpDate.getDate();this.today=format_date(strFormat,pad(day),pad(start_month+1),start_year);this.todaynum=start_year+pad(start_month+1)+pad(day);this.bgcolor="white";this.cell_color="black";this.cellselect_color="white";this.cellselect_bgcolor="navy";this.array_selecteddates=new Array();this.array_displayed_dates=new Array();this.startmonth=start_month+1;this.startyear=start_year;this.numberofmonths=number_of_months;this.prevnext_jumpcount=number_of_months;this.firstdatenum="";this.lastdatenum="";this.lowestselecteddatenum=-1;this.highestselecteddatenum=-1;this.selectedcell=null;this.defaultselecttoday=true;this.multiselecting=true;this.multiselectwason=false;this.shiftoff=false;this.ctrloff=false;this.adateisselected=false;this.onDateSelected=null;this.onMultiDateSelected=null;this.onCalendarDrawn=null;this.onRedraw=null;}objCalendar.prototype.create_calendar=pt_create_calendar;objCalendar.prototype.todaysdate=pt_todaysdate;objCalendar.prototype.nextmonth=next_month;objCalendar.prototype.prevmonth=previous_month;objCalendar.prototype.highlightdate=pt_highlightdate;objCalendar.prototype.highlightbetweendates=pt_highlightbetweendates;objCalendar.prototype.selectdate=pt_selectdate;objCalendar.prototype.highlight_selected_dates=pt_highlight_selected_dates;objCalendar.prototype.restorecellcolor=pt_restorecellcolor;objCalendar.prototype.clearselecteddates=pt_clearselecteddates;objCalendar.prototype.check_multi_select=pt_check_multi_select;objCalendar.prototype.selecteddates_list=pt_selecteddates_list;objCalendar.prototype.isadateselected=pt_isadateselected;function pt_selectdate(e){var evtobj=window.event?event:e;var oCell=this;var ctrlSelect=false;var shiftSelect=false;var singleSelect=false;switch(oCell.oCalendar.check_multi_select(evtobj)){case 0:shiftSelect=true;break;case 1:ctrlSelect=true;break;}if(shiftSelect){if(oCell.oCalendar.selectedcell){if(oCell.oCalendar.selectedcell.numdate>oCell.numdate){oCell.oCalendar.clearselecteddates();oCell.oCalendar.highlightbetweendates(oCell.numdate,oCell.oCalendar.selectedcell.numdate,undefined,undefined,true);}else{oCell.oCalendar.clearselecteddates();oCell.oCalendar.highlightbetweendates(oCell.oCalendar.selectedcell.numdate,oCell.numdate,undefined,undefined,true);}if(oCell.oCalendar.onDateSelected!=null){oCell.oCalendar.onDateSelected(oCell);}oCell.oCalendar.selectedcell=oCell;}else{singleSelect=true;}}else{if(ctrlSelect){oCell.oCalendar.multiselectwason=true;oCell.oCalendar.selectedcell=null;}else{singleSelect=true;oCell.oCalendar.multiselectwason=false;oCell.oCalendar.clearselecteddates();oCell.oCalendar.lowestselecteddatenum=-1;oCell.oCalendar.highestselecteddatenum=-1;}}var boolRemove=false;if(oCell.highlighted){oCell.oCalendar.restorecellcolor(oCell.numdate);oCell.oCalendar.array_selecteddates[oCell.id]=null;boolRemove=true;}if(singleSelect){oCell.oCalendar.clearselecteddates();}if(!shiftSelect&&!boolRemove){oCell.oCalendar.highlightdate(oCell.numdate);}if(!boolRemove){oCell.highlighted=true;oCell.oCalendar.array_selecteddates[oCell.id]=oCell.numdate;if((oCell.oCalendar.lowestselecteddatenum==-1)||(oCell.oCalendar.lowestselecteddatenum>oCell.numdate)){oCell.oCalendar.lowestselecteddatenum=oCell.numdate;}if((oCell.oCalendar.highestselecteddatenum==-1)||(oCell.oCalendar.highestselecteddatenum<oCell.numdate)){oCell.oCalendar.highestselecteddatenum=oCell.numdate;}oCell.oCalendar.selectedcell=oCell;}if(oCell.oCalendar.onDateSelected!=null){oCell.oCalendar.onDateSelected(oCell);}oCell.oCalendar.adateisselected=oCell.oCalendar.isadateselected();}function pt_isadateselected(){for(cellid in this.array_selecteddates){try{var cell_date=this.array_selecteddates[cellid];if(cell_date!=null){return true;}}catch(e){}}return false;}function pt_highlightdate(in_datenum,in_bgcolour,in_fontcolour,store){if(in_datenum!=undefined){var strcellid=this.oHolder.id+"_"+in_datenum;var doc=app.getEleDoc(this.oHolder);var oCell=doc.getElementById(this.oHolder.id+"_"+in_datenum);}else{var oCell=this;}if(!store){oCell.Origcolor=undefined;oCell.Origfontcolor=undefined;}if(oCell.Origcolor==undefined){oCell.Origcolor=(in_bgcolour!=undefined)?in_bgcolour:oCell.style.background;}if(oCell.Origfontcolor==undefined){oCell.Origfontcolor=(in_fontcolour!=undefined)?in_fontcolour:oCell.style.color;}if(in_bgcolour==undefined){in_bgcolour=oCell.oCalendar.cellselect_bgcolor;}if(in_fontcolour==undefined){in_fontcolour=oCell.oCalendar.cellselect_color;}oCell.style.background=in_bgcolour;oCell.style.color=in_fontcolour;if(store){oCell.oCalendar.array_selecteddates[oCell.id]=oCell.numdate;if((oCell.oCalendar.lowestselecteddatenum==-1)||(oCell.oCalendar.lowestselecteddatenum>oCell.numdate)){oCell.oCalendar.lowestselecteddatenum=oCell.numdate;}if((oCell.oCalendar.highestselecteddatenum==-1)||(oCell.oCalendar.highestselecteddatenum<oCell.numdate)){oCell.oCalendar.highestselecteddatenum=oCell.numdate;}}}function pt_highlightbetweendates(in_startdatenum,in_enddatenum,in_bgcolour,in_fontcolour,store){var strhighlighteddates="";for(cell_numdate in this.array_displayed_dates){if((cell_numdate>=in_startdatenum)&&(cell_numdate<=in_enddatenum)){this.highlightdate(cell_numdate,in_bgcolour,in_fontcolour,store);if(strhighlighteddates!=""){strhighlighteddates+=",";}strhighlighteddates+=cell_numdate;}if(cell_numdate>in_enddatenum){return strhighlighteddates;}}return strhighlighteddates;}function pt_restorecellcolor(in_datenum){try{var doc=app.getEleDoc(this.oHolder);var oCell=doc.getElementById(this.oHolder.id+"_"+in_datenum);if(oCell.Origcolor!=undefined){oCell.style.background=oCell.Origcolor;}if(oCell.Origfontcolor!=undefined){oCell.style.color=oCell.Origfontcolor;}this.array_selecteddates[oCell.id]=null;oCell.highlighted=false;}catch(e){}}function pt_highlight_selected_dates(){for(cellid in this.array_selecteddates){try{var cell_date=this.array_selecteddates[cellid];if(cell_date!=null){this.highlightdate(cell_date);}}catch(e){}}}function pt_clearselecteddates(){for(cellid in this.array_selecteddates){try{var cell_date=this.array_selecteddates[cellid];if(cell_date!=null){this.restorecellcolor(cell_date);}}catch(e){}}this.array_selecteddates=new Array();this.adateisselected=false;this.lowestselecteddatenum=-1;}function pt_check_multi_select(evtobj){if(!this.multiselecting){return -1;}var SHIFTselect=evtobj.shiftKey;var CTRLselect=evtobj.ctrlKey;if((SHIFTselect)&&(!this.shiftoff)){return 0;}if((CTRLselect)&&(!this.ctrloff)){return 1;}return -1;}function pt_selecteddates_list(strDelimiter){var retString="";for(cellid in this.array_selecteddates){var cell_date=this.array_selecteddates[cellid];if(cell_date!=null){if(retString!=""){retString+=strDelimiter;}retString+=cell_date;}}return retString;}function pt_todaysdate(){return this.today;}function retfalse(){return false;}function pt_create_calendar(){var monthtodo=this.startmonth;var yeartodo=this.startyear;this.array_displayed_dates=new Array();this.firstdatenum="";this.lastdatenum="";this.oHolder.innerHTML="";var aDoc=app.getEleDoc(this.oHolder);for(var y=0;y<this.numberofmonths;y++){var boolDrawHeader=false;var aDiv=aDoc.getElementById(this.name+"_"+y);if(aDiv==null){boolDrawHeader=true;var strDiv="<div id='"+this.name+"_"+y+"' class='date-calendar' style='background:"+this.bgcolor+"' calendarobjectname='"+this.name+"'></div>";this.oHolder.onselectstart=retfalse;app.insertBeforeEnd(this.oHolder,strDiv);var aDiv=aDoc.getElementById(this.name+"_"+y);this.oHolder.oCalendar=this;}var showarrows=false;if(y==0){showarrows=true;}if(boolDrawHeader){create_header(aDiv,showarrows,this.name);create_body(aDiv,this.name);}if(monthtodo>12){monthtodo=monthtodo-12;yeartodo++;}set_calendar_monthyear(aDiv,monthtodo,yeartodo,this);monthtodo++;}if(this.onCalendarDrawn!=null){this.onCalendarDrawn();}}function previous_month(varname){if(varname==undefined){var oCalendar=this;}else{var oCalendar=eval(varname);}if(oCalendar.prevnext_jumpcount>1){oCalendar.startmonth=oCalendar.startmonth-oCalendar.prevnext_jumpcount+1;}else{oCalendar.startmonth=oCalendar.startmonth-oCalendar.prevnext_jumpcount;}if(oCalendar.startmonth<1){oCalendar.startmonth=12+oCalendar.startmonth;oCalendar.startyear--;}oCalendar.create_calendar();if(oCalendar.onRedraw!=null){oCalendar.onRedraw();}}function next_month(varname){if(varname==undefined){var oCalendar=this;}else{var oCalendar=eval(varname);}if(oCalendar.prevnext_jumpcount>1){oCalendar.startmonth=oCalendar.startmonth+oCalendar.prevnext_jumpcount-1;}else{oCalendar.startmonth=oCalendar.startmonth+oCalendar.prevnext_jumpcount;}if(oCalendar.startmonth>12){oCalendar.startmonth=oCalendar.startmonth-12;oCalendar.startyear++;}oCalendar.create_calendar();if(oCalendar.onRedraw!=null){oCalendar.onRedraw();}}function monthtext(in_month_number){return arr_months[in_month_number-1];}function set_calendar_monthyear(in_oHolder,in_month,in_year,oCalendar){app.setElementText(document.getElementById("tb_monthyear_"+in_oHolder.id),monthtext(in_month)+" "+in_year);var in_date=new Date();in_date.setYear(in_year);in_date.setMonth(in_month-1);var mydate=new Date();mydate.setYear(in_date.getFullYear());mydate.setMonth(in_date.getMonth());mydate.setDate(1);currmonth=getmonth(mydate);checkmonth=getmonth(mydate);lastweek=1;var x=2;var tmpDate=new Date();var highlightday=false;var thisyear=tmpDate.getFullYear();if((currmonth==getmonth(tmpDate))&&(in_year==thisyear)){highlightday=true;}var currday=getdayofweek(mydate);var currweek=getweek(mydate);set_calendarday(currweek-1,currday-1,1,in_oHolder,highlightday,in_month,in_year,oCalendar);while(checkmonth==currmonth){mydate.setDate(x);var currweek=getweek(mydate);if(lastweek>currweek){break;}lastweek=currweek;currday=getdayofweek(mydate);set_calendarday(currweek-1,currday,x,in_oHolder,highlightday,in_month,in_year,oCalendar);checkmonth=getmonth(mydate);x++;}}function create_body(objDivholder,objectcalendarname){var strHTML="";strHTML+='<table width="150px" border="0" cellspacing="0" cellpadding="0" class="daysheader" align=center >';strHTML+='<tr height="15px" >';strHTML+='<td class="daycell" valign="bottom" align="right">M</td>';strHTML+='<td class="daycell" valign="bottom" align="right">T</td>';strHTML+='<td class="daycell" valign="bottom" align="right">W</td>';strHTML+='<td class="daycell" valign="bottom" align="right">T</td>';strHTML+='<td class="daycell" valign="bottom" align="right">F</td>';strHTML+='<td class="daycell" valign="bottom" align="right">S</td>';strHTML+='<td class="daycell" valign="bottom" align="right">S</td>';strHTML+="</tr>";strHTML+="</table>";strHTML+='<table id="tbl_days" width="150px" border="0" cellspacing="0" cellpadding="0" class="daysholder"  align="center" calendarobjectname="'+objectcalendarname+'" >';for(var x=0;x<6;x++){strHTML+="<tr>";strHTML+='<td class="daycell" valign="middle" align="right" ></td>';strHTML+='<td class="daycell"  valign="middle" align="right" ></td>';strHTML+='<td class="daycell"  valign="middle" align="right" ></td>';strHTML+='<td class="daycell"  valign="middle" align="right" ></td>';strHTML+='<td class="daycell"  valign="middle" align="right" ></td>';strHTML+='<td class="daycell"  valign="middle" align="right" ></td>';strHTML+='<td class="daycell"  valign="middle" align="right" ></td>';strHTML+="</tr>";}strHTML+="</table>";app.insertBeforeEnd(objDivholder,strHTML);}function create_header(objDivholder,control_arrows,objectcalendarname){var strHTML="";strHTML+='<table width="150px" border="0" cellspacing="0" cellpadding="0" class="monthyear">';strHTML+='	<tr height="16px">';if(control_arrows){strHTML+='		<td><image src="arr_left.ico" align=left onclick="previous_month(this.getAttribute(\'calendarobjectname\'))" calendarobjectname="'+objectcalendarname+'" ></td>';}strHTML+='		<td  id="tb_monthyear_'+objDivholder.id+'" valign="middle"  align="middle" width="100%" class="monthyeartext"></td>';if(control_arrows){strHTML+='		<td><image src="arr_right.ico" align=right onclick="next_month(this.getAttribute(\'calendarobjectname\'))" calendarobjectname="'+objectcalendarname+'" ></td>';}strHTML+="	</tr>";strHTML+="</table>";app.insertBeforeEnd(objDivholder,strHTML);}function pad(instring){var num=new Number(instring);if(num<10){instring="0"+instring;}return instring;}function get_child(strName,oParent){for(x=0;x<oParent.childNodes.length;x++){if(oParent.childNodes[x].id==strName){return oParent.childNodes[x];}}return null;}function set_calendarday(in_week,in_daypos,in_day,in_oHolder,hilighttoday,in_month,in_year,oCalendar){if(in_daypos==-1){in_daypos=6;}var oCell=app.get_parent_child_by_id(in_oHolder,"tbl_days").rows[in_week].cells[in_daypos];oCell.oCalendar=oCalendar;app.addEvent(oCell,"click",oCalendar.selectdate);app.addEvent(oCell,"dragstart",dragdate);app.setElementText(oCell,in_day);oCell.style.color=oCalendar.cell_color;oCell.date=format_date(oCalendar.format,pad(in_day),pad(in_month),in_year);oCell.day=pad(in_day);oCell.month=pad(in_month);oCell.year=pad(in_year);oCell.numdate=in_year+""+pad(in_month)+""+pad(in_day);oCell.id=oCalendar.oHolder.id+"_"+oCell.numdate;oCalendar.array_displayed_dates[oCell.numdate]=oCell.numdate;if(oCalendar.firstdatenum==""){oCalendar.firstdatenum=oCell.numdate;}oCalendar.lastdatenum=oCell.numdate;if(hilighttoday){var tmpdate=new Date();var today=tmpdate.getDate();if(today==in_day){oCell.style.background="silver";}}}function dragdate(){var ocell=this;event.dataTransfer.setData("Text",ocell.date);}function getyear(in_date){var todaysdate=in_date;if(todaysdate==undefined){todaysdate=new Date();}var todaysyear=todaysdate.getFullYear();return todaysyear;}function getmonth(in_date){var todaysdate=in_date;if(todaysdate==undefined){todaysdate=new Date();}var todaysmonth=todaysdate.getMonth()+1;return todaysmonth;}function getweek(in_date){dayof=in_date.getDate();in_date.setDate(1);week=1;for(x=1;x<dayof;x++){in_date.setDate(x);y=getdayofweek(in_date);if(y==0){week++;}}return week;}function getdayofweek(in_date){var todaysdate=in_date;if(todaysdate==undefined){todaysdate=new Date();}var todaysday=todaysdate.getDay();return todaysday;}function format_date(strFormat,dd,mm,yyyy){strDate=string_replace(strFormat,"dd",dd,true);strDate=string_replace(strDate,"mm",mm,true);strDate=string_replace(strDate,"yyyy",yyyy,true);return strDate;}function isObject(HTMLele){if((typeof HTMLele!="object")||(HTMLele==null)){return false;}return true;}function string_replace(strText,strFind,strReplace,boolGlobalreplace){var flags=(boolGlobalreplace)?"gi":"i";var rExp=new RegExp(strFind,flags);return strText.replace(rExp,strReplace);}function convert_dateepoch(intYear,intMonth,intDay,intHour,intMinutes,intSeconds){var humDate=new Date(Date.UTC(intYear,intMonth-1,intDay,intHour,intMinutes,intSeconds));var epochDate=new Number((humDate.getTime()/1000));return epochDate;}function convert_epochdate(intEpoch){if(intEpoch<0){intEpoch=(1073741824-(intEpoch*-1))+1073741824;}return new Date(intEpoch*1000);}