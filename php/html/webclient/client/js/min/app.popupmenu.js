function _new__popupmenu(strUniqueID,eleOwner,actionFunction){return new _popupmenu(strUniqueID,eleOwner,actionFunction);}function _popupmenu(strUniqueID,eleOwner,actionFunction){this.id=strUniqueID;this.popobject=(eleOwner!=undefined)?eleOwner:null;this.actionfunction=(actionFunction!=undefined)?actionFunction:null;this.arr_items=new Array();this.highlightcolor="navy";this.highlighttextcolor="#ffffff";this.htmldocument=(eleOwner!=undefined)?app.getEleDoc(eleOwner):null;this.htmlholder=null;this.created=false;this.parentmenu=null;this.currentitem=null;}_popupmenu.prototype.reset=function(){if(this.htmlholder==null){return;}var parent=this.htmlholder.parentNode;parent.removeChild(this.htmlholder);this.htmlholder=null;for(var x=0;x<this.arr_items.length;x++){this.arr_items[x].reset();}this.arr_items=new Array();};_popupmenu.prototype.show=function(intLeft,intTop,ev){if(this.htmlholder==null){if(!this.create()){return false;}}if(intLeft==undefined&&intTop==undefined){if(ev!=undefined){var i=app.findMousePos(ev);intTop=i[1];intLeft=i[0];}else{intTop=this.popobject.offsetTop+this.popobject.offsetHeight-1;intLeft=this.popobject.offsetLeft;}}this.htmlholder.style.position="absolute";this.htmlholder.style.top=intTop;this.htmlholder.style.left=intLeft;this.htmlholder.style.zIndex=99999999;this.htmlholder.style.display="block";};_popupmenu.prototype.hide=function(){if(this.htmlholder!=null){this.hide_children();this.htmlholder.style.display="none";}};_popupmenu.prototype.create=function(){var strHTML="<div id='"+this.id+"' onclick='this.popupmenu.select(event);' onmouseover='this.popupmenu.highlight(event);' onmouseout='this.popupmenu.lowlight(event);' class='menu-holder'>";var strTable="<table cellspacing='0' cellpadding='0' border='0'>";for(var x=0;x<this.arr_items.length;x++){strTable+=this.arr_items[x]._create_html();}strTable+="</table>";strHTML+=strTable+"</div>";app.insertBeforeEnd(this.htmldocument.body,strHTML);this.htmlholder=this.htmldocument.getElementById(this.id);this.created=true;this.htmlholder.popupmenu=this;return true;};_popupmenu.prototype.show_child=function(eventSourceElement){var menuItem=this.arr_items[eventSourceElement.rowIndex];if(menuItem!=undefined&&menuItem.childmenu!=null){if(this.currentitem!=null&&this.currentitem!=menuItem){this.currentitem.childmenu.hide();}menuItem.childmenu.show(this.htmlholder.offsetLeft+this.htmlholder.offsetWidth-1,this.htmlholder.offsetTop+eventSourceElement.offsetTop+2);this.currentitem=menuItem;menuItem.childmenu.parentmenu=this;}};_popupmenu.prototype.hide_children=function(eventSourceElement){for(strPos in this.arr_items){var menuItem=this.arr_items[strPos];if(menuItem!=undefined&&menuItem.childmenu!=null){if(this.currentitem!=null){this.currentitem.childmenu.hide();}}}};_popupmenu.prototype.show_item=function(strID){for(var x=0;x<this.arr_items.length;x++){if(this.arr_items[x].id==strID){this.htmlholder.childNodes[0].rows[x].style.display="inline";break;}}};_popupmenu.prototype.hide_item=function(strID){for(var x=0;x<this.arr_items.length;x++){if(this.arr_items[x].id==strID){this.htmlholder.childNodes[0].rows[x].style.display="none";break;}}};_popupmenu.prototype.highlight=function(ev){var eventSourceElement=ev_source(ev);while(eventSourceElement.tagName!="TR"){eventSourceElement=eventSourceElement.parentNode;if(eventSourceElement==null){return false;}}if(eventSourceElement.id=="split"){return false;}eventSourceElement.className="mnu-highlighter";this.show_child(eventSourceElement);};_popupmenu.prototype.lowlight=function(ev){var eventSourceElement=ev_source(ev);while(eventSourceElement.tagName!="TR"){eventSourceElement=eventSourceElement.parentNode;if(eventSourceElement==null){return false;}}eventSourceElement.className="";};_popupmenu.prototype.select=function(ev){if(this.popobject!=null){var iEnhanced=this.popobject.getAttribute("enhanced");if(iEnhanced=="1"){this.popobject.setAttribute("mnudown","0");this.popobject.setAttribute("checked","0");this.popobject.className="toolbar-item";toolbar_enhanced_hilo(this.popobject,false);}}this.hide();var pMenu=this.parentmenu;while(pMenu!=null){pMenu.hide();pMenu=pMenu.parentmenu;}var eventSourceElement=ev_source(ev);while(eventSourceElement.tagName!="TR"){eventSourceElement=eventSourceElement.parentNode;if(eventSourceElement==null){return false;}}var rowIndex=eventSourceElement.rowIndex;var selectedItem=this.arr_items[rowIndex];if(selectedItem!=undefined){if(this.actionfunction){this.actionfunction(selectedItem);}}};_popupmenu.prototype.addmenuitem=function(strID,strLabel,strImage,boolAChildMenu){this.arr_items[this.arr_items.length++]=new _popupmenuitem(strID,strLabel,strImage,boolAChildMenu,this);return this.arr_items[this.arr_items.length-1];};function _popupmenuitem(strID,strLabel,strImage,boolAChildMenu,parentMenu){this.id=strID;this.label=strLabel;this.img=strImage;this.bMenu=boolAChildMenu;this.childmenu=null;this.popupmenu=parentMenu;this.htmlrow=null;}_popupmenuitem.prototype.reset=function(){if(this.bMenu&&this.popupmenu!=null){this.popupmenu.reset();}this.popupmenu=null;this.htmlrow=null;};_popupmenuitem.prototype._create_html=function(){var strImgHtml="";var strLabelHtml=this.label;var strChildClass=(this.bMenu)?"mnu-child":"mnu-nochild";if(this.id=="split"){var strHTML="<tr id='split'><td><div class='mnu-icon'></div></td><td colspan='3' align='middle'><div class='mnu-splitter'></div></td></tr>";}else{var strHTML="<tr><td><div class='mnu-icon'>"+strImgHtml+"</div></td><td valign='middle'><div class='mnu-text'>"+strLabelHtml+"</div></td><td valign='middle'><div class='mnu-ctrl'></div></td><td valign='middle'><div class='"+strChildClass+"'></div></td></tr>";}return strHTML;};