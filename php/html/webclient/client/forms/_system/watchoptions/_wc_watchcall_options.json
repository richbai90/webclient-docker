{"espForm":{"configuration":{"settings":{"name":"_wc_watchcall_options","title":"Watching Options","description":"webclient sys form that allows us to set the notification settings","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":""}}}},"layouts":{"layout":[{"appearance":{"width":"292","height":"100","backgroundColor":"#eaeaea","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"flg_option_1","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"20","left":"14","right":"287","bottom":"37"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Notify me when request(s) are updated^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"btn_ok","type":"EventButton"},"appearance":{"index":"1","caption":"Ok","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"63","left":"133","right":"203","bottom":"90"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"2","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"63","left":"212","right":"282","bottom":"90"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"flg_option_2","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"41","left":"14","right":"287","bottom":"58"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Remove request(s) from watched list when closed^2|","disabledBackgroundColor":"#eeeeee"}}}]},"javascript":{"methods":{"method":[{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"btn_ok_OnPressed","code":"btn_ok_OnPressed()\n{\n\t\/\/-- use xmlmethod call to set options\n\tvar strCallrefs = _swdoc.GetArg(\"_callrefs\");\n\tif(strCallrefs!=\"\")\n\t{\n\t\tvar arrCallrefs = strCallrefs.split(\",\");\t\n\t\tvar _intOption1 = flg_option_1.value;\n\t\tvar _intOption2 = flg_option_2.value;\n\t\t\n\t\tvar _intSetOptionValue = _intOption1 + _intOption2;\n\t\t\n\t\t\n\t\t\/\/-- remove all options and we will reset them\n\t\tfor(var y=1;y<3;y++)\n\t\t{\n\t\t\tvar xmlmc = new XmlMethodCall();\n\t\t\tfor(var x=0;x<arrCallrefs.length;x++)\n\t\t\t{\n\t\t\t\txmlmc.SetParam(\"callref\",arrCallrefs[x]);\n\t\t\t}\t\t\n\t\t\txmlmc.SetParam(\"options\", y);\t\n\t\t\txmlmc.Invoke(\"helpdesk\", \"removeWatchOptions\");\n\t\t}\n\n\t\t\n\t\t\/\/-- set any notification options\n\t\tif(_intSetOptionValue!=0)\n\t\t{\n\t\t\tvar xmlmc = new XmlMethodCall();\n\t\t\tfor(var x=0;x<arrCallrefs.length;x++)\n\t\t\t{\n\t\t\t\txmlmc.SetParam(\"callref\",arrCallrefs[x]);\n\t\t\t}\t\t\n\t\t\txmlmc.SetParam(\"options\", _intSetOptionValue);\n\t\t\txmlmc.Invoke(\"helpdesk\", \"setWatchOptions\");\n\t\t}\n\t\txmlmc.Reset();\n\t}\n\t\n\t_swdoc.CloseForm();\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tif( _swdoc.GetArg('_callrefs')==\"\") return;\n\t\n\t\/\/-- need to get watch options and set defaults\n\tvar rs = new SqlQuery()\n\trs.Query(\"select * from watchcalls where callref in (\" + _swdoc.GetArg('_callrefs') + \") and analystid = '\" + app.global.PrepareForSQL(app.session.analystId) + \"'\",\"sw_systemdb\");\n\tif(rs.Fetch())\n\t{\n\t\tvar strOptions = rs.GetValueAsString(\"options\");\n\t\t\n\t\t\n\t\tif(strOptions.indexOf(\"messenger_notify\")!=-1)\n\t\t{\n\t\t\t_eva(flg_option_1 , \"1\");\n\t\t}\n\t\tif(strOptions.indexOf(\"remove_when_closed\")!=-1)\n\t\t{\n\t\t\t_eva(flg_option_2 , \"2\");\t\n\t\t}\n\t}\n\t\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}