{"espForm":{"configuration":{"settings":{"name":"_sys_new_calltask","title":"New Task","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"tables":{"table":{"name":"calltasks","type":"Main Details Table","flags":"2"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var FLG_ASSIGNEE = 0;\nvar FLG_GROUP = 1;\nvar FLG_ALL = 2;\nvar FLG_SEQUENTIAL = 8;\nvar FLG_NOTIFY_ASSIGNEE = 16;\nvar FLG_NOTIFY_CALLOWNER = 32;\nvar FLG_NOTIFY_ONCOMPLETE = 64;\nvar strCallref = 0;\nvar oRec = null;\nvar tempFlags = 0;\n\nfunction setAssigneeDisplay(groupid,analystid)\n{\n\tif(groupid==\"\")groupid=app.session.groupId;\n\t\n\tvar strAssign = \"#\" + groupid;\n\tif(analystid!=\"\") strAssign += \":\" + analystid;\n\t_ete(mainform.tb_assign , strAssign);\n\n\tif(_swdoc.calltasks.groupid != groupid)\n\t{\n\t\t_swdoc.calltasks.groupid = groupid;\n\t\t_een(mainform.btn_update , true);\n\t}\n\tif(_swdoc.calltasks.analystid != analystid)\n\t{\n\t\t_swdoc.calltasks.analystid = analystid;\n\t\t_een(mainform.btn_update , true);\t\n\t}\n}\n\n\nfunction setFormFields()\n{\n\t\/\/- -are we editing a temp record\n\tif(_swdoc.calltasks.taskid!=\"\")\n\t{\n\t\t\/\/-- time to do work\n\t\t_eva(mainform.tb_completeby , _swdoc.calltasks.compltbyx \/ 60);\n\t\t_eva(mainform.tb_reminder , _swdoc.calltasks.notifytime \/ 60);\n\t\t\n\t\t\/\/-- assigner value\n\t\t_eva(mainform.lb_completeby , \"0\");\t\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_GROUP)\n\t\t{\n\t\t\t_eva(mainform.lb_completeby , \"1\");\n\t\t}\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_ALL)\n\t\t{\n\t\t\t_eva(mainform.lb_completeby , \"2\");\n\t\t}\t\n\n\t\t\/\/-- notify flags\t\t\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_NOTIFY_ASSIGNEE)\n\t\t{\n\t\t\t_swdoc.tempFlags += _swdoc.FLG_NOTIFY_ASSIGNEE;\n\t\t\t_eva(mainform.flg_reminder, 1);\n\t\t\t_eva(mainform.flg_reminder_ass , 1);\n\t\t}\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_NOTIFY_CALLOWNER)\n\t\t{\n\t\t\t_swdoc.tempFlags += _swdoc.FLG_NOTIFY_CALLOWNER;\t\n\t\t\t_eva(mainform.flg_reminder ,1);\n\t\t\t_eva(mainform.flg_reminder_co , 1);\t\n\t\t}\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_NOTIFY_ONCOMPLETE)\n\t\t{\n\t\t\t_swdoc.tempFlags += _swdoc.FLG_NOTIFY_ONCOMPLETE;\n\t\t\t_eva(mainform.flg_notify_on_complete,1);\n\t\t}\n\t\t_een(mainform.tb_reminder , (mainform.flg_reminder.value == 1)?true:false);\n\t\tif(mainform.tb_reminder.enable)\n\t\t{\n\t\t\t_een(mainform.flg_reminder_co , true);\t\n\t\t\t_een(mainform.flg_reminder_ass , true);\t\t\n\t\t}\n\t}\n\telse\n\t{\n\t\t_eva(mainform.lb_completeby , \"0\");\n\t}\n}\n\nfunction setReminderFlags()\n{\n\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"438","height":"288","backgroundColor":"#eaeaea","backgroundImage":"0|Telephone Call|Site Visit|","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Allowable time:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"11","left":"10","right":"106","bottom":"29"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Assign To:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"33","left":"10","right":"106","bottom":"51"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"To be completed:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"55","left":"10","right":"106","bottom":"73"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Priority:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"77","left":"10","right":"106","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Line1","type":"Line","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Line 1","backgroundColor":"#ffffff","foregroundColor":"#777777","font":{"@size":"0"}},"objectPlacement":{"position":{"top":"103","left":"11","right":"427","bottom":"112"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Line2","type":"Line","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"5","caption":"Line 1","backgroundColor":"#ffffff","foregroundColor":"#777777","font":{"@size":"0"}},"objectPlacement":{"position":{"top":"159","left":"11","right":"426","bottom":"167"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"flg_reminder","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"118","left":"7","right":"84","bottom":"136"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Reminder:^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_reminder","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"118","left":"87","right":"122","bottom":"136"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Minute Time Period","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"30","disabledBackgroundColor":"#f8f8f8"}}},{"general":{"name":"flg_reminder_ass","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"118","left":"132","right":"241","bottom":"136"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Remind assignee^1|","defaultValue":"1","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_reminder_co","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"138","left":"132","right":"250","bottom":"156"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Remind call owner^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_notify_on_complete","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"118","left":"258","right":"282","bottom":"136"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"^1|","defaultValue":"0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"txt_noify","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"11","caption":"Notify support group when task is completed","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"118","left":"281","right":"420","bottom":"158"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"tb_assign","type":"Field"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"33","left":"110","right":"370","bottom":"51"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","disabledBackgroundColor":"#f8f8f8"}}},{"general":{"name":"btn_assign","type":"EventButton"},"appearance":{"index":"13","caption":"...","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"31","left":"374","right":"394","bottom":"53"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"img_me","type":"Image"},"appearance":{"index":"14","caption":"&[app.webroot]\/webclient\/client\/forms\/images\/swanalyst.png","backgroundColor":"#eaeaea","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"Stretch","borderStyle":"None"},"objectPlacement":{"position":{"top":"34","left":"401","right":"417","bottom":"50"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backMode":"1"}}},{"general":{"name":"lb_completeby","type":"Field"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"110","right":"418","bottom":"73"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"0","listItems":"only by the assignee^0|by any member of the assignee's group^1|by any support analyst using Supportworks^2|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lb_priority","type":"Field"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"77","left":"110","right":"226","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"calltasks.priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"Medium","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lb_type","type":"Field"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"77","left":"302","right":"418","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"calltasks.type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"To Do","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"18","caption":"Type:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"77","left":"231","right":"298","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_desc","type":"Field"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"189","left":"8","right":"429","bottom":"253"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"calltasks.details"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"btn_update","type":"EventButton"},"appearance":{"index":"20","caption":"Save","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"257","left":"293","right":"356","bottom":"282"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"21","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"257","left":"366","right":"429","bottom":"282"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"tb_completeby","type":"Field"},"appearance":{"index":"22","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"11","left":"110","right":"274","bottom":"29"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Minute Time Period","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"60","disabledBackgroundColor":"#f8f8f8"}}},{"general":{"name":"Text9","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"23","caption":"Description:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"168","left":"10","right":"106","bottom":"186"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"img_me_OnLeftClick","code":"img_me_OnLeftClick()\n{\n\t\/\/-- set assignee to current analyst context\n\t_swdoc.setAssigneeDisplay(app.session.groupId,app.session.analystId)\t\n\treturn true;\n}"},{"name":"flg_reminder_OnValueChanged","code":"flg_reminder_OnValueChanged(strValue)\n{\n\tvar bEnable = (strValue==1)?true:false;\n\t_een(tb_reminder , bEnable);\n\t_een(flg_reminder_ass , bEnable);\n\t_een(flg_reminder_co , bEnable);\n\n}"},{"name":"btn_update_OnPressed","code":"btn_update_OnPressed()\n{\n\t\/\/-- check complete by option and assignee\n\tif(mainform.lb_completeby.value==0 && _swdoc.calltasks.analystid==\"\")\n\t{\n\t\tMessageBox(\"Please select an analyst to assign this task to or alernatively change the [To be completed] list box option.\");\n\t\treturn false;\n\t}\n\n\t\n\t\/\/-- set flags\n\tvar iCallTaskFlags = parseInt(mainform.lb_completeby.value) + _swdoc.tempFlags;\n\t_swdoc.calltasks.flags = iCallTaskFlags;\t\n\n\t\/\/-- set status to not started\n\t_swdoc.calltasks.status = 1;\n\n\t\/\/-- set allowable time\n\t_swdoc.calltasks.compltbyx   = tb_completeby.value * 60;\n\t_swdoc.calltasks.notifytime = tb_reminder.value * 60;\n\n\t\/\/--set some data defaults\n\n\tif(_swdoc.calltasks.taskid==\"\" || _swdoc.calltasks.taskid==0)\n\t{\n\t\tvar strDbMethod = \"insertRecord\";\n\t\t_swdoc.calltasks.taskid = _swdoc.GetArg(\"_nexttaskid\");\n\t\t_swdoc.calltasks.parentgroup = _swdoc.GetArg(\"_parentgroup\");\n\t\t_swdoc.calltasks.parentgroupsequence = _swdoc.GetArg(\"_pgs\");\t\n\t}\n\telse\n\t{\n\t\t\/\/-- updating\n\t\tvar strDbMethod = \"updateRecord\";\n\t}\n\t\n\n\t\/\/-- xmlmc record add\n\tvar xmlmc = new XmlMethodCall();\n\txmlmc.SetParam('_tablename','sw_systemdb.wc_calltasks');\n\txmlmc.SetParam('_keycolumn','sessionid,taskid,parentgroup');\n\txmlmc.SetParam('sessionid',_swdoc.GetArg(\"_table\"));\n\txmlmc.SetParam('taskid',_swdoc.calltasks.taskid);\n\txmlmc.SetParam('parentgroup',_swdoc.calltasks.parentgroup);\n\txmlmc.SetParam('parentgroupsequence',_swdoc.calltasks.parentgroupsequence);\n\txmlmc.SetParam('flags',_swdoc.calltasks.flags);\n\txmlmc.SetParam('analystid',_swdoc.calltasks.analystid);\n\txmlmc.SetParam('groupid',_swdoc.calltasks.groupid);\n\txmlmc.SetParam('details',_swdoc.calltasks.details);\n\txmlmc.SetParam('notifytime',_swdoc.calltasks.notifytime);\n\txmlmc.SetParam('compltbyx',_swdoc.calltasks.compltbyx);\n\txmlmc.SetParam('priority',_swdoc.calltasks.priority);\n\txmlmc.SetParam('type',_swdoc.calltasks.type);\n\tif(!xmlmc.Invoke(\"webclient\",strDbMethod))\n\t{\n\t\tdebugger;\n\t\tMessageBox(\"Failed to add the temporary call task. Please contact your Administrator.\");\n\t\treturn;\n\t}\n\n\t\n\t\/\/if(!_swdoc.Save())\n\t\/\/{\n\t\/\/\treturn;\n\t\/\/}\n\t\/\/MessageBox(13)\n\n\t\/\/-- with temp record saved we can add workflow to existing call if we have one\n\tvar iCallref =  _swdoc.GetArg(\"_callref\");\n\t\/\/MessageBox(14)\n\tif(iCallref!=\"\")\n\t{\n\t\t\/\/-- check if we have a workflow to add to this call\n\t\/\/\tMessageBox(15)\n\n\t\tvar strParams = \"_table=\" + _swdoc.GetArg(\"_table\") + \"&_callref=\" + iCallref\n\t\tvar strURL = app.webroot + \"\/webclient\/service\/workflow\/attach_call_workflow.php\";\n\t\/\/\tMessageBox(strParams)\n\t\tvar res = app.get_http(strURL, \"swsessionid=\" + app._swsessionid + \"&\"+ strParams, true, false,  null, null);\n\t\/\/\tMessageBox(16)\t\n\t\tif(res!=\"ok\")\n\t\t{\n\t\t\tMessageBox(\"The system failed to attach the associated workflow due to the follwing reason:-\\n\\n\"+res+\"\\n\\nPlease contact your Administrator.\");\n\t\t}\n\t}\n\t\n\t\t\n\t\/\/-- close\n\t\/\/MessageBox(17)\t\n\t_swdoc.CloseForm();\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\n\t\/\/-- set assign display\n\t_swdoc.setAssigneeDisplay(_swdoc.calltasks.groupid,_swdoc.calltasks.analystid);\n\n\t_swdoc.setFormFields();\n\n\t\n\n\t\n\n\t\n}"},{"name":"btn_assign_OnPressed","code":"btn_assign_OnPressed()\n{\n\t\n\tvar o = app.g.pick_analystorgroup(\"Choose Assignee\");\n\tif(o!=false)\n\t{\n\t\tvar strGroup = \"\";\n\t\tvar strAnalyst = \"\";\n\t\tif(o.oGroup !=false)\n\t\t{\n\t\t\tstrGroup = o.oGroup.id\n\t\t\tif(o.oAnalyst !=false)strAnalyst = o.oAnalyst.id;\n\t\t\t_swdoc.setAssigneeDisplay(strGroup,strAnalyst)\t\t\t\n\t\t}\n\t}\n\n\n}"},{"name":"tb_completeby_OnValueChanged","code":"tb_completeby_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_completeby_OnValueChanged","code":"lb_completeby_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_priority_OnValueChanged","code":"lb_priority_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_type_OnValueChanged","code":"lb_type_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"tb_reminder_OnValueChanged","code":"tb_reminder_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"flg_reminder_ass_OnValueChanged","code":"flg_reminder_ass_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\tif(strValue==1)\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags -1 + 17;\n\t}\n\telse\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags -16;\t\n\t}\n\n}"},{"name":"flg_reminder_co_OnValueChanged","code":"flg_reminder_co_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\tif(strValue==1)\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags -1 + 33;\t\t\n\t}\n\telse\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags - 32;\t\t\t\n\t}\n}"},{"name":"flg_notify_on_complete_OnValueChanged","code":"flg_notify_on_complete_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\tif(strValue==1)\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags - 1 + 65;\t\t\t\t\t\n\t}\n\telse\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags - 64;\t\t\t\t\n\n\t}\n\n}"},{"name":"tb_desc_OnValueChanged","code":"tb_desc_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}