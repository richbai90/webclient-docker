{"espForm":{"configuration":{"settings":{"name":"_sys_calltask","title":"Work Item Properties &[calltasks.callref] - &[calltasks.taskid]","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"tables":{"table":{"name":"calltasks","type":"Main Details Table","flags":"2"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var FLG_ASSIGNEE = 0;\nvar FLG_GROUP = 1;\nvar FLG_ALL = 2;\nvar FLG_SEQUENTIAL = 8;\nvar FLG_NOTIFY_ASSIGNEE = 16;\nvar FLG_NOTIFY_CALLOWNER = 32;\nvar FLG_NOTIFY_ONCOMPLETE = 64;\nvar strCallref = 0;\nvar oRec = null;\nvar tempFlags = 0;\n\nfunction setAssigneeDisplay(groupid,analystid)\n{\n\tif(groupid==\"\")groupid=app.session.groupId;\n\t\n\tvar strAssign = \"#\" + groupid;\n\tif(analystid!=\"\") strAssign += \":\" + analystid;\n\t_ete(mainform.tb_assign , strAssign);\n\n\tif(_swdoc.calltasks.groupid != groupid)\n\t{\n\t\t_swdoc.calltasks.groupid = groupid;\n\t\t_een(mainform.btn_update , true);\n\t}\n\tif(_swdoc.calltasks.analystid != analystid)\n\t{\n\t\t_swdoc.calltasks.analystid = analystid;\n\t\t_een(mainform.btn_update , true);\t\n\t}\n}\n\n\nfunction setFormFields()\n{\n\t\/\/- -are we editing a temp record\n\tif(_swdoc.calltasks.taskid!=\"\")\n\t{\n\t\t\/\/-- time to do work\n\t\t_eva(mainform.tb_completeby , _swdoc.calltasks.compltbyx);\n\t\t_eva(mainform.tb_reminder , _swdoc.calltasks.notifytime \/ 60);\n\t\t\n\t\t\/\/-- assigner value\n\t\t_eva(mainform.lb_completeby , \"0\");\t\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_GROUP)\n\t\t{\n\t\t\t_eva(mainform.lb_completeby , \"1\");\n\t\t}\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_ALL)\n\t\t{\n\t\t\t_eva(mainform.lb_completeby , \"2\");\n\t\t}\t\n\n\t\t\/\/-- notify flags\t\t\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_NOTIFY_ASSIGNEE)\n\t\t{\n\t\t\t_swdoc.tempFlags += _swdoc.FLG_NOTIFY_ASSIGNEE;\n\t\t\t_eva(mainform.flg_reminder, 1);\n\t\t\t_eva(mainform.flg_reminder_ass , 1);\n\t\t}\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_NOTIFY_CALLOWNER)\n\t\t{\n\t\t\t_swdoc.tempFlags += _swdoc.FLG_NOTIFY_CALLOWNER;\t\n\t\t\t_eva(mainform.flg_reminder ,1);\n\t\t\t_eva(mainform.flg_reminder_co , 1);\t\n\t\t}\n\t\tif(_swdoc.calltasks.flags & _swdoc.FLG_NOTIFY_ONCOMPLETE)\n\t\t{\n\t\t\t_swdoc.tempFlags += _swdoc.FLG_NOTIFY_ONCOMPLETE;\n\t\t\t_eva(mainform.flg_notify_on_complete,1);\n\t\t}\n\t\t_een(mainform.tb_reminder , (mainform.flg_reminder.value == 1)?true:false);\n\t\tif(mainform.tb_reminder.enable)\n\t\t{\n\t\t\t_een(mainform.flg_reminder_co , true);\t\n\t\t\t_een(mainform.flg_reminder_ass , true);\t\t\n\t\t}\n\t}\n\telse\n\t{\n\t\t_eva(mainform.lb_completeby , \"0\");\n\t}\n}\n\nfunction setReminderFlags()\n{\n\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"438","height":"306","backgroundColor":"#eaeaea","backgroundImage":"0|Telephone Call|Site Visit|","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"Text1","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"0","caption":"Complete by:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"11","left":"10","right":"106","bottom":"29"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text2","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Assign To:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"33","left":"10","right":"106","bottom":"51"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text3","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"To be completed:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"55","left":"10","right":"106","bottom":"73"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Text4","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","caption":"Priority:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"77","left":"10","right":"106","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Line1","type":"Line","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Line 1","backgroundColor":"#ffffff","foregroundColor":"#777777","font":{"@size":"0"}},"objectPlacement":{"position":{"top":"124","left":"11","right":"427","bottom":"133"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"Line2","type":"Line","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"5","caption":"Line 1","backgroundColor":"#ffffff","foregroundColor":"#777777","font":{"@size":"0"}},"objectPlacement":{"position":{"top":"180","left":"11","right":"426","bottom":"188"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"flg_reminder","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"6","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"139","left":"7","right":"84","bottom":"157"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Reminder:^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_reminder","type":"Field"},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"139","left":"87","right":"122","bottom":"157"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Minute Time Period","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"20","disabledBackgroundColor":"#f8f8f8"}}},{"general":{"name":"flg_reminder_ass","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"8","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"139","left":"132","right":"241","bottom":"157"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Remind assignee^1|","defaultValue":"1","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_reminder_co","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"9","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"159","left":"132","right":"250","bottom":"177"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Remind call owner^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"flg_notify_on_complete","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"10","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"139","left":"258","right":"282","bottom":"157"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"^1|","defaultValue":"0","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text5","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"11","caption":"Notify support group when task is completed","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"139","left":"281","right":"420","bottom":"179"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"tb_assign","type":"Field"},"appearance":{"index":"12","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"33","left":"110","right":"370","bottom":"51"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"true","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","disabledBackgroundColor":"#f8f8f8"}}},{"general":{"name":"btn_assign","type":"EventButton"},"appearance":{"index":"13","caption":"...","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"31","left":"374","right":"394","bottom":"53"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"img_me","type":"Image"},"appearance":{"index":"14","caption":"&[app.webroot]\/webclient\/client\/forms\/images\/swanalyst.png","backgroundColor":"#eaeaea","foregroundColor":"#000000","font":{"@size":"0"},"alignment":"Stretch","borderStyle":"None"},"objectPlacement":{"position":{"top":"34","left":"401","right":"417","bottom":"50"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backMode":"1"}}},{"general":{"name":"lb_completeby","type":"Field"},"appearance":{"index":"15","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"55","left":"110","right":"418","bottom":"73"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"0","listItems":"only by the assignee^0|by any member of the assignee's group^1|by any support analyst using Supportworks^2|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lb_priority","type":"Field"},"appearance":{"index":"16","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"77","left":"110","right":"226","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"calltasks.priority"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"Medium","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lb_type","type":"Field"},"appearance":{"index":"17","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"77","left":"302","right":"418","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"calltasks.type"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"true"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"To Do","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"Text6","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"18","caption":"Type:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"77","left":"231","right":"298","bottom":"95"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"tb_desc","type":"Field"},"appearance":{"index":"19","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"210","left":"8","right":"429","bottom":"274"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"data":{"binding":"calltasks.details"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"true","url":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"btn_update","type":"EventButton"},"appearance":{"index":"20","caption":"Update","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"278","left":"293","right":"356","bottom":"303"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"21","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"278","left":"366","right":"429","bottom":"303"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"txt_status","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"22","caption":"Status:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"99","left":"10","right":"106","bottom":"117"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_status","type":"Field"},"appearance":{"index":"23","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"99","left":"110","right":"226","bottom":"117"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"calltasks.status"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"2","listItems":"Not Started^2|In Progress^3|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"txt_perc","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"24","caption":"% Complete:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"99","left":"231","right":"298","bottom":"117"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"lb_perc","type":"Field"},"appearance":{"index":"25","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"99","left":"302","right":"418","bottom":"117"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"calltasks.percentcomplete"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","defaultValue":"0","listItems":"0|25|50|75|100|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"tb_completeby","type":"Field"},"appearance":{"index":"26","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"11","left":"110","right":"274","bottom":"29"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"data":{"binding":"calltasks.compltbyx"},"controlInfo":{"mouseOverCursor":"Window Default","type":"Date\/Time Control","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","colorDateIndicator":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#333333","image":"#eeeeee","disabledBackgroundColor":"#f8f8f8","dateFormatMode":"0"}}},{"general":{"name":"Text9","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"27","caption":"Description:","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"189","left":"10","right":"106","bottom":"207"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}}]},"javascript":{"methods":{"method":[{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"img_me_OnLeftClick","code":"img_me_OnLeftClick()\n{\n\t\/\/-- set assignee to current analyst context\n\t_swdoc.setAssigneeDisplay(app.session.groupId,app.session.analystId)\t\n\treturn true;\n}"},{"name":"flg_reminder_OnValueChanged","code":"flg_reminder_OnValueChanged(strValue)\n{\n\tvar bEnable = (strValue==\"1\")?true:false;\n\t_een(tb_reminder , bEnable);\n\t_een(flg_reminder_ass , bEnable);\n\t_een(flg_reminder_co , bEnable);\n\n}"},{"name":"btn_update_OnPressed","code":"btn_update_OnPressed()\n{\n\t\/\/-- use php helpdesk con to update task\n\n\t\/\/-- set flags\n\tvar iCallTaskFlags = parseInt(mainform.lb_completeby.value) + _swdoc.tempFlags;\n\t_swdoc.calltasks.flags = iCallTaskFlags;\n\t\n\t\/\/-- set allowable time\n\t_swdoc.calltasks.notifytime = (tb_reminder.value * 60);\n\n\tvar hdcon = new HelpdeskSession();\n\tif(hdcon.Connect())\n\t{\n\t\t\/\/-- start new call dairy update\n\t\tif(hdcon.UpdateTask())\n\t\t{   \n\t\t\tvar boolProcess=false;\n\t\t\t\/\/-- send identifying data\n\t\t\thdcon.SendNumber (\"callref\", calltasks.callref);\n\t\t\thdcon.SendNumber (\"taskid\", calltasks.taskid);\n\n\t\t\t\/\/-- send modified data\n\t\t\tif(rec = _swdoc.GetRecord(\"calltasks\"))\t\n\t\t\t{\n\t\t\t\tvar boolProcess=true;\n\t\t\t\thdcon.SendNumber(\"compltbyx\", _swdoc.calltasks.compltbyx);\t\n\t\t\t\thdcon.SendNumber(\"status\", calltasks.status);\n\t\t\t\t\n\t\t\t\tif(isNaN(_swdoc.calltasks.flags))_swdoc.calltasks.flags=0;\n\t\t\t\thdcon.SendNumber(\"flags\", _swdoc.calltasks.flags);\n\t\t\t\thdcon.SendValue(\"analystid\", _swdoc.calltasks.analystid);\n\t\t\t\thdcon.SendValue(\"groupid\", _swdoc.calltasks.groupid);\n\t\t\t\thdcon.SendValue(\"details\", calltasks.details);\n\t\t\t\thdcon.SendValue(\"priority\", lb_priority.display);\n\t\t\t\thdcon.SendValue(\"type\", lb_type.display);\n\t\t\t\thdcon.SendNumber(\"notifytime\", _swdoc.calltasks.notifytime);\n\t\t\t\thdcon.SendValue(\"parentgroup\", calltasks.parentgroup);\n\t\t\t\thdcon.SendNumber(\"parentgroupsequence\", calltasks.parentgroupsequence);\n\t\t\t\thdcon.SendNumber(\"percentcomplete\", calltasks.percentcomplete);\t\n\t\t\t}\n\t\n\t\t\t\/\/-- do we have stuff to submit\n\t\t\tif(boolProcess)\n\t\t\t{\n\t\t\t\t\/\/-- if the commit fails raise message\n\t        \tif(!hdcon.Commit())\n\t\t\t\t{\n\t\t\t\t\tMessageBox(\"Failed to update Task. The following error was reported:-\\n\\n\"+ hdcon.GetLastErrorStr() +\"\\n\\nPlease contact your Administrator\");\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\t\/\/_swdoc._overide_dsn = (calltasks.status!=16)?\"sw_systemdb\":\"swdata\";\n\t\t\t\t\t\/\/_swdoc.Save();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t\/\/-- finished with the connection, close it.    \n\thdcon.Close();\n\t\n\t\n\t\/\/-- close\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\n\t\/\/-- set assign display\n\t_swdoc.setAssigneeDisplay(_swdoc.calltasks.groupid,_swdoc.calltasks.analystid);\n\n\t_swdoc.setFormFields();\n\n\n\tvar bEnable = (calltasks.status==16)?false:true;\n\t\n\t_een(tb_completeby , bEnable);\n\t_een(btn_assign , bEnable);\n\t_een(img_me , bEnable);\n\t_een(lb_completeby , bEnable);\n\t_een(lb_priority , bEnable);\n\t_een(lb_type , bEnable);\n\t_een(lb_status , bEnable);\n\t_een(lb_perc , bEnable);\n\t_een(flg_reminder , bEnable);\n\t_een(flg_notify_on_complete , bEnable);\n\t_een(tb_desc , bEnable);\n\n\tif(calltasks.status!=16)\n\t{\n\t\t\/\/-- set flags\n\t\t_eva(flg_reminder_ass , (_swdoc.calltasks.flags & 16)?\"1\":\"0\");\n\t\t_een(flg_reminder_ass , (flg_reminder_ass.value==\"1\")?true:false);\n\t\t_eva(flg_reminder_co , (_swdoc.calltasks.flags & 32)?\"1\":\"0\");\n\t\t_een(flg_reminder_co , (flg_reminder_co.value==\"1\")?true:false);\t\n\t\t\n\t\t_een(tb_reminder , (flg_reminder_ass.value==1 || flg_reminder_co.value==1));\n\t\t_eva(flg_reminder , (flg_reminder_ass.value==1 || flg_reminder_co.value==1));\n\t\t\n\t\t_eva(flg_notify_on_complete , (_swdoc.calltasks.flags & 64)?\"1\":\"0\");\n\t}\n\t\n\t\/\/-- inactive - so cannot change status or perc complete\n\tif(calltasks.status==1)\n\t{\n\t\t_evi(txt_status,false);\n\t\t_evi(lb_status,false);\t\n\t\t_evi(lb_perc,false);\t\t\n\t\t_evi(txt_perc,false);\t\t\n\t}\n\n\t\n}"},{"name":"btn_assign_OnPressed","code":"btn_assign_OnPressed()\n{\n\t\n\tvar o = app.g.pick_analystorgroup(\"Choose Assignee\");\n\tif(o!=false)\n\t{\n\t\tvar strGroup = \"\";\n\t\tvar strAnalyst = \"\";\n\t\tif(o.oGroup !=false)\n\t\t{\n\t\t\tstrGroup = o.oGroup.id\n\t\t\tif(o.oAnalyst !=false)strAnalyst = o.oAnalyst.id;\n\t\t\t_swdoc.setAssigneeDisplay(strGroup,strAnalyst)\t\t\t\n\t\t}\n\t}\n\n\n}"},{"name":"tb_completeby_OnValueChanged","code":"tb_completeby_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_completeby_OnValueChanged","code":"lb_completeby_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_priority_OnValueChanged","code":"lb_priority_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_type_OnValueChanged","code":"lb_type_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_status_OnValueChanged","code":"lb_status_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"lb_perc_OnValueChanged","code":"lb_perc_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"tb_reminder_OnValueChanged","code":"tb_reminder_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"flg_reminder_ass_OnValueChanged","code":"flg_reminder_ass_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\tif(strValue==1)\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags -1 + 17;\n\t}\n\telse\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags -16;\t\n\t}\n\n}"},{"name":"flg_reminder_co_OnValueChanged","code":"flg_reminder_co_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\tif(strValue==1)\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags -1 + 33;\t\t\n\t}\n\telse\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags - 32;\t\t\t\n\t}\n}"},{"name":"flg_notify_on_complete_OnValueChanged","code":"flg_notify_on_complete_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\tif(strValue==1)\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags - 1 + 65;\t\t\t\t\t\n\t}\n\telse\n\t{\n\t\t_swdoc.tempFlags = _swdoc.tempFlags - 64;\t\t\t\t\n\n\t}\n\n}"},{"name":"tb_desc_OnValueChanged","code":"tb_desc_OnValueChanged(strValue)\n{\n\t_een(btn_update , true);\n\n\n}"},{"name":"flg_reminder_OnLeftClick","code":"flg_reminder_OnLeftClick()\n{\n\tvar bEnable = (strValue==1)?true:false;\n\t_een(tb_reminder , bEnable);\n\t_een(flg_reminder_ass , bEnable);\n\t_een(flg_reminder_co , bEnable);\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}