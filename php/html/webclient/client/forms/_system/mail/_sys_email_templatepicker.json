{"espForm":{"configuration":{"settings":{"name":"_sys_email_templatepicker","title":"Select E-Mail Template","description":"Used to select an email template to use when doing call update","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var selectedindex = -1;\nvar selectedcallclass = \"\";\nvar flg_userfirstaddress = 0;\nvar flg_userhtmltemplate = 1;\nvar arrTemplates = new Array();"}}}},"layouts":{"layout":[{"appearance":{"width":"245","height":"373","backgroundColor":"#dddddd","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"sl_templates","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"false","horizontalGridLines":"false","autoLoad":"false","allowMultiSelect":"false"}},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"33","left":"11","right":"239","bottom":"258"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Available E-Mail Templates","width":"225","image":"-1","dataColumn":"0"}},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#cae1ee","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"1","borderColor":"#080808"}}},{"general":{"name":"lb_callclass","type":"Field"},"appearance":{"index":"1","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"9","left":"126","right":"239","bottom":"27"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Distinct Pick List","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","pickListOrderDesc":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#000000","image":"#eeeeee","disabledBackgroundColor":"#eeeeee","sqlSource":"syscache","distinctTable":"swcallclasses","distinctColumn":"CallClass","extraOptions":"All Classes","defaultValue":"All Classes"}}},{"general":{"name":"lbl_class","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"2","caption":"Class","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"9","left":"34","right":"122","bottom":"27"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"flg_address","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"263","left":"11","right":"33","bottom":"282"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"^1|","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lbl_address","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"4","caption":"Use the first address of the mailbox to which the selected template belongs as the 'From' address for the E-mail","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Left","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"263","left":"31","right":"233","bottom":"312"},"scaling":{"top":"100","left":"0","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","multiLine":"true"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"5","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"345","left":"187","right":"239","bottom":"369"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_ok","type":"EventButton"},"appearance":{"index":"6","caption":"OK","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"345","left":"129","right":"181","bottom":"369"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"flg_html","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"7","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"316","left":"11","right":"237","bottom":"335"},"scaling":{"top":"100","left":"0","right":"0","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Use HTML template if available^1|","disabledBackgroundColor":"#eeeeee","defaultValue":"1"}}}]},"javascript":{"methods":{"method":[{"name":"sl_templates_OnHeaderItemClicked","code":"sl_templates_OnHeaderItemClicked(strOrder, nCol)\n{\n\treturn false;\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t_swdoc.arrTemplates = _swdoc._form['_emailtemplates'];\n\tvar strDefaultClass = _swdoc._form['_defaultclass'];\n\t_swdoc.selectedcallclass = strDefaultClass;\n\tfor(var x=0;x<_swdoc.arrTemplates.length;x++)\n\t{\n\t\tif(strDefaultClass.toLowerCase()==_swdoc.arrTemplates[x].callclass.toLowerCase() || _swdoc.arrTemplates[x].callclass==\"All Classes\")\n\t\t{\n\t\t\t\/\/-- insertrow\t\n\t\t\tvar strName = _swdoc.arrTemplates[x].name;\n\t\t\tvar strMBTitle = _swdoc.arrTemplates[x].mailboxname;\n\t\t\tvar arrRowData = new Array();\n\t\t\tarrRowData[0] = strName + \" (\" + strMBTitle + \")\";\n\t\t\tsl_templates._insertrow(arrRowData,1);\n\t\t}\n\t}\n\tsl_templates.SetRowSelected(0, true);\n\t_eva(flg_html , 1);\n\t_eva(lb_callclass , strDefaultClass);\n\t\n}"},{"name":"btn_ok_OnPressed","code":"btn_ok_OnPressed()\n{\n\t_swdoc.selectedindex = sl_templates.curSel;\n\t_swdoc.flg_userfirstaddress = flg_address.value;\n\t_swdoc.flg_userhtmltemplate = flg_html.value;\n\t\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc.selectedindex = -1;\n\t_swdoc.CloseForm();\n\n}"},{"name":"sl_templates_OnItemDoubleClicked","code":"sl_templates_OnItemDoubleClicked(nRow, nCol)\n{\n\t_swdoc.selectedindex = sl_templates.curSel;\n\t_swdoc.flg_userfirstaddress = flg_address.value;\n\t_swdoc.flg_userhtmltemplate = flg_html.value;\n\t\n\t_swdoc.CloseForm();\n\treturn false;\n\n}"},{"name":"sl_templates_OnItemSelected","code":"sl_templates_OnItemSelected(nRow)\n{\n\t\n\t\/\/-- enable button\n \t_een(btn_ok , true);\n\n}"},{"name":"lb_callclass_OnValueChanged","code":"lb_callclass_OnValueChanged(strValue)\n{\n\t\/\/-- remove rows\n\t_een(btn_ok , false);\n\twhile(sl_templates.rowCount()>0)\n\t{\t\n\t\tsl_templates.RemoveRow(0);\n\t}\n\t\t\n\tvar strDefaultClass = strValue;\n\tfor(var x=0;x<_swdoc.arrTemplates.length;x++)\n\t{\n\t\tif(_swdoc.arrTemplates[x].callclass==\"All Classes\" || (strDefaultClass.toLowerCase()==_swdoc.arrTemplates[x].callclass.toLowerCase()))\n\t\t{\n\t\t\t\/\/-- insertrow\t\n\t\t\tvar strName = _swdoc.arrTemplates[x].name;\n\t\t\tvar strMBTitle = _swdoc.arrTemplates[x].mailboxname;\n\t\t\tvar arrRowData = new Array();\n\t\t\tarrRowData[0] = strName + \" (\" + strMBTitle + \")\";\n\t\t\tsl_templates._insertrow(arrRowData,1);\n\t\t}\n\t}\n\tif(sl_templates.rowCount()>0)sl_templates.SetRowSelected(0, true);\n\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}