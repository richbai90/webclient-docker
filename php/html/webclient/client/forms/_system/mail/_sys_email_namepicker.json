{"espForm":{"configuration":{"settings":{"name":"_sys_email_namepicker","title":"E-mail Address\/Contact Lookup","description":"used by webclient to display matching email names in email form","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _selected_email_transport = \"\";\nvar _selected_email_address = \"\";\nvar _selected_email_name = \"\";\nvar _old_filter_value = 0;\n\nfunction _get_matching_addresses(strCheckFor)\n{\n\tmainform.sl_address._RemoveAllRows();\n\t_een(mainform.btn_ok , false);\n\n\tvar xmlmc = new XmlMethodCall;\n\txmlmc.SetParam(\"address\", strCheckFor);\n\tif(xmlmc.Invoke(\"addressbook\", \"verifyAddress\"))\n\t{\n\t\t\/\/-- store address info\n    \tvar iCount = xmlmc.GetParam(\"addressCount\");\n   \t\tvar xmlAddresses = xmlmc.xmlDOM.getElementsByTagName(\"address\");\n   \t\tfor(var x=0; x < xmlAddresses.length;x++)\n   \t\t{\n   \t\t\tvar xmlAddress = xmlAddresses[x];\n    \t\tvar strEmail = app.xmlNodeTextByTag(xmlAddress,\"email\");\n    \t\tvar strName = app.xmlNodeTextByTag(xmlAddress,\"name\");\n    \t\tvar strTransport = app.xmlNodeTextByTag(xmlAddress,\"transport\");\t\n    \t\t\n    \t\tvar arrRow = new Array(strName,strEmail,strTransport);\n\t\t\tmainform.sl_address._insertrow(arrRow,1);\t\t\t\n    \t}\t\n\t}\n\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"361","height":"291","backgroundColor":"#eaeaea","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"sl_address","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"false","horizontalGridLines":"false","autoLoad":"false","allowMultiSelect":"false"}},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"78","left":"9","right":"357","bottom":"288"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Name","width":"154","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Address","width":"209","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Transport","width":"120","image":"-1","dataColumn":"2"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#cae1ee","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"1","borderColor":"#d3c9b6"}}},{"general":{"name":"btn_ok","type":"EventButton"},"appearance":{"index":"1","caption":"Select","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"11","left":"294","right":"355","bottom":"37"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"2","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"41","left":"294","right":"355","bottom":"67"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"flg_filter","type":"Field","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"3","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"None"},"objectPlacement":{"position":{"top":"40","left":"4","right":"167","bottom":"73"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Form Flags","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#d3c9b6","image":"#eeeeee","flagItems":"Show matching entries^2|Show all entries^4|","disabledBackgroundColor":"#eeeeee","defaultValue":"2"}}},{"general":{"name":"tb_checkvalue","type":"Field"},"appearance":{"index":"4","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"14","left":"10","right":"274","bottom":"32"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Text Edit","textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#4d4d4d","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}}]},"javascript":{"methods":{"method":[{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc.CloseForm();\n\n\n}"},{"name":"btn_ok_OnPressed","code":"btn_ok_OnPressed()\n{\n\t_swdoc._selected_email_address = sl_address.GetItemTextRaw(sl_address.curSel, 1);\n\t_swdoc._selected_email_name = sl_address.GetItemTextRaw(sl_address.curSel, 0);\t\n\t_swdoc._selected_email_transport = sl_address.GetItemTextRaw(sl_address.curSel, 2);\t\t\n\t_swdoc.CloseForm();\n\n}"},{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tif(app.bWebClient==false) return false;\n\n\t_eva(tb_checkvalue , _swdoc.GetArg(\"_email_check_string\"));\n\t_eva(flg_filter , 2);\n\t_swdoc._old_filter_value = flg_filter.value;\t\n\tif(tb_checkvalue.value!=\"\")\n\t{\n\t\t\/\/-- using filter setup sqllist\n\t\t_swdoc._get_matching_addresses(tb_checkvalue.value);\n\t}\n\n}"},{"name":"flg_filter_OnValueChanged","code":"flg_filter_OnValueChanged(strValue)\n{\n\tvar searchFor = \"\";\n\t_een(tb_checkvalue , true);\t\n\tif(strValue==0)\n\t{\n\t\t_een(tb_checkvalue , false);\n\t\t_eva(flg_filter , 4);\n\t}\n\telse if(strValue==6)\n\t{\n\t\tif(_swdoc._old_filter_value==2)\n\t\t{\n\t\t\t_een(tb_checkvalue , false);\t\n\t\t\t_eva(flg_filter , 4);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsearchFor = tb_checkvalue.value;\n\t\t\tif(searchFor==\"\")searchFor = \"-666\";\n\t\t\t_eva(flg_filter , 2);\n\t\t}\n\t}\n\t\n\t_swdoc._old_filter_value = flg_filter.value;\n\t_swdoc._get_matching_addresses(searchFor);\n\n}"},{"name":"tb_checkvalue_OnValueChanged","code":"tb_checkvalue_OnValueChanged(strValue)\n{\n\tif(flg_filter.value==2 && strValue==\"\")\n\t{\n\t\t_swdoc._get_matching_addresses(\"-666\");\n\t}\n\telse\n\t{\n\t\t_swdoc._get_matching_addresses(strValue);\n\t}\n\t\n}"},{"name":"sl_address_OnItemSelected","code":"sl_address_OnItemSelected(nRow)\n{\n\t_een(btn_ok , true);\n\n\n}"},{"name":"sl_address_OnHeaderItemClicked","code":"sl_address_OnHeaderItemClicked(strOrder, nCol)\n{\n\t\/\/-- cannot order address search\n\treturn false;\n\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}