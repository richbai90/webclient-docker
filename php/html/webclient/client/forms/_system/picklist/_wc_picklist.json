{"espForm":{"configuration":{"settings":{"name":"_wc_picklist","title":"Choose","description":"webclient picklist form for lcf","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"var _selected_picklistkey = \"\";\nvar _selected_table = \"\";"}}}},"layouts":{"layout":[{"appearance":{"width":"555","height":"231","backgroundColor":"#d4d0c8","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"sl_picklist","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"false","horizontalGridLines":"false","autoLoad":"false","allowMultiSelect":"false"}},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"3-D Sunken"},"objectPlacement":{"position":{"top":"9","left":"6","right":"478","bottom":"224"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#cae1ee","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#d3c9b6","sqlSource":"swdata"}}},{"general":{"name":"btn_prop","type":"EventButton"},"appearance":{"index":"1","caption":"Properties","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"9","left":"488","right":"549","bottom":"36"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_new","type":"EventButton"},"appearance":{"index":"2","caption":"New","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"40","left":"488","right":"549","bottom":"67"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_select","type":"EventButton"},"appearance":{"index":"3","caption":"Select","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"164","left":"488","right":"549","bottom":"191"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_cancel","type":"EventButton"},"appearance":{"index":"4","caption":"Cancel","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"196","left":"488","right":"549","bottom":"223"},"scaling":{"top":"100","left":"100","right":"100","bottom":"100"}},"controlInfo":{"mouseOverCursor":"Window Default","properties":{"backgroundColor":"#ff9900"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\tif(IsObjectDefined(\"app._xmlPickLists\")==false)return;\n\n\t\/\/-- get picklist details from xml\n\tif(app._xmlPickLists==null)\n\t{\n\t\tMessageBox(\"The picklist definition (\"+ top._primary_key +\") does not exist. Please contact your Administrator\");\n\t\t_swdoc.CloseForm();\n\t\treturn;\n\t}\n\n\tvar xmlPL = null;\n\tvar arrPickLists = app._xmlPickLists.getElementsByTagName('pickListForm');\n\tfor(var x=0;x < arrPickLists.length;x++)\n\t{\n\t\tvar strName = app.xmlNodeTextByTag(arrPickLists[x],\"name\");\n\t\tif(strName==top._primary_key)\n\t\t{\n\t\t\txmlPL = arrPickLists[x];\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t\/\/-- set sqllist (sl_picklist)\n\tif(xmlPL!=null)\n\t{\n\t\t\/\/-- \n\t\t_swdoc.SetTitle(app.xmlNodeTextByTag(xmlPL,\"title\"));\n\n\t\t\/\/-- set sqltable properties\n\t\tsl_picklist.table = app.xmlNodeTextByTag(xmlPL,\"table\");\n\t\t_swdoc._selected_table = sl_picklist.table;\n\t\tsl_picklist.editRecordForm = app.xmlNodeTextByTag(xmlPL,\"propertiesForm\");\n\t\tsl_picklist.addRecordForm = app.xmlNodeTextByTag(xmlPL,\"newRecordForm\");\t\n\t\t\n\t\t\/\/-- get columns and draw out\n\t\tvar strColumnXML = \"\";\n\t\tvar arrColumns = app.xmlNodeTextByTag(xmlPL,\"visibleColumns\").split(\",\");\n\t\tsl_picklist._create_bespoke_xmlcols(arrColumns);\t\t\n\n\t\t\/\/-- set filter\t\n\t\tvar strFilter = _swdoc.GetArg('_filter');\n\t\tif(strFilter==undefined || strFilter==\"\")\n\t\t{\n\t\t\tvar strFilterCol = _swdoc.GetArg('_resolvecolumn');\n\t\t\tvar strFilterValue = _swdoc.GetArg('_resolvevalue');\n\t\t\tif(app.dd.tables[sl_picklist.table].columns[strFilterCol].IsNumeric())\n\t\t\t{\n\t\t\t\tif(isNaN(strFilterValue))\n\t\t\t\t{\n\t\t\t\t\tMessageBox('The column you are resolving agaisnt is numeric. Please enter a numeric value');\n\t\t\t\t\t_swdoc.CloseForm();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tsl_picklist._filter(strFilterCol + '=' + strFilterValue);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tsl_picklist._filter(strFilterCol + \" like '%\" + app.pfs(strFilterValue) + \"%'\");\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tsl_picklist._filter(strFilter);\n\t\t}\n\t}\n\n\n\n}"},{"name":"btn_select_OnPressed","code":"btn_select_OnPressed()\n{\n    var sCol = dd.tables[sl_picklist.table].PrimaryKey;\n\tvar keyValue = sl_picklist.GetItemTextRaw(sl_picklist.curSel, sCol)\n\t\n\tif(keyValue!=\"\")\n\t{\n\t\t_swdoc._selected_picklistkey = keyValue;\n\t\t_swdoc.CloseForm();\n\t}\n}"},{"name":"btn_prop_OnPressed","code":"btn_prop_OnPressed()\n{\n\tsl_picklist.EditRecord(sl_picklist.curSel);\n}"},{"name":"btn_cancel_OnPressed","code":"btn_cancel_OnPressed()\n{\n\t_swdoc._selected_picklistkey = \"\";\n\t_swdoc.CloseForm()\n\t\n\n\n}"},{"name":"btn_new_OnPressed","code":"btn_new_OnPressed()\n{\n\tsl_picklist.CreateRecord();\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}