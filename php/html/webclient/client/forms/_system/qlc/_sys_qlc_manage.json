{"espForm":{"configuration":{"settings":{"name":"_sys_qlc_manage","title":"Manage Quick-Log Templates","description":"webclient sys form that allows user to enter save details for a quick log call","options":{"allowResize":"true","showMenubar":"false","showToolbar":"false","showStatusBar":"false"}},"javascript":{"methods":{"method":{"name":"(Globals)","code":"\nfunction _filter_qlc_sqllist(strFolderName)\n{\n\t\/\/-- clear down\n\tmainform.sl_templates._RemoveAllRows();\n\t\n\t\/\/-- get list of qlc templates for folder\n\tvar xmlmc = new XmlMethodCall();\n\txmlmc.SetParam(\"mailbox\",strFolderName);\n\tif(xmlmc.Invoke(\"helpdesk\",\"quicklogCallGetList\"))\n\t{\n\t\t\/\/-- add items to sqllist\n\t\tvar arrQLI = xmlmc.xmlDOM.getElementsByTagName(\"quicklogCall\");\n\t\tfor (var y=0;y<arrQLI.length;y++)\n\t\t{\n\t\t\tvar strCommID = app.xmlNodeTextByTag(arrQLI[y],\"quicklogCallName\");\n\t\t\tvar strQlcName =  app.xmlNodeTextByTag(arrQLI[y],\"quicklogCallName\");\n\t\t\tvar strQlcForm =  app.xmlNodeTextByTag(arrQLI[y],\"formName\");\n\t\t\tvar strQlcClass =  app.xmlNodeTextByTag(arrQLI[y],\"callClass\");\t\t\n\t\t\tvar arrData = new Array();\n\t\t\tarrData[0] = strCommID;\n\t\t\tarrData[1] = strQlcName;\t\n\t\t\tarrData[2] = strQlcForm;\t\t\n\t\t\tarrData[3] = strQlcClass;\t\t\t\n\t\t\tmainform.sl_templates._insertrow(arrData,1);\n\t\t}\n\t}\n\n}"}}}},"layouts":{"layout":[{"appearance":{"width":"444","height":"189","backgroundColor":"#eaeaea","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"controls":{"control":[{"general":{"name":"lb_savein","type":"Field"},"appearance":{"index":"0","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"21","left":"65","right":"369","bottom":"39"},"scaling":{"top":"0","left":"0","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","type":"Pick List (Numeric Mode)","flags":{"invisible":"false","readOnly":"false","mandatory":"true","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","comboAutoUpdate":"false","comboNewValues":"true","useDDPickList":"false"},"textLineCount":"0","textInputFormat":"Text","properties":{"borderColor":"#000000","image":"#eeeeee","disabledBackgroundColor":"#eeeeee"}}},{"general":{"name":"lbl_lb_savein","type":"Text","flags":{"transparent":"true","xpStyle":"false","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false"}},"appearance":{"index":"1","caption":"Look in :","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"alignment":"Right","borderStyle":"None","fillStyle":"Solid"},"objectPlacement":{"position":{"top":"20","left":"5","right":"61","bottom":"38"},"scaling":{"top":"0","left":"0","right":"0","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default"}},{"general":{"name":"sl_templates","type":"SqlTable","flags":{"transparent":"false","xpStyle":"true","hasShadow":"false","toolbarButtonStyle":"false","cache":"false","hasBorder":"false","hasCheckbox":"false","showHeader":"true","verticalGridLines":"false","horizontalGridLines":"false","autoLoad":"false","allowMultiSelect":"false"}},"appearance":{"index":"2","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"},"borderStyle":"Rectangle"},"objectPlacement":{"position":{"top":"47","left":"17","right":"369","bottom":"184"},"scaling":{"top":"0","left":"0","right":"100","bottom":"100"}},"columns":{"controlInfo":[{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"true","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"commID","width":"15","image":"-1","dataColumn":"0"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Template Name","width":"179","image":"-1","dataColumn":"1"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Form Type","width":"120","image":"-1","dataColumn":"2"},{"mouseOverCursor":"Window Default","type":"Text Edit","flags":{"invisible":"false","readOnly":"false","mandatory":"false","mandatoryLabelBackground":"false","mandatoryLabelText":"false","allowNullValue":"false","skipTabStop":"false","disabled":"false","protected":"false","noMacroExpand":"false","readOnlyInit":"false","autoCompleteField":"false","editUnlimitedText":"false","url":"false","hidden":"false","allowResize":"true","allowSort":"true"},"textLineCount":"0","textInputFormat":"Text","name":"Class","width":"120","image":"-1","dataColumn":"3"}]},"sortColumn":"-1","sortDescending":"false","headerHeight":"18","rowHeight":"16","selectedColor":"#0024c0","selectedTextColor":"#ffffff","controlInfo":{"mouseOverCursor":"Window Default","properties":{"highlightStyle":"0","borderColor":"#000000"}}},{"general":{"name":"btn_view","type":"EventButton"},"appearance":{"index":"3","caption":"View","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"45","left":"378","right":"438","bottom":"71"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}},{"general":{"name":"btn_delete","type":"EventButton"},"appearance":{"index":"4","caption":"Delete","backgroundColor":"#ffffff","foregroundColor":"#000000","font":{"@size":"8","#text":"Arial"}},"objectPlacement":{"position":{"top":"75","left":"378","right":"438","bottom":"101"},"scaling":{"top":"0","left":"100","right":"100","bottom":"0"}},"controlInfo":{"mouseOverCursor":"Window Default","flags":{"invisible":"false","skipTabStop":"false","disabled":"true","protected":"false","noMacroExpand":"false","multiLine":"false"},"properties":{"backgroundColor":"#ff9900"}}}]},"javascript":{"methods":{"method":[{"name":"OnFormLoaded","code":"OnFormLoaded(bDataReloaded)\n{\n\t\n\tif(!app.bWebClient)return;\n\t\t\n\t\/\/-- get list of mailboxes user can save ql item to\n\tvar boolNoRight = true;\t\n\tvar strSaveIn =\"\";\t\n\t_swdoc._arr_folders = new Array();\t\n\tfor(var x=0;x< app._arr_xml_mailbox_list.length;x++)\n\t{\n\t\tvar xmlMb = app._arr_xml_mailbox_list[x];\n\n\t\tvar strMailboxName = app.xmlNodeTextByTag(xmlMb,\"name\")\n\t\tvar strMailboxDisplay = app.xmlNodeTextByTag(xmlMb,\"displayName\")\n\t\tvar intType = app.xmlNodeTextByTag(xmlMb,\"type\")\n\t\tif(intType==1)strMailboxDisplay=\"My Quick-Log Calls\";\n\t\n\t\t\/\/-- check that have permission to manage qlog\n\t\tif(!app._email_checkright(_EM_MANAGEQLOG, strMailboxName, false)) \n\t\t{\n\t\t\t\/\/-- no permission so do not display\n\t\t\tboolNoRight = true;\n\t\t\tcontinue;\n\t\t}\n\t\t\n\t\tif(strSaveIn!=\"\")strSaveIn+=\"|\";\n\t\tstrSaveIn += strMailboxDisplay+\"^\"+x;\n\t\t_swdoc._arr_folders[x] = strMailboxName;\n\t}\t\n\n\tif(strSaveIn==\"\")\n\t{\n\t\tif(boolNoRight) MessageBox(_EM_RIGHTS_MSG[_EM_MANAGEQLOG]);\n\t\t_swdoc.CloseForm();\n\t\treturn false;\n\t}\n\tlb_savein.pickList = strSaveIn;\n\t_eva(lb_savein , 0);\n\n\t\/\/-- add sqllist items based on first quicklog call folder\n\t_swdoc._filter_qlc_sqllist(_swdoc._arr_folders[0]);\n\n}"},{"name":"lb_savein_OnValueChanged","code":"lb_savein_OnValueChanged(strValue)\n{\n\n\t_een(btn_view,false);\n\t_een(btn_delete,false);\t\n\t_swdoc._filter_qlc_sqllist(_swdoc._arr_folders[strValue]);\n}"},{"name":"sl_templates_OnItemSelected","code":"sl_templates_OnItemSelected(nRow)\n{\n\t\/\/-- set \n\tvar strName = sl_templates.GetItemText(nRow, 1);\n\tif(strName!=\"\")\n\t{\n\t\t_een(btn_view,true);\n\t\t_een(btn_delete,true);\t\n\t}\n\telse\n\t{\n\t\t_een(btn_view,false);\n\t\t_een(btn_delete,false);\t\n\t}\n\t\n}"},{"name":"btn_view_OnPressed","code":"btn_view_OnPressed()\n{\n\t\/\/-- run quicklog call from here\n\tapp.global._runQuickLogCall(sl_templates.GetItemText(sl_templates.curSel, 1),_swdoc._arr_folders[lb_savein.value]);\n\n}"},{"name":"btn_delete_OnPressed","code":"btn_delete_OnPressed()\n{\n\tif(app.global._deleteQuickLogCall(sl_templates.GetItemText(sl_templates.curSel, 1),_swdoc._arr_folders[lb_savein.value]))\n\t{\n\t\t_een(btn_view,false);\n\t\t_een(btn_delete,false);\t\n\t\t_swdoc._filter_qlc_sqllist(_swdoc._arr_folders[lb_savein.value]);\t\t\n\t}\n}"}]}}},{"appearance":{"width":"360","height":"220","backgroundColor":"#ffffff","fillColour":"#ffffff","textColour":"#000000","font":{"@size":"8","#text":"Arial"}},"javascript":{}}]}}}